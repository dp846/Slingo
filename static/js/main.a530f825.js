/*! For license information please see main.a530f825.js.LICENSE.txt */
!function(){var e={8354:function(e,t,n){"use strict";var r=n(4836);t.__esModule=!0,t.default=function(e,t){e.classList?e.classList.add(t):(0,a.default)(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var a=r(n(3812));e.exports=t.default},3812:function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default},2910:function(e){"use strict";function t(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e.exports=function(e,n){e.classList?e.classList.remove(n):"string"===typeof e.className?e.className=t(e.className,n):e.setAttribute("class",t(e.className&&e.className.baseVal||"",n))}},2618:function(e,t,n){var r;!function(){"use strict";var a=!("undefined"===typeof window||!window.document||!window.document.createElement),i={canUseDOM:a,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:a&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:a&&!!window.screen};void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}()},2176:function(e){"use strict";e.exports=function(e,t,n,r,a,i,o,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,a,i,o,s],l=0;(u=new Error(t.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},8987:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(N){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?g:m;if(t){if(e<0)return g;if(e>=h)return w}else{if(e<=-f)return C;if(e+1>=f)return k}return e<0?s(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=m,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),d=parseInt(e.substring(o,o+u),n);if(u<8){var p=s(c(n,u));i=i.mul(p).add(s(d))}else i=(i=i.mul(a)).add(s(d))}return i.unsigned=t,i}function d(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?l(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=d;var p=4294967296,h=p*p,f=h/2,v=o(1<<24),m=o(0);n.ZERO=m;var g=o(0,!0);n.UZERO=g;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var k=u(-1,2147483647,!1);n.MAX_VALUE=k;var w=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var C=u(0,-2147483648,!1);n.MIN_VALUE=C;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(C)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(e);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(y)},S.neg=S.negate,S.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,p=0,h=0,f=0;return h+=(f+=i+(65535&e.low))>>>16,p+=(h+=a+c)>>>16,l+=(p+=n+s)>>>16,l+=t+o,u((h&=65535)<<16|(f&=65535),(l&=65535)<<16|(p&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return m;if(r(e)||(e=d(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(C))return e.isOdd()?C:m;if(e.eq(C))return this.isOdd()?C:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,p=e.low>>>16,h=65535&e.low,f=0,g=0,y=0,b=0;return y+=(b+=o*h)>>>16,g+=(y+=i*h)>>>16,y&=65535,g+=(y+=o*p)>>>16,f+=(g+=a*h)>>>16,g&=65535,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=o*l)>>>16,f+=n*h+a*p+i*l+o*c,u((y&=65535)<<16|(b&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return b;i=g}else{if(this.eq(C))return e.eq(y)||e.eq(x)?C:e.eq(C)?y:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?y:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(C))return this.unsigned?g:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),p=s(n),h=p.mul(e);h.isNegative()||h.gt(a);)h=(p=s(n-=l,this.unsigned)).mul(e);p.isZero()&&(p=y),i=i.add(p),a=a.sub(h)}return i},S.div=S.divide,S.modulo=function(e){return r(e)||(e=d(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return u(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=d(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=d(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=d(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var F=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var M,z=Object.assign;function P(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var B=!1;function V(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function W(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case w:return"Portal";case N:return"Profiler";case S:return"StrictMode";case _:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(he).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ge=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ce=null,Se=null;function Ne(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=ka(t),we(e.stateNode,e.type,t))}}function Ie(e){Ce?Se?Se.push(e):Se=[e]:Ce=e}function Te(){if(Ce){var e=Ce,t=Se;if(Se=Ce=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ee(e,t){return e(t)}function _e(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ee(e,t,n)}finally{Re=!1,(null!==Ce||null!==Se)&&(_e(),Te())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=ka(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Fe=!1;if(l)try{var De={};Object.defineProperty(De,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(le){Fe=!1}function Le(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Me=!1,ze=null,Pe=!1,Be=null,Ve={onError:function(e){Me=!0,ze=e}};function We(e,t,n,r,a,i,o,s,u){Me=!1,ze=null,Le.apply(Ve,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return He(a),e;if(o===r)return He(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ze=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,$e=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=dt(s):0!==(i&=o)&&(r=dt(i))}else 0!==(o=n&~a)?r=dt(o):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,wt,Ct,St,Nt,It=!1,Tt=[],Et=null,_t=null,Rt=null,At=new Map,Ot=new Map,Ft=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Mt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function zt(e){var t=ya(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void Nt(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){Pt(e)&&n.delete(t)}function Vt(){It=!1,null!==Et&&Pt(Et)&&(Et=null),null!==_t&&Pt(_t)&&(_t=null),null!==Rt&&Pt(Rt)&&(Rt=null),At.forEach(Bt),Ot.forEach(Bt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function Ut(e){function t(t){return Wt(t,e)}if(0<Tt.length){Wt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Wt(Et,e),null!==_t&&Wt(_t,e),null!==Rt&&Wt(Rt,e),At.forEach(t),Ot.forEach(t),n=0;n<Ft.length;n++)(r=Ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ft.length&&null===(n=Ft[0]).blockedOn;)zt(n),null===n.blockedOn&&Ft.shift()}var jt=x.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,jt.transition=i}}function qt(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,jt.transition=i}}function Kt(e,t,n,r){if(Ht){var a=Zt(e,t,n,r);if(null===a)Hr(e,t,r,Xt,n),Lt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Mt(Et,e,t,n,r,a),!0;case"dragenter":return _t=Mt(_t,e,t,n,r,a),!0;case"mouseover":return Rt=Mt(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Mt(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ot.set(i,Mt(Ot.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&kt(i),null===(i=Zt(e,t,n,r))&&Hr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function Zt(e,t,n,r){if(Xt=null,null!==(e=ya(e=ke(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return $t=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),dn=z({},cn,{view:0,detail:0}),pn=an(dn),hn=z({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=an(hn),vn=an(z({},hn,{dataTransfer:0})),mn=an(z({},dn,{relatedTarget:0})),gn=an(z({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=z({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(z({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function Nn(){return Sn}var In=z({},dn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(In),En=an(z({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=an(z({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),Rn=an(z({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=z({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(An),Fn=[9,13,27,32],Dn=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ln,zn=l&&(!Dn||Ln&&8<Ln&&11>=Ln),Pn=String.fromCharCode(32),Bn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Fn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ie(r),0<(t=qr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Xn(e){Pr(e,0)}function Zn(e){if(K(xa(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(l){var Jn;if(l){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&Zn(Kn)){var t=[];Gn(t,Kn,e,ke(e)),Ae(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zn(Kn)}function ir(e,t){if("click"===e)return Zn(t)}function or(e,t){if("input"===e||"change"===e)return Zn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=qr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Cr={},Sr={};function Nr(e){if(Cr[e])return Cr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Cr[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Ir=Nr("animationend"),Tr=Nr("animationiteration"),Er=Nr("animationstart"),_r=Nr("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Rr.set(e,t),u(t,[e])}for(var Fr=0;Fr<Ar.length;Fr++){var Dr=Ar[Fr];Or(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Or(Ir,"onAnimationEnd"),Or(Tr,"onAnimationIteration"),Or(Er,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(_r,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function zr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(We.apply(this,arguments),Me){if(!Me)throw Error(i(198));var l=ze;Me=!1,ze=null,Pe||(Pe=!0,Be=l)}}(r,t,void 0,e),e.currentTarget=null}function Pr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;zr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;zr(a,s,c),i=u}}}if(Pe)throw e=Be,Pe=!1,Be=null,e}function Br(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Wr]){e[Wr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,Vr("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Yt(t)){case 1:var a=Gt;break;case 4:a=qt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!Fe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=ke(n),o=[];e:{var s=Rr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Tn;break;case"focusin":c="focus",u=mn;break;case"focusout":c="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=_n;break;case Ir:case Tr:case Er:u=gn;break;case _r:u=Rn;break;case"scroll":u=pn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=En}var l=0!==(4&t),d=!l&&"scroll"===e,p=l?null!==s?s+"Capture":null:s;l=[];for(var h,f=r;null!==f;){var v=(h=f).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==p&&(null!=(v=Oe(f,p))&&l.push(Gr(f,v,h)))),d)break;f=f.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(d=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=fn,v="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(l=En,v="onPointerLeave",p="onPointerEnter",f="pointer"),d=null==u?s:xa(u),h=null==c?s:xa(c),(s=new l(v,f+"leave",u,n,a)).target=d,s.relatedTarget=h,v=null,ya(a)===r&&((l=new l(p,f+"enter",c,n,a)).target=h,l.relatedTarget=d,v=l),d=v,u&&c)e:{for(p=c,f=0,h=l=u;h;h=Kr(h))f++;for(h=0,v=p;v;v=Kr(v))h++;for(;0<f-h;)l=Kr(l),f--;for(;0<h-f;)p=Kr(p),h--;for(;f--;){if(l===p||null!==p&&l===p.alternate)break e;l=Kr(l),p=Kr(p)}l=null}else l=null;null!==u&&Xr(o,s,u,l,!1),null!==c&&null!==d&&Xr(o,d,c,l,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Yn;else if(Hn(s))if(Qn)m=or;else{m=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Gn(o,m,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?xa(r):window,e){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(zn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Jt="value"in(Qt=a)?Qt.value:Qt.textContent,Un=!0)),0<(g=qr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Pn);case"textInput":return(e=t.data)===Pn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Dn&&Vn(e,t)?(e=en(),$t=Jt=Qt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Pr(o,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=Oe(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Oe(n,i))&&o.unshift(Gr(n,u,s)):a||null!=(u=Oe(n,i))&&o.push(Gr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Zr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Zr,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function $r(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),pa="__reactFiber$"+da,ha="__reactProps$"+da,fa="__reactContainer$"+da,va="__reactEvents$"+da,ma="__reactListeners$"+da,ga="__reactHandles$"+da;function ya(e){var t=e[pa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[pa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[pa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[pa]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ka(e){return e[ha]||null}var wa=[],Ca=-1;function Sa(e){return{current:e}}function Na(e){0>Ca||(e.current=wa[Ca],wa[Ca]=null,Ca--)}function Ia(e,t){Ca++,wa[Ca]=e.current,e.current=t}var Ta={},Ea=Sa(Ta),_a=Sa(!1),Ra=Ta;function Aa(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Fa(){Na(_a),Na(Ea)}function Da(e,t,n){if(Ea.current!==Ta)throw Error(i(168));Ia(Ea,t),Ia(_a,n)}function La(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,j(e)||"Unknown",a));return z({},n,r)}function Ma(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Ra=Ea.current,Ia(Ea,e),Ia(_a,_a.current),!0}function za(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=La(e,t,Ra),r.__reactInternalMemoizedMergedChildContext=e,Na(_a),Na(Ea),Ia(Ea,e)):Na(_a),Ia(_a,n)}var Pa=null,Ba=!1,Va=!1;function Wa(e){null===Pa?Pa=[e]:Pa.push(e)}function Ua(){if(!Va&&null!==Pa){Va=!0;var e=0,t=bt;try{var n=Pa;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Pa=null,Ba=!1}catch(a){throw null!==Pa&&(Pa=Pa.slice(e+1)),Ke($e,Ua),a}finally{bt=t,Va=!1}}return null}var ja=[],Ha=0,Ga=null,qa=0,Ka=[],Xa=0,Za=null,Ya=1,Qa="";function Ja(e,t){ja[Ha++]=qa,ja[Ha++]=Ga,Ga=e,qa=t}function $a(e,t,n){Ka[Xa++]=Ya,Ka[Xa++]=Qa,Ka[Xa++]=Za,Za=e;var r=Ya;e=Qa;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ya=1<<32-ot(t)+a|n<<a|r,Qa=i+e}else Ya=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&(Ja(e,1),$a(e,1,0))}function ti(e){for(;e===Ga;)Ga=ja[--Ha],ja[Ha]=null,qa=ja[--Ha],ja[Ha]=null;for(;e===Za;)Za=Ka[--Xa],Ka[Xa]=null,Qa=Ka[--Xa],Ka[Xa]=null,Ya=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Za?{id:Ya,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw pi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ri;e;)e=ca(e.nextSibling)}function hi(){ri=ni=null,ai=!1}function fi(e){null===ii?ii=[e]:ii.push(e)}var vi=x.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=z({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gi=Sa(null),yi=null,bi=null,xi=null;function ki(){xi=bi=yi=null}function wi(e){var t=gi.current;Na(gi),e._currentValue=t}function Ci(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ni(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ii=null;function Ti(e){null===Ii?Ii=[e]:Ii.push(e)}function Ei(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ti(t)):(n.next=a.next,a.next=n),t.interleaved=n,_i(e,r)}function _i(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function Ai(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Di(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&_u)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,_i(e,n)}return null===(a=r.interleaved)?(t.next=t,Ti(r)):(t.next=a.next,a.next=t),r.interleaved=t,_i(e,n)}function Li(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Mi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zi(e,t,n,r){var a=e.updateQueue;Ri=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var d=a.baseState;for(o=0,l=c=u=null,s=i;;){var p=s.lane,h=s.eventTime;if((r&p)===p){null!==l&&(l=l.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,v=s;switch(p=t,h=n,v.tag){case 1:if("function"===typeof(f=v.payload)){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=v.payload)?f.call(h,d,p):f)||void 0===p)break e;d=z({},d,p);break e;case 2:Ri=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=h,u=d):l=l.next=h,o|=p;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(p=s).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===l&&(u=d),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);zu|=o,e.lanes=o,e.memoizedState=d}}function Pi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Bi=(new r.Component).refs;function Vi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:z({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Wi={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Fi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Di(e,i,a))&&(rc(t,e,a,r),Li(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Fi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Di(e,i,a))&&(rc(t,e,a,r),Li(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Fi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Di(e,a,r))&&(rc(t,e,r,n),Li(t,e,r))}};function Ui(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function ji(e,t,n){var r=!1,a=Ta,i=t.contextType;return"object"===typeof i&&null!==i?i=Ni(i):(a=Oa(t)?Ra:Ea.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):Ta),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Wi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Hi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Wi.enqueueReplaceState(t,t.state,null)}function Gi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Bi,Ai(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ni(i):(i=Oa(t)?Ra:Ea.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Vi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Wi.enqueueReplaceState(a,a.state,null),zi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function qi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Bi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ki(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function Zi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Pc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===C?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Xi(i)===t.type)?((r=a(t,n.props)).ref=qi(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=qi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Pc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=qi(e,null,t),n.return=e,n;case w:return(t=Bc(t,e.mode,n)).return=e,t;case O:return p(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Mc(t,e.mode,n,null)).return=e,t;Ki(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case O:return h(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:d(e,t,n,r,null);Ki(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,a,null);Ki(t,r)}return null}function v(a,i,s,u){for(var c=null,l=null,d=i,v=i=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var g=h(a,d,s[v],u);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(a,d),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g,d=m}if(v===s.length)return n(a,d),ai&&Ja(a,v),c;if(null===d){for(;v<s.length;v++)null!==(d=p(a,s[v],u))&&(i=o(d,i,v),null===l?c=d:l.sibling=d,l=d);return ai&&Ja(a,v),c}for(d=r(a,d);v<s.length;v++)null!==(m=f(d,a,v,s[v],u))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(a,e)})),ai&&Ja(a,v),c}function m(a,s,u,c){var l=L(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var d=l=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=h(a,v,y.value,c);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,m),null===d?l=b:d.sibling=b,d=b,v=g}if(y.done)return n(a,v),ai&&Ja(a,m),l;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=p(a,y.value,c))&&(s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return ai&&Ja(a,m),l}for(v=r(a,v);!y.done;m++,y=u.next())null!==(y=f(v,a,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Ja(a,m),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===C&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===C){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Xi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=qi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===C?((i=Mc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Lc(o.type,o.key,o.props,null,r.mode,u)).ref=qi(r,i,o),u.return=r,r=u)}return s(r);case w:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bc(o,r.mode,u)).return=r,r=i}return s(r);case O:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(L(o))return m(r,i,o,u);Ki(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Pc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Yi=Zi(!0),Qi=Zi(!1),Ji={},$i=Sa(Ji),eo=Sa(Ji),to=Sa(Ji);function no(e){if(e===Ji)throw Error(i(174));return e}function ro(e,t){switch(Ia(to,t),Ia(eo,e),Ia($i,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Na($i),Ia($i,t)}function ao(){Na($i),Na(eo),Na(to)}function io(e){no(to.current);var t=no($i.current),n=ue(t,e.type);t!==n&&(Ia(eo,e),Ia($i,n))}function oo(e){eo.current===e&&(Na($i),Na(eo))}var so=Sa(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var po=x.ReactCurrentDispatcher,ho=x.ReactCurrentBatchConfig,fo=0,vo=null,mo=null,go=null,yo=!1,bo=!1,xo=0,ko=0;function wo(){throw Error(i(321))}function Co(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function So(e,t,n,r,a,o){if(fo=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,po.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,go=mo=null,t.updateQueue=null,po.current=cs,e=n(r,a)}while(bo)}if(po.current=os,t=null!==mo&&null!==mo.next,fo=0,go=mo=vo=null,yo=!1,t)throw Error(i(300));return e}function No(){var e=0!==xo;return xo=0,e}function Io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?vo.memoizedState=go=e:go=go.next=e,go}function To(){if(null===mo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===go?vo.memoizedState:go.next;if(null!==t)go=t,mo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===go?vo.memoizedState=go=e:go=go.next=e}return go}function Eo(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=mo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var d=l.lane;if((fo&d)===d)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=p,s=r):c=c.next=p,vo.lanes|=d,zu|=d}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,zu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Oo(e,t){var n=vo,r=To(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Ho(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Bo(9,Do.bind(null,n,r,a,t),void 0,null),null===Ru)throw Error(i(349));0!==(30&fo)||Fo(n,t,a)}return a}function Fo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Do(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&zo(e)}function Lo(e,t,n){return n((function(){Mo(t)&&zo(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function zo(e){var t=_i(e,1);null!==t&&rc(t,e,1,-1)}function Po(e){var t=Io();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Vo(){return To().memoizedState}function Wo(e,t,n,r){var a=Io();vo.flags|=e,a.memoizedState=Bo(1|t,n,void 0,void 0===r?null:r)}function Uo(e,t,n,r){var a=To();r=void 0===r?null:r;var i=void 0;if(null!==mo){var o=mo.memoizedState;if(i=o.destroy,null!==r&&Co(r,o.deps))return void(a.memoizedState=Bo(t,n,i,r))}vo.flags|=e,a.memoizedState=Bo(1|t,n,i,r)}function jo(e,t){return Wo(8390656,8,e,t)}function Ho(e,t){return Uo(2048,8,e,t)}function Go(e,t){return Uo(4,2,e,t)}function qo(e,t){return Uo(4,4,e,t)}function Ko(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4,4,Ko.bind(null,t,e),n)}function Zo(){}function Yo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Co(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Co(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&fo)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,zu|=n,e.baseState=!0),t)}function $o(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{bt=n,ho.transition=r}}function es(){return To().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ei(e,t,n,r))){rc(n,e,r,tc()),is(n,t,r)}}function ns(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,Ti(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ei(e,t,a,r))&&(rc(n,e,r,a=tc()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ni,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},ss={readContext:Ni,useCallback:function(e,t){return Io().memoizedState=[e,void 0===t?null:t],e},useContext:Ni,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wo(4194308,4,Ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wo(4,2,e,t)},useMemo:function(e,t){var n=Io();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Io();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Io().memoizedState=e},useState:Po,useDebugValue:Zo,useDeferredValue:function(e){return Io().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=$o.bind(null,e[1]),Io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=Io();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ru)throw Error(i(349));0!==(30&fo)||Fo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,jo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,Bo(9,Do.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Io(),t=Ru.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Ya&~(1<<32-ot(Ya)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ko++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ni,useCallback:Yo,useContext:Ni,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:qo,useMemo:Qo,useReducer:_o,useRef:Vo,useState:function(){return _o(Eo)},useDebugValue:Zo,useDeferredValue:function(e){return Jo(To(),mo.memoizedState,e)},useTransition:function(){return[_o(Eo)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ni,useCallback:Yo,useContext:Ni,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:qo,useMemo:Qo,useReducer:Ro,useRef:Vo,useState:function(){return Ro(Eo)},useDebugValue:Zo,useDeferredValue:function(e){var t=To();return null===mo?t.memoizedState=e:Jo(t,mo.memoizedState,e)},useTransition:function(){return[Ro(Eo)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Fi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gu||(Gu=!0,qu=r),ps(0,t)},n}function vs(e,t,n){(n=Fi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ps(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ps(0,t),"function"!==typeof r&&(null===Ku?Ku=new Set([this]):Ku.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Ic.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fi(-1,1)).tag=2,Di(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ks(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Yi(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var i=t.ref;return Si(t,a),r=So(e,t,n,r,i,a),n=No(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ks(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Cs(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Fc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,(e=Dc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Gs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return Ts(e,t,n,r,a)}function Ns(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ia(Du,Fu),Fu|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ia(Du,Fu),Fu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ia(Du,Fu),Fu|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ia(Du,Fu),Fu|=r;return ks(e,t,a,n),t.child}function Is(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,r,a){var i=Oa(n)?Ra:Ea.current;return i=Aa(t,i),Si(t,a),n=So(e,t,n,r,i,a),r=No(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ks(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Es(e,t,n,r,a){if(Oa(n)){var i=!0;Ma(t)}else i=!1;if(Si(t,a),null===t.stateNode)Hs(e,t),ji(t,n,r),Gi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ni(c):c=Aa(t,c=Oa(n)?Ra:Ea.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Hi(t,o,r,c),Ri=!1;var p=t.memoizedState;o.state=p,zi(t,r,o,a),u=t.memoizedState,s!==r||p!==u||_a.current||Ri?("function"===typeof l&&(Vi(t,n,l,r),u=t.memoizedState),(s=Ri||Ui(t,n,s,r,p,u,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Oi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:mi(t.type,s),o.props=c,d=t.pendingProps,p=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ni(u):u=Aa(t,u=Oa(n)?Ra:Ea.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||p!==u)&&Hi(t,o,r,u),Ri=!1,p=t.memoizedState,o.state=p,zi(t,r,o,a);var f=t.memoizedState;s!==d||p!==f||_a.current||Ri?("function"===typeof h&&(Vi(t,n,h,r),f=t.memoizedState),(c=Ri||Ui(t,n,c,r,p,f,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return _s(e,t,n,r,i,a)}function _s(e,t,n,r,a,i){Is(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&za(t,n,!1),Gs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Yi(t,e.child,null,i),t.child=Yi(t,null,s,i)):ks(e,t,s,i),t.memoizedState=r.state,a&&za(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Da(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Da(0,t.context,!1),ro(e,t.containerInfo)}function As(e,t,n,r,a){return hi(),fi(a),t.flags|=256,ks(e,t,n,r),t.child}var Os,Fs,Ds,Ls,Ms={dehydrated:null,treeContext:null,retryLane:0};function zs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ps(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ia(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=zc(u,a,0,null),e=Mc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zs(n),t.memoizedState=Ms,e):Bs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Vs(e,t,s,r=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=zc({mode:"visible",children:r.children},a,0,null),(o=Mc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Yi(t,e.child,null,s),t.child.memoizedState=zs(s),t.memoizedState=Ms,o);if(0===(1&t.mode))return Vs(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Vs(e,t,s,r=ds(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=Ru)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,_i(e,a),rc(r,e,a,-1))}return mc(),Vs(e,t,s,r=ds(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Xa++]=Ya,Ka[Xa++]=Qa,Ka[Xa++]=Za,Ya=e.id,Qa=e.overflow,Za=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Dc(r,s):(s=Mc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?zs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ms,a}return e=(s=e.child).sibling,a=Dc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=zc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vs(e,t,n,r){return null!==r&&fi(r),Yi(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ci(e.return,t,n)}function Us(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function js(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ks(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,n,t);else if(19===e.tag)Ws(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ia(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Us(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Us(t,!0,n,null,i);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),zu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ks(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ks(t),null;case 1:case 17:return Oa(t.type)&&Fa(),Ks(t),null;case 3:return r=t.stateNode,ao(),Na(_a),Na(Ea),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),Fs(e,t),Ks(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Ks(t),null}if(e=no($i.current),di(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[pa]=t,r[ha]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Y(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":q(r),$(r,o,!0);break;case"textarea":q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[pa]=t,e[ha]=r,Os(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Y(e,r),a=Z(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=z({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&pe(e,l):"number"===typeof l&&pe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Br("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":q(e),$(e,r,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ks(t),null;case 6:if(e&&null!=t.stateNode)Ls(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no($i.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[pa]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pa]=t,t.stateNode=r}return Ks(t),null;case 13:if(Na(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))pi(),hi(),t.flags|=98560,o=!1;else if(o=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[pa]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ks(t),o=!1}else null!==ii&&(sc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Lu&&(Lu=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ks(t),null);case 4:return ao(),Fs(e,t),null===e&&Ur(t.stateNode.containerInfo),Ks(t),null;case 10:return wi(t.type._context),Ks(t),null;case 19:if(Na(so),null===(o=t.memoizedState))return Ks(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)qs(o,!1);else{if(0!==Lu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,qs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ia(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>ju&&(t.flags|=128,r=!0,qs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return Ks(t),null}else 2*Qe()-o.renderingStartTime>ju&&1073741824!==n&&(t.flags|=128,r=!0,qs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=so.current,Ia(so,r?1&n|2:1&n),t):(Ks(t),null);case 22:case 23:return pc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Fu)&&(Ks(t),6&t.subtreeFlags&&(t.flags|=8192)):Ks(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Zs(e,t){switch(ti(t),t.tag){case 1:return Oa(t.type)&&Fa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Na(_a),Na(Ea),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Na(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Na(so),null;case 4:return ao(),null;case 10:return wi(t.type._context),null;case 22:case 23:return pc(),null;default:return null}}Os=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Fs=function(){},Ds=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no($i.current);var i,o=null;switch(n){case"input":a=Z(e,a),r=Z(e,r),o=[];break;case"select":a=z({},a,{value:void 0}),r=z({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Br("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Nc(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Nc(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tu(t,n,i)}a=a.next}while(a!==r)}}function au(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ou(e){var t=e.alternate;null!==t&&(e.alternate=null,ou(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[ha],delete t[va],delete t[ma],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var du=null,pu=!1;function hu(e,t,n){for(n=n.child;null!==n;)fu(e,t,n),n=n.sibling}function fu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=du,a=pu;du=null,hu(e,t,n),pu=a,null!==(du=r)&&(pu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(pu?(e=du,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Ut(e)):ua(du,n.stateNode));break;case 4:r=du,a=pu,du=n.stateNode.containerInfo,pu=!0,hu(e,t,n),du=r,pu=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tu(n,t,o),a=a.next}while(a!==r)}hu(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Nc(n,t,s)}hu(e,t,n);break;case 21:hu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,hu(e,t,n),Qs=r):hu(e,t,n);break;default:hu(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=_c.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:du=u.stateNode,pu=!1;break e;case 3:case 4:du=u.stateNode.containerInfo,pu=!0;break e}u=u.return}if(null===du)throw Error(i(160));fu(o,s,a),du=null,pu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Nc(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gu(t,e),t=t.sibling}function gu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mu(t,e),yu(e),4&r){try{ru(3,e,e.return),au(3,e)}catch(m){Nc(e,e.return,m)}try{ru(5,e,e.return)}catch(m){Nc(e,e.return,m)}}break;case 1:mu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(mu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(m){Nc(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Q(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?me(a,p):"dangerouslySetInnerHTML"===d?de(a,p):"children"===d?pe(a,p):b(a,d,p,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(a,!!o.multiple,f,!1):h!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(m){Nc(e,e.return,m)}}break;case 6:if(mu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Nc(e,e.return,m)}}break;case 3:if(mu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){Nc(e,e.return,m)}break;case 4:default:mu(t,e),yu(e);break;case 13:mu(t,e),yu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Uu=Qe())),4&r&&vu(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||d,mu(t,e),Qs=l):mu(t,e),yu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for($s=e,d=e.child;null!==d;){for(p=$s=d;null!==$s;){switch(f=(h=$s).child,h.tag){case 0:case 11:case 14:case 15:ru(4,h,h.return);break;case 1:eu(h,h.return);var v=h.stateNode;if("function"===typeof v.componentWillUnmount){r=h,n=h.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Nc(r,n,m)}}break;case 5:eu(h,h.return);break;case 22:if(null!==h.memoizedState){wu(p);continue}}null!==f?(f.return=h,$s=f):wu(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{a=p.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(m){Nc(e,e.return,m)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(m){Nc(e,e.return,m)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mu(t,e),yu(e),4&r&&vu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(pe(a,""),r.flags&=-33),lu(e,uu(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cu(e,uu(e),o);break;default:throw Error(i(161))}}catch(s){Nc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){$s=e,xu(e,t,n)}function xu(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var a=$s,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Ys;var c=Qs;if(Ys=o,(Qs=u)&&!c)for($s=a;null!==$s;)u=(o=$s).child,22===o.tag&&null!==o.memoizedState?Cu(a):null!==u?(u.return=o,$s=u):Cu(a);for(;null!==i;)$s=i,xu(i,t,n),i=i.sibling;$s=a,Ys=s,Qs=c}ku(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,$s=i):ku(e)}}function ku(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||au(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Pi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Pi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Ut(p)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&iu(t)}catch(h){Nc(t,t.return,h)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function wu(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function Cu(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(u){Nc(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Nc(t,a,u)}}var i=t.return;try{iu(t)}catch(u){Nc(t,i,u)}break;case 5:var o=t.return;try{iu(t)}catch(u){Nc(t,o,u)}}}catch(u){Nc(t,t.return,u)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var Su,Nu=Math.ceil,Iu=x.ReactCurrentDispatcher,Tu=x.ReactCurrentOwner,Eu=x.ReactCurrentBatchConfig,_u=0,Ru=null,Au=null,Ou=0,Fu=0,Du=Sa(0),Lu=0,Mu=null,zu=0,Pu=0,Bu=0,Vu=null,Wu=null,Uu=0,ju=1/0,Hu=null,Gu=!1,qu=null,Ku=null,Xu=!1,Zu=null,Yu=0,Qu=0,Ju=null,$u=-1,ec=0;function tc(){return 0!==(6&_u)?Qe():-1!==$u?$u:$u=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&_u)&&0!==Ou?Ou&-Ou:null!==vi.transition?(0===ec&&(ec=vt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<Qu)throw Qu=0,Ju=null,Error(i(185));gt(e,n,r),0!==(2&_u)&&e===Ru||(e===Ru&&(0===(2&_u)&&(Pu|=n),4===Lu&&uc(e,Ou)),ac(e,r),1===n&&0===_u&&0===(1&t.mode)&&(ju=Qe()+500,Ba&&Ua()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=ht(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=pt(e,e===Ru?Ou:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,Wa(e)}(cc.bind(null,e)):Wa(cc.bind(null,e)),oa((function(){0===(6&_u)&&Ua()})),n=null;else{switch(xt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($u=-1,ec=0,0!==(6&_u))throw Error(i(327));var n=e.callbackNode;if(Cc()&&e.callbackNode!==n)return null;var r=pt(e,e===Ru?Ou:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=_u;_u|=2;var o=vc();for(Ru===e&&Ou===t||(Hu=null,ju=Qe()+500,hc(e,t));;)try{bc();break}catch(u){fc(e,u)}ki(),Iu.current=o,_u=a,null!==Au?t=0:(Ru=null,Ou=0,t=Lu)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=oc(e,a))),1===t)throw n=Mu,hc(e,0),uc(e,r),ac(e,Qe()),n;if(6===t)uc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(o=ft(e))&&(r=o,t=oc(e,o))),1===t))throw n=Mu,hc(e,0),uc(e,r),ac(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Wu,Hu);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=Uu+500-Qe())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Wu,Hu),t);break}wc(e,Wu,Hu);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nu(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Wu,Hu),r);break}wc(e,Wu,Hu);break;default:throw Error(i(329))}}}return ac(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=Vu;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Wu,Wu=n,null!==t&&sc(t)),e}function sc(e){null===Wu?Wu=e:Wu.push.apply(Wu,e)}function uc(e,t){for(t&=~Bu,t&=~Pu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&_u))throw Error(i(327));Cc();var t=pt(e,0);if(0===(1&t))return ac(e,Qe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Mu,hc(e,0),uc(e,t),ac(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Wu,Hu),ac(e,Qe()),null}function lc(e,t){var n=_u;_u|=1;try{return e(t)}finally{0===(_u=n)&&(ju=Qe()+500,Ba&&Ua())}}function dc(e){null!==Zu&&0===Zu.tag&&0===(6&_u)&&Cc();var t=_u;_u|=1;var n=Eu.transition,r=bt;try{if(Eu.transition=null,bt=1,e)return e()}finally{bt=r,Eu.transition=n,0===(6&(_u=t))&&Ua()}}function pc(){Fu=Du.current,Na(Du)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Fa();break;case 3:ao(),Na(_a),Na(Ea),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Na(so);break;case 10:wi(r.type._context);break;case 22:case 23:pc()}n=n.return}if(Ru=e,Au=e=Dc(e.current,null),Ou=Fu=t,Lu=0,Mu=null,Bu=Pu=zu=0,Wu=Vu=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(r=(n=Ii[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ii=null}return e}function fc(e,t){for(;;){var n=Au;try{if(ki(),po.current=os,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(fo=0,go=mo=vo=null,bo=!1,xo=0,Tu.current=null,null===n||null===n.return){Lu=1,Mu=t,Au=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ou,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,d=u,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,u,0,t),1&f.mode&&ms(o,l,t),c=l;var v=(t=f).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){ms(o,l,t),mc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,u,0,t),fi(ls(c,u));break e}}o=c=ls(c,u),4!==Lu&&(Lu=2),null===Vu?Vu=[o]:Vu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Mi(o,fs(0,c,t));break e;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ku||!Ku.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Mi(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}kc(n)}catch(x){t=x,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function vc(){var e=Iu.current;return Iu.current=os,null===e?os:e}function mc(){0!==Lu&&3!==Lu&&2!==Lu||(Lu=4),null===Ru||0===(268435455&zu)&&0===(268435455&Pu)||uc(Ru,Ou)}function gc(e,t){var n=_u;_u|=2;var r=vc();for(Ru===e&&Ou===t||(Hu=null,hc(e,t));;)try{yc();break}catch(a){fc(e,a)}if(ki(),_u=n,Iu.current=r,null!==Au)throw Error(i(261));return Ru=null,Ou=0,Lu}function yc(){for(;null!==Au;)xc(Au)}function bc(){for(;null!==Au&&!Ze();)xc(Au)}function xc(e){var t=Su(e.alternate,e,Fu);e.memoizedProps=e.pendingProps,null===t?kc(e):Au=t,Tu.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Fu)))return void(Au=n)}else{if(null!==(n=Zs(n,t)))return n.flags&=32767,void(Au=n);if(null===e)return Lu=6,void(Au=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Au=t);Au=t=e}while(null!==t);0===Lu&&(Lu=5)}function wc(e,t,n){var r=bt,a=Eu.transition;try{Eu.transition=null,bt=1,function(e,t,n,r){do{Cc()}while(null!==Zu);if(0!==(6&_u))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Ru&&(Au=Ru=null,Ou=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xu||(Xu=!0,Rc(tt,(function(){return Cc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Eu.transition,Eu.transition=null;var s=bt;bt=1;var u=_u;_u|=4,Tu.current=null,function(e,t){if(ea=Ht,hr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var s=0,u=-1,c=-1,l=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==a&&3!==p.nodeType||(u=s+a),p!==o||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++l===a&&(u=s),h===o&&++d===r&&(c=s),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(k){Nc(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}v=nu,nu=!1}(e,n),gu(n,e),fr(ta),Ht=!!ea,ta=ea=null,e.current=n,bu(n,e,a),Ye(),_u=u,bt=s,Eu.transition=o}else e.current=n;if(Xu&&(Xu=!1,Zu=e,Yu=a),o=e.pendingLanes,0===o&&(Ku=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Gu)throw Gu=!1,e=qu,qu=null,e;0!==(1&Yu)&&0!==e.tag&&Cc(),o=e.pendingLanes,0!==(1&o)?e===Ju?Qu++:(Qu=0,Ju=e):Qu=0,Ua()}(e,t,n,r)}finally{Eu.transition=a,bt=r}return null}function Cc(){if(null!==Zu){var e=xt(Yu),t=Eu.transition,n=bt;try{if(Eu.transition=null,bt=16>e?16:e,null===Zu)var r=!1;else{if(e=Zu,Zu=null,Yu=0,0!==(6&_u))throw Error(i(331));var a=_u;for(_u|=4,$s=e.current;null!==$s;){var o=$s,s=o.child;if(0!==(16&$s.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for($s=l;null!==$s;){var d=$s;switch(d.tag){case 0:case 11:case 15:ru(8,d,o)}var p=d.child;if(null!==p)p.return=d,$s=p;else for(;null!==$s;){var h=(d=$s).sibling,f=d.return;if(ou(d),d===l){$s=null;break}if(null!==h){h.return=f,$s=h;break}$s=f}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}$s=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,$s=s;else e:for(;null!==$s;){if(0!==(2048&(o=$s).flags))switch(o.tag){case 0:case 11:case 15:ru(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,$s=y;break e}$s=o.return}}var b=e.current;for($s=b;null!==$s;){var x=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,$s=x;else e:for(s=b;null!==$s;){if(0!==(2048&(u=$s).flags))try{switch(u.tag){case 0:case 11:case 15:au(9,u)}}catch(w){Nc(u,u.return,w)}if(u===s){$s=null;break e}var k=u.sibling;if(null!==k){k.return=u.return,$s=k;break e}$s=u.return}}if(_u=a,Ua(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Eu.transition=t}}return!1}function Sc(e,t,n){e=Di(e,t=fs(0,t=ls(n,t),1),1),t=tc(),null!==e&&(gt(e,1,t),ac(e,t))}function Nc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ku||!Ku.has(r))){t=Di(t,e=vs(t,e=ls(n,e),1),1),e=tc(),null!==t&&(gt(t,1,e),ac(t,e));break}}t=t.return}}function Ic(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Ru===e&&(Ou&n)===n&&(4===Lu||3===Lu&&(130023424&Ou)===Ou&&500>Qe()-Uu?hc(e,0):Bu|=n),ac(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=_i(e,t))&&(gt(e,t,n),ac(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function _c(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Tc(e,n)}function Rc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,r){return new Ac(e,t,n,r)}function Fc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Fc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case C:return Mc(n.children,a,o,t);case S:s=8,a|=8;break;case N:return(e=Oc(12,n,t,2|a)).elementType=N,e.lanes=o,e;case _:return(e=Oc(13,n,t,a)).elementType=_,e.lanes=o,e;case R:return(e=Oc(19,n,t,a)).elementType=R,e.lanes=o,e;case F:return zc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case T:s=9;break e;case E:s=11;break e;case A:s=14;break e;case O:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Oc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Oc(7,e,r,t)).lanes=n,e}function zc(e,t,n,r){return(e=Oc(22,e,r,t)).elementType=F,e.lanes=n,e.stateNode={isHidden:!1},e}function Pc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Wc(e,t,n,r,a,i,o,s,u){return e=new Vc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Oc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ai(i),e}function Uc(e){if(!e)return Ta;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Oa(n))return La(e,n,t)}return t}function jc(e,t,n,r,a,i,o,s,u){return(e=Wc(n,r,!0,e,0,i,0,s,u)).context=Uc(null),n=e.current,(i=Fi(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Di(n,i,a),e.current.lanes=a,gt(e,a,r),ac(e,r),e}function Hc(e,t,n,r){var a=t.current,i=tc(),o=nc(a);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fi(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Di(a,t,o))&&(rc(e,a,o,i),Li(e,a,o)),o}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Su=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_a.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),hi();break;case 5:io(t);break;case 1:Oa(t.type)&&Ma(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ia(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ia(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ps(e,t,n):(Ia(so,1&so.current),null!==(e=Gs(e,t,n))?e.sibling:null);Ia(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return js(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ia(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Ns(e,t,n)}return Gs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&$a(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Hs(e,t),e=t.pendingProps;var a=Aa(t,Ea.current);Si(t,n),a=So(null,t,r,e,a,n);var o=No();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(o=!0,Ma(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ai(t),a.updater=Wi,t.stateNode=a,a._reactInternals=t,Gi(t,r,e,n),t=_s(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ks(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Hs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Fc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===A)return 14}return 2}(r),e=mi(r,e),a){case 0:t=Ts(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Cs(null,t,r,mi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 3:e:{if(Rs(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Oi(e,t),zi(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),r===a){t=Gs(e,t,n);break e}ks(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Is(e,t),ks(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Ps(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Yi(t,null,r,n):ks(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ia(gi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!_a.current){t=Gs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Fi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ci(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ci(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ks(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Si(t,n),r=r(a=Ni(a)),t.flags|=1,ks(e,t,r,n),t.child;case 14:return a=mi(r=t.type,t.pendingProps),Cs(e,t,r,a=mi(r.type,a),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:mi(r,a),Hs(e,t),t.tag=1,Oa(r)?(e=!0,Ma(t)):e=!1,Si(t,n),ji(t,r,a),Gi(t,r,a,n),_s(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Ns(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Gc(o);s.call(e)}}Hc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Gc(o);i.call(e)}}var o=jc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[fa]=o.current,Ur(8===e.nodeType?e.parentNode:e),dc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Gc(u);s.call(e)}}var u=Wc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=u,e[fa]=u.current,Ur(8===e.nodeType?e.parentNode:e),dc((function(){Hc(t,u,n,r)})),u}(n,t,e,a,r);return Gc(o)}Yc.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Yc.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Hc(null,e,null,null)})),t[fa]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ft.length&&0!==t&&t<Ft[n].priority;n++);Ft.splice(n,0,e),0===n&&zt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Qe()),0===(6&_u)&&(ju=Qe()+500,Ua()))}break;case 13:dc((function(){var t=_i(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Kc(e,1)}},wt=function(e){if(13===e.tag){var t=_i(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=nc(e),n=_i(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},St=function(){return bt},Nt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ka(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=lc,_e=dc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,ka,Ie,Te,lc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Wc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,a,0,o,s),e[fa]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[fa]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},3688:function(e,t,n){"use strict";function r(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function a(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function i(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}function o(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof e.getDerivedStateFromProps&&"function"!==typeof t.getSnapshotBeforeUpdate)return e;var n=null,o=null,s=null;if("function"===typeof t.componentWillMount?n="componentWillMount":"function"===typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"===typeof t.componentWillReceiveProps?o="componentWillReceiveProps":"function"===typeof t.UNSAFE_componentWillReceiveProps&&(o="UNSAFE_componentWillReceiveProps"),"function"===typeof t.componentWillUpdate?s="componentWillUpdate":"function"===typeof t.UNSAFE_componentWillUpdate&&(s="UNSAFE_componentWillUpdate"),null!==n||null!==o||null!==s){var u=e.displayName||e.name,c="function"===typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+u+" uses "+c+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==o?"\n  "+o:"")+(null!==s?"\n  "+s:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof e.getDerivedStateFromProps&&(t.componentWillMount=r,t.componentWillReceiveProps=a),"function"===typeof t.getSnapshotBeforeUpdate){if("function"!==typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=i;var l=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;l.call(this,e,t,r)}}return e}n.r(t),n.d(t,{polyfill:function(){return o}}),r.__suppressDeprecationWarning=!0,a.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0},2240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bodyOpenClassName=t.portalClassName=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2791),o=f(i),s=f(n(4164)),u=f(n(2007)),c=f(n(4334)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(5858)),d=n(3663),p=f(d),h=n(3688);function f(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var m=t.portalClassName="ReactModalPortal",g=t.bodyOpenClassName="ReactModal__Body--open",y=d.canUseDOM&&void 0!==s.default.createPortal,b=function(e){return document.createElement(e)},x=function(){return y?s.default.createPortal:s.default.unstable_renderSubtreeIntoContainer};function k(e){return e()}var w=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,u=Array(i),l=0;l<i;l++)u[l]=arguments[l];return n=a=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),a.removePortal=function(){!y&&s.default.unmountComponentAtNode(a.node);var e=k(a.props.parentSelector);e&&e.contains(a.node)?e.removeChild(a.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},a.portalRef=function(e){a.portal=e},a.renderPortal=function(e){var n=x()(a,o.default.createElement(c.default,r({defaultStyles:t.defaultStyles},e)),a.node);a.portalRef(n)},v(a,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){d.canUseDOM&&(y||(this.node=b("div")),this.node.className=this.props.portalClassName,k(this.props.parentSelector).appendChild(this.node),!y&&this.renderPortal(this.props))}},{key:"getSnapshotBeforeUpdate",value:function(e){return{prevParent:k(e.parentSelector),nextParent:k(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(e,t,n){if(d.canUseDOM){var r=this.props,a=r.isOpen,i=r.portalClassName;e.portalClassName!==i&&(this.node.className=i);var o=n.prevParent,s=n.nextParent;s!==o&&(o.removeChild(this.node),s.appendChild(this.node)),(e.isOpen||a)&&!y&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(d.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),n=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);n?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-t)):this.removePortal()}}},{key:"render",value:function(){return d.canUseDOM&&y?(!this.node&&y&&(this.node=b("div")),x()(o.default.createElement(c.default,r({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){l.setElement(e)}}]),t}(i.Component);w.propTypes={isOpen:u.default.bool.isRequired,style:u.default.shape({content:u.default.object,overlay:u.default.object}),portalClassName:u.default.string,bodyOpenClassName:u.default.string,htmlOpenClassName:u.default.string,className:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),overlayClassName:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),appElement:u.default.oneOfType([u.default.instanceOf(p.default),u.default.instanceOf(d.SafeHTMLCollection),u.default.instanceOf(d.SafeNodeList),u.default.arrayOf(u.default.instanceOf(p.default))]),onAfterOpen:u.default.func,onRequestClose:u.default.func,closeTimeoutMS:u.default.number,ariaHideApp:u.default.bool,shouldFocusAfterRender:u.default.bool,shouldCloseOnOverlayClick:u.default.bool,shouldReturnFocusAfterClose:u.default.bool,preventScroll:u.default.bool,parentSelector:u.default.func,aria:u.default.object,data:u.default.object,role:u.default.string,contentLabel:u.default.string,shouldCloseOnEsc:u.default.bool,overlayRef:u.default.func,contentRef:u.default.func,id:u.default.string,overlayElement:u.default.func,contentElement:u.default.func},w.defaultProps={isOpen:!1,portalClassName:m,bodyOpenClassName:g,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(e,t){return o.default.createElement("div",e,t)},contentElement:function(e,t){return o.default.createElement("div",e,t)}},w.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,h.polyfill)(w),t.default=w},4334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2791),s=m(n(2007)),u=v(n(8844)),c=m(n(870)),l=v(n(5858)),d=v(n(4942)),p=n(3663),h=m(p),f=m(n(8484));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}n(5670);var g={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},y=function(e){return"Tab"===e.code||9===e.keyCode},b=function(e){return"Escape"===e.code||27===e.keyCode},x=0,k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOverlayRef=function(e){n.overlay=e,n.props.overlayRef&&n.props.overlayRef(e)},n.setContentRef=function(e){n.content=e,n.props.contentRef&&n.props.contentRef(e)},n.afterClose=function(){var e=n.props,t=e.appElement,r=e.ariaHideApp,a=e.htmlOpenClassName,i=e.bodyOpenClassName,o=e.parentSelector,s=o&&o().ownerDocument||document;i&&d.remove(s.body,i),a&&d.remove(s.getElementsByTagName("html")[0],a),r&&x>0&&0===(x-=1)&&l.show(t),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(u.returnFocus(n.props.preventScroll),u.teardownScopedFocus()):u.popWithoutFocus()),n.props.onAfterClose&&n.props.onAfterClose(),f.default.deregister(n)},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(u.setupScopedFocus(n.node),u.markForFocusLater()),n.setState({isOpen:!0},(function(){n.openAnimationFrame=requestAnimationFrame((function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen({overlayEl:n.overlay,contentEl:n.content})}))})))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus({preventScroll:!0})},n.closeWithTimeout=function(){var e=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:e},(function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())}))},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(e){y(e)&&(0,c.default)(n.content,e),n.props.shouldCloseOnEsc&&b(e)&&(e.stopPropagation(),n.requestClose(e))},n.handleOverlayOnClick=function(e){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(e):n.focusContent()),n.shouldClose=null},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(e){n.props.shouldCloseOnOverlayClick||e.target!=n.overlay||e.preventDefault()},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1},n.requestClose=function(e){return n.ownerHandlesClose()&&n.props.onRequestClose(e)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(e,t){var r="object"===("undefined"===typeof t?"undefined":a(t))?t:{base:g[e],afterOpen:g[e]+"--after-open",beforeClose:g[e]+"--before-close"},i=r.base;return n.state.afterOpen&&(i=i+" "+r.afterOpen),n.state.beforeClose&&(i=i+" "+r.beforeClose),"string"===typeof t&&t?i+" "+t:i},n.attributesFromObject=function(e,t){return Object.keys(t).reduce((function(n,r){return n[e+"-"+r]=t[r],n}),{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&!e.isOpen?this.open():!this.props.isOpen&&e.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!t.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var e=this.props,t=e.appElement,n=e.ariaHideApp,r=e.htmlOpenClassName,a=e.bodyOpenClassName,i=e.parentSelector,o=i&&i().ownerDocument||document;a&&d.add(o.body,a),r&&d.add(o.getElementsByTagName("html")[0],r),n&&(x+=1,l.hide(t)),f.default.register(this)}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.className,a=e.overlayClassName,i=e.defaultStyles,o=e.children,s=n?{}:i.content,u=a?{}:i.overlay;if(this.shouldBeClosed())return null;var c={ref:this.setOverlayRef,className:this.buildClassName("overlay",a),style:r({},u,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},l=r({id:t,ref:this.setContentRef,style:r({},s,this.props.style.content),className:this.buildClassName("content",n),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",r({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),d=this.props.contentElement(l,o);return this.props.overlayElement(c,d)}}]),t}(o.Component);k.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},k.propTypes={isOpen:s.default.bool.isRequired,defaultStyles:s.default.shape({content:s.default.object,overlay:s.default.object}),style:s.default.shape({content:s.default.object,overlay:s.default.object}),className:s.default.oneOfType([s.default.string,s.default.object]),overlayClassName:s.default.oneOfType([s.default.string,s.default.object]),parentSelector:s.default.func,bodyOpenClassName:s.default.string,htmlOpenClassName:s.default.string,ariaHideApp:s.default.bool,appElement:s.default.oneOfType([s.default.instanceOf(h.default),s.default.instanceOf(p.SafeHTMLCollection),s.default.instanceOf(p.SafeNodeList),s.default.arrayOf(s.default.instanceOf(h.default))]),onAfterOpen:s.default.func,onAfterClose:s.default.func,onRequestClose:s.default.func,closeTimeoutMS:s.default.number,shouldFocusAfterRender:s.default.bool,shouldCloseOnOverlayClick:s.default.bool,shouldReturnFocusAfterClose:s.default.bool,preventScroll:s.default.bool,role:s.default.string,contentLabel:s.default.string,aria:s.default.object,data:s.default.object,children:s.default.node,shouldCloseOnEsc:s.default.bool,overlayRef:s.default.func,contentRef:s.default.func,id:s.default.string,overlayElement:s.default.func,contentElement:s.default.func,testId:s.default.string},t.default=k,e.exports=t.default},5858:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){s&&(s.removeAttribute?s.removeAttribute("aria-hidden"):null!=s.length?s.forEach((function(e){return e.removeAttribute("aria-hidden")})):document.querySelectorAll(s).forEach((function(e){return e.removeAttribute("aria-hidden")})));s=null},t.log=function(){0},t.assertNodeList=u,t.setElement=function(e){var t=e;if("string"===typeof t&&o.canUseDOM){var n=document.querySelectorAll(t);u(n,t),t=n}return s=t||s},t.validateElement=c,t.hide=function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=c(e)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.setAttribute("aria-hidden","true")}}catch(o){n=!0,r=o}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}},t.show=function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=c(e)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.removeAttribute("aria-hidden")}}catch(o){n=!0,r=o}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}},t.documentNotReadyOrSSRTesting=function(){s=null};var r,a=n(2391),i=(r=a)&&r.__esModule?r:{default:r},o=n(3663);var s=null;function u(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function c(e){var t=e||s;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,i.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}},5670:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){for(var e=[o,s],t=0;t<e.length;t++){var n=e[t];n&&(n.parentNode&&n.parentNode.removeChild(n))}o=s=null,u=[]},t.log=function(){console.log("bodyTrap ----------"),console.log(u.length);for(var e=[o,s],t=0;t<e.length;t++){var n=e[t]||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")};var r,a=n(8484),i=(r=a)&&r.__esModule?r:{default:r};var o=void 0,s=void 0,u=[];function c(){0!==u.length&&u[u.length-1].focusContent()}i.default.subscribe((function(e,t){o||s||((o=document.createElement("div")).setAttribute("data-react-modal-body-trap",""),o.style.position="absolute",o.style.opacity="0",o.setAttribute("tabindex","0"),o.addEventListener("focus",c),(s=o.cloneNode()).addEventListener("focus",c)),(u=t).length>0?(document.body.firstChild!==o&&document.body.insertBefore(o,document.body.firstChild),document.body.lastChild!==s&&document.body.appendChild(s)):(o.parentElement&&o.parentElement.removeChild(o),s.parentElement&&s.parentElement.removeChild(s))}))},4942:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){var e=document.getElementsByTagName("html")[0];for(var t in n)a(e,n[t]);var i=document.body;for(var o in r)a(i,r[o]);n={},r={}},t.log=function(){0};var n={},r={};function a(e,t){e.classList.remove(t)}t.add=function(e,t){return a=e.classList,i="html"==e.nodeName.toLowerCase()?n:r,void t.split(" ").forEach((function(e){!function(e,t){e[t]||(e[t]=0),e[t]+=1}(i,e),a.add(e)}));var a,i},t.remove=function(e,t){return a=e.classList,i="html"==e.nodeName.toLowerCase()?n:r,void t.split(" ").forEach((function(e){!function(e,t){e[t]&&(e[t]-=1)}(i,e),0===i[e]&&a.remove(e)}));var a,i}},8844:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){o=[]},t.log=function(){0},t.handleBlur=c,t.handleFocus=l,t.markForFocusLater=function(){o.push(document.activeElement)},t.returnFocus=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=null;try{return void(0!==o.length&&(t=o.pop()).focus({preventScroll:e}))}catch(n){console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}},t.popWithoutFocus=function(){o.length>0&&o.pop()},t.setupScopedFocus=function(e){s=e,window.addEventListener?(window.addEventListener("blur",c,!1),document.addEventListener("focus",l,!0)):(window.attachEvent("onBlur",c),document.attachEvent("onFocus",l))},t.teardownScopedFocus=function(){s=null,window.addEventListener?(window.removeEventListener("blur",c),document.removeEventListener("focus",l)):(window.detachEvent("onBlur",c),document.detachEvent("onFocus",l))};var r,a=n(9750),i=(r=a)&&r.__esModule?r:{default:r};var o=[],s=null,u=!1;function c(){u=!0}function l(){if(u){if(u=!1,!s)return;setTimeout((function(){s.contains(document.activeElement)||((0,i.default)(s)[0]||s).focus()}),0)}}},8484:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(){console.log("portalOpenInstances ----------"),console.log(r.openInstances.length),r.openInstances.forEach((function(e){return console.log(e)})),console.log("end portalOpenInstances ----------")},t.resetState=function(){r=new n};var n=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.register=function(e){-1===t.openInstances.indexOf(e)&&(t.openInstances.push(e),t.emit("register"))},this.deregister=function(e){var n=t.openInstances.indexOf(e);-1!==n&&(t.openInstances.splice(n,1),t.emit("deregister"))},this.subscribe=function(e){t.subscribers.push(e)},this.emit=function(e){t.subscribers.forEach((function(n){return n(e,t.openInstances.slice())}))},this.openInstances=[],this.subscribers=[]},r=new n;t.default=r},3663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canUseDOM=t.SafeNodeList=t.SafeHTMLCollection=void 0;var r,a=n(2618);var i=((r=a)&&r.__esModule?r:{default:r}).default,o=i.canUseDOM?window.HTMLElement:{};t.SafeHTMLCollection=i.canUseDOM?window.HTMLCollection:{},t.SafeNodeList=i.canUseDOM?window.NodeList:{},t.canUseDOM=i.canUseDOM;t.default=o},870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,i.default)(e);if(!n.length)return void t.preventDefault();var r=void 0,a=t.shiftKey,s=n[0],u=n[n.length-1],c=o();if(e===c){if(!a)return;r=u}u!==c||a||(r=s);s===c&&a&&(r=u);if(r)return t.preventDefault(),void r.focus();var l=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==l||"Chrome"==l[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var d=n.indexOf(c);d>-1&&(d+=a?-1:1);if("undefined"===typeof(r=n[d]))return t.preventDefault(),void(r=a?u:s).focus();t.preventDefault(),r.focus()};var r,a=n(9750),i=(r=a)&&r.__esModule?r:{default:r};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.activeElement.shadowRoot?o(e.activeElement.shadowRoot):e.activeElement}e.exports=t.default},9750:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var n=[].slice.call(t.querySelectorAll("*"),0).reduce((function(t,n){return t.concat(n.shadowRoot?e(n.shadowRoot):[n])}),[]);return n.filter(s)};var n="none",r="contents",a=/input|select|textarea|button|object|iframe/;function i(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;try{var a=window.getComputedStyle(e),i=a.getPropertyValue("display");return t?i!==r&&function(e,t){return"visible"!==t.getPropertyValue("overflow")||e.scrollWidth<=0&&e.scrollHeight<=0}(e,a):i===n}catch(o){return console.warn("Failed to inspect element style"),!1}}function o(e,t){var n=e.nodeName.toLowerCase();return(a.test(n)&&!e.disabled||"a"===n&&e.href||t)&&function(e){for(var t=e,n=e.getRootNode&&e.getRootNode();t&&t!==document.body;){if(n&&t===n&&(t=n.host.parentNode),i(t))return!1;t=t.parentNode}return!0}(e)}function s(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var n=isNaN(t);return(n||t>=0)&&o(e,!n)}e.exports=t.default},7948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(2240),i=(r=a)&&r.__esModule?r:{default:r};t.default=i.default,e.exports=t.default},2168:function(e,t,n){var r,a=n(2791),i=(r=n(2176))&&"object"==typeof r&&"default"in r?r.default:r,o=n(8267),s={scale:{entering:{transform:"translateX(-50%) scale(1.5)"},entered:{transform:"translateX(-50%) scale(1)"},exiting:{transform:"translateX(-50%) scale(1.5)"},exited:{transform:"translateX(-50%) scale(1)"}},rotate:{entering:{transform:"translateX(-50%) rotate(360deg)"},entered:{transform:"translateX(-50%) rotate(0deg)"},exiting:{transform:"translateX(-50%) rotate(0deg)"},exited:{transform:"translateX(-50%) rotate(360deg)"}},skew:{entering:{transform:"translateX(-50%) skewX(20deg)"},entered:{transform:"translateX(-50%) skewX(0deg)"},exiting:{transform:"translateX(-50%) skewX(20deg)"},exited:{transform:"translateX(-50%) skewX(0deg)"}}};function u(e){return(e>100||e<0||"number"!=typeof e)&&console.warn("[react-step-progress-bar]: The value passed to percent or position needs to be a number between 0 and 100 (passed value: "+e+")."),Math.min(100,Math.max(e,0))}var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.render=function(){var e=this.props,t=e.accomplished,n=e.index,r=e.children,c=e.transition;void 0===c&&(c=null);var l=e.transitionDuration;void 0===l&&(l=300);var d=u(e.position),p={left:d+"%",transitionDuration:l+"ms"};return a.createElement(o.Transition,{in:t,timeout:l},(function(e){return c&&(i(null!=s[c],c+" is not listed in the built-in transitions."),p=Object.assign({},p,s[c][e])),a.createElement("div",{className:"RSPBstep",style:p},r({accomplished:t,position:d,transitionState:e,index:n}))}))},t}(a.Component),l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.render=function(){var e=this.props,t=e.percent,n=e.children,r=e.stepPositions;void 0===r&&(r=[]);var o=e.unfilledBackground;void 0===o&&(o=null);var s=e.filledBackground;void 0===s&&(s=null);var c=e.width;void 0===c&&(c=null);var l=e.height;void 0===l&&(l=null);var d=e.hasStepZero;void 0===d&&(d=!0);var p=e.text;void 0===p&&(p=null),i(!(r.length>0&&r.length!==a.Children.count(n)),"When specifying a stepPositions props, the number of children must match the length of the positions array.");var h=u(t);return a.createElement("div",{className:"RSPBprogressBar",style:{background:o,width:c,height:l}},a.Children.map(n,(function(e,t){var i=r.length>0?r[t]:function(e,t,n){return n?100/(e-1)*t:100/e*(t+1)}(a.Children.count(n),t,d);return a.cloneElement(e,{accomplished:i<=h,position:i,index:t})})),p?a.createElement("div",{className:"RSPBprogressBarText"},p):null,a.createElement("div",{className:"RSPBprogression",style:{background:s,width:h+"%"}}))},t}(a.Component);t.k=l},6664:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}t.default=e}(n(2007));var r=s(n(8354)),a=s(n(2910)),i=s(n(2791)),o=s(n(119));n(5127);function s(e){return e&&e.__esModule?e:{default:e}}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}var c=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,r.default)(e,t)}))},l=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,a.default)(e,t)}))},d=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).onEnter=function(e,n){var r=t.getClassNames(n?"appear":"enter").className;t.removeClasses(e,"exit"),c(e,r),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.getClassNames(n?"appear":"enter").activeClassName;t.reflowAndAddClass(e,r),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.getClassNames("appear").doneClassName,a=t.getClassNames("enter").doneClassName,i=n?r+" "+a:a;t.removeClasses(e,n?"appear":"enter"),c(e,i),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.getClassNames("exit").className;t.removeClasses(e,"appear"),t.removeClasses(e,"enter"),c(e,n),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.getClassNames("exit").activeClassName;t.reflowAndAddClass(e,n),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.getClassNames("exit").doneClassName;t.removeClasses(e,"exit"),c(e,n),t.props.onExited&&t.props.onExited(e)},t.getClassNames=function(e){var n=t.props.classNames,r="string"===typeof n,a=r?(r&&n?n+"-":"")+e:n[e];return{className:a,activeClassName:r?a+"-active":n[e+"Active"],doneClassName:r?a+"-done":n[e+"Done"]}},t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.removeClasses=function(e,t){var n=this.getClassNames(t),r=n.className,a=n.activeClassName,i=n.doneClassName;r&&l(e,r),a&&l(e,a),i&&l(e,i)},a.reflowAndAddClass=function(e,t){t&&(e&&e.scrollTop,c(e,t))},a.render=function(){var e=u({},this.props);return delete e.classNames,i.default.createElement(o.default,u({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(i.default.Component);d.defaultProps={classNames:""},d.propTypes={};var p=d;t.default=p,e.exports=t.default},8162:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;o(n(2007));var r=o(n(2791)),a=n(4164),i=o(n(2326));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t,n;function o(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleEnter=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEnter",0,n)},t.handleEntering=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntering",0,n)},t.handleEntered=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntered",0,n)},t.handleExit=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExit",1,n)},t.handleExiting=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExiting",1,n)},t.handleExited=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExited",1,n)},t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var s=o.prototype;return s.handleLifecycle=function(e,t,n){var i,o=this.props.children,s=r.default.Children.toArray(o)[t];s.props[e]&&(i=s.props)[e].apply(i,n),this.props[e]&&this.props[e]((0,a.findDOMNode)(this))},s.render=function(){var e=this.props,t=e.children,n=e.in,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["children","in"]),o=r.default.Children.toArray(t),s=o[0],u=o[1];return delete a.onEnter,delete a.onEntering,delete a.onEntered,delete a.onExit,delete a.onExiting,delete a.onExited,r.default.createElement(i.default,a,n?r.default.cloneElement(s,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):r.default.cloneElement(u,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},o}(r.default.Component);s.propTypes={};var u=s;t.default=u,e.exports=t.default},119:function(e,t,n){"use strict";t.__esModule=!0,t.default=t.EXITING=t.ENTERED=t.ENTERING=t.EXITED=t.UNMOUNTED=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(2007)),a=s(n(2791)),i=s(n(4164)),o=n(3688);n(5127);function s(e){return e&&e.__esModule?e:{default:e}}var u="unmounted";t.UNMOUNTED=u;var c="exited";t.EXITED=c;var l="entering";t.ENTERING=l;var d="entered";t.ENTERED=d;var p="exiting";t.EXITING=p;var h=function(e){var t,n;function r(t,n){var r;r=e.call(this,t,n)||this;var a,i=n.transitionGroup,o=i&&!i.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(a=c,r.appearStatus=l):a=d:a=t.unmountOnExit||t.mountOnEnter?u:c,r.state={status:a},r.nextCallback=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.getChildContext=function(){return{transitionGroup:null}},r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===u?{status:c}:null},o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==l&&n!==d&&(t=l):n!==l&&n!==d||(t=p)}this.updateStatus(!1,t)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},o.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=i.default.findDOMNode(this);t===l?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&this.state.status===c&&this.setState({status:u})},o.performEnter=function(e,t){var n=this,r=this.props.enter,a=this.context.transitionGroup?this.context.transitionGroup.isMounting:t,i=this.getTimeouts(),o=a?i.appear:i.enter;t||r?(this.props.onEnter(e,a),this.safeSetState({status:l},(function(){n.props.onEntering(e,a),n.onTransitionEnd(e,o,(function(){n.safeSetState({status:d},(function(){n.props.onEntered(e,a)}))}))}))):this.safeSetState({status:d},(function(){n.props.onEntered(e)}))},o.performExit=function(e){var t=this,n=this.props.exit,r=this.getTimeouts();n?(this.props.onExit(e),this.safeSetState({status:p},(function(){t.props.onExiting(e),t.onTransitionEnd(e,r.exit,(function(){t.safeSetState({status:c},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:c},(function(){t.props.onExited(e)}))},o.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},o.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},o.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var r=null==t&&!this.props.addEndListener;e&&!r?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},o.render=function(){var e=this.state.status;if(e===u)return null;var t=this.props,n=t.children,r=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,["children"]);if(delete r.in,delete r.mountOnEnter,delete r.unmountOnExit,delete r.appear,delete r.enter,delete r.exit,delete r.timeout,delete r.addEndListener,delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,"function"===typeof n)return n(e,r);var i=a.default.Children.only(n);return a.default.cloneElement(i,r)},r}(a.default.Component);function f(){}h.contextTypes={transitionGroup:r.object},h.childContextTypes={transitionGroup:function(){}},h.propTypes={},h.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:f,onEntering:f,onEntered:f,onExit:f,onExiting:f,onExited:f},h.UNMOUNTED=0,h.EXITED=1,h.ENTERING=2,h.ENTERED=3,h.EXITING=4;var v=(0,o.polyfill)(h);t.default=v},2326:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=s(n(2007)),a=s(n(2791)),i=n(3688),o=n(8546);function s(e){return e&&e.__esModule?e:{default:e}}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},d=function(e){var t,n;function r(t,n){var r,a=(r=e.call(this,t,n)||this).handleExited.bind(c(c(r)));return r.state={handleExited:a,firstRender:!0},r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}},i.componentDidMount=function(){this.appeared=!0,this.mounted=!0},i.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(e,t){var n=t.children,r=t.handleExited;return{children:t.firstRender?(0,o.getInitialChildMapping)(e,r):(0,o.getNextChildMapping)(e,n,r),firstRender:!1}},i.handleExited=function(e,t){var n=(0,o.getChildMapping)(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=u({},t.children);return delete n[e.key],{children:n}})))},i.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["component","childFactory"]),i=l(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?i:a.default.createElement(t,r,i)},r}(a.default.Component);d.childContextTypes={transitionGroup:r.default.object.isRequired},d.propTypes={},d.defaultProps={component:"div",childFactory:function(e){return e}};var p=(0,i.polyfill)(d);t.default=p,e.exports=t.default},8267:function(e,t,n){"use strict";var r=s(n(6664)),a=s(n(8162)),i=s(n(2326)),o=s(n(119));function s(e){return e&&e.__esModule?e:{default:e}}e.exports={Transition:o.default,TransitionGroup:i.default,ReplaceTransition:a.default,CSSTransition:r.default}},8546:function(e,t,n){"use strict";t.__esModule=!0,t.getChildMapping=a,t.mergeChildMappings=i,t.getInitialChildMapping=function(e,t){return a(e.children,(function(n){return(0,r.cloneElement)(n,{onExited:t.bind(null,n),in:!0,appear:o(n,"appear",e),enter:o(n,"enter",e),exit:o(n,"exit",e)})}))},t.getNextChildMapping=function(e,t,n){var s=a(e.children),u=i(t,s);return Object.keys(u).forEach((function(a){var i=u[a];if((0,r.isValidElement)(i)){var c=a in t,l=a in s,d=t[a],p=(0,r.isValidElement)(d)&&!d.props.in;!l||c&&!p?l||!c||p?l&&c&&(0,r.isValidElement)(d)&&(u[a]=(0,r.cloneElement)(i,{onExited:n.bind(null,i),in:d.props.in,exit:o(i,"exit",e),enter:o(i,"enter",e)})):u[a]=(0,r.cloneElement)(i,{in:!1}):u[a]=(0,r.cloneElement)(i,{onExited:n.bind(null,i),in:!0,exit:o(i,"exit",e),enter:o(i,"enter",e)})}})),u};var r=n(2791);function a(e,t){var n=Object.create(null);return e&&r.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,r.isValidElement)(e)?t(e):e}(e)})),n}function i(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,a=Object.create(null),i=[];for(var o in e)o in t?i.length&&(a[o]=i,i=[]):i.push(o);var s={};for(var u in t){if(a[u])for(r=0;r<a[u].length;r++){var c=a[u][r];s[a[u][r]]=n(c)}s[u]=n(u)}for(r=0;r<i.length;r++)s[i[r]]=n(i[r]);return s}function o(e,t,n){return null!=n[t]?n[t]:e.props[t]}},5127:function(e,t,n){"use strict";t.__esModule=!0,t.classNamesShape=t.timeoutsShape=void 0;var r;(r=n(2007))&&r.__esModule;t.timeoutsShape=null;t.classNamesShape=null},97:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,r){t.call(navigator,e,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return a(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,s()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(s()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),a=e.minScreenshotWidth!==t.minScreenshotWidth,i=e.minScreenshotHeight!==t.minScreenshotHeight;(r||a||i)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,a=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var i=r/a;a=(r=n.minScreenshotWidth||this.video.clientWidth)/i,n.minScreenshotHeight&&a<n.minScreenshotHeight&&(r=(a=n.minScreenshotHeight)*i)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||a,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,s=this.canvas;return o&&s&&(n.mirrored&&(o.translate(s.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||s.width,(null===e||void 0===e?void 0:e.height)||s.height),n.mirrored&&(o.scale(-1,1),o.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,a){var i={video:"undefined"===typeof a||a};n.audio&&(i.audio="undefined"===typeof r||r),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(i).then((function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var a=function(e){return{optional:[{sourceId:e}]}},i=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,o=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)}));var s=i(n.audioConstraints);s&&(t=s);var u=i(n.videoConstraints);u&&(o=u),r(a(t),a(o))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,a=n.audio,s=(n.forceScreenshotSourceSize,n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),u=n.style,c=void 0===u?{}:u,l=n.children,d=o(n,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=s?i(i({},c),{transform:(c.transform||"")+" scaleX(-1)"}):c,h={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",i({autoPlay:!0,src:t.src,muted:!a,playsInline:!0,ref:function(t){e.video=t},style:p},d)),l&&l(h))},t.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=u},react:function(t,n){t.exports=e}}).default},e.exports=r(n(2791))},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,v(x,g.prototype),x.isPureReactComponent=!0;var k=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:C.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+E(u,0):i,k(o)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),_(o,t,a,"",(function(e){return e}))):null!=o&&(I(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",k(e))for(var c=0;c<e.length;c++){var l=i+E(s=e[c],c);u+=_(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=_(s=s.value,t,a,l=i+E(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],a=0;return _(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},F={transition:null},D={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:F,ReactCurrentOwner:C};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=C.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=F.transition;F.transition={};try{e()}finally{F.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],d=1,p=null,h=3,f=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function k(e){if(m=!1,x(e),!v)if(null!==r(c))v=!0,F(w);else{var t=r(l);null!==t&&D(k,t.startTime-e)}}function w(e,n){v=!1,m&&(m=!1,y(I),I=-1),f=!0;var i=h;try{for(x(n),p=r(c);null!==p&&(!(p.expirationTime>n)||e&&!_());){var o=p.callback;if("function"===typeof o){p.callback=null,h=p.priorityLevel;var s=o(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(c)&&a(c),x(n)}else a(c);p=r(c)}if(null!==p)var u=!0;else{var d=r(l);null!==d&&D(k,d.startTime-n),u=!1}return u}finally{p=null,h=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,S=!1,N=null,I=-1,T=5,E=-1;function _(){return!(t.unstable_now()-E<T)}function R(){if(null!==N){var e=t.unstable_now();E=e;var n=!0;try{n=N(!0,e)}finally{n?C():(S=!1,N=null)}}else S=!1}if("function"===typeof b)C=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,O=A.port2;A.port1.onmessage=R,C=function(){O.postMessage(null)}}else C=function(){g(R,0)};function F(e){N=e,S||(S=!0,C())}function D(e,n){I=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||f||(v=!0,F(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(m?(y(I),I=-1):m=!0,D(k,i-o))):(e.sortIndex=s,n(c,e),v||f||(v=!0,F(w))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i,o){var s,u=256,c=6,l="random",d=o.pow(u,c),p=o.pow(2,52),h=2*p,f=u-1;function v(e,t,n){var r=[],f=b(y((t=1==t?{entropy:!0}:t||{}).entropy?[e,x(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(e)),x(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,x(i)]}}():e,3),r),v=new m(r),k=function(){for(var e=v.g(c),t=d,n=0;e<p;)e=(e+n)*u,t*=u,n=v.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return k.int32=function(){return 0|v.g(4)},k.quick=function(){return v.g(4)/4294967296},k.double=k,b(x(v.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&g(r,v),e.state=function(){return g(v,{})}),n?(o[l]=e,t):e})(k,f,"global"in t?t.global:this==o,t.state)}function m(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(y(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function b(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return x(t)}function x(e){return String.fromCharCode.apply(0,e)}if(b(o.random(),i),e.exports){e.exports=v;try{s=n(5042)}catch(k){}}else void 0===(r=function(){return v}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2391:function(e){"use strict";var t=function(){};e.exports=t},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/Slingo/",function(){"use strict";var e={};n.r(e),n.d(e,{browserFiles:function(){return Pl},browserHTTPRequest:function(){return Yl},concatenateArrayBuffers:function(){return Zu},copyModel:function(){return Bc},decodeWeights:function(){return ju},encodeWeights:function(){return Wu},fromMemory:function(){return td},fromMemorySync:function(){return nd},getLoadHandlers:function(){return uc},getModelArtifactsForJSON:function(){return $u},getModelArtifactsForJSONSync:function(){return Ju},getModelArtifactsInfoForJSON:function(){return tc},getSaveHandlers:function(){return sc},getWeightSpecs:function(){return nc},http:function(){return Zl},isHTTPScheme:function(){return Kl},listModels:function(){return Lc},loadWeights:function(){return Ul},moveModel:function(){return Wc},registerLoadRouter:function(){return oc},registerSaveRouter:function(){return ic},removeModel:function(){return zc},weightsLoaderFactory:function(){return Hl},withSaveHandler:function(){return rd},withSaveHandlerSync:function(){return ad}});var t={};n.r(t),n.d(t,{conv2d:function(){return Tv},depthwiseConv2d:function(){return Rv},matMul:function(){return Av}});var r={};n.r(r),n.d(r,{json:function(){return $S}});var a={};n.r(a),n.d(a,{json:function(){return eN}});var i={};n.r(i),n.d(i,{json:function(){return tN}});var o={};n.r(o),n.d(o,{json:function(){return nN}});var s={};n.r(s),n.d(s,{json:function(){return rN}});var u={};n.r(u),n.d(u,{json:function(){return aN}});var c={};n.r(c),n.d(c,{json:function(){return iN}});var l={};n.r(l),n.d(l,{json:function(){return oN}});var d={};n.r(d),n.d(d,{json:function(){return sN}});var p={};n.r(p),n.d(p,{json:function(){return uN}});var h={};n.r(h),n.d(h,{json:function(){return cN}});var f={};n.r(f),n.d(f,{json:function(){return lN}});var v={};n.r(v),n.d(v,{json:function(){return dN}});var m={};n.r(m),n.d(m,{json:function(){return pN}});var g={};n.r(g),n.d(g,{json:function(){return hN}});var y={};n.r(y),n.d(y,{json:function(){return fN}});var b={};n.r(b),n.d(b,{json:function(){return vN}});var x={};n.r(x),n.d(x,{json:function(){return mN}});var k={};n.r(k),n.d(k,{json:function(){return gN}});var w={};n.r(w),n.d(w,{OP_SCOPE_SUFFIX:function(){return Du},abs:function(){return wl},acos:function(){return gd},acosh:function(){return yd},add:function(){return rl},addN:function(){return bd},all:function(){return xd},any:function(){return kd},argMax:function(){return wd},argMin:function(){return Cd},asin:function(){return Sd},asinh:function(){return Nd},atan:function(){return Id},atan2:function(){return Td},atanh:function(){return Ed},avgPool:function(){return Gd},avgPool3d:function(){return qd},basicLSTMCell:function(){return Jd},batchNorm:function(){return ep},batchNorm2d:function(){return tp},batchNorm3d:function(){return np},batchNorm4d:function(){return rp},batchToSpaceND:function(){return $d},bincount:function(){return ap},booleanMaskAsync:function(){return cv},broadcastArgs:function(){return ip},broadcastTo:function(){return op},buffer:function(){return Kc},cast:function(){return Xc},ceil:function(){return sp},clipByValue:function(){return up},clone:function(){return Zc},complex:function(){return Mu},concat:function(){return Kd},concat1d:function(){return cp},concat2d:function(){return lp},concat3d:function(){return dp},concat4d:function(){return pp},conv1d:function(){return fp},conv2d:function(){return hp},conv2dTranspose:function(){return mp},conv3d:function(){return gp},conv3dTranspose:function(){return bp},cos:function(){return xp},cosh:function(){return kp},cosineWindow:function(){return bv},cumprod:function(){return wp},cumsum:function(){return Cp},denseBincount:function(){return Sp},depthToSpace:function(){return Np},depthwiseConv2d:function(){return Ip},diag:function(){return Tp},dilation2d:function(){return Ep},div:function(){return il},divNoNan:function(){return Ap},dot:function(){return Op},dropout:function(){return gv},einsum:function(){return Fp},elu:function(){return Dp},enclosingPowerOfTwo:function(){return yv},equal:function(){return _p},erf:function(){return Lp},euclideanNorm:function(){return Xp},exp:function(){return Zp},expandDims:function(){return Yp},expm1:function(){return Qp},eye:function(){return $p},fft:function(){return Mf},fill:function(){return gl},floor:function(){return eh},floorDiv:function(){return al},fused:function(){return t},gather:function(){return th},gatherND:function(){return mv},greater:function(){return nh},greaterEqual:function(){return rh},ifft:function(){return zf},imag:function(){return ah},image:function(){return Fm},inTopKAsync:function(){return kv},irfft:function(){return Pf},isFinite:function(){return ih},isInf:function(){return oh},isNaN:function(){return sh},leakyRelu:function(){return uh},less:function(){return ch},lessEqual:function(){return lh},linalg:function(){return Dm},linspace:function(){return dh},localResponseNormalization:function(){return ph},log:function(){return hh},log1p:function(){return fh},logSigmoid:function(){return gh},logSoftmax:function(){return yh},logSumExp:function(){return bh},logicalAnd:function(){return xh},logicalNot:function(){return kh},logicalOr:function(){return wh},logicalXor:function(){return Ch},losses:function(){return Lm},lowerBound:function(){return Ih},matMul:function(){return Xd},max:function(){return jp},maxPool:function(){return Th},maxPool3d:function(){return Eh},maxPoolWithArgmax:function(){return _h},maximum:function(){return Il},mean:function(){return Rh},meshgrid:function(){return Fh},min:function(){return Hp},minimum:function(){return Dh},mirrorPad:function(){return Lh},mod:function(){return Mh},moments:function(){return zh},movingAverage:function(){return dv},mul:function(){return ol},multiRNNCell:function(){return Ph},multinomial:function(){return Bh},neg:function(){return vh},norm:function(){return Kp},notEqual:function(){return Vh},oneHot:function(){return Wh},ones:function(){return Oh},onesLike:function(){return Uh},op:function(){return Lu},outerProduct:function(){return jh},pad:function(){return Hh},pad1d:function(){return Gh},pad2d:function(){return qh},pad3d:function(){return Kh},pad4d:function(){return Xh},pool:function(){return Yh},pow:function(){return bl},prelu:function(){return Qh},print:function(){return Yc},prod:function(){return Jh},raggedGather:function(){return $h},raggedRange:function(){return ef},raggedTensorToTensor:function(){return tf},rand:function(){return nf},randomGamma:function(){return uf},randomNormal:function(){return cf},randomStandardNormal:function(){return lf},randomUniform:function(){return df},range:function(){return pf},real:function(){return hf},reciprocal:function(){return ff},relu:function(){return vf},relu6:function(){return mf},reshape:function(){return Hd},reverse:function(){return gf},reverse1d:function(){return yf},reverse2d:function(){return bf},reverse3d:function(){return xf},reverse4d:function(){return kf},rfft:function(){return Vf},round:function(){return wf},rsqrt:function(){return Cf},scalar:function(){return dl},scatterND:function(){return fv},searchSorted:function(){return Nh},selu:function(){return Sf},separableConv2d:function(){return Nf},setdiff1dAsync:function(){return Tf},sigmoid:function(){return Zd},sign:function(){return Ef},signal:function(){return Om},sin:function(){return _f},sinh:function(){return Rf},slice:function(){return Yd},slice1d:function(){return Af},slice2d:function(){return Of},slice3d:function(){return Ff},slice4d:function(){return Df},softmax:function(){return Lf},softplus:function(){return mh},spaceToBatchND:function(){return Zh},sparse:function(){return Mm},sparseToDense:function(){return vv},spectral:function(){return Am},split:function(){return Bf},sqrt:function(){return sl},square:function(){return ul},squaredDifference:function(){return Wf},squeeze:function(){return Uf},stack:function(){return jf},step:function(){return Hf},stridedSlice:function(){return Gf},string:function(){return zm},sub:function(){return xl},sum:function(){return Gp},tan:function(){return qf},tanh:function(){return Qd},tensor:function(){return Pu},tensor1d:function(){return Kf},tensor2d:function(){return Xf},tensor3d:function(){return id},tensor4d:function(){return Zf},tensor5d:function(){return Yf},tensor6d:function(){return Qf},tile:function(){return Jp},topk:function(){return Jf},transpose:function(){return lv},truncatedNormal:function(){return $f},unique:function(){return ev},unsortedSegmentSum:function(){return tv},unstack:function(){return nv},upperBound:function(){return rv},variable:function(){return av},where:function(){return Rp},whereAsync:function(){return sv},zeros:function(){return Ah},zerosLike:function(){return cl}});var C,S=n(2791),N=n.t(S,2),I=n(1250);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _(e,t){if(e){if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function R(e){return function(e){if(Array.isArray(e))return T(e)}(e)||E(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function F(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O(t)?t:String(t)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}function L(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function z(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function B(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){var t=B();return function(){var n,r=P(e);if(t){var a=P(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return V(e)}(this,n)}}function U(e){if(Array.isArray(e))return e}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function H(e,t){return U(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,a=l}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||_(e,t)||j()}function G(e,t,n){return G=B()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&M(a,n.prototype),a},G.apply(null,arguments)}function q(e){var t="function"===typeof Map?new Map:void 0;return q=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return G(e,arguments,P(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),M(r,e)},q(e)}function K(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(C||(C={}));var Z,Y="popstate";function Q(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function J(e,t){return{usr:e.state,key:e.key,idx:t}}function $(e,t,n,r){return void 0===n&&(n=null),X({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?te(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function ee(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function te(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function ne(e,t,n,r){void 0===r&&(r={});var a=r,i=a.window,o=void 0===i?document.defaultView:i,s=a.v5Compat,u=void 0!==s&&s,c=o.history,l=C.Pop,d=null,p=h();function h(){return(c.state||{idx:null}).idx}function f(){l=C.Pop;var e=h(),t=null==e?null:e-p;p=e,d&&d({action:l,location:m.location,delta:t})}function v(e){var t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:ee(e);return Q(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==p&&(p=0,c.replaceState(X({},c.state,{idx:p}),""));var m={get action(){return l},get location(){return e(o,c)},listen:function(e){if(d)throw new Error("A history only accepts one active listener");return o.addEventListener(Y,f),d=e,function(){o.removeEventListener(Y,f),d=null}},createHref:function(e){return t(o,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=C.Push;var r=$(m.location,e,t);n&&n(r,e);var a=J(r,p=h()+1),i=m.createHref(r);try{c.pushState(a,"",i)}catch(s){o.location.assign(i)}u&&d&&d({action:l,location:m.location,delta:1})},replace:function(e,t){l=C.Replace;var r=$(m.location,e,t);n&&n(r,e);var a=J(r,p=h()),i=m.createHref(r);c.replaceState(a,"",i),u&&d&&d({action:l,location:m.location,delta:0})},go:function(e){return c.go(e)}};return m}function re(e,t,n){void 0===n&&(n="/");var r=ge(("string"===typeof t?te(t):t).pathname||"/",n);if(null==r)return null;var a=ae(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=fe(a[o],me(r));return i}function ae(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var a=function(e,a,i){var o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(Q(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var s=we([r,o.relativePath]),u=n.concat(o);e.children&&e.children.length>0&&(Q(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),ae(e.children,t,u,s)),(null!=e.path||e.index)&&t.push({path:s,score:he(s,e.index),routesMeta:u})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,i=K(ie(e.path));try{for(i.s();!(r=i.n()).done;){var o=r.value;a(e,t,o)}}catch(s){i.e(s)}finally{i.f()}}else a(e,t)})),t}function ie(e){var t=e.split("/");if(0===t.length)return[];var n,r=U(n=t)||E(n)||_(n)||j(),a=r[0],i=r.slice(1),o=a.endsWith("?"),s=a.replace(/\?$/,"");if(0===i.length)return o?[s,""]:[s];var u=ie(i.join("/")),c=[];return c.push.apply(c,R(u.map((function(e){return""===e?s:[s,e].join("/")})))),o&&c.push.apply(c,R(u)),c.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Z||(Z={}));var oe=/^:\w+$/,se=3,ue=2,ce=1,le=10,de=-2,pe=function(e){return"*"===e};function he(e,t){var n=e.split("/"),r=n.length;return n.some(pe)&&(r+=de),t&&(r+=ue),n.filter((function(e){return!pe(e)})).reduce((function(e,t){return e+(oe.test(t)?se:""===t?ce:le)}),r)}function fe(e,t){for(var n=e.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",l=ve({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var d=s.route;i.push({params:r,pathname:we([a,l.pathname]),pathnameBase:Ce(we([a,l.pathnameBase])),route:d}),"/"!==l.pathnameBase&&(a=we([a,l.pathnameBase]))}return i}function ve(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);ye("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");var i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),r=H(n,2),a=r[0],i=r[1],o=t.match(a);if(!o)return null;var s=o[0],u=s.replace(/(.)\/+$/,"$1"),c=o.slice(1);return{params:i.reduce((function(e,t,n){if("*"===t){var r=c[n]||"";u=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return ye(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(c[n]||"",t),e}),{}),pathname:s,pathnameBase:u,pattern:e}}function me(e){try{return decodeURI(e)}catch(t){return ye(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function ge(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function ye(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function be(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function xe(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function ke(e,t,n,r){var a;void 0===r&&(r=!1),"string"===typeof e?a=te(e):(Q(!(a=X({},e)).pathname||!a.pathname.includes("?"),be("?","pathname","search",a)),Q(!a.pathname||!a.pathname.includes("#"),be("#","pathname","hash",a)),Q(!a.search||!a.search.includes("#"),be("#","search","hash",a)));var i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(r||null==s)i=n;else{var u=t.length-1;if(s.startsWith("..")){for(var c=s.split("/");".."===c[0];)c.shift(),u-=1;a.pathname=c.join("/")}i=u>=0?t[u]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?te(e):e,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:Se(i),hash:Ne(s)}}(a,i),d=s&&"/"!==s&&s.endsWith("/"),p=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!p||(l.pathname+="/"),l}var we=function(e){return e.join("/").replace(/\/\/+/g,"/")},Ce=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},Se=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},Ne=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},Ie=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n)}(q(Error));function Te(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Ee=["post","put","patch","delete"],_e=(new Set(Ee),["get"].concat(Ee));new Set(_e),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;Symbol("deferred");function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Re.apply(this,arguments)}var Ae="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Oe=S.useState,Fe=S.useEffect,De=S.useLayoutEffect,Le=S.useDebugValue;function Me(e){var t=e.getSnapshot,n=e.value;try{var r=t();return!Ae(n,r)}catch(a){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,N.useSyncExternalStore;var ze=S.createContext(null);var Pe=S.createContext(null);var Be=S.createContext(null);var Ve=S.createContext(null);var We=S.createContext(null);var Ue=S.createContext({outlet:null,matches:[]});var je=S.createContext(null);function He(){return null!=S.useContext(We)}function Ge(){return He()||Q(!1),S.useContext(We).location}function qe(){He()||Q(!1);var e=S.useContext(Ve),t=e.basename,n=e.navigator,r=S.useContext(Ue).matches,a=Ge().pathname,i=JSON.stringify(xe(r).map((function(e){return e.pathnameBase}))),o=S.useRef(!1);return S.useEffect((function(){o.current=!0})),S.useCallback((function(e,r){if(void 0===r&&(r={}),o.current)if("number"!==typeof e){var s=ke(e,JSON.parse(i),a,"path"===r.relative);"/"!==t&&(s.pathname="/"===s.pathname?t:we([t,s.pathname])),(r.replace?n.replace:n.push)(s,r.state,r)}else n.go(e)}),[t,n,i,a])}function Ke(){var e=function(){var e,t=S.useContext(je),n=$e(Ze.UseRouteError),r=et(Ze.UseRouteError);if(t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=Te(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:a},n):null,null)}var Xe,Ze,Ye=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).state={location:e.location,error:e.error},r}return L(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?S.createElement(Ue.Provider,{value:this.props.routeContext},S.createElement(je.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),n}(S.Component);function Qe(e){var t=e.routeContext,n=e.match,r=e.children,a=S.useContext(ze);return a&&a.static&&a.staticContext&&n.route.errorElement&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(Ue.Provider,{value:t},r)}function Je(e,t,n){if(void 0===t&&(t=[]),null==e){if(null==n||!n.errors)return null;e=n.matches}var r=e,a=null==n?void 0:n.errors;if(null!=a){var i=r.findIndex((function(e){return e.route.id&&(null==a?void 0:a[e.route.id])}));i>=0||Q(!1),r=r.slice(0,Math.min(r.length,i+1))}return r.reduceRight((function(e,i,o){var s=i.route.id?null==a?void 0:a[i.route.id]:null,u=n?i.route.errorElement||S.createElement(Ke,null):null,c=t.concat(r.slice(0,o+1)),l=function(){return S.createElement(Qe,{match:i,routeContext:{outlet:e,matches:c}},s?u:void 0!==i.route.element?i.route.element:e)};return n&&(i.route.errorElement||0===o)?S.createElement(Ye,{location:n.location,component:u,error:s,children:l(),routeContext:{outlet:null,matches:c}}):l()}),null)}function $e(e){var t=S.useContext(Pe);return t||Q(!1),t}function et(e){var t=function(e){var t=S.useContext(Ue);return t||Q(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||Q(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(Xe||(Xe={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(Ze||(Ze={}));var tt;function nt(e){Q(!1)}function rt(e){var t=e.basename,n=void 0===t?"/":t,r=e.children,a=void 0===r?null:r,i=e.location,o=e.navigationType,s=void 0===o?C.Pop:o,u=e.navigator,c=e.static,l=void 0!==c&&c;He()&&Q(!1);var d=n.replace(/^\/*/,"/"),p=S.useMemo((function(){return{basename:d,navigator:u,static:l}}),[d,u,l]);"string"===typeof i&&(i=te(i));var h=i,f=h.pathname,v=void 0===f?"/":f,m=h.search,g=void 0===m?"":m,y=h.hash,b=void 0===y?"":y,x=h.state,k=void 0===x?null:x,w=h.key,N=void 0===w?"default":w,I=S.useMemo((function(){var e=ge(v,d);return null==e?null:{pathname:e,search:g,hash:b,state:k,key:N}}),[d,v,g,b,k,N]);return null==I?null:S.createElement(Ve.Provider,{value:p},S.createElement(We.Provider,{children:a,value:{location:I,navigationType:s}}))}function at(e){var t=e.children,n=e.location,r=S.useContext(ze);return function(e,t){He()||Q(!1);var n,r=S.useContext(Ve).navigator,a=S.useContext(Pe),i=S.useContext(Ue).matches,o=i[i.length-1],s=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/"),c=(o&&o.route,Ge());if(t){var l,d="string"===typeof t?te(t):t;"/"===u||(null==(l=d.pathname)?void 0:l.startsWith(u))||Q(!1),n=d}else n=c;var p=n.pathname||"/",h=re(e,{pathname:"/"===u?p:p.slice(u.length)||"/"}),f=Je(h&&h.map((function(e){return Object.assign({},e,{params:Object.assign({},s,e.params),pathname:we([u,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:we([u,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),i,a||void 0);return t&&f?S.createElement(We.Provider,{value:{location:Re({pathname:"/",search:"",hash:"",state:null,key:"default"},n),navigationType:C.Pop}},f):f}(r&&!t?r.router.routes:ot(t),n)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(tt||(tt={}));var it=new Promise((function(){}));S.Component;function ot(e,t){void 0===t&&(t=[]);var n=[];return S.Children.forEach(e,(function(e,r){if(S.isValidElement(e))if(e.type!==S.Fragment){e.type!==nt&&Q(!1),e.props.index&&e.props.children&&Q(!1);var a=[].concat(R(t),[r]),i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(i.children=ot(e.props.children,a)),n.push(i)}else n.push.apply(n,ot(e.props.children,t))})),n}var st={container:"inhome_container__H16Bc",intro:"inhome_intro__8iMEb",home:"inhome_home__l3AY6",greeting:"inhome_greeting__NBnUT","navigation-buttons":"inhome_navigation-buttons__DOVZ7"},ut={"navbar-container":"navbar_navbar-container__z5dpA","navbar-container-content":"navbar_navbar-container-content__4VI5y","brand-section":"navbar_brand-section__3EFgw","brand-logo":"navbar_brand-logo__sVykQ","brand-name":"navbar_brand-name__4RoFZ","navigation-section":"navbar_navigation-section__wNgXa","navigation-icons":"navbar_navigation-icons__I17BM","user-name":"navbar_user-name__JOfOh","logout-button":"navbar_logout-button__6kk9M"},ct=n(184);function lt(){var e=localStorage.getItem("name"),t=qe();return(0,ct.jsx)("nav",{className:ut["navbar-container"],children:(0,ct.jsxs)("div",{className:ut["navbar-container-content"],children:[(0,ct.jsxs)("div",{className:ut["brand-section"],children:[(0,ct.jsxs)("svg",{width:"150",height:"150",viewBox:"0 0 150 150",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ut["brand-logo"],children:[(0,ct.jsx)("circle",{cx:"75",cy:"75",r:"75",fill:"#FF6C2D"}),(0,ct.jsx)("path",{d:"M49.4437 115.5C48.7087 115.5 48.0656 115.223 47.5144 114.67C46.9631 114.117 46.6875 113.471 46.6875 112.733C46.6875 111.934 46.9631 111.273 47.5144 110.75C48.0656 110.227 48.7087 109.966 49.4437 109.966H66.9V104.432H43.9313C43.1962 104.432 42.5531 104.155 42.0019 103.602C41.4506 103.049 41.175 102.403 41.175 101.665C41.175 100.866 41.4506 100.205 42.0019 99.6821C42.5531 99.1594 43.1962 98.8981 43.9313 98.8981H66.9V93.3642H40.2562C39.5213 93.3642 38.8781 93.0874 38.3269 92.534C37.7756 91.9807 37.5 91.335 37.5 90.5972C37.5 89.7978 37.7756 89.1368 38.3269 88.6142C38.8781 88.0915 39.5213 87.8302 40.2562 87.8302H66.9V82.2962H45.7688C45.0338 82.2962 44.3906 82.0195 43.8394 81.4661C43.2881 80.9127 43.0125 80.2671 43.0125 79.5292C43.0125 78.7299 43.2881 78.0689 43.8394 77.5462C44.3906 77.0236 45.0338 76.7623 45.7688 76.7623H76.6387L72.5044 68.6458C72.0144 67.662 71.8612 66.6628 72.045 65.6482C72.2287 64.6337 72.7188 63.7882 73.515 63.1118C73.9437 62.7429 74.3572 62.5584 74.7553 62.5584C75.1534 62.5584 75.5975 62.7736 76.0875 63.2041L95.565 81.9273C96.4225 82.7266 97.0656 83.649 97.4944 84.6943C97.9231 85.7396 98.1375 86.8156 98.1375 87.9224V107.199C98.1375 109.474 97.3413 111.426 95.7487 113.056C94.1562 114.685 92.1963 115.5 89.8687 115.5H49.4437ZM70.9425 58.1313L59.0906 45.5876C58.6006 45.0342 58.3709 44.3732 58.4016 43.6046C58.4322 42.836 58.7231 42.175 59.2744 41.6216C59.8256 41.1297 60.4841 40.8991 61.2497 40.9299C62.0153 40.9606 62.6431 41.2527 63.1331 41.8061L78.2925 57.9468C76.945 57.3319 75.7047 57.0245 74.5716 57.0245C73.4384 57.0245 72.2288 57.3934 70.9425 58.1313ZM67.0837 70.0293L54.8644 57.2089C54.3744 56.6555 54.1447 55.9945 54.1753 55.2259C54.2059 54.4573 54.4969 53.7963 55.0481 53.2429C55.5994 52.751 56.2578 52.5204 57.0234 52.5512C57.7891 52.5819 58.4169 52.874 58.9069 53.4274L67.4512 62.2817C67.145 62.8966 66.9153 63.4961 66.7622 64.0803C66.6091 64.6644 66.5325 65.2024 66.5325 65.6943C66.5325 66.4322 66.5784 67.1547 66.6703 67.8618C66.7622 68.5689 66.9 69.2914 67.0837 70.0293ZM101.261 80.1749C100.955 79.7444 100.618 79.3294 100.251 78.9297C99.8831 78.5301 99.485 78.115 99.0562 77.6846L79.0275 58.5002L80.9569 56.5633L82.8862 54.6264L64.6031 35.1653C64.1131 34.6119 63.8681 33.9663 63.8681 33.2284C63.8681 32.4906 64.1437 31.8449 64.695 31.2915C65.2462 30.7996 65.92 30.569 66.7162 30.5998C67.5125 30.6305 68.1556 30.9226 68.6456 31.476L86.9287 50.8449L90.9712 46.9711L76.3631 31.6605C75.8731 31.1071 75.6434 30.4461 75.6741 29.6775C75.7047 28.9089 75.9956 28.2479 76.5469 27.6945C77.0981 27.2026 77.7566 26.972 78.5222 27.0027C79.2878 27.0335 79.9156 27.3255 80.4056 27.8789L101.629 50.3837L104.661 41.6216C105.028 40.5763 105.671 39.7923 106.59 39.2697C107.509 38.747 108.489 38.5472 109.53 38.6702C110.081 38.7316 110.464 38.9007 110.678 39.1774C110.893 39.4541 111 39.9307 111 40.607V67.6312C111 68.7995 110.77 69.9063 110.311 70.9516C109.852 71.9969 109.193 72.9192 108.336 73.7186L101.261 80.1749Z",fill:"white"})]}),(0,ct.jsx)("p",{className:ut["brand-name"],children:"Slingo"})]}),(0,ct.jsxs)("div",{className:ut["navigation-section"],children:[(0,ct.jsxs)("div",{className:ut["navigation-icons"],children:[(0,ct.jsx)("a",{onClick:function(){return t(-1)},children:(0,ct.jsxs)("svg",{width:"60",height:"60",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ut["navigation-icon-back"],children:[(0,ct.jsx)("circle",{cx:"30",cy:"30",r:"30",fill:"#FF6C2D"}),(0,ct.jsx)("path",{d:"M35.0714 44.4677L22.4286 31.0456C22.3095 30.8935 22.2083 30.7351 22.125 30.5703C22.0417 30.4056 22 30.2091 22 29.981C22 29.8035 22.0417 29.6261 22.125 29.4487C22.2083 29.2712 22.3095 29.1191 22.4286 28.9924L35.0714 15.5323C35.381 15.1774 35.7798 15 36.2679 15C36.756 15 37.1548 15.1774 37.4643 15.5323C37.8214 15.8872 38 16.3181 38 16.8251C38 17.3321 37.8214 17.7757 37.4643 18.1559L26.3571 29.981L37.5 41.8441C37.8095 42.2243 37.9702 42.6679 37.9821 43.1749C37.994 43.6819 37.8333 44.1001 37.5 44.4297C37.1429 44.8099 36.7262 45 36.25 45C35.7738 45 35.381 44.8226 35.0714 44.4677Z",fill:"white"})]})}),(0,ct.jsx)("a",{onClick:function(){return t(1)},children:(0,ct.jsxs)("svg",{width:"60",height:"60",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ut["navigation-icon-forward"],children:[(0,ct.jsx)("circle",{cx:"30",cy:"30",r:"30",transform:"rotate(180 30 30)",fill:"#FF6C2D"}),(0,ct.jsx)("path",{d:"M24.9286 15.5323L37.5714 28.9544C37.6905 29.1065 37.7917 29.2649 37.875 29.4297C37.9583 29.5944 38 29.7909 38 30.019C38 30.1965 37.9583 30.3739 37.875 30.5513C37.7917 30.7288 37.6905 30.8809 37.5714 31.0076L24.9286 44.4677C24.619 44.8226 24.2202 45 23.7321 45C23.244 45 22.8452 44.8226 22.5357 44.4677C22.1786 44.1128 22 43.6819 22 43.1749C22 42.6679 22.1786 42.2243 22.5357 41.8441L33.6429 30.019L22.5 18.1559C22.1905 17.7757 22.0298 17.3321 22.0179 16.8251C22.006 16.3181 22.1667 15.8999 22.5 15.5703C22.8571 15.1901 23.2738 15 23.75 15C24.2262 15 24.619 15.1774 24.9286 15.5323Z",fill:"white"})]})})]}),(0,ct.jsx)("a",{className:ut["user-name"],href:"#",children:e}),(0,ct.jsx)("a",{className:ut["logout-button"],onClick:function(){localStorage.removeItem("token"),localStorage.removeItem("name"),localStorage.removeItem("was_visited"),window.location="Slingo"},children:"Logout"})]})]})})}function dt(){var e=localStorage.getItem("name"),t=qe();return(0,S.useEffect)((function(){if(!localStorage.getItem("was_visited"))return localStorage.setItem("was_visited",1),t("/tutorial")})),(0,ct.jsxs)("div",{className:st.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:st.intro,children:[(0,ct.jsx)("h1",{className:st.home,children:"Home"}),(0,ct.jsxs)("p",{className:st.greeting,children:["Hello, ",e]})]}),(0,ct.jsxs)("div",{className:st["navigation-buttons"],children:[(0,ct.jsx)("button",{onClick:function(){return t("/learn")},className:st["translate-button"],children:"Learn"}),(0,ct.jsx)("button",{onClick:function(){return t("/translate")},className:st["learn-button"],children:"Translate"})]})]})}var pt={container:"home_container__Iww69",body:"home_body__CM9u8",navbar:"home_navbar__cGyBb","navbar-container":"home_navbar-container__hqDUp","navbar-right":"home_navbar-right__xrJqh","navbar-button-login":"home_navbar-button-login__MLP8u","navbar-button-signup":"home_navbar-button-signup__v0MCH","container-1":"home_container-1__I1sVs","slingo-logo":"home_slingo-logo__9MGCs","sub-container":"home_sub-container__v1wgj","sub-container-content":"home_sub-container-content__C2OAZ",footer:"home_footer__YYbVZ","footer-content":"home_footer-content__NsMUG","slingo-logo-text":"home_slingo-logo-text__MEPLL","slingo-logo-2":"home_slingo-logo-2__Ub57O","footer-copyright":"home_footer-copyright__sQadl"};function ht(){var e=qe();return(0,ct.jsxs)("div",{className:pt.container,children:[(0,ct.jsxs)("body",{className:pt.body,children:[(0,ct.jsx)("nav",{className:pt.navbar,children:(0,ct.jsx)("div",{className:pt["navbar-container"],children:(0,ct.jsxs)("div",{className:pt["navbar-right"],children:[(0,ct.jsx)("button",{onClick:function(){return e("/login")},className:pt["navbar-button-login"],children:"Login"}),(0,ct.jsx)("button",{onClick:function(){return e("/signup")},className:pt["navbar-button-signup"],children:"Signup"})]})})}),(0,ct.jsxs)("div",{className:pt["container-1"],children:[(0,ct.jsxs)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:pt["slingo-logo"],children:[(0,ct.jsx)("circle",{cx:"50",cy:"50",r:"50",fill:"#FF6C2D"}),(0,ct.jsx)("path",{d:"M32.9625 77C32.4725 77 32.0437 76.8155 31.6762 76.4466C31.3087 76.0777 31.125 75.6473 31.125 75.1553C31.125 74.6224 31.3087 74.1818 31.6762 73.8333C32.0437 73.4849 32.4725 73.3107 32.9625 73.3107H44.6V69.6214H29.2875C28.7975 69.6214 28.3687 69.4369 28.0012 69.068C27.6337 68.6991 27.45 68.2686 27.45 67.7767C27.45 67.2438 27.6337 66.8032 28.0012 66.4547C28.3687 66.1063 28.7975 65.9321 29.2875 65.9321H44.6V62.2428H26.8375C26.3475 62.2428 25.9187 62.0583 25.5512 61.6894C25.1837 61.3204 25 60.89 25 60.3981C25 59.8652 25.1837 59.4245 25.5512 59.0761C25.9187 58.7277 26.3475 58.5535 26.8375 58.5535H44.6V54.8641H30.5125C30.0225 54.8641 29.5938 54.6797 29.2262 54.3108C28.8587 53.9418 28.675 53.5114 28.675 53.0195C28.675 52.4866 28.8587 52.0459 29.2262 51.6975C29.5938 51.3491 30.0225 51.1748 30.5125 51.1748H51.0925L48.3363 45.7639C48.0096 45.108 47.9075 44.4419 48.03 43.7655C48.1525 43.0891 48.4792 42.5255 49.01 42.0745C49.2958 41.8286 49.5715 41.7056 49.8369 41.7056C50.1023 41.7056 50.3983 41.8491 50.725 42.136L63.71 54.6182C64.2817 55.1511 64.7104 55.766 64.9963 56.4628C65.2821 57.1597 65.425 57.8771 65.425 58.6149V71.466C65.425 72.9828 64.8942 74.2843 63.8325 75.3706C62.7708 76.4568 61.4642 77 59.9125 77H32.9625ZM47.295 38.7542L39.3938 30.3917C39.0671 30.0228 38.914 29.5821 38.9344 29.0697C38.9548 28.5573 39.1488 28.1167 39.5163 27.7477C39.8838 27.4198 40.3227 27.2661 40.8331 27.2866C41.3435 27.3071 41.7621 27.5018 42.0888 27.8707L52.195 38.6312C51.2967 38.2213 50.4698 38.0163 49.7144 38.0163C48.959 38.0163 48.1525 38.2623 47.295 38.7542ZM44.7225 46.6862L36.5763 38.1393C36.2496 37.7704 36.0965 37.3297 36.1169 36.8173C36.1373 36.3049 36.3313 35.8642 36.6988 35.4953C37.0663 35.1673 37.5052 35.0136 38.0156 35.0341C38.526 35.0546 38.9446 35.2493 39.2712 35.6183L44.9675 41.5211C44.7633 41.9311 44.6102 42.3307 44.5081 42.7202C44.406 43.1096 44.355 43.4683 44.355 43.7962C44.355 44.2881 44.3856 44.7698 44.4469 45.2412C44.5081 45.7126 44.6 46.1943 44.7225 46.6862ZM67.5075 53.4499C67.3033 53.163 67.0788 52.8863 66.8338 52.6198C66.5888 52.3534 66.3233 52.0767 66.0375 51.7897L52.685 39.0001L53.9713 37.7089L55.2575 36.4176L43.0688 23.4435C42.7421 23.0746 42.5788 22.6442 42.5788 22.1523C42.5788 21.6604 42.7625 21.23 43.13 20.861C43.4975 20.5331 43.9467 20.3794 44.4775 20.3999C45.0083 20.4204 45.4371 20.6151 45.7638 20.984L57.9525 33.8966L60.6475 31.3141L50.9088 21.107C50.5821 20.738 50.429 20.2974 50.4494 19.785C50.4698 19.2726 50.6637 18.8319 51.0312 18.463C51.3988 18.135 51.8377 17.9813 52.3481 18.0018C52.8585 18.0223 53.2771 18.217 53.6038 18.5859L67.7525 33.5891L69.7738 27.7477C70.0187 27.0509 70.4475 26.5282 71.06 26.1798C71.6725 25.8313 72.3258 25.6981 73.02 25.7801C73.3875 25.8211 73.6427 25.9338 73.7856 26.1183C73.9285 26.3028 74 26.6204 74 27.0714V45.0875C74 45.8663 73.8469 46.6042 73.5406 47.3011C73.2344 47.9979 72.7954 48.6128 72.2238 49.1457L67.5075 53.4499Z",fill:"white"})]}),(0,ct.jsx)("h1",{children:"Slingo"}),(0,ct.jsx)("blockquote",{children:"Language is more than just voice"}),(0,ct.jsx)("div",{className:pt["sub-container"],children:(0,ct.jsxs)("div",{className:pt["sub-container-content"],children:[(0,ct.jsx)("h1",{children:"What is Slingo?"}),(0,ct.jsx)("p",{children:"Slingo is a web application where learning and translating sign language is made simple and accessible. Our mission is to support the deaf community by providing a platform for individuals to improve their sign language skills and effectively communicate with those who use sign language. With our user-friendly interface and innovative technology, learning sign language has never been easier. Join us now to start your journey."})]})})]})]}),(0,ct.jsx)("div",{className:pt.footer,children:(0,ct.jsxs)("div",{className:pt["footer-content"],children:[(0,ct.jsxs)("div",{className:pt["slingo-logo-text"],children:[(0,ct.jsxs)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:pt["slingo-logo-2"],children:[(0,ct.jsx)("circle",{cx:"50",cy:"50",r:"50",fill:"#FF6C2D"}),(0,ct.jsx)("path",{d:"M32.9625 77C32.4725 77 32.0437 76.8155 31.6762 76.4466C31.3087 76.0777 31.125 75.6473 31.125 75.1553C31.125 74.6224 31.3087 74.1818 31.6762 73.8333C32.0437 73.4849 32.4725 73.3107 32.9625 73.3107H44.6V69.6214H29.2875C28.7975 69.6214 28.3687 69.4369 28.0012 69.068C27.6337 68.6991 27.45 68.2686 27.45 67.7767C27.45 67.2438 27.6337 66.8032 28.0012 66.4547C28.3687 66.1063 28.7975 65.9321 29.2875 65.9321H44.6V62.2428H26.8375C26.3475 62.2428 25.9187 62.0583 25.5512 61.6894C25.1837 61.3204 25 60.89 25 60.3981C25 59.8652 25.1837 59.4245 25.5512 59.0761C25.9187 58.7277 26.3475 58.5535 26.8375 58.5535H44.6V54.8641H30.5125C30.0225 54.8641 29.5938 54.6797 29.2262 54.3108C28.8587 53.9418 28.675 53.5114 28.675 53.0195C28.675 52.4866 28.8587 52.0459 29.2262 51.6975C29.5938 51.3491 30.0225 51.1748 30.5125 51.1748H51.0925L48.3363 45.7639C48.0096 45.108 47.9075 44.4419 48.03 43.7655C48.1525 43.0891 48.4792 42.5255 49.01 42.0745C49.2958 41.8286 49.5715 41.7056 49.8369 41.7056C50.1023 41.7056 50.3983 41.8491 50.725 42.136L63.71 54.6182C64.2817 55.1511 64.7104 55.766 64.9963 56.4628C65.2821 57.1597 65.425 57.8771 65.425 58.6149V71.466C65.425 72.9828 64.8942 74.2843 63.8325 75.3706C62.7708 76.4568 61.4642 77 59.9125 77H32.9625ZM47.295 38.7542L39.3938 30.3917C39.0671 30.0228 38.914 29.5821 38.9344 29.0697C38.9548 28.5573 39.1488 28.1167 39.5163 27.7477C39.8838 27.4198 40.3227 27.2661 40.8331 27.2866C41.3435 27.3071 41.7621 27.5018 42.0888 27.8707L52.195 38.6312C51.2967 38.2213 50.4698 38.0163 49.7144 38.0163C48.959 38.0163 48.1525 38.2623 47.295 38.7542ZM44.7225 46.6862L36.5763 38.1393C36.2496 37.7704 36.0965 37.3297 36.1169 36.8173C36.1373 36.3049 36.3313 35.8642 36.6988 35.4953C37.0663 35.1673 37.5052 35.0136 38.0156 35.0341C38.526 35.0546 38.9446 35.2493 39.2712 35.6183L44.9675 41.5211C44.7633 41.9311 44.6102 42.3307 44.5081 42.7202C44.406 43.1096 44.355 43.4683 44.355 43.7962C44.355 44.2881 44.3856 44.7698 44.4469 45.2412C44.5081 45.7126 44.6 46.1943 44.7225 46.6862ZM67.5075 53.4499C67.3033 53.163 67.0788 52.8863 66.8338 52.6198C66.5888 52.3534 66.3233 52.0767 66.0375 51.7897L52.685 39.0001L53.9713 37.7089L55.2575 36.4176L43.0688 23.4435C42.7421 23.0746 42.5788 22.6442 42.5788 22.1523C42.5788 21.6604 42.7625 21.23 43.13 20.861C43.4975 20.5331 43.9467 20.3794 44.4775 20.3999C45.0083 20.4204 45.4371 20.6151 45.7638 20.984L57.9525 33.8966L60.6475 31.3141L50.9088 21.107C50.5821 20.738 50.429 20.2974 50.4494 19.785C50.4698 19.2726 50.6637 18.8319 51.0312 18.463C51.3988 18.135 51.8377 17.9813 52.3481 18.0018C52.8585 18.0223 53.2771 18.217 53.6038 18.5859L67.7525 33.5891L69.7738 27.7477C70.0187 27.0509 70.4475 26.5282 71.06 26.1798C71.6725 25.8313 72.3258 25.6981 73.02 25.7801C73.3875 25.8211 73.6427 25.9338 73.7856 26.1183C73.9285 26.3028 74 26.6204 74 27.0714V45.0875C74 45.8663 73.8469 46.6042 73.5406 47.3011C73.2344 47.9979 72.7954 48.6128 72.2238 49.1457L67.5075 53.4499Z",fill:"white"})]}),(0,ct.jsx)("h2",{children:"Slingo"})]}),(0,ct.jsx)("blockquote",{children:"Language is more than just voice"}),(0,ct.jsx)("p",{className:pt["footer-copyright"],children:"\xa9 Slingo 2023. All rights reserved."})]})})]})}function ft(){ft=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(E){u=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new N(a||[]);return r(o,"_invoke",{value:k(e,n,s)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var d={};function p(){}function h(){}function f(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(I([])));g&&g!==t&&n.call(g,i)&&(v=g);var y=f.prototype=p.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function a(r,i,o,s){var u=l(e[r],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==O(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,s)}))}s(u.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function k(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=l(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function I(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=f,r(y,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=u(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(x.prototype),u(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new x(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(y),u(y,s,"Generator"),u(y,i,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function vt(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function mt(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){vt(i,r,a,o,s,"next",e)}function s(e){vt(i,r,a,o,s,"throw",e)}o(void 0)}))}}function gt(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xt(e,t){return function(){return e.apply(t,arguments)}}var kt,wt=Object.prototype.toString,Ct=Object.getPrototypeOf,St=(kt=Object.create(null),function(e){var t=wt.call(e);return kt[t]||(kt[t]=t.slice(8,-1).toLowerCase())}),Nt=function(e){return e=e.toLowerCase(),function(t){return St(t)===e}},It=function(e){return function(t){return typeof t===e}},Tt=Array.isArray,Et=It("undefined");var _t=Nt("ArrayBuffer");var Rt=It("string"),At=It("function"),Ot=It("number"),Ft=function(e){return null!==e&&"object"===typeof e},Dt=function(e){if("object"!==St(e))return!1;var t=Ct(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Lt=Nt("Date"),Mt=Nt("File"),zt=Nt("Blob"),Pt=Nt("FileList"),Bt=Nt("URLSearchParams");function Vt(e,t){var n,r,a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allOwnKeys,i=void 0!==a&&a;if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Tt(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{var o,s=i?Object.getOwnPropertyNames(e):Object.keys(e),u=s.length;for(n=0;n<u;n++)o=s[n],t.call(null,e[o],o,e)}}function Wt(e,t){t=t.toLowerCase();for(var n,r=Object.keys(e),a=r.length;a-- >0;)if(t===(n=r[a]).toLowerCase())return n;return null}var Ut="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,jt=function(e){return!Et(e)&&e!==Ut};var Ht,Gt=(Ht="undefined"!==typeof Uint8Array&&Ct(Uint8Array),function(e){return Ht&&e instanceof Ht}),qt=Nt("HTMLFormElement"),Kt=function(e){var t=Object.prototype.hasOwnProperty;return function(e,n){return t.call(e,n)}}(),Xt=Nt("RegExp"),Zt=function(e,t){var n=Object.getOwnPropertyDescriptors(e),r={};Vt(n,(function(n,a){!1!==t(n,a,e)&&(r[a]=n)})),Object.defineProperties(e,r)},Yt="abcdefghijklmnopqrstuvwxyz",Qt="0123456789",Jt={DIGIT:Qt,ALPHA:Yt,ALPHA_DIGIT:Yt+Yt.toUpperCase()+Qt};var $t={isArray:Tt,isArrayBuffer:_t,isBuffer:function(e){return null!==e&&!Et(e)&&null!==e.constructor&&!Et(e.constructor)&&At(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"===typeof FormData&&e instanceof FormData||wt.call(e)===t||At(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&_t(e.buffer)},isString:Rt,isNumber:Ot,isBoolean:function(e){return!0===e||!1===e},isObject:Ft,isPlainObject:Dt,isUndefined:Et,isDate:Lt,isFile:Mt,isBlob:zt,isRegExp:Xt,isFunction:At,isStream:function(e){return Ft(e)&&At(e.pipe)},isURLSearchParams:Bt,isTypedArray:Gt,isFileList:Pt,forEach:Vt,merge:function e(){for(var t=(jt(this)&&this||{}).caseless,n={},r=function(r,a){var i=t&&Wt(n,a)||a;Dt(n[i])&&Dt(r)?n[i]=e(n[i],r):Dt(r)?n[i]=e({},r):Tt(r)?n[i]=r.slice():n[i]=r},a=0,i=arguments.length;a<i;a++)arguments[a]&&Vt(arguments[a],r);return n},extend:function(e,t,n){return Vt(t,(function(t,r){n&&At(t)?e[r]=xt(t,n):e[r]=t}),{allOwnKeys:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys}),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n,r){var a,i,o,s={};if(t=t||{},null==e)return t;do{for(i=(a=Object.getOwnPropertyNames(e)).length;i-- >0;)o=a[i],r&&!r(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&Ct(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:St,kindOfTest:Nt,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;if(Tt(e))return e;var t=e.length;if(!Ot(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},forEachEntry:function(e,t){for(var n,r=(e&&e[Symbol.iterator]).call(e);(n=r.next())&&!n.done;){var a=n.value;t.call(e,a[0],a[1])}},matchAll:function(e,t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:qt,hasOwnProperty:Kt,hasOwnProp:Kt,reduceDescriptors:Zt,freezeMethods:function(e){Zt(e,(function(t,n){if(At(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;var r=e[n];At(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=function(){throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:function(e,t){var n={},r=function(e){e.forEach((function(e){n[e]=!0}))};return Tt(e)?r(e):r(String(e).split(t)),n},toCamelCase:function(e){return e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))},noop:function(){},toFiniteNumber:function(e,t){return e=+e,Number.isFinite(e)?e:t},findKey:Wt,global:Ut,isContextDefined:jt,ALPHABET:Jt,generateString:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt.ALPHA_DIGIT,n="",r=t.length;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&At(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:function(e){var t=new Array(10);return function e(n,r){if(Ft(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[r]=n;var a=Tt(n)?[]:{};return Vt(n,(function(t,n){var i=e(t,r+1);!Et(i)&&(a[n]=i)})),t[r]=void 0,a}}return n}(e,0)}};function en(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a)}$t.inherits(en,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:$t.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var tn=en.prototype,nn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(e){nn[e]={value:e}})),Object.defineProperties(en,nn),Object.defineProperty(tn,"isAxiosError",{value:!0}),en.from=function(e,t,n,r,a,i){var o=Object.create(tn);return $t.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(function(e){return"isAxiosError"!==e})),en.call(o,e.message,t,n,r,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};var rn=en,an=null;function on(e){return $t.isPlainObject(e)||$t.isArray(e)}function sn(e){return $t.endsWith(e,"[]")?e.slice(0,-2):e}function un(e,t,n){return e?e.concat(t).map((function(e,t){return e=sn(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}var cn=$t.toFlatObject($t,{},null,(function(e){return/^is[A-Z]/.test(e)}));var ln=function(e,t,n){if(!$t.isObject(e))throw new TypeError("target must be an object");t=t||new(an||FormData);var r=(n=$t.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!$t.isUndefined(t[e])}))).metaTokens,a=n.visitor||c,i=n.dots,o=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&$t.isSpecCompliantForm(t);if(!$t.isFunction(a))throw new TypeError("visitor must be a function");function u(e){if(null===e)return"";if($t.isDate(e))return e.toISOString();if(!s&&$t.isBlob(e))throw new rn("Blob is not supported. Use a Buffer instead.");return $t.isArrayBuffer(e)||$t.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){var s=e;if(e&&!a&&"object"===typeof e)if($t.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if($t.isArray(e)&&function(e){return $t.isArray(e)&&!e.some(on)}(e)||($t.isFileList(e)||$t.endsWith(n,"[]"))&&(s=$t.toArray(e)))return n=sn(n),s.forEach((function(e,r){!$t.isUndefined(e)&&null!==e&&t.append(!0===o?un([n],r,i):null===o?n:n+"[]",u(e))})),!1;return!!on(e)||(t.append(un(a,n,i),u(e)),!1)}var l=[],d=Object.assign(cn,{defaultVisitor:c,convertValue:u,isVisitable:on});if(!$t.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!$t.isUndefined(n)){if(-1!==l.indexOf(n))throw Error("Circular reference detected in "+r.join("."));l.push(n),$t.forEach(n,(function(n,i){!0===(!($t.isUndefined(n)||null===n)&&a.call(t,n,$t.isString(i)?i.trim():i,r,d))&&e(n,r?r.concat(i):[i])})),l.pop()}}(e),t};function dn(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function pn(e,t){this._pairs=[],e&&ln(e,this,t)}var hn=pn.prototype;hn.append=function(e,t){this._pairs.push([e,t])},hn.toString=function(e){var t=e?function(t){return e.call(this,t,dn)}:dn;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var fn=pn;function vn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function mn(e,t,n){if(!t)return e;var r,a=n&&n.encode||vn,i=n&&n.serialize;if(r=i?i(t,n):$t.isURLSearchParams(t)?t.toString():new fn(t,n).toString(a)){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}var gn=function(){function e(){A(this,e),this.handlers=[]}return L(e,[{key:"use",value:function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){$t.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}]),e}(),yn=gn,bn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xn={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:fn,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},isStandardBrowserEnv:function(){var e;return("undefined"===typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!==typeof window&&"undefined"!==typeof document)}(),isStandardBrowserWebWorkerEnv:"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};var kn=function(e){function t(e,n,r,a){var i=e[a++],o=Number.isFinite(+i),s=a>=e.length;return i=!i&&$t.isArray(r)?r.length:i,s?($t.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o):(r[i]&&$t.isObject(r[i])||(r[i]=[]),t(e,n,r[i],a)&&$t.isArray(r[i])&&(r[i]=function(e){var t,n,r={},a=Object.keys(e),i=a.length;for(t=0;t<i;t++)r[n=a[t]]=e[n];return r}(r[i])),!o)}if($t.isFormData(e)&&$t.isFunction(e.entries)){var n={};return $t.forEachEntry(e,(function(e,r){t(function(e){return $t.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),r,n,0)})),n}return null},wn={"Content-Type":void 0};var Cn={transitional:bn,adapter:["xhr","http"],transformRequest:[function(e,t){var n,r=t.getContentType()||"",a=r.indexOf("application/json")>-1,i=$t.isObject(e);if(i&&$t.isHTMLForm(e)&&(e=new FormData(e)),$t.isFormData(e))return a&&a?JSON.stringify(kn(e)):e;if($t.isArrayBuffer(e)||$t.isBuffer(e)||$t.isStream(e)||$t.isFile(e)||$t.isBlob(e))return e;if($t.isArrayBufferView(e))return e.buffer;if($t.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ln(e,new xn.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return xn.isNode&&$t.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((n=$t.isFileList(e))||r.indexOf("multipart/form-data")>-1){var o=this.env&&this.env.FormData;return ln(n?{"files[]":e}:e,o&&new o,this.formSerializer)}}return i||a?(t.setContentType("application/json",!1),function(e,t,n){if($t.isString(e))try{return(t||JSON.parse)(e),$t.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||Cn.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&$t.isString(e)&&(n&&!this.responseType||r)){var a=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(i){if(a){if("SyntaxError"===i.name)throw rn.from(i,rn.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xn.classes.FormData,Blob:xn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};$t.forEach(["delete","get","head"],(function(e){Cn.headers[e]={}})),$t.forEach(["post","put","patch"],(function(e){Cn.headers[e]=$t.merge(wn)}));var Sn=Cn,Nn=$t.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),In=Symbol("internals");function Tn(e){return e&&String(e).trim().toLowerCase()}function En(e){return!1===e||null==e?e:$t.isArray(e)?e.map(En):String(e)}function _n(e,t,n,r,a){return $t.isFunction(r)?r.call(this,t,n):(a&&(t=n),$t.isString(t)?$t.isString(r)?-1!==t.indexOf(r):$t.isRegExp(r)?r.test(t):void 0:void 0)}var Rn=function(e,t){function n(e){A(this,n),e&&this.set(e)}return L(n,[{key:"set",value:function(e,t,n){var r=this;function a(e,t,n){var a=Tn(t);if(!a)throw new Error("header name must be a non-empty string");var i=$t.findKey(r,a);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=En(e))}var i=function(e,t){return $t.forEach(e,(function(e,n){return a(e,n,t)}))};return $t.isPlainObject(e)||e instanceof this.constructor?i(e,t):$t.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z]+$/.test(e.trim())?i(function(e){var t,n,r,a={};return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!t||a[t]&&Nn[t]||("set-cookie"===t?a[t]?a[t].push(n):a[t]=[n]:a[t]=a[t]?a[t]+", "+n:n)})),a}(e),t):null!=e&&a(t,e,n),this}},{key:"get",value:function(e,t){if(e=Tn(e)){var n=$t.findKey(this,e);if(n){var r=this[n];if(!t)return r;if(!0===t)return function(e){for(var t,n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;t=r.exec(e);)n[t[1]]=t[2];return n}(r);if($t.isFunction(t))return t.call(this,r,n);if($t.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(e,t){if(e=Tn(e)){var n=$t.findKey(this,e);return!(!n||void 0===this[n]||t&&!_n(0,this[n],n,t))}return!1}},{key:"delete",value:function(e,t){var n=this,r=!1;function a(e){if(e=Tn(e)){var a=$t.findKey(n,e);!a||t&&!_n(0,n[a],a,t)||(delete n[a],r=!0)}}return $t.isArray(e)?e.forEach(a):a(e),r}},{key:"clear",value:function(e){for(var t=Object.keys(this),n=t.length,r=!1;n--;){var a=t[n];e&&!_n(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}},{key:"normalize",value:function(e){var t=this,n={};return $t.forEach(this,(function(r,a){var i=$t.findKey(n,a);if(i)return t[i]=En(r),void delete t[a];var o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))}(a):String(a).trim();o!==a&&delete t[a],t[o]=En(r),n[o]=!0})),this}},{key:"concat",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.constructor).concat.apply(e,[this].concat(n))}},{key:"toJSON",value:function(e){var t=Object.create(null);return $t.forEach(this,(function(n,r){null!=n&&!1!==n&&(t[r]=e&&$t.isArray(n)?n.join(", "):n)})),t}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(e){var t=H(e,2);return t[0]+": "+t[1]})).join("\n")}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(e){return e instanceof this?e:new this(e)}},{key:"concat",value:function(e){for(var t=new this(e),n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach((function(e){return t.set(e)})),t}},{key:"accessor",value:function(e){var t=(this[In]=this[In]={accessors:{}}).accessors,n=this.prototype;function r(e){var r=Tn(e);t[r]||(!function(e,t){var n=$t.toCamelCase(" "+t);["get","set","has"].forEach((function(r){Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})}))}(n,e),t[r]=!0)}return $t.isArray(e)?e.forEach(r):r(e),this}}]),n}();Rn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),$t.freezeMethods(Rn.prototype),$t.freezeMethods(Rn);var An=Rn;function On(e,t){var n=this||Sn,r=t||n,a=An.from(r.headers),i=r.data;return $t.forEach(e,(function(e){i=e.call(n,i,a.normalize(),t?t.status:void 0)})),a.normalize(),i}function Fn(e){return!(!e||!e.__CANCEL__)}function Dn(e,t,n){rn.call(this,null==e?"canceled":e,rn.ERR_CANCELED,t,n),this.name="CanceledError"}$t.inherits(Dn,rn,{__CANCEL__:!0});var Ln=Dn;var Mn=xn.isStandardBrowserEnv?{write:function(e,t,n,r,a,i){var o=[];o.push(e+"="+encodeURIComponent(t)),$t.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),$t.isString(r)&&o.push("path="+r),$t.isString(a)&&o.push("domain="+a),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function zn(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var Pn=xn.isStandardBrowserEnv?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=$t.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0};var Bn=function(e,t){e=e||10;var n,r=new Array(e),a=new Array(e),i=0,o=0;return t=void 0!==t?t:1e3,function(s){var u=Date.now(),c=a[o];n||(n=u),r[i]=s,a[i]=u;for(var l=o,d=0;l!==i;)d+=r[l++],l%=e;if((i=(i+1)%e)===o&&(o=(o+1)%e),!(u-n<t)){var p=c&&u-c;return p?Math.round(1e3*d/p):void 0}}};function Vn(e,t){var n=0,r=Bn(50,250);return function(a){var i=a.loaded,o=a.lengthComputable?a.total:void 0,s=i-n,u=r(s);n=i;var c={loaded:i,total:o,progress:o?i/o:void 0,bytes:s,rate:u||void 0,estimated:u&&o&&i<=o?(o-i)/u:void 0,event:a};c[t?"download":"upload"]=!0,e(c)}}var Wn="undefined"!==typeof XMLHttpRequest,Un={http:an,xhr:Wn&&function(e){return new Promise((function(t,n){var r,a=e.data,i=An.from(e.headers).normalize(),o=e.responseType;function s(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}$t.isFormData(a)&&(xn.isStandardBrowserEnv||xn.isStandardBrowserWebWorkerEnv)&&i.setContentType(!1);var u=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(c+":"+l))}var d=zn(e.baseURL,e.url);function p(){if(u){var r=An.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new rn("Request failed with status code "+n.status,[rn.ERR_BAD_REQUEST,rn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:o&&"text"!==o&&"json"!==o?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:r,config:e,request:u}),u=null}}if(u.open(e.method.toUpperCase(),mn(d,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,"onloadend"in u?u.onloadend=p:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(p)},u.onabort=function(){u&&(n(new rn("Request aborted",rn.ECONNABORTED,e,u)),u=null)},u.onerror=function(){n(new rn("Network Error",rn.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||bn;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new rn(t,r.clarifyTimeoutError?rn.ETIMEDOUT:rn.ECONNABORTED,e,u)),u=null},xn.isStandardBrowserEnv){var h=(e.withCredentials||Pn(d))&&e.xsrfCookieName&&Mn.read(e.xsrfCookieName);h&&i.set(e.xsrfHeaderName,h)}void 0===a&&i.setContentType(null),"setRequestHeader"in u&&$t.forEach(i.toJSON(),(function(e,t){u.setRequestHeader(t,e)})),$t.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),o&&"json"!==o&&(u.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&u.addEventListener("progress",Vn(e.onDownloadProgress,!0)),"function"===typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",Vn(e.onUploadProgress)),(e.cancelToken||e.signal)&&(r=function(t){u&&(n(!t||t.type?new Ln(null,e,u):t),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r)));var f=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(d);f&&-1===xn.protocols.indexOf(f)?n(new rn("Unsupported protocol "+f+":",rn.ERR_BAD_REQUEST,e)):u.send(a||null)}))}};$t.forEach(Un,(function(e,t){if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}}));var jn={getAdapter:function(e){for(var t,n,r=(e=$t.isArray(e)?e:[e]).length,a=0;a<r&&(t=e[a],!(n=$t.isString(t)?Un[t.toLowerCase()]:t));a++);if(!n){if(!1===n)throw new rn("Adapter ".concat(t," is not supported by the environment"),"ERR_NOT_SUPPORT");throw new Error($t.hasOwnProp(Un,t)?"Adapter '".concat(t,"' is not available in the build"):"Unknown adapter '".concat(t,"'"))}if(!$t.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:Un};function Hn(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ln(null,e)}function Gn(e){return Hn(e),e.headers=An.from(e.headers),e.data=On.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),jn.getAdapter(e.adapter||Sn.adapter)(e).then((function(t){return Hn(e),t.data=On.call(e,e.transformResponse,t),t.headers=An.from(t.headers),t}),(function(t){return Fn(t)||(Hn(e),t&&t.response&&(t.response.data=On.call(e,e.transformResponse,t.response),t.response.headers=An.from(t.response.headers))),Promise.reject(t)}))}var qn=function(e){return e instanceof An?e.toJSON():e};function Kn(e,t){t=t||{};var n={};function r(e,t,n){return $t.isPlainObject(e)&&$t.isPlainObject(t)?$t.merge.call({caseless:n},e,t):$t.isPlainObject(t)?$t.merge({},t):$t.isArray(t)?t.slice():t}function a(e,t,n){return $t.isUndefined(t)?$t.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function i(e,t){if(!$t.isUndefined(t))return r(void 0,t)}function o(e,t){return $t.isUndefined(t)?$t.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,a,i){return i in t?r(n,a):i in e?r(void 0,n):void 0}var u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:function(e,t){return a(qn(e),qn(t),!0)}};return $t.forEach(Object.keys(e).concat(Object.keys(t)),(function(r){var i=u[r]||a,o=i(e[r],t[r],r);$t.isUndefined(o)&&i!==s||(n[r]=o)})),n}var Xn="1.3.4",Zn={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){Zn[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var Yn={};Zn.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Xn+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,a,i){if(!1===e)throw new rn(r(a," has been removed"+(t?" in "+t:"")),rn.ERR_DEPRECATED);return t&&!Yn[a]&&(Yn[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,i)}};var Qn={assertOptions:function(e,t,n){if("object"!==typeof e)throw new rn("options must be an object",rn.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),a=r.length;a-- >0;){var i=r[a],o=t[i];if(o){var s=e[i],u=void 0===s||o(s,i,e);if(!0!==u)throw new rn("option "+i+" must be "+u,rn.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new rn("Unknown option "+i,rn.ERR_BAD_OPTION)}},validators:Zn},Jn=Qn.validators,$n=function(){function e(t){A(this,e),this.defaults=t,this.interceptors={request:new yn,response:new yn}}return L(e,[{key:"request",value:function(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{};var n,r=t=Kn(this.defaults,t),a=r.transitional,i=r.paramsSerializer,o=r.headers;void 0!==a&&Qn.assertOptions(a,{silentJSONParsing:Jn.transitional(Jn.boolean),forcedJSONParsing:Jn.transitional(Jn.boolean),clarifyTimeoutError:Jn.transitional(Jn.boolean)},!1),void 0!==i&&Qn.assertOptions(i,{encode:Jn.function,serialize:Jn.function},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase(),(n=o&&$t.merge(o.common,o[t.method]))&&$t.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete o[e]})),t.headers=An.concat(n,o);var s=[],u=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(u=u&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));var c,l=[];this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));var d,p=0;if(!u){var h=[Gn.bind(this),void 0];for(h.unshift.apply(h,s),h.push.apply(h,l),d=h.length,c=Promise.resolve(t);p<d;)c=c.then(h[p++],h[p++]);return c}d=s.length;var f=t;for(p=0;p<d;){var v=s[p++],m=s[p++];try{f=v(f)}catch(g){m.call(this,g);break}}try{c=Gn.call(this,f)}catch(g){return Promise.reject(g)}for(p=0,d=l.length;p<d;)c=c.then(l[p++],l[p++]);return c}},{key:"getUri",value:function(e){return mn(zn((e=Kn(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}]),e}();$t.forEach(["delete","get","head","options"],(function(e){$n.prototype[e]=function(t,n){return this.request(Kn(n||{},{method:e,url:t,data:(n||{}).data}))}})),$t.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,a){return this.request(Kn(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}$n.prototype[e]=t(),$n.prototype[e+"Form"]=t(!0)}));var er=$n,tr=function(){function e(t){if(A(this,e),"function"!==typeof t)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(e){n=e}));var r=this;this.promise.then((function(e){if(r._listeners){for(var t=r._listeners.length;t-- >0;)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},t((function(e,t,a){r.reason||(r.reason=new Ln(e,t,a),n(r.reason))}))}return L(e,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}},{key:"unsubscribe",value:function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}}}],[{key:"source",value:function(){var t;return{token:new e((function(e){t=e})),cancel:t}}}]),e}();var nr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(nr).forEach((function(e){var t=H(e,2),n=t[0],r=t[1];nr[r]=n}));var rr=nr;var ar=function e(t){var n=new er(t),r=xt(er.prototype.request,n);return $t.extend(r,er.prototype,n,{allOwnKeys:!0}),$t.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Kn(t,n))},r}(Sn);ar.Axios=er,ar.CanceledError=Ln,ar.CancelToken=tr,ar.isCancel=Fn,ar.VERSION=Xn,ar.toFormData=ln,ar.AxiosError=rn,ar.Cancel=ar.CanceledError,ar.all=function(e){return Promise.all(e)},ar.spread=function(e){return function(t){return e.apply(null,t)}},ar.isAxiosError=function(e){return $t.isObject(e)&&!0===e.isAxiosError},ar.mergeConfig=Kn,ar.AxiosHeaders=An,ar.formToJSON=function(e){return kn($t.isHTMLForm(e)?new FormData(e):e)},ar.HttpStatusCode=rr,ar.default=ar;var ir=ar,or={container:"login_container__pWGaW","login-header":"login_login-header__iaub3","container-1":"login_container-1__-mHB5","sub-container-1":"login_sub-container-1__4ee7O","slingo-header":"login_slingo-header__5M796","slingo-slogan":"login_slingo-slogan__I56SR","quote-part-1":"login_quote-part-1__kCA61","quote-author":"login_quote-author__VwhJP","slingo-logo":"login_slingo-logo__lGqNR","sub-container-2":"login_sub-container-2__CGyVZ","login-form":"login_login-form__AKtuQ","forgot-password":"login_forgot-password__Ypq-g","login-button":"login_login-button__r1sRB","link-to-signup":"login_link-to-signup__+cg-z","or-separator":"login_or-separator__UP0lb","continue-with-google-button":"login_continue-with-google-button__+Gfq5"};function sr(){var e=H((0,S.useState)({email:"",password:""}),2),t=e[0],n=e[1],r=H((0,S.useState)(""),2),a=r[0],i=r[1];function o(e){return n((function(t){return bt(bt({},t),e)}))}function s(){return(s=mt(ft().mark((function e(n){var r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"http://localhost:8080/api/auth/",e.next=5,ir.post("http://localhost:8080/api/auth/",t);case 5:r=e.sent,a=r.data,localStorage.setItem("token",a.token),localStorage.setItem("name",a.name),localStorage.setItem("userid",a.userId),window.location="/",e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),e.t0.response&&e.t0.response.status>=400&&e.t0.response.status<=500&&i(e.t0.response.data.message);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}return(0,ct.jsxs)("div",{className:or.container,children:[(0,ct.jsxs)("div",{className:or["container-1"],children:[(0,ct.jsxs)("div",{className:or["sub-container-1"],children:[(0,ct.jsx)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:or["slingo-logo"],children:(0,ct.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M99.7398 50C99.7398 77.2829 77.5487 99.4 50.1746 99.4C22.8005 99.4 0.609375 77.2829 0.609375 50C0.609375 22.7171 22.8005 0.600006 50.1746 0.600006C77.5487 0.600006 99.7398 22.7171 99.7398 50ZM31.0544 77.5045C31.4378 77.8881 31.8853 78.08 32.3966 78.08H60.5183C62.1375 78.08 63.5009 77.5152 64.6088 76.3854C65.7166 75.2557 66.2705 73.9021 66.2705 72.3246V58.9595C66.2705 58.1922 66.1214 57.4461 65.8232 56.7213C65.5248 55.9966 65.0775 55.3571 64.4809 54.8029L50.9314 41.8214C50.5905 41.5231 50.2816 41.3738 50.0047 41.3738C49.7277 41.3738 49.44 41.5017 49.1418 41.7575C48.5879 42.2265 48.247 42.8127 48.1192 43.5161C47.9914 44.2196 48.0979 44.9123 48.4387 45.5945L51.3148 51.2218H29.8401C29.3288 51.2218 28.8813 51.4031 28.4978 51.7654C28.1144 52.1277 27.9227 52.5861 27.9227 53.1403C27.9227 53.6518 28.1144 54.0995 28.4978 54.4832C28.8813 54.8669 29.3288 55.0587 29.8401 55.0587H44.5401V58.8956H26.0053C25.494 58.8956 25.0465 59.0768 24.6631 59.4391C24.2796 59.8015 24.0879 60.2598 24.0879 60.814C24.0879 61.3256 24.2796 61.7732 24.6631 62.157C25.0465 62.5406 25.494 62.7325 26.0053 62.7325H44.5401V66.5694H28.5618C28.0505 66.5694 27.6031 66.7505 27.2196 67.1129C26.8361 67.4753 26.6444 67.9335 26.6444 68.4878C26.6444 68.9993 26.8361 69.4471 27.2196 69.8307C27.6031 70.2144 28.0505 70.4062 28.5618 70.4062H44.5401V74.2431H32.3966C31.8853 74.2431 31.4378 74.4243 31.0544 74.7866C30.6709 75.1491 30.4792 75.6073 30.4792 76.1615C30.4792 76.6732 30.6709 77.1208 31.0544 77.5045ZM39.1075 29.6074L47.3522 38.3044C48.247 37.7928 49.0886 37.5369 49.8768 37.5369C50.6651 37.5369 51.5279 37.7501 52.4653 38.1764L41.9197 26.9855C41.5788 26.6019 41.142 26.3994 40.6094 26.3781C40.0768 26.3567 39.6188 26.5166 39.2353 26.8576C38.8519 27.2414 38.6494 27.6996 38.6281 28.2325C38.6068 28.7654 38.7666 29.2237 39.1075 29.6074ZM36.1674 37.6649L44.6679 46.5536C44.5401 46.0421 44.4442 45.5411 44.3803 45.0508C44.3163 44.5606 44.2844 44.0596 44.2844 43.548C44.2844 43.207 44.3376 42.834 44.4442 42.429C44.5507 42.0239 44.7105 41.6083 44.9235 41.1819L38.9796 35.043C38.6388 34.6593 38.202 34.4568 37.6694 34.4355C37.1368 34.4141 36.6788 34.574 36.2953 34.9151C35.9119 35.2988 35.7094 35.7571 35.6881 36.29C35.6668 36.8229 35.8266 37.2812 36.1674 37.6649ZM67.7406 52.7246C67.9962 53.0017 68.2305 53.2895 68.4435 53.5879L73.3648 49.1115C73.9613 48.5573 74.4194 47.9178 74.739 47.1931C75.0586 46.4684 75.2183 45.701 75.2183 44.891V26.1543C75.2183 25.6852 75.1437 25.3549 74.9946 25.163C74.8455 24.9711 74.5792 24.8539 74.1957 24.8113C73.4713 24.726 72.7896 24.8645 72.1505 25.227C71.5114 25.5893 71.0639 26.1329 70.8083 26.8576L68.6992 32.9327L53.9353 17.3293C53.5944 16.9457 53.1576 16.7432 52.625 16.7219C52.0924 16.7005 51.6345 16.8604 51.251 17.2015C50.8675 17.5852 50.6651 18.0435 50.6438 18.5764C50.6225 19.1093 50.7823 19.5675 51.1232 19.9513L61.2853 30.5667L58.4731 33.2525L45.7545 19.8234C45.4136 19.4397 44.9661 19.2372 44.4122 19.2159C43.8584 19.1946 43.3896 19.3544 43.0062 19.6954C42.6227 20.0792 42.431 20.5268 42.431 21.0384C42.431 21.55 42.6014 21.9976 42.9423 22.3812L55.6609 35.8743L54.3188 37.2173L52.9766 38.5601L66.9096 51.8613C67.2079 52.1598 67.4849 52.4475 67.7406 52.7246Z",fill:"white"})}),(0,ct.jsx)("h1",{className:or["slingo-header"],children:"Slingo"})]}),(0,ct.jsxs)("div",{className:or["slingo-slogan"],children:[(0,ct.jsxs)("div",{className:or["quote-part-1"],children:[(0,ct.jsx)("p",{children:'"Sign language is the noblest gift '}),(0,ct.jsx)("p",{children:'God has given to deaf people."'})]}),(0,ct.jsx)("p",{className:or["quote-author"],children:"- George William Veditz"})]})]}),(0,ct.jsxs)("div",{className:or["sub-container-2"],children:[(0,ct.jsx)("h1",{className:or["login-header"],children:"Login"}),(0,ct.jsxs)("form",{className:or["login-form"],onSubmit:function(e){return s.apply(this,arguments)},children:[(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:or["login-form-label"],htmlFor:"email",children:"Email"}),(0,ct.jsx)("input",{type:"text",id:"email",value:t.email,onChange:function(e){return o({email:e.target.value})},placeholder:"Enter your email"})]}),(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:or["login-form-label"],htmlFor:"password",children:"Password"}),(0,ct.jsx)("input",{type:"password",id:"password",value:t.password,onChange:function(e){return o({password:e.target.value})},placeholder:"Enter your password"}),(0,ct.jsx)("a",{className:or["forgot-password"],href:"/forgot-password",children:"Forgot password?"})]}),a&&(0,ct.jsx)("div",{children:a}),(0,ct.jsx)("button",{className:or["login-button"],type:"submit",children:"Login"}),(0,ct.jsx)("div",{className:or["link-to-signup"],children:(0,ct.jsxs)("p",{children:["Not a user? ",(0,ct.jsx)("a",{href:"/signup",children:"Sign up"})]})}),(0,ct.jsxs)("svg",{width:"690",height:"14",viewBox:"0 0 690 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:or["or-separator"],children:[(0,ct.jsx)("path",{d:"M0 5.5H284",stroke:"#868686","stroke-width":"3"}),(0,ct.jsx)("path",{d:"M406 5.5H690",stroke:"#868686","stroke-width":"3"}),(0,ct.jsx)("path",{d:"M333.914 6.80078V6.53125C333.914 5.61719 334.047 4.76953 334.312 3.98828C334.578 3.19922 334.961 2.51562 335.461 1.9375C335.969 1.35156 336.586 0.898438 337.312 0.578125C338.047 0.25 338.875 0.0859375 339.797 0.0859375C340.727 0.0859375 341.555 0.25 342.281 0.578125C343.016 0.898438 343.637 1.35156 344.145 1.9375C344.652 2.51562 345.039 3.19922 345.305 3.98828C345.57 4.76953 345.703 5.61719 345.703 6.53125V6.80078C345.703 7.71484 345.57 8.5625 345.305 9.34375C345.039 10.125 344.652 10.8086 344.145 11.3945C343.637 11.9727 343.02 12.4258 342.293 12.7539C341.566 13.0742 340.742 13.2344 339.82 13.2344C338.891 13.2344 338.059 13.0742 337.324 12.7539C336.598 12.4258 335.98 11.9727 335.473 11.3945C334.965 10.8086 334.578 10.125 334.312 9.34375C334.047 8.5625 333.914 7.71484 333.914 6.80078ZM336.738 6.53125V6.80078C336.738 7.37109 336.797 7.91016 336.914 8.41797C337.031 8.92578 337.215 9.37109 337.465 9.75391C337.715 10.1367 338.035 10.4375 338.426 10.6562C338.816 10.875 339.281 10.9844 339.82 10.9844C340.344 10.9844 340.797 10.875 341.18 10.6562C341.57 10.4375 341.891 10.1367 342.141 9.75391C342.391 9.37109 342.574 8.92578 342.691 8.41797C342.816 7.91016 342.879 7.37109 342.879 6.80078V6.53125C342.879 5.96875 342.816 5.4375 342.691 4.9375C342.574 4.42969 342.387 3.98047 342.129 3.58984C341.879 3.19922 341.559 2.89453 341.168 2.67578C340.785 2.44922 340.328 2.33594 339.797 2.33594C339.266 2.33594 338.805 2.44922 338.414 2.67578C338.031 2.89453 337.715 3.19922 337.465 3.58984C337.215 3.98047 337.031 4.42969 336.914 4.9375C336.797 5.4375 336.738 5.96875 336.738 6.53125ZM350.906 2.73438V13H348.082V0.320312H350.777L350.906 2.73438ZM354.785 0.238281L354.762 2.86328C354.59 2.83203 354.402 2.80859 354.199 2.79297C354.004 2.77734 353.809 2.76953 353.613 2.76953C353.129 2.76953 352.703 2.83984 352.336 2.98047C351.969 3.11328 351.66 3.30859 351.41 3.56641C351.168 3.81641 350.98 4.12109 350.848 4.48047C350.715 4.83984 350.637 5.24219 350.613 5.6875L349.969 5.73438C349.969 4.9375 350.047 4.19922 350.203 3.51953C350.359 2.83984 350.594 2.24219 350.906 1.72656C351.227 1.21094 351.625 0.808594 352.102 0.519531C352.586 0.230469 353.145 0.0859375 353.777 0.0859375C353.949 0.0859375 354.133 0.101562 354.328 0.132812C354.531 0.164062 354.684 0.199219 354.785 0.238281Z",fill:"#868686"})]}),(0,ct.jsx)("a",{href:"/auth/google",className:or["continue-with-google-button"],children:(0,ct.jsxs)("svg",{width:"406",height:"80",viewBox:"0 0 406 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:or["continue-with-google-logo"],children:[(0,ct.jsx)("path",{d:"M406 0H0V80H406V0Z",fill:"white"}),(0,ct.jsx)("path",{d:"M128.225 51.288C126.961 51.288 125.793 51.064 124.721 50.616C123.665 50.152 122.737 49.504 121.937 48.672C121.153 47.84 120.545 46.864 120.113 45.744C119.681 44.624 119.465 43.4 119.465 42.072C119.465 40.728 119.681 39.496 120.113 38.376C120.545 37.256 121.153 36.28 121.937 35.448C122.721 34.616 123.649 33.976 124.721 33.528C125.793 33.064 126.961 32.832 128.225 32.832C129.457 32.832 130.561 33.048 131.537 33.48C132.529 33.912 133.361 34.472 134.033 35.16C134.721 35.848 135.209 36.584 135.497 37.368L133.337 38.352C132.921 37.36 132.273 36.56 131.393 35.952C130.513 35.328 129.457 35.016 128.225 35.016C126.977 35.016 125.865 35.312 124.889 35.904C123.929 36.496 123.177 37.32 122.633 38.376C122.089 39.432 121.817 40.664 121.817 42.072C121.817 43.464 122.089 44.688 122.633 45.744C123.177 46.8 123.929 47.624 124.889 48.216C125.865 48.808 126.977 49.104 128.225 49.104C129.457 49.104 130.513 48.8 131.393 48.192C132.273 47.568 132.921 46.76 133.337 45.768L135.497 46.752C135.209 47.536 134.721 48.272 134.033 48.96C133.361 49.648 132.529 50.208 131.537 50.64C130.561 51.072 129.457 51.288 128.225 51.288ZM144.342 51.288C143.094 51.288 141.966 51 140.958 50.424C139.95 49.832 139.15 49.024 138.558 48C137.966 46.976 137.67 45.816 137.67 44.52C137.67 43.224 137.958 42.072 138.534 41.064C139.126 40.056 139.926 39.256 140.934 38.664C141.942 38.072 143.078 37.776 144.342 37.776C145.59 37.776 146.718 38.072 147.726 38.664C148.734 39.24 149.526 40.032 150.102 41.04C150.694 42.048 150.99 43.208 150.99 44.52C150.99 45.832 150.686 47 150.078 48.024C149.47 49.032 148.662 49.832 147.654 50.424C146.662 51 145.558 51.288 144.342 51.288ZM144.342 49.128C145.142 49.128 145.862 48.928 146.502 48.528C147.158 48.128 147.67 47.576 148.038 46.872C148.422 46.168 148.614 45.384 148.614 44.52C148.614 43.64 148.422 42.864 148.038 42.192C147.67 41.504 147.158 40.96 146.502 40.56C145.862 40.144 145.142 39.936 144.342 39.936C143.526 39.936 142.79 40.144 142.134 40.56C141.494 40.96 140.982 41.504 140.598 42.192C140.214 42.864 140.022 43.64 140.022 44.52C140.022 45.384 140.214 46.168 140.598 46.872C140.982 47.576 141.494 48.128 142.134 48.528C142.79 48.928 143.526 49.128 144.342 49.128ZM153.901 51V38.064H156.085V40.584L155.725 40.368C156.045 39.552 156.557 38.92 157.261 38.472C157.981 38.008 158.821 37.776 159.781 37.776C160.709 37.776 161.533 37.984 162.253 38.4C162.989 38.816 163.565 39.392 163.981 40.128C164.413 40.864 164.629 41.696 164.629 42.624V51H162.373V43.344C162.373 42.624 162.245 42.016 161.989 41.52C161.733 41.024 161.365 40.64 160.885 40.368C160.421 40.08 159.885 39.936 159.277 39.936C158.669 39.936 158.125 40.08 157.645 40.368C157.181 40.64 156.813 41.032 156.541 41.544C156.269 42.04 156.133 42.64 156.133 43.344V51H153.901ZM173.079 51.144C171.815 51.144 170.839 50.784 170.151 50.064C169.479 49.344 169.143 48.328 169.143 47.016V40.2H166.791V38.064H167.271C167.847 38.064 168.303 37.888 168.639 37.536C168.975 37.184 169.143 36.72 169.143 36.144V35.088H171.375V38.064H174.279V40.2H171.375V46.944C171.375 47.376 171.439 47.752 171.567 48.072C171.711 48.392 171.943 48.648 172.263 48.84C172.583 49.016 173.007 49.104 173.535 49.104C173.647 49.104 173.783 49.096 173.943 49.08C174.119 49.064 174.279 49.048 174.423 49.032V51C174.215 51.048 173.983 51.08 173.727 51.096C173.471 51.128 173.255 51.144 173.079 51.144ZM177.338 51V38.064H179.57V51H177.338ZM177.338 36V33.12H179.57V36H177.338ZM183.034 51V38.064H185.218V40.584L184.858 40.368C185.178 39.552 185.69 38.92 186.394 38.472C187.114 38.008 187.954 37.776 188.914 37.776C189.842 37.776 190.666 37.984 191.386 38.4C192.122 38.816 192.698 39.392 193.114 40.128C193.546 40.864 193.762 41.696 193.762 42.624V51H191.506V43.344C191.506 42.624 191.378 42.016 191.122 41.52C190.866 41.024 190.498 40.64 190.018 40.368C189.554 40.08 189.018 39.936 188.41 39.936C187.802 39.936 187.258 40.08 186.778 40.368C186.314 40.64 185.946 41.032 185.674 41.544C185.402 42.04 185.266 42.64 185.266 43.344V51H183.034ZM201.54 51.288C200.612 51.288 199.772 51.072 199.02 50.64C198.284 50.208 197.708 49.608 197.292 48.84C196.892 48.056 196.692 47.16 196.692 46.152V38.064H198.924V45.912C198.924 46.552 199.052 47.112 199.308 47.592C199.58 48.072 199.948 48.448 200.412 48.72C200.892 48.992 201.436 49.128 202.044 49.128C202.652 49.128 203.188 48.992 203.652 48.72C204.132 48.448 204.5 48.056 204.756 47.544C205.028 47.032 205.164 46.424 205.164 45.72V38.064H207.42V51H205.236V48.48L205.596 48.696C205.292 49.512 204.772 50.152 204.036 50.616C203.316 51.064 202.484 51.288 201.54 51.288ZM216.829 51.288C215.581 51.288 214.469 50.992 213.493 50.4C212.517 49.808 211.749 49 211.189 47.976C210.629 46.936 210.349 45.776 210.349 44.496C210.349 43.2 210.621 42.048 211.165 41.04C211.725 40.032 212.477 39.24 213.421 38.664C214.381 38.072 215.453 37.776 216.637 37.776C217.597 37.776 218.445 37.952 219.181 38.304C219.933 38.64 220.565 39.104 221.077 39.696C221.605 40.272 222.005 40.936 222.277 41.688C222.565 42.424 222.709 43.192 222.709 43.992C222.709 44.168 222.693 44.368 222.661 44.592C222.645 44.8 222.621 45 222.589 45.192H211.981V43.272H221.293L220.237 44.136C220.381 43.304 220.301 42.56 219.997 41.904C219.693 41.248 219.245 40.728 218.653 40.344C218.061 39.96 217.389 39.768 216.637 39.768C215.885 39.768 215.197 39.96 214.573 40.344C213.949 40.728 213.461 41.28 213.109 42C212.773 42.704 212.637 43.544 212.701 44.52C212.637 45.464 212.781 46.296 213.133 47.016C213.501 47.72 214.013 48.272 214.669 48.672C215.341 49.056 216.069 49.248 216.853 49.248C217.717 49.248 218.445 49.048 219.037 48.648C219.629 48.248 220.109 47.736 220.477 47.112L222.349 48.072C222.093 48.664 221.693 49.208 221.149 49.704C220.621 50.184 219.989 50.568 219.253 50.856C218.533 51.144 217.725 51.288 216.829 51.288ZM232.744 51L228.304 38.064H230.776L234.304 48.888L233.44 48.864L236.896 38.064H239.008L242.464 48.864L241.6 48.888L245.152 38.064H247.6L243.16 51H241.024L237.616 40.2H238.288L234.88 51H232.744ZM249.596 51V38.064H251.828V51H249.596ZM249.596 36V33.12H251.828V36H249.596ZM260.548 51.144C259.284 51.144 258.308 50.784 257.62 50.064C256.948 49.344 256.612 48.328 256.612 47.016V40.2H254.26V38.064H254.74C255.316 38.064 255.772 37.888 256.108 37.536C256.444 37.184 256.612 36.72 256.612 36.144V35.088H258.844V38.064H261.748V40.2H258.844V46.944C258.844 47.376 258.908 47.752 259.036 48.072C259.18 48.392 259.412 48.648 259.731 48.84C260.052 49.016 260.476 49.104 261.004 49.104C261.116 49.104 261.252 49.096 261.412 49.08C261.588 49.064 261.748 49.048 261.892 49.032V51C261.684 51.048 261.452 51.08 261.196 51.096C260.94 51.128 260.724 51.144 260.548 51.144ZM264.807 51V32.832H267.039V40.584L266.631 40.368C266.951 39.552 267.463 38.92 268.167 38.472C268.887 38.008 269.727 37.776 270.687 37.776C271.615 37.776 272.439 37.984 273.159 38.4C273.895 38.816 274.471 39.392 274.887 40.128C275.319 40.864 275.535 41.696 275.535 42.624V51H273.279V43.344C273.279 42.624 273.143 42.016 272.871 41.52C272.615 41.024 272.255 40.64 271.791 40.368C271.327 40.08 270.791 39.936 270.183 39.936C269.591 39.936 269.055 40.08 268.575 40.368C268.095 40.64 267.719 41.032 267.447 41.544C267.175 42.04 267.039 42.64 267.039 43.344V51H264.807ZM291.397 51.288C290.133 51.288 288.965 51.064 287.893 50.616C286.821 50.152 285.893 49.504 285.109 48.672C284.325 47.84 283.709 46.864 283.261 45.744C282.829 44.624 282.613 43.4 282.613 42.072C282.613 40.728 282.829 39.496 283.261 38.376C283.693 37.256 284.301 36.28 285.085 35.448C285.869 34.616 286.797 33.976 287.869 33.528C288.941 33.064 290.109 32.832 291.373 32.832C292.605 32.832 293.709 33.048 294.685 33.48C295.677 33.912 296.509 34.472 297.181 35.16C297.869 35.848 298.357 36.584 298.645 37.368L296.533 38.4C296.117 37.36 295.469 36.536 294.589 35.928C293.709 35.32 292.637 35.016 291.373 35.016C290.125 35.016 289.013 35.312 288.037 35.904C287.077 36.496 286.325 37.32 285.781 38.376C285.237 39.432 284.965 40.664 284.965 42.072C284.965 43.464 285.237 44.688 285.781 45.744C286.341 46.8 287.101 47.624 288.061 48.216C289.037 48.808 290.149 49.104 291.397 49.104C292.485 49.104 293.469 48.872 294.349 48.408C295.229 47.944 295.925 47.304 296.437 46.488C296.949 45.672 297.205 44.728 297.205 43.656V42.552L298.285 43.56H291.373V41.52H299.581V43.104C299.581 44.352 299.365 45.48 298.933 46.488C298.501 47.496 297.909 48.36 297.157 49.08C296.405 49.784 295.533 50.328 294.541 50.712C293.549 51.096 292.501 51.288 291.397 51.288ZM308.639 51.288C307.391 51.288 306.263 51 305.255 50.424C304.247 49.832 303.447 49.024 302.855 48C302.263 46.976 301.967 45.816 301.967 44.52C301.967 43.224 302.255 42.072 302.831 41.064C303.423 40.056 304.223 39.256 305.231 38.664C306.239 38.072 307.375 37.776 308.639 37.776C309.887 37.776 311.015 38.072 312.023 38.664C313.031 39.24 313.823 40.032 314.399 41.04C314.991 42.048 315.287 43.208 315.287 44.52C315.287 45.832 314.983 47 314.375 48.024C313.767 49.032 312.959 49.832 311.951 50.424C310.959 51 309.855 51.288 308.639 51.288ZM308.639 49.128C309.439 49.128 310.159 48.928 310.799 48.528C311.455 48.128 311.967 47.576 312.335 46.872C312.719 46.168 312.911 45.384 312.911 44.52C312.911 43.64 312.719 42.864 312.335 42.192C311.967 41.504 311.455 40.96 310.799 40.56C310.159 40.144 309.439 39.936 308.639 39.936C307.823 39.936 307.087 40.144 306.431 40.56C305.791 40.96 305.279 41.504 304.895 42.192C304.511 42.864 304.319 43.64 304.319 44.52C304.319 45.384 304.511 46.168 304.895 46.872C305.279 47.576 305.791 48.128 306.431 48.528C307.087 48.928 307.823 49.128 308.639 49.128ZM324.342 51.288C323.094 51.288 321.966 51 320.958 50.424C319.95 49.832 319.15 49.024 318.558 48C317.966 46.976 317.67 45.816 317.67 44.52C317.67 43.224 317.958 42.072 318.534 41.064C319.126 40.056 319.926 39.256 320.934 38.664C321.942 38.072 323.078 37.776 324.342 37.776C325.59 37.776 326.718 38.072 327.726 38.664C328.734 39.24 329.526 40.032 330.102 41.04C330.694 42.048 330.99 43.208 330.99 44.52C330.99 45.832 330.686 47 330.078 48.024C329.47 49.032 328.662 49.832 327.654 50.424C326.662 51 325.558 51.288 324.342 51.288ZM324.342 49.128C325.142 49.128 325.862 48.928 326.502 48.528C327.158 48.128 327.67 47.576 328.038 46.872C328.422 46.168 328.614 45.384 328.614 44.52C328.614 43.64 328.422 42.864 328.038 42.192C327.67 41.504 327.158 40.96 326.502 40.56C325.862 40.144 325.142 39.936 324.342 39.936C323.526 39.936 322.79 40.144 322.134 40.56C321.494 40.96 320.982 41.504 320.598 42.192C320.214 42.864 320.022 43.64 320.022 44.52C320.022 45.384 320.214 46.168 320.598 46.872C320.982 47.576 321.494 48.128 322.134 48.528C322.79 48.928 323.526 49.128 324.342 49.128ZM340.069 56.28C339.157 56.28 338.309 56.136 337.525 55.848C336.757 55.56 336.093 55.16 335.533 54.648C334.989 54.152 334.573 53.568 334.285 52.896L336.373 51.936C336.597 52.544 337.021 53.056 337.645 53.472C338.285 53.904 339.085 54.12 340.045 54.12C340.781 54.12 341.445 53.976 342.037 53.688C342.645 53.416 343.125 53 343.477 52.44C343.829 51.896 344.005 51.232 344.005 50.448V47.544L344.413 47.976C343.965 48.856 343.317 49.528 342.469 49.992C341.637 50.456 340.717 50.688 339.709 50.688C338.493 50.688 337.405 50.408 336.445 49.848C335.485 49.272 334.733 48.496 334.189 47.52C333.645 46.528 333.373 45.432 333.373 44.232C333.373 43.016 333.645 41.92 334.189 40.944C334.733 39.968 335.477 39.2 336.421 38.64C337.381 38.064 338.469 37.776 339.685 37.776C340.693 37.776 341.605 38.008 342.421 38.472C343.253 38.92 343.917 39.544 344.413 40.344L344.077 40.944V38.064H346.261V50.448C346.261 51.568 345.997 52.568 345.469 53.448C344.941 54.328 344.205 55.016 343.261 55.512C342.333 56.024 341.269 56.28 340.069 56.28ZM339.901 48.528C340.669 48.528 341.357 48.336 341.965 47.952C342.589 47.568 343.085 47.056 343.453 46.416C343.821 45.76 344.005 45.032 344.005 44.232C344.005 43.448 343.821 42.728 343.453 42.072C343.085 41.416 342.589 40.896 341.965 40.512C341.357 40.128 340.669 39.936 339.901 39.936C339.117 39.936 338.405 40.128 337.765 40.512C337.125 40.896 336.621 41.416 336.253 42.072C335.901 42.712 335.725 43.432 335.725 44.232C335.725 45.032 335.901 45.76 336.253 46.416C336.621 47.056 337.117 47.568 337.741 47.952C338.381 48.336 339.101 48.528 339.901 48.528ZM349.721 51V32.832H351.953V51H349.721ZM361.369 51.288C360.121 51.288 359.009 50.992 358.033 50.4C357.057 49.808 356.289 49 355.729 47.976C355.169 46.936 354.889 45.776 354.889 44.496C354.889 43.2 355.161 42.048 355.705 41.04C356.265 40.032 357.017 39.24 357.961 38.664C358.921 38.072 359.993 37.776 361.177 37.776C362.137 37.776 362.985 37.952 363.721 38.304C364.473 38.64 365.105 39.104 365.617 39.696C366.145 40.272 366.545 40.936 366.817 41.688C367.105 42.424 367.248 43.192 367.248 43.992C367.248 44.168 367.233 44.368 367.201 44.592C367.185 44.8 367.161 45 367.129 45.192H356.521V43.272H365.833L364.777 44.136C364.921 43.304 364.841 42.56 364.537 41.904C364.233 41.248 363.785 40.728 363.193 40.344C362.601 39.96 361.929 39.768 361.177 39.768C360.425 39.768 359.737 39.96 359.113 40.344C358.489 40.728 358.001 41.28 357.649 42C357.313 42.704 357.177 43.544 357.241 44.52C357.177 45.464 357.321 46.296 357.673 47.016C358.041 47.72 358.553 48.272 359.209 48.672C359.881 49.056 360.609 49.248 361.393 49.248C362.257 49.248 362.985 49.048 363.577 48.648C364.169 48.248 364.649 47.736 365.017 47.112L366.889 48.072C366.633 48.664 366.233 49.208 365.689 49.704C365.161 50.184 364.529 50.568 363.793 50.856C363.073 51.144 362.265 51.288 361.369 51.288Z",fill:"#616161"}),(0,ct.jsx)("path",{d:"M391 2H15C7.8203 2 2 7.8203 2 15V65C2 72.1797 7.8203 78 15 78H391C398.18 78 404 72.1797 404 65V15C404 7.8203 398.18 2 391 2Z",stroke:"#616161","stroke-width":"4"}),(0,ct.jsx)("path",{d:"M60.7371 32.0915C62.0955 29.3579 64.1794 27.0598 66.7558 25.4543C69.3322 23.8488 72.2997 22.999 75.3265 23C79.7265 23 83.4229 24.6335 86.249 27.2983L81.5682 32.0305C79.8751 30.3953 77.7233 29.5621 75.3265 29.5621C71.0735 29.5621 67.4735 32.4661 66.1918 36.365C65.8653 37.355 65.6792 38.411 65.6792 39.5C65.6792 40.589 65.8653 41.645 66.1918 42.635C67.4751 46.5356 71.0735 49.4379 75.3265 49.4379C77.5224 49.4379 79.3918 48.8522 80.8547 47.8622C81.7028 47.2979 82.4288 46.5657 82.9889 45.7098C83.549 44.8539 83.9316 43.8921 84.1135 42.8825H75.3265V36.5003H90.7029C90.8955 37.5794 91 38.7047 91 39.8746C91 44.9005 89.2204 49.131 86.1314 52.002C83.431 54.5232 79.7347 56 75.3265 56C73.1823 56.0009 71.0588 55.5747 69.0776 54.7458C67.0964 53.9169 65.2962 52.7015 63.78 51.1692C62.2638 49.6369 61.0612 47.8176 60.241 45.8153C59.4209 43.813 58.9991 41.6671 59 39.5C59 36.8369 59.6302 34.319 60.7371 32.0915Z",fill:"#616161"})]})})]})]})]})}var ur={"signup-header":"signup_signup-header__C6b26",container:"signup_container__m9340","container-1":"signup_container-1__Ic7TC","sub-container-1":"signup_sub-container-1__x7Y+u","slingo-header":"signup_slingo-header__mTaS+","slingo-welcome":"signup_slingo-welcome__OoYjS","quote-part-1":"signup_quote-part-1__rHsKK","slingo-logo":"signup_slingo-logo__GEDPh","sub-container-2":"signup_sub-container-2__A-0kw","signup-form":"signup_signup-form__E5-Yn","create-account-button":"signup_create-account-button__QSuKh","link-to-login":"signup_link-to-login__OPW6R","or-separator":"signup_or-separator__075cQ","continue-with-google-button":"signup_continue-with-google-button__5Y3Ww"};function cr(){var e=H((0,S.useState)({name:"",email:"",password:""}),2),t=e[0],n=e[1],r=H((0,S.useState)(""),2),a=r[0],i=r[1],o=H((0,S.useState)(""),2),s=o[0],u=o[1];function c(e){return n((function(t){return bt(bt({},t),e)}))}function l(){return(l=mt(ft().mark((function e(n){var r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"http://localhost:8080/api/users",e.next=5,ir.post("http://localhost:8080/api/users",t);case 5:r=e.sent,a=r.data,u(a.message),i(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response&&e.t0.response.status>=400&&e.t0.response.status<=500&&(i(e.t0.response.data.message),u(""));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}return(0,ct.jsxs)("div",{className:ur.container,children:[(0,ct.jsxs)("div",{className:ur["container-1"],children:[(0,ct.jsxs)("div",{className:ur["sub-container-1"],children:[(0,ct.jsx)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ur["slingo-logo"],children:(0,ct.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M99.7398 50C99.7398 77.2829 77.5487 99.4 50.1746 99.4C22.8005 99.4 0.609375 77.2829 0.609375 50C0.609375 22.7171 22.8005 0.600006 50.1746 0.600006C77.5487 0.600006 99.7398 22.7171 99.7398 50ZM31.0544 77.5045C31.4378 77.8881 31.8853 78.08 32.3966 78.08H60.5183C62.1375 78.08 63.5009 77.5152 64.6088 76.3854C65.7166 75.2557 66.2705 73.9021 66.2705 72.3246V58.9595C66.2705 58.1922 66.1214 57.4461 65.8232 56.7213C65.5248 55.9966 65.0775 55.3571 64.4809 54.8029L50.9314 41.8214C50.5905 41.5231 50.2816 41.3738 50.0047 41.3738C49.7277 41.3738 49.44 41.5017 49.1418 41.7575C48.5879 42.2265 48.247 42.8127 48.1192 43.5161C47.9914 44.2196 48.0979 44.9123 48.4387 45.5945L51.3148 51.2218H29.8401C29.3288 51.2218 28.8813 51.4031 28.4978 51.7654C28.1144 52.1277 27.9227 52.5861 27.9227 53.1403C27.9227 53.6518 28.1144 54.0995 28.4978 54.4832C28.8813 54.8669 29.3288 55.0587 29.8401 55.0587H44.5401V58.8956H26.0053C25.494 58.8956 25.0465 59.0768 24.6631 59.4391C24.2796 59.8015 24.0879 60.2598 24.0879 60.814C24.0879 61.3256 24.2796 61.7732 24.6631 62.157C25.0465 62.5406 25.494 62.7325 26.0053 62.7325H44.5401V66.5694H28.5618C28.0505 66.5694 27.6031 66.7505 27.2196 67.1129C26.8361 67.4753 26.6444 67.9335 26.6444 68.4878C26.6444 68.9993 26.8361 69.4471 27.2196 69.8307C27.6031 70.2144 28.0505 70.4062 28.5618 70.4062H44.5401V74.2431H32.3966C31.8853 74.2431 31.4378 74.4243 31.0544 74.7866C30.6709 75.1491 30.4792 75.6073 30.4792 76.1615C30.4792 76.6732 30.6709 77.1208 31.0544 77.5045ZM39.1075 29.6074L47.3522 38.3044C48.247 37.7928 49.0886 37.5369 49.8768 37.5369C50.6651 37.5369 51.5279 37.7501 52.4653 38.1764L41.9197 26.9855C41.5788 26.6019 41.142 26.3994 40.6094 26.3781C40.0768 26.3567 39.6188 26.5166 39.2353 26.8576C38.8519 27.2414 38.6494 27.6996 38.6281 28.2325C38.6068 28.7654 38.7666 29.2237 39.1075 29.6074ZM36.1674 37.6649L44.6679 46.5536C44.5401 46.0421 44.4442 45.5411 44.3803 45.0508C44.3163 44.5606 44.2844 44.0596 44.2844 43.548C44.2844 43.207 44.3376 42.834 44.4442 42.429C44.5507 42.0239 44.7105 41.6083 44.9235 41.1819L38.9796 35.043C38.6388 34.6593 38.202 34.4568 37.6694 34.4355C37.1368 34.4141 36.6788 34.574 36.2953 34.9151C35.9119 35.2988 35.7094 35.7571 35.6881 36.29C35.6668 36.8229 35.8266 37.2812 36.1674 37.6649ZM67.7406 52.7246C67.9962 53.0017 68.2305 53.2895 68.4435 53.5879L73.3648 49.1115C73.9613 48.5573 74.4194 47.9178 74.739 47.1931C75.0586 46.4684 75.2183 45.701 75.2183 44.891V26.1543C75.2183 25.6852 75.1437 25.3549 74.9946 25.163C74.8455 24.9711 74.5792 24.8539 74.1957 24.8113C73.4713 24.726 72.7896 24.8645 72.1505 25.227C71.5114 25.5893 71.0639 26.1329 70.8083 26.8576L68.6992 32.9327L53.9353 17.3293C53.5944 16.9457 53.1576 16.7432 52.625 16.7219C52.0924 16.7005 51.6345 16.8604 51.251 17.2015C50.8675 17.5852 50.6651 18.0435 50.6438 18.5764C50.6225 19.1093 50.7823 19.5675 51.1232 19.9513L61.2853 30.5667L58.4731 33.2525L45.7545 19.8234C45.4136 19.4397 44.9661 19.2372 44.4122 19.2159C43.8584 19.1946 43.3896 19.3544 43.0062 19.6954C42.6227 20.0792 42.431 20.5268 42.431 21.0384C42.431 21.55 42.6014 21.9976 42.9423 22.3812L55.6609 35.8743L54.3188 37.2173L52.9766 38.5601L66.9096 51.8613C67.2079 52.1598 67.4849 52.4475 67.7406 52.7246Z",fill:"white"})}),(0,ct.jsx)("h1",{className:ur["slingo-header"],children:"Slingo"})]}),(0,ct.jsx)("div",{className:ur["slingo-welcome"],children:(0,ct.jsxs)("div",{className:ur["quote-part-1"],children:[(0,ct.jsx)("p",{children:"Communication knows no bounds,"}),(0,ct.jsx)("p",{children:"sign language opens up new pathways"}),(0,ct.jsx)("p",{children:"to connect with others"})]})})]}),(0,ct.jsxs)("div",{className:ur["sub-container-2"],children:[(0,ct.jsx)("h1",{className:ur["signup-header"],children:"Signup"}),(0,ct.jsxs)("form",{className:ur["signup-form"],onSubmit:function(e){return l.apply(this,arguments)},children:[(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:ur["signup-form-label"],htmlFor:"name",children:"Name"}),(0,ct.jsx)("input",{type:"text",id:"name",value:t.name,required:!0,onChange:function(e){return c({name:e.target.value})},placeholder:"Enter your name"})]}),(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:ur["signup-form-label"],htmlFor:"email",children:"Email"}),(0,ct.jsx)("input",{type:"text",id:"email",value:t.email,required:!0,onChange:function(e){return c({email:e.target.value})},placeholder:"Enter your email"})]}),(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:ur["signup-form-label"],htmlFor:"password",children:"Password"}),(0,ct.jsx)("input",{type:"password",id:"password",value:t.password,required:!0,onChange:function(e){return c({password:e.target.value})},placeholder:"Enter a password"})]}),a&&(0,ct.jsx)("div",{children:a}),s&&(0,ct.jsx)("div",{children:s}),(0,ct.jsx)("button",{className:ur["create-account-button"],type:"submit",children:"Create Account"}),(0,ct.jsx)("div",{className:ur["link-to-login"],children:(0,ct.jsxs)("p",{children:["Already a user? ",(0,ct.jsx)("a",{href:"/login",children:"Login"})]})}),(0,ct.jsxs)("svg",{width:"690",height:"14",viewBox:"0 0 690 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ur["or-separator"],children:[(0,ct.jsx)("path",{d:"M0 5.5H284",stroke:"#868686","stroke-width":"3"}),(0,ct.jsx)("path",{d:"M406 5.5H690",stroke:"#868686","stroke-width":"3"}),(0,ct.jsx)("path",{d:"M333.914 6.80078V6.53125C333.914 5.61719 334.047 4.76953 334.312 3.98828C334.578 3.19922 334.961 2.51562 335.461 1.9375C335.969 1.35156 336.586 0.898438 337.312 0.578125C338.047 0.25 338.875 0.0859375 339.797 0.0859375C340.727 0.0859375 341.555 0.25 342.281 0.578125C343.016 0.898438 343.637 1.35156 344.145 1.9375C344.652 2.51562 345.039 3.19922 345.305 3.98828C345.57 4.76953 345.703 5.61719 345.703 6.53125V6.80078C345.703 7.71484 345.57 8.5625 345.305 9.34375C345.039 10.125 344.652 10.8086 344.145 11.3945C343.637 11.9727 343.02 12.4258 342.293 12.7539C341.566 13.0742 340.742 13.2344 339.82 13.2344C338.891 13.2344 338.059 13.0742 337.324 12.7539C336.598 12.4258 335.98 11.9727 335.473 11.3945C334.965 10.8086 334.578 10.125 334.312 9.34375C334.047 8.5625 333.914 7.71484 333.914 6.80078ZM336.738 6.53125V6.80078C336.738 7.37109 336.797 7.91016 336.914 8.41797C337.031 8.92578 337.215 9.37109 337.465 9.75391C337.715 10.1367 338.035 10.4375 338.426 10.6562C338.816 10.875 339.281 10.9844 339.82 10.9844C340.344 10.9844 340.797 10.875 341.18 10.6562C341.57 10.4375 341.891 10.1367 342.141 9.75391C342.391 9.37109 342.574 8.92578 342.691 8.41797C342.816 7.91016 342.879 7.37109 342.879 6.80078V6.53125C342.879 5.96875 342.816 5.4375 342.691 4.9375C342.574 4.42969 342.387 3.98047 342.129 3.58984C341.879 3.19922 341.559 2.89453 341.168 2.67578C340.785 2.44922 340.328 2.33594 339.797 2.33594C339.266 2.33594 338.805 2.44922 338.414 2.67578C338.031 2.89453 337.715 3.19922 337.465 3.58984C337.215 3.98047 337.031 4.42969 336.914 4.9375C336.797 5.4375 336.738 5.96875 336.738 6.53125ZM350.906 2.73438V13H348.082V0.320312H350.777L350.906 2.73438ZM354.785 0.238281L354.762 2.86328C354.59 2.83203 354.402 2.80859 354.199 2.79297C354.004 2.77734 353.809 2.76953 353.613 2.76953C353.129 2.76953 352.703 2.83984 352.336 2.98047C351.969 3.11328 351.66 3.30859 351.41 3.56641C351.168 3.81641 350.98 4.12109 350.848 4.48047C350.715 4.83984 350.637 5.24219 350.613 5.6875L349.969 5.73438C349.969 4.9375 350.047 4.19922 350.203 3.51953C350.359 2.83984 350.594 2.24219 350.906 1.72656C351.227 1.21094 351.625 0.808594 352.102 0.519531C352.586 0.230469 353.145 0.0859375 353.777 0.0859375C353.949 0.0859375 354.133 0.101562 354.328 0.132812C354.531 0.164062 354.684 0.199219 354.785 0.238281Z",fill:"#868686"})]}),(0,ct.jsx)("a",{href:"/auth/google",className:ur["continue-with-google-button"],children:(0,ct.jsxs)("svg",{width:"406",height:"80",viewBox:"0 0 406 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:ur["continue-with-google-logo"],children:[(0,ct.jsx)("path",{d:"M406 0H0V80H406V0Z",fill:"white"}),(0,ct.jsx)("path",{d:"M128.225 51.288C126.961 51.288 125.793 51.064 124.721 50.616C123.665 50.152 122.737 49.504 121.937 48.672C121.153 47.84 120.545 46.864 120.113 45.744C119.681 44.624 119.465 43.4 119.465 42.072C119.465 40.728 119.681 39.496 120.113 38.376C120.545 37.256 121.153 36.28 121.937 35.448C122.721 34.616 123.649 33.976 124.721 33.528C125.793 33.064 126.961 32.832 128.225 32.832C129.457 32.832 130.561 33.048 131.537 33.48C132.529 33.912 133.361 34.472 134.033 35.16C134.721 35.848 135.209 36.584 135.497 37.368L133.337 38.352C132.921 37.36 132.273 36.56 131.393 35.952C130.513 35.328 129.457 35.016 128.225 35.016C126.977 35.016 125.865 35.312 124.889 35.904C123.929 36.496 123.177 37.32 122.633 38.376C122.089 39.432 121.817 40.664 121.817 42.072C121.817 43.464 122.089 44.688 122.633 45.744C123.177 46.8 123.929 47.624 124.889 48.216C125.865 48.808 126.977 49.104 128.225 49.104C129.457 49.104 130.513 48.8 131.393 48.192C132.273 47.568 132.921 46.76 133.337 45.768L135.497 46.752C135.209 47.536 134.721 48.272 134.033 48.96C133.361 49.648 132.529 50.208 131.537 50.64C130.561 51.072 129.457 51.288 128.225 51.288ZM144.342 51.288C143.094 51.288 141.966 51 140.958 50.424C139.95 49.832 139.15 49.024 138.558 48C137.966 46.976 137.67 45.816 137.67 44.52C137.67 43.224 137.958 42.072 138.534 41.064C139.126 40.056 139.926 39.256 140.934 38.664C141.942 38.072 143.078 37.776 144.342 37.776C145.59 37.776 146.718 38.072 147.726 38.664C148.734 39.24 149.526 40.032 150.102 41.04C150.694 42.048 150.99 43.208 150.99 44.52C150.99 45.832 150.686 47 150.078 48.024C149.47 49.032 148.662 49.832 147.654 50.424C146.662 51 145.558 51.288 144.342 51.288ZM144.342 49.128C145.142 49.128 145.862 48.928 146.502 48.528C147.158 48.128 147.67 47.576 148.038 46.872C148.422 46.168 148.614 45.384 148.614 44.52C148.614 43.64 148.422 42.864 148.038 42.192C147.67 41.504 147.158 40.96 146.502 40.56C145.862 40.144 145.142 39.936 144.342 39.936C143.526 39.936 142.79 40.144 142.134 40.56C141.494 40.96 140.982 41.504 140.598 42.192C140.214 42.864 140.022 43.64 140.022 44.52C140.022 45.384 140.214 46.168 140.598 46.872C140.982 47.576 141.494 48.128 142.134 48.528C142.79 48.928 143.526 49.128 144.342 49.128ZM153.901 51V38.064H156.085V40.584L155.725 40.368C156.045 39.552 156.557 38.92 157.261 38.472C157.981 38.008 158.821 37.776 159.781 37.776C160.709 37.776 161.533 37.984 162.253 38.4C162.989 38.816 163.565 39.392 163.981 40.128C164.413 40.864 164.629 41.696 164.629 42.624V51H162.373V43.344C162.373 42.624 162.245 42.016 161.989 41.52C161.733 41.024 161.365 40.64 160.885 40.368C160.421 40.08 159.885 39.936 159.277 39.936C158.669 39.936 158.125 40.08 157.645 40.368C157.181 40.64 156.813 41.032 156.541 41.544C156.269 42.04 156.133 42.64 156.133 43.344V51H153.901ZM173.079 51.144C171.815 51.144 170.839 50.784 170.151 50.064C169.479 49.344 169.143 48.328 169.143 47.016V40.2H166.791V38.064H167.271C167.847 38.064 168.303 37.888 168.639 37.536C168.975 37.184 169.143 36.72 169.143 36.144V35.088H171.375V38.064H174.279V40.2H171.375V46.944C171.375 47.376 171.439 47.752 171.567 48.072C171.711 48.392 171.943 48.648 172.263 48.84C172.583 49.016 173.007 49.104 173.535 49.104C173.647 49.104 173.783 49.096 173.943 49.08C174.119 49.064 174.279 49.048 174.423 49.032V51C174.215 51.048 173.983 51.08 173.727 51.096C173.471 51.128 173.255 51.144 173.079 51.144ZM177.338 51V38.064H179.57V51H177.338ZM177.338 36V33.12H179.57V36H177.338ZM183.034 51V38.064H185.218V40.584L184.858 40.368C185.178 39.552 185.69 38.92 186.394 38.472C187.114 38.008 187.954 37.776 188.914 37.776C189.842 37.776 190.666 37.984 191.386 38.4C192.122 38.816 192.698 39.392 193.114 40.128C193.546 40.864 193.762 41.696 193.762 42.624V51H191.506V43.344C191.506 42.624 191.378 42.016 191.122 41.52C190.866 41.024 190.498 40.64 190.018 40.368C189.554 40.08 189.018 39.936 188.41 39.936C187.802 39.936 187.258 40.08 186.778 40.368C186.314 40.64 185.946 41.032 185.674 41.544C185.402 42.04 185.266 42.64 185.266 43.344V51H183.034ZM201.54 51.288C200.612 51.288 199.772 51.072 199.02 50.64C198.284 50.208 197.708 49.608 197.292 48.84C196.892 48.056 196.692 47.16 196.692 46.152V38.064H198.924V45.912C198.924 46.552 199.052 47.112 199.308 47.592C199.58 48.072 199.948 48.448 200.412 48.72C200.892 48.992 201.436 49.128 202.044 49.128C202.652 49.128 203.188 48.992 203.652 48.72C204.132 48.448 204.5 48.056 204.756 47.544C205.028 47.032 205.164 46.424 205.164 45.72V38.064H207.42V51H205.236V48.48L205.596 48.696C205.292 49.512 204.772 50.152 204.036 50.616C203.316 51.064 202.484 51.288 201.54 51.288ZM216.829 51.288C215.581 51.288 214.469 50.992 213.493 50.4C212.517 49.808 211.749 49 211.189 47.976C210.629 46.936 210.349 45.776 210.349 44.496C210.349 43.2 210.621 42.048 211.165 41.04C211.725 40.032 212.477 39.24 213.421 38.664C214.381 38.072 215.453 37.776 216.637 37.776C217.597 37.776 218.445 37.952 219.181 38.304C219.933 38.64 220.565 39.104 221.077 39.696C221.605 40.272 222.005 40.936 222.277 41.688C222.565 42.424 222.709 43.192 222.709 43.992C222.709 44.168 222.693 44.368 222.661 44.592C222.645 44.8 222.621 45 222.589 45.192H211.981V43.272H221.293L220.237 44.136C220.381 43.304 220.301 42.56 219.997 41.904C219.693 41.248 219.245 40.728 218.653 40.344C218.061 39.96 217.389 39.768 216.637 39.768C215.885 39.768 215.197 39.96 214.573 40.344C213.949 40.728 213.461 41.28 213.109 42C212.773 42.704 212.637 43.544 212.701 44.52C212.637 45.464 212.781 46.296 213.133 47.016C213.501 47.72 214.013 48.272 214.669 48.672C215.341 49.056 216.069 49.248 216.853 49.248C217.717 49.248 218.445 49.048 219.037 48.648C219.629 48.248 220.109 47.736 220.477 47.112L222.349 48.072C222.093 48.664 221.693 49.208 221.149 49.704C220.621 50.184 219.989 50.568 219.253 50.856C218.533 51.144 217.725 51.288 216.829 51.288ZM232.744 51L228.304 38.064H230.776L234.304 48.888L233.44 48.864L236.896 38.064H239.008L242.464 48.864L241.6 48.888L245.152 38.064H247.6L243.16 51H241.024L237.616 40.2H238.288L234.88 51H232.744ZM249.596 51V38.064H251.828V51H249.596ZM249.596 36V33.12H251.828V36H249.596ZM260.548 51.144C259.284 51.144 258.308 50.784 257.62 50.064C256.948 49.344 256.612 48.328 256.612 47.016V40.2H254.26V38.064H254.74C255.316 38.064 255.772 37.888 256.108 37.536C256.444 37.184 256.612 36.72 256.612 36.144V35.088H258.844V38.064H261.748V40.2H258.844V46.944C258.844 47.376 258.908 47.752 259.036 48.072C259.18 48.392 259.412 48.648 259.731 48.84C260.052 49.016 260.476 49.104 261.004 49.104C261.116 49.104 261.252 49.096 261.412 49.08C261.588 49.064 261.748 49.048 261.892 49.032V51C261.684 51.048 261.452 51.08 261.196 51.096C260.94 51.128 260.724 51.144 260.548 51.144ZM264.807 51V32.832H267.039V40.584L266.631 40.368C266.951 39.552 267.463 38.92 268.167 38.472C268.887 38.008 269.727 37.776 270.687 37.776C271.615 37.776 272.439 37.984 273.159 38.4C273.895 38.816 274.471 39.392 274.887 40.128C275.319 40.864 275.535 41.696 275.535 42.624V51H273.279V43.344C273.279 42.624 273.143 42.016 272.871 41.52C272.615 41.024 272.255 40.64 271.791 40.368C271.327 40.08 270.791 39.936 270.183 39.936C269.591 39.936 269.055 40.08 268.575 40.368C268.095 40.64 267.719 41.032 267.447 41.544C267.175 42.04 267.039 42.64 267.039 43.344V51H264.807ZM291.397 51.288C290.133 51.288 288.965 51.064 287.893 50.616C286.821 50.152 285.893 49.504 285.109 48.672C284.325 47.84 283.709 46.864 283.261 45.744C282.829 44.624 282.613 43.4 282.613 42.072C282.613 40.728 282.829 39.496 283.261 38.376C283.693 37.256 284.301 36.28 285.085 35.448C285.869 34.616 286.797 33.976 287.869 33.528C288.941 33.064 290.109 32.832 291.373 32.832C292.605 32.832 293.709 33.048 294.685 33.48C295.677 33.912 296.509 34.472 297.181 35.16C297.869 35.848 298.357 36.584 298.645 37.368L296.533 38.4C296.117 37.36 295.469 36.536 294.589 35.928C293.709 35.32 292.637 35.016 291.373 35.016C290.125 35.016 289.013 35.312 288.037 35.904C287.077 36.496 286.325 37.32 285.781 38.376C285.237 39.432 284.965 40.664 284.965 42.072C284.965 43.464 285.237 44.688 285.781 45.744C286.341 46.8 287.101 47.624 288.061 48.216C289.037 48.808 290.149 49.104 291.397 49.104C292.485 49.104 293.469 48.872 294.349 48.408C295.229 47.944 295.925 47.304 296.437 46.488C296.949 45.672 297.205 44.728 297.205 43.656V42.552L298.285 43.56H291.373V41.52H299.581V43.104C299.581 44.352 299.365 45.48 298.933 46.488C298.501 47.496 297.909 48.36 297.157 49.08C296.405 49.784 295.533 50.328 294.541 50.712C293.549 51.096 292.501 51.288 291.397 51.288ZM308.639 51.288C307.391 51.288 306.263 51 305.255 50.424C304.247 49.832 303.447 49.024 302.855 48C302.263 46.976 301.967 45.816 301.967 44.52C301.967 43.224 302.255 42.072 302.831 41.064C303.423 40.056 304.223 39.256 305.231 38.664C306.239 38.072 307.375 37.776 308.639 37.776C309.887 37.776 311.015 38.072 312.023 38.664C313.031 39.24 313.823 40.032 314.399 41.04C314.991 42.048 315.287 43.208 315.287 44.52C315.287 45.832 314.983 47 314.375 48.024C313.767 49.032 312.959 49.832 311.951 50.424C310.959 51 309.855 51.288 308.639 51.288ZM308.639 49.128C309.439 49.128 310.159 48.928 310.799 48.528C311.455 48.128 311.967 47.576 312.335 46.872C312.719 46.168 312.911 45.384 312.911 44.52C312.911 43.64 312.719 42.864 312.335 42.192C311.967 41.504 311.455 40.96 310.799 40.56C310.159 40.144 309.439 39.936 308.639 39.936C307.823 39.936 307.087 40.144 306.431 40.56C305.791 40.96 305.279 41.504 304.895 42.192C304.511 42.864 304.319 43.64 304.319 44.52C304.319 45.384 304.511 46.168 304.895 46.872C305.279 47.576 305.791 48.128 306.431 48.528C307.087 48.928 307.823 49.128 308.639 49.128ZM324.342 51.288C323.094 51.288 321.966 51 320.958 50.424C319.95 49.832 319.15 49.024 318.558 48C317.966 46.976 317.67 45.816 317.67 44.52C317.67 43.224 317.958 42.072 318.534 41.064C319.126 40.056 319.926 39.256 320.934 38.664C321.942 38.072 323.078 37.776 324.342 37.776C325.59 37.776 326.718 38.072 327.726 38.664C328.734 39.24 329.526 40.032 330.102 41.04C330.694 42.048 330.99 43.208 330.99 44.52C330.99 45.832 330.686 47 330.078 48.024C329.47 49.032 328.662 49.832 327.654 50.424C326.662 51 325.558 51.288 324.342 51.288ZM324.342 49.128C325.142 49.128 325.862 48.928 326.502 48.528C327.158 48.128 327.67 47.576 328.038 46.872C328.422 46.168 328.614 45.384 328.614 44.52C328.614 43.64 328.422 42.864 328.038 42.192C327.67 41.504 327.158 40.96 326.502 40.56C325.862 40.144 325.142 39.936 324.342 39.936C323.526 39.936 322.79 40.144 322.134 40.56C321.494 40.96 320.982 41.504 320.598 42.192C320.214 42.864 320.022 43.64 320.022 44.52C320.022 45.384 320.214 46.168 320.598 46.872C320.982 47.576 321.494 48.128 322.134 48.528C322.79 48.928 323.526 49.128 324.342 49.128ZM340.069 56.28C339.157 56.28 338.309 56.136 337.525 55.848C336.757 55.56 336.093 55.16 335.533 54.648C334.989 54.152 334.573 53.568 334.285 52.896L336.373 51.936C336.597 52.544 337.021 53.056 337.645 53.472C338.285 53.904 339.085 54.12 340.045 54.12C340.781 54.12 341.445 53.976 342.037 53.688C342.645 53.416 343.125 53 343.477 52.44C343.829 51.896 344.005 51.232 344.005 50.448V47.544L344.413 47.976C343.965 48.856 343.317 49.528 342.469 49.992C341.637 50.456 340.717 50.688 339.709 50.688C338.493 50.688 337.405 50.408 336.445 49.848C335.485 49.272 334.733 48.496 334.189 47.52C333.645 46.528 333.373 45.432 333.373 44.232C333.373 43.016 333.645 41.92 334.189 40.944C334.733 39.968 335.477 39.2 336.421 38.64C337.381 38.064 338.469 37.776 339.685 37.776C340.693 37.776 341.605 38.008 342.421 38.472C343.253 38.92 343.917 39.544 344.413 40.344L344.077 40.944V38.064H346.261V50.448C346.261 51.568 345.997 52.568 345.469 53.448C344.941 54.328 344.205 55.016 343.261 55.512C342.333 56.024 341.269 56.28 340.069 56.28ZM339.901 48.528C340.669 48.528 341.357 48.336 341.965 47.952C342.589 47.568 343.085 47.056 343.453 46.416C343.821 45.76 344.005 45.032 344.005 44.232C344.005 43.448 343.821 42.728 343.453 42.072C343.085 41.416 342.589 40.896 341.965 40.512C341.357 40.128 340.669 39.936 339.901 39.936C339.117 39.936 338.405 40.128 337.765 40.512C337.125 40.896 336.621 41.416 336.253 42.072C335.901 42.712 335.725 43.432 335.725 44.232C335.725 45.032 335.901 45.76 336.253 46.416C336.621 47.056 337.117 47.568 337.741 47.952C338.381 48.336 339.101 48.528 339.901 48.528ZM349.721 51V32.832H351.953V51H349.721ZM361.369 51.288C360.121 51.288 359.009 50.992 358.033 50.4C357.057 49.808 356.289 49 355.729 47.976C355.169 46.936 354.889 45.776 354.889 44.496C354.889 43.2 355.161 42.048 355.705 41.04C356.265 40.032 357.017 39.24 357.961 38.664C358.921 38.072 359.993 37.776 361.177 37.776C362.137 37.776 362.985 37.952 363.721 38.304C364.473 38.64 365.105 39.104 365.617 39.696C366.145 40.272 366.545 40.936 366.817 41.688C367.105 42.424 367.248 43.192 367.248 43.992C367.248 44.168 367.233 44.368 367.201 44.592C367.185 44.8 367.161 45 367.129 45.192H356.521V43.272H365.833L364.777 44.136C364.921 43.304 364.841 42.56 364.537 41.904C364.233 41.248 363.785 40.728 363.193 40.344C362.601 39.96 361.929 39.768 361.177 39.768C360.425 39.768 359.737 39.96 359.113 40.344C358.489 40.728 358.001 41.28 357.649 42C357.313 42.704 357.177 43.544 357.241 44.52C357.177 45.464 357.321 46.296 357.673 47.016C358.041 47.72 358.553 48.272 359.209 48.672C359.881 49.056 360.609 49.248 361.393 49.248C362.257 49.248 362.985 49.048 363.577 48.648C364.169 48.248 364.649 47.736 365.017 47.112L366.889 48.072C366.633 48.664 366.233 49.208 365.689 49.704C365.161 50.184 364.529 50.568 363.793 50.856C363.073 51.144 362.265 51.288 361.369 51.288Z",fill:"#616161"}),(0,ct.jsx)("path",{d:"M391 2H15C7.8203 2 2 7.8203 2 15V65C2 72.1797 7.8203 78 15 78H391C398.18 78 404 72.1797 404 65V15C404 7.8203 398.18 2 391 2Z",stroke:"#616161","stroke-width":"4"}),(0,ct.jsx)("path",{d:"M60.7371 32.0915C62.0955 29.3579 64.1794 27.0598 66.7558 25.4543C69.3322 23.8488 72.2997 22.999 75.3265 23C79.7265 23 83.4229 24.6335 86.249 27.2983L81.5682 32.0305C79.8751 30.3953 77.7233 29.5621 75.3265 29.5621C71.0735 29.5621 67.4735 32.4661 66.1918 36.365C65.8653 37.355 65.6792 38.411 65.6792 39.5C65.6792 40.589 65.8653 41.645 66.1918 42.635C67.4751 46.5356 71.0735 49.4379 75.3265 49.4379C77.5224 49.4379 79.3918 48.8522 80.8547 47.8622C81.7028 47.2979 82.4288 46.5657 82.9889 45.7098C83.549 44.8539 83.9316 43.8921 84.1135 42.8825H75.3265V36.5003H90.7029C90.8955 37.5794 91 38.7047 91 39.8746C91 44.9005 89.2204 49.131 86.1314 52.002C83.431 54.5232 79.7347 56 75.3265 56C73.1823 56.0009 71.0588 55.5747 69.0776 54.7458C67.0964 53.9169 65.2962 52.7015 63.78 51.1692C62.2638 49.6369 61.0612 47.8176 60.241 45.8153C59.4209 43.813 58.9991 41.6671 59 39.5C59 36.8369 59.6302 34.319 60.7371 32.0915Z",fill:"#616161"})]})})]})]})]})}var lr={container:"emailauth_container__4gnDP","login-header":"emailauth_login-header__rKK8v","container-1":"emailauth_container-1__TpDzl","sub-container-1":"emailauth_sub-container-1__CmaGI","slingo-header":"emailauth_slingo-header__wTXPm","slingo-slogan":"emailauth_slingo-slogan__VcOw7","quote-part-1":"emailauth_quote-part-1__a2x6v","quote-author":"emailauth_quote-author__0-rRS","slingo-logo":"emailauth_slingo-logo__+DOw5","sub-container-2":"emailauth_sub-container-2__Hr2l2","login-form":"emailauth_login-form__xXCOr","forgot-password":"emailauth_forgot-password__V5O-y","login-button":"emailauth_login-button__8tHSS","link-to-signup":"emailauth_link-to-signup__mMU7R","or-separator":"emailauth_or-separator__0irRA","continue-with-google-button":"emailauth_continue-with-google-button__tgkTE"};function dr(){var e=H((0,S.useState)(""),2),t=e[0],n=e[1],r=H((0,S.useState)(""),2),a=r[0],i=r[1],o=H((0,S.useState)(""),2),s=o[0],u=o[1],c=function(){var e=mt(ft().mark((function e(n){var r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"http://localhost:8080/api/password-reset",e.next=5,ir.post("http://localhost:8080/api/password-reset",{email:t});case 5:r=e.sent,a=r.data,i(a.message),u(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response&&e.t0.response.status>=400&&e.t0.response.status<=500&&(u(e.t0.response.data.message),i(""));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return(0,ct.jsxs)("div",{className:lr.container,children:[(0,ct.jsxs)("div",{className:lr["container-1"],children:[(0,ct.jsxs)("div",{className:lr["sub-container-1"],children:[(0,ct.jsx)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:lr["slingo-logo"],children:(0,ct.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M99.7398 50C99.7398 77.2829 77.5487 99.4 50.1746 99.4C22.8005 99.4 0.609375 77.2829 0.609375 50C0.609375 22.7171 22.8005 0.600006 50.1746 0.600006C77.5487 0.600006 99.7398 22.7171 99.7398 50ZM31.0544 77.5045C31.4378 77.8881 31.8853 78.08 32.3966 78.08H60.5183C62.1375 78.08 63.5009 77.5152 64.6088 76.3854C65.7166 75.2557 66.2705 73.9021 66.2705 72.3246V58.9595C66.2705 58.1922 66.1214 57.4461 65.8232 56.7213C65.5248 55.9966 65.0775 55.3571 64.4809 54.8029L50.9314 41.8214C50.5905 41.5231 50.2816 41.3738 50.0047 41.3738C49.7277 41.3738 49.44 41.5017 49.1418 41.7575C48.5879 42.2265 48.247 42.8127 48.1192 43.5161C47.9914 44.2196 48.0979 44.9123 48.4387 45.5945L51.3148 51.2218H29.8401C29.3288 51.2218 28.8813 51.4031 28.4978 51.7654C28.1144 52.1277 27.9227 52.5861 27.9227 53.1403C27.9227 53.6518 28.1144 54.0995 28.4978 54.4832C28.8813 54.8669 29.3288 55.0587 29.8401 55.0587H44.5401V58.8956H26.0053C25.494 58.8956 25.0465 59.0768 24.6631 59.4391C24.2796 59.8015 24.0879 60.2598 24.0879 60.814C24.0879 61.3256 24.2796 61.7732 24.6631 62.157C25.0465 62.5406 25.494 62.7325 26.0053 62.7325H44.5401V66.5694H28.5618C28.0505 66.5694 27.6031 66.7505 27.2196 67.1129C26.8361 67.4753 26.6444 67.9335 26.6444 68.4878C26.6444 68.9993 26.8361 69.4471 27.2196 69.8307C27.6031 70.2144 28.0505 70.4062 28.5618 70.4062H44.5401V74.2431H32.3966C31.8853 74.2431 31.4378 74.4243 31.0544 74.7866C30.6709 75.1491 30.4792 75.6073 30.4792 76.1615C30.4792 76.6732 30.6709 77.1208 31.0544 77.5045ZM39.1075 29.6074L47.3522 38.3044C48.247 37.7928 49.0886 37.5369 49.8768 37.5369C50.6651 37.5369 51.5279 37.7501 52.4653 38.1764L41.9197 26.9855C41.5788 26.6019 41.142 26.3994 40.6094 26.3781C40.0768 26.3567 39.6188 26.5166 39.2353 26.8576C38.8519 27.2414 38.6494 27.6996 38.6281 28.2325C38.6068 28.7654 38.7666 29.2237 39.1075 29.6074ZM36.1674 37.6649L44.6679 46.5536C44.5401 46.0421 44.4442 45.5411 44.3803 45.0508C44.3163 44.5606 44.2844 44.0596 44.2844 43.548C44.2844 43.207 44.3376 42.834 44.4442 42.429C44.5507 42.0239 44.7105 41.6083 44.9235 41.1819L38.9796 35.043C38.6388 34.6593 38.202 34.4568 37.6694 34.4355C37.1368 34.4141 36.6788 34.574 36.2953 34.9151C35.9119 35.2988 35.7094 35.7571 35.6881 36.29C35.6668 36.8229 35.8266 37.2812 36.1674 37.6649ZM67.7406 52.7246C67.9962 53.0017 68.2305 53.2895 68.4435 53.5879L73.3648 49.1115C73.9613 48.5573 74.4194 47.9178 74.739 47.1931C75.0586 46.4684 75.2183 45.701 75.2183 44.891V26.1543C75.2183 25.6852 75.1437 25.3549 74.9946 25.163C74.8455 24.9711 74.5792 24.8539 74.1957 24.8113C73.4713 24.726 72.7896 24.8645 72.1505 25.227C71.5114 25.5893 71.0639 26.1329 70.8083 26.8576L68.6992 32.9327L53.9353 17.3293C53.5944 16.9457 53.1576 16.7432 52.625 16.7219C52.0924 16.7005 51.6345 16.8604 51.251 17.2015C50.8675 17.5852 50.6651 18.0435 50.6438 18.5764C50.6225 19.1093 50.7823 19.5675 51.1232 19.9513L61.2853 30.5667L58.4731 33.2525L45.7545 19.8234C45.4136 19.4397 44.9661 19.2372 44.4122 19.2159C43.8584 19.1946 43.3896 19.3544 43.0062 19.6954C42.6227 20.0792 42.431 20.5268 42.431 21.0384C42.431 21.55 42.6014 21.9976 42.9423 22.3812L55.6609 35.8743L54.3188 37.2173L52.9766 38.5601L66.9096 51.8613C67.2079 52.1598 67.4849 52.4475 67.7406 52.7246Z",fill:"white"})}),(0,ct.jsx)("h1",{className:lr["slingo-header"],children:"Slingo"})]}),(0,ct.jsxs)("div",{className:lr["slingo-slogan"],children:[(0,ct.jsxs)("div",{className:lr["quote-part-1"],children:[(0,ct.jsx)("p",{children:'"Sign language is the noblest gift '}),(0,ct.jsx)("p",{children:'God has given to deaf people."'})]}),(0,ct.jsx)("p",{className:lr["quote-author"],children:"- George William Veditz"})]})]}),(0,ct.jsxs)("div",{className:lr["sub-container-2"],children:[(0,ct.jsx)("h1",{className:lr["login-header"],children:"Forgot password"}),(0,ct.jsxs)("form",{className:lr["login-form"],onSubmit:c,children:[(0,ct.jsxs)("div",{children:[(0,ct.jsx)("label",{className:lr["login-form-label"],htmlFor:"email",children:"Email"}),(0,ct.jsx)("input",{type:"text",id:"email",value:t,required:!0,onChange:function(e){return n(e.target.value)},placeholder:"Enter your email"})]}),s&&(0,ct.jsx)("div",{children:s}),a&&(0,ct.jsx)("div",{children:a}),(0,ct.jsx)("button",{className:lr["login-button"],type:"submit",children:"Submit"})]})]})]})}var pr=n(97),hr=n.n(pr),fr=function(){function e(t,n){A(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return L(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),vr=function(){function e(){A(this,e)}return L(e,[{key:"refCount",value:function(e){return mr("refCount")}},{key:"incRef",value:function(e){return mr("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return mr("time")}},{key:"read",value:function(e){return mr("read")}},{key:"readSync",value:function(e){return mr("readSync")}},{key:"readToGPU",value:function(e,t){return mr("readToGPU")}},{key:"numDataIds",value:function(){return mr("numDataIds")}},{key:"disposeData",value:function(e,t){return mr("disposeData")}},{key:"write",value:function(e,t,n){return mr("write")}},{key:"move",value:function(e,t,n,r,a){return mr("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return mr("createTensorFromGPUData")}},{key:"memory",value:function(){return mr("memory")}},{key:"floatPrecision",value:function(){return mr("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return mr("dispose")}}]),e}();function mr(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function gr(e){for(var t=e.length,n=0;t>0;)n=Math.random()*t|0,xr(e,--t,n)}function yr(e,t,n){return Math.max(e,Math.min(t,n))}function br(e){return e%2===0?e:e+1}function xr(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function kr(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function wr(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function Cr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";wr(Ir(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function Sr(e){wr(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Nr(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ir(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Tr(e){return e%1===0}function Er(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function _r(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Rr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function s(){if(e())a();else{o++;var u=t(o);null!=n&&o>=n?i():null!=r?r(s,u):setTimeout(s,u)}}()}))}function Ar(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function Or(e,t){var n=t.length;return wr((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),wr(e.every((function(e){return Tr(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function Fr(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:Or(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Dr(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function Lr(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function Mr(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function zr(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function Pr(e){return"string"===typeof e||e instanceof String}function Br(e){return"number"===typeof e}function Vr(e){return Array.isArray(e)?Vr(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":Br(e)?"float32":Pr(e)?"string":"boolean"===typeof e?"bool":"float32"}function Wr(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Ur(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function jr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Hr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var s=t[0],u=t.slice(1),c=u.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<s;l++)a[l]=Hr(e+l*c,u,n,r);return a}function Gr(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return Hr(0,e,t,n)}function qr(e,t){for(var n=Kr(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Kr(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function Xr(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return Gr(e,new Float32Array(n));if("int32"===t)return Gr(e,new Int32Array(n));if("bool"===t)return Gr(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function Zr(e){e.forEach((function(t){wr(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function Yr(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function Qr(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Jr(e){return e&&e.then&&"function"===typeof e.then}var $r="tfjsflags",ea=function(){function e(t){A(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ta,this.populateURLFlags()}return L(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(na().getBool("IS_TEST")||na().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];na().getBool("IS_TEST")||na().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Jr(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if($r in t)t[$r].split(",").forEach((function(t){var n=H(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function ta(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function na(){return aa}var ra,aa=null;function ia(){if(null==ra){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}ra=e}return ra}function oa(e,t){var n=function(){var e=ia();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var sa="Abs",ua="Acos",ca="Acosh",la="Add",da="AddN",pa="All",ha="Any",fa="ArgMax",va="ArgMin",ma="Asin",ga="Asinh",ya="Atan",ba="Atanh",xa="Atan2",ka="AvgPool",wa="AvgPoolGrad",Ca="AvgPool3D",Sa="AvgPool3DGrad",Na="BatchMatMul",Ia="BatchToSpaceND",Ta="Bincount",Ea="BroadcastArgs",_a="Cast",Ra="Ceil",Aa="ClipByValue",Oa="Complex",Fa="ComplexAbs",Da="Concat",La="Conv2D",Ma="Conv2DBackpropFilter",za="Conv2DBackpropInput",Pa="Conv3D",Ba="Conv3DBackpropFilterV2",Va="Conv3DBackpropInputV2",Wa="Cos",Ua="Cosh",ja="Cumprod",Ha="Cumsum",Ga="CropAndResize",qa="DenseBincount",Ka="DepthToSpace",Xa="DepthwiseConv2dNative",Za="DepthwiseConv2dNativeBackpropFilter",Ya="DepthwiseConv2dNativeBackpropInput",Qa="Diag",Ja="Dilation2D",$a="Dilation2DBackpropInput",ei="Dilation2DBackpropFilter",ti="RealDiv",ni="Einsum",ri="Elu",ai="EluGrad",ii="Erf",oi="Equal",si="Exp",ui="ExpandDims",ci="Expm1",li="FFT",di="Fill",pi="FlipLeftRight",hi="Floor",fi="FloorDiv",vi="FusedBatchNorm",mi="GatherV2",gi="GatherNd",yi="Greater",bi="GreaterEqual",xi="Identity",ki="IFFT",wi="Imag",Ci="IsFinite",Si="IsInf",Ni="IsNan",Ii="LeakyRelu",Ti="Less",Ei="LessEqual",_i="LinSpace",Ri="Log",Ai="Log1p",Oi="LogicalAnd",Fi="LogicalNot",Di="LogicalOr",Li="LRN",Mi="LRNGrad",zi="Max",Pi="Maximum",Bi="MaxPool",Vi="MaxPoolGrad",Wi="MaxPool3D",Ui="MaxPool3DGrad",ji="MaxPoolWithArgmax",Hi="Mean",Gi="Min",qi="Minimum",Ki="MirrorPad",Xi="Mod",Zi="Multinomial",Yi="Multiply",Qi="Neg",Ji="NotEqual",$i="NonMaxSuppressionV3",eo="NonMaxSuppressionV4",to="NonMaxSuppressionV5",no="OnesLike",ro="OneHot",ao="Pack",io="PadV2",oo="Pow",so="Prelu",uo="Prod",co="RaggedGather",lo="RaggedRange",po="RaggedTensorToTensor",ho="Range",fo="Real",vo="Reciprocal",mo="Relu",go="Reshape",yo="ResizeNearestNeighbor",bo="ResizeNearestNeighborGrad",xo="ResizeBilinear",ko="ResizeBilinearGrad",wo="Relu6",Co="Reverse",So="Round",No="Rsqrt",Io="ScatterNd",To="SearchSorted",Eo="Select",_o="Selu",Ro="Slice",Ao="Sin",Oo="Sinh",Fo="Sign",Do="Sigmoid",Lo="Softplus",Mo="Sqrt",zo="Sum",Po="SpaceToBatchND",Bo="SplitV",Vo="Softmax",Wo="SparseFillEmptyRows",Uo="SparseReshape",jo="SparseSegmentMean",Ho="SparseSegmentSum",Go="SparseToDense",qo="SquaredDifference",Ko="Square",Xo="StridedSlice",Zo="StringNGrams",Yo="StringSplit",Qo="StringToHashBucketFast",Jo="Sub",$o="Tan",es="Tanh",ts="Tile",ns="TopK",rs="Transform",as="Transpose",is="Unique",os="Unpack",ss="UnsortedSegmentSum",us="ZerosLike",cs="Step",ls="FromPixels",ds="RotateWithOffset",ps="_FusedMatMul",hs="FusedConv2D",fs="FusedDepthwiseConv2D";function vs(){var e;na().getBool("IS_TEST")||na().getBool("PROD")||(e=console).warn.apply(e,arguments)}var ms=oa("kernelRegistry",(function(){return new Map})),gs=oa("gradRegistry",(function(){return new Map}));function ys(e,t){var n=Cs(e,t);return ms.get(n)}function bs(e){return gs.get(e)}function xs(e){for(var t=ms.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=H(i,2),s=o[0],u=o[1];H(s.split("_"),1)[0]===e&&n.push(u)}return n}function ks(e){var t=e.kernelName,n=e.backendName,r=Cs(t,n);ms.has(r)&&vs("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),ms.set(r,e)}function ws(e){var t=e.kernelName;gs.has(t)&&na().getBool("DEBUG")&&vs("Overriding the gradient for '".concat(t,"'")),gs.set(t,e)}function Cs(e,t){return"".concat(t,"_").concat(e)}var Ss=n(8987),Ns=n.n(Ss)()||Ss;function Is(e){return Ns.fromString(e,!0,16)}var Ts=Is("c3a5c85c97cb3127"),Es=Is("b492b66fbe98f273"),_s=Is("9ae16a3b2f90404f");function Rs(e){return e.xor(e.shru(47))}function As(e,t,n){var r=e.slice(t,t+n);return Ns.fromBytes(Array.from(r),!0,!0)}function Os(e,t){return As(e,t,8)}function Fs(e,t){return As(e,t,4)}function Ds(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function Ls(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Is("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function Ms(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=Ds(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(Ds(a,44)),[a.add(r),i.add(o)]}(Os(e,t),Os(e,t+8),Os(e,t+16),Os(e,t+24),n,r)}function zs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=Ns.fromNumber(81,!0);if(t<=32)return t<=16?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=_s.add(2*t),r=Os(e,0).add(_s),a=Os(e,t-8);return Ls(Ds(a,37).mul(n).add(r),Ds(r,25).add(a).mul(n),n)}if(t>=4){var i=_s.add(2*t);return Ls(Fs(e,0).shl(3).add(t),Fs(e,t-4),i)}if(t>0){var o=e[0]+(e[t>>1]<<8),s=t+(e[t-1]<<2);return Rs(_s.mul(o).xor(Ts.mul(s))).mul(_s)}return _s}(e,t):function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=_s.add(2*t),r=Os(e,0).mul(Es),a=Os(e,8),i=Os(e,t-8).mul(n),o=Os(e,t-16).mul(_s);return Ls(Ds(r.add(a),43).add(Ds(i,30)).add(o),r.add(Ds(a.add(_s),18)).add(i),n)}(e,t);if(t<=64)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=_s.add(2*t),r=Os(e,0).mul(_s),a=Os(e,8),i=Os(e,t-8).mul(n),o=Os(e,t-16).mul(_s),s=Ds(r.add(a),43).add(Ds(i,30)).add(o),u=Ls(s,r.add(Ds(a.add(_s),18)).add(i),n),c=Os(e,16).mul(n),l=Os(e,24),d=s.add(Os(e,t-32)).mul(n),p=u.add(Os(e,t-24)).mul(n);return Ls(Ds(c.add(l),43).add(Ds(d,30)).add(p),c.add(Ds(l.add(r),18)).add(d),n)}(e,t);var r=n,a=n.mul(Es).add(113),i=Rs(a.mul(_s).add(113)).mul(_s),o=[Ns.UZERO,Ns.UZERO],s=[Ns.UZERO,Ns.UZERO];r=r.mul(_s).add(Os(e,0));var u=0,c=64*(t-1>>6),l=c+(t-1&63)-63;do{r=Ds(r.add(a).add(o[0]).add(Os(e,u+8)),37).mul(Es),a=Ds(a.add(o[1]).add(Os(e,u+48)),42).mul(Es),r=r.xor(s[1]),a=a.add(o[0]).add(Os(e,u+40)),i=Ds(i.add(s[0]),33).mul(Es),o=Ms(e,u,o[1].mul(Es),r.add(s[0])),s=Ms(e,u+32,i.add(s[1]),a.add(Os(e,u+16)));var d=[r,i];i=d[0],r=d[1],u+=64}while(u!==c);var p=Es.add(i.and(255).shl(1));u=l,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=Ds(r.add(a).add(o[0]).add(Os(e,u+8)),37).mul(p),a=Ds(a.add(o[1]).add(Os(e,u+48)),42).mul(p),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(Os(e,u+40))),i=Ds(i.add(s[0]),33).mul(p),o=Ms(e,u,o[1].mul(p),r.add(s[0])),s=Ms(e,u+32,i.add(s[1]),a.add(Os(e,u+16)));var h=[r,i];return i=h[0],r=h[1],Ls(Ls(o[0],s[0],p).add(Rs(a).mul(Ts)).add(i),Ls(o[1],s[1],p).add(r),p)}function Ps(e,t){return"string"===t?Ws(e):Bs([e],t)}function Bs(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Hs(e)),na().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function Vs(){return na().platform.now()}function Ws(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",na().platform.encode(e,t)}function Us(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",na().platform.decode(e,t)}function js(e){return na().platform.isTypedArray(e)}function Hs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||Jr(e)||null==e||js(e)&&n)t.push(e);else if(Array.isArray(e)||js(e))for(var r=0;r<e.length;++r)Hs(e[r],t,n);else{for(var a=-1,i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];/^([1-9]+[0-9]*|0)$/.test(s)&&(a=Math.max(a,Number(s)))}for(var u=0;u<=a;u++)Hs(e[u],t,n)}return t}var Gs=function(){function e(t,n){A(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new qs)}return L(e,[{key:"profileKernel",value:function(e,t,n){var r,a,i=function(){r=n()},o=Vs();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();var s,u=K(r);try{for(u.s();!(s=u.n()).done;){s.value.dataSync()}}catch(d){u.e(d)}finally{u.f()}a=Promise.resolve({kernelMs:Vs()-o})}if(na().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var c=function(){var t=r[l];t.data().then((function(n){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(n,t.dtype,e)}))},l=0;l<r.length;l++)c();return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var qs=function(){function e(){A(this,e)}return L(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?_r("".concat(r,"ms"),9):r.error,s=_r(e,25),u=t.rank,c=t.size,l=_r(t.shape.toString(),14),d="";for(var p in a){var h=a[p];if(null!=h){var f=h.shape||t.shape,v=f.length;d+="".concat(p,": ").concat(v,"D ").concat(v>0?f:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(d,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();var Ks=20,Xs=3,Zs=7;function Ys(e,t,n,r){var a=jr(t),i=function(e,t,n,r){var a=Nr(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?eu(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,d=0;d<i;d++)o[d]=Math.max(o[d],Qs(u[l+d],0,n).length);return o}(e,t,n,a),o=t.length,s=$s(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function Qs(e,t,n){return _r(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(Zs))," + ")+"".concat(parseFloat(e[1].toFixed(Zs)),"j"):Pr(e)?"'".concat(e,"'"):"bool"===n?Js(e):parseFloat(e.toFixed(Zs)).toString(),t)}function Js(e){return 0===e?"false":"true"}function $s(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u)return"complex64"===n?[Qs(eu(e)[0],0,n)]:"bool"===n?[Js(e[0])]:[e[0].toString()];if(1===u){if(s>Ks){var c=Xs*o,l=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-Xs)*o,s*o));return"complex64"===n&&(l=eu(l),d=eu(d)),["["+l.map((function(e,t){return Qs(e,a[t],n)})).join(", ")+", ..., "+d.map((function(e,t){return Qs(e,a[s-Xs+t],n)})).join(", ")+"]"]}return["["+("complex64"===n?eu(e):Array.from(e)).map((function(e,t){return Qs(e,a[t],n)})).join(", ")+"]"]}var p=t.slice(1),h=r.slice(1),f=r[0]*o,v=[];if(s>Ks){for(var m=0;m<Xs;m++){var g=m*f,y=g+f;v.push.apply(v,R($s(e.slice(g,y),p,n,h,a,!1)))}v.push("...");for(var b=s-Xs;b<s;b++){var x=b*f,k=x+f;v.push.apply(v,R($s(e.slice(x,k),p,n,h,a,b===s-1)))}}else for(var w=0;w<s;w++){var C=w*f,S=C+f;v.push.apply(v,R($s(e.slice(C,S),p,n,h,a,w===s-1)))}var N=2===u?",":"";v[0]="["+(s>0?v[0]+N:"");for(var I=1;I<v.length-1;I++)v[I]=" "+v[I]+N;for(var T=",\n",E=2;E<u;E++)T+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(i?"":T),v}function eu(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var tu=function(){function e(t,n,r){var a=this;if(A(this,e),this.dtype=n,this.shape=t.slice(),this.size=Nr(t),null!=r){var i=r.length;wr(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Lr(n,this.size),this.strides=jr(t)}return L(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),wr(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return nu().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),nu=null,ru=null;var au=function(){function e(t,n,r,a){A(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Nr(t),this.strides=jr(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return L(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",ru.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return ru.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Gr(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return Gr(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=nu().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return Us(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),nu().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=nu().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return Us(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,nu().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(nu().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ru.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),ru.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ys(this.dataSync(),this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),ru.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),nu().makeVariable(this,e,t,n)}}]),e}();function iu(){return oa("Tensor",(function(){return au}))}Object.defineProperty(au,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),iu();var ou,su,uu,cu,lu,du=function(e){z(n,e);var t=W(n);function n(e,r,a,i){var o;return A(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return L(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Ir(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));nu().disposeTensor(this),this.dataId=e.dataId,nu().incRef(this,null)}},{key:"dispose",value:function(){nu().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(au);Object.defineProperty(du,Symbol.hasInstance,{value:function(e){return e instanceof au&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ou||(ou={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(su||(su={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(uu||(uu={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(cu||(cu={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(lu||(lu={}));var pu={float32:cu,int32:su,bool:uu,complex64:lu};function hu(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return pu[e][t]}function fu(e){return hu(e,"int32")}function vu(e,t){if(e.dtype===t.dtype)return[e,t];var n=hu(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function mu(e,t){return t.some((function(t){return t.id===e.id}))}function gu(e){var t=[];return yu(e,t,new Set),t}function yu(e,t,n){if(null!=e)if(e instanceof au)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),yu(o,t,n))}}}function bu(e){return null!=e.kernelName}var xu=function(){function e(){A(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return L(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),ku=function(){function e(t){A(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new xu}return L(e,[{key:"ready",value:function(){var e=mt(ft().mark((function e(){var t,n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(vs("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Gs(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;xs(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;xs(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof vr||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,vs("Initialization of backend ".concat(e," failed")),vs(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return vs("Initialization of backend ".concat(e," failed")),vs(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=Su.runKernel(xi,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return Su.runKernel(_a,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=ys(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=bu(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(bu(e)){var l=e.kernelName,d=e.inputs,p=e.attrs;null==this.backendName&&this.backend;var h=ys(l,this.backendName);wr(null!=h,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=h.kernelFunc({inputs:d,attrs:p,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var s=a.getTensorsForGradient(l,d,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var f=e.forwardFunc,v=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return f(a.backend,v)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var m,g=e.inputs,y=e.attrs,b=bu(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(m=a.profiler.profileKernel(c,g,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(m),t=m.outputs):t=n()})),o&&this.addTapeNode(c,g,t,b,i,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(g).map((function(e){return null!=g[e]?g[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=bs(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(wr(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&Pr(e[0])&&(a=e.map((function(e){return Ws(e)})));var i=r.write(a,t,n),o=new au(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new au(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new du(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*zr(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof du||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*zr(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,R(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=K(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=bs(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=Kr(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=gu(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(wr(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));wr(i instanceof au,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],d=!1,p=0;p<t.length;p++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),d=!0,a[s.id]=!0;break}if(d)break}}var h={};h[n.id]=!0;for(var f={},v=e.length-1;v>=0;v--)for(var m=e[v],g=m.inputs,y=0;y<m.outputs.length;y++)if(h[m.outputs[y].id]){for(var b in g)h[g[b].id]=!0,f[m.id]=!0;break}for(var x=[],k=0;k<e.length;k++){var w=e[k];if(a[w.id]&&f[w.id]){var C={};for(var S in w.inputs){var N=w.inputs[S];r[N.id]&&(C[S]=N)}var I=Object.assign({},w);I.inputs=C,I.outputs=w.outputs,x.push(I)}}return x}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?function(e){var t=qr(Nr(e),"float32");return Su.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(var a=function(){var a=t[i],o=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[t];if(!Ir(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var u=e[o.id];e[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},i=t.length-1;i>=0;i--)a()}(e,o,(function(e){return r.tidy(e)}),Nu);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=K(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return wr(Wr(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;wr(r.every((function(e){return e instanceof au})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));return t.runKernelFunc({forwardFunc:function(t,n){return wr((i=e.apply(void 0,[].concat(r,[n]))).value instanceof au,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),wr(Wr(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},backwardsFunc:function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];wr(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),wr(a.every((function(e){return e instanceof au})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o},inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vs(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=Vs()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new xu,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function wu(){var e=ia();if(null==e._tfengine){var t=new ea(e);e._tfengine=new ku(t)}return function(e){aa=e}(e._tfengine.ENV),nu=function(){return e._tfengine},e._tfengine}ku.nextTensorId=0,ku.nextVariableId=0;var Cu,Su=wu();function Nu(e,t){var n={a:e,b:t};return Su.runKernel(la,n)}function Iu(e){if(void 0!==Cu)return Cu;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Tu(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var Eu=na();function _u(e,t){var n=e;if(js(e))return"string"===t?[]:[e.length];if("object"===typeof e){if("texture"in e){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if("buffer"in e&&!(e.buffer instanceof ArrayBuffer))return[e.buffer.size/(null==t?4:zr(t))]}if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||js(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&na().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ru(e,a,[]),a}function Ru(e,t,n){if(n=n||[],Array.isArray(e)||js(e)){wr(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),wr(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)Ru(e[a],r,n.concat(a))}else wr(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function Au(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function Ou(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof au)return Au(r,e.dtype,t,n),e;var a=Vr(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Au(r,a,t,n),null==e||!js(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=_u(e,a);js(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?Bs(e,a):Hs(e,[],!0);return Su.makeTensor(s,o,a)}function Fu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((function(e,a){return Ou(e,"".concat(t,"[").concat(a,"]"),n,r)}))}Eu.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Eu.registerFlag("IS_BROWSER",(function(){return Tu()})),Eu.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),Eu.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Eu.registerFlag("PROD",(function(){return!1})),Eu.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Eu.getBool("DEBUG")})),Eu.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Eu.registerFlag("IS_TEST",(function(){return!1})),Eu.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),Eu.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),Eu.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),Eu.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var Du="__op";function Lu(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Du;var a=function(){Su.startScope(n);try{var e=r.apply(void 0,arguments);return Jr(e)&&console.error("Cannot return a Promise inside of tidy."),Su.endScope(e),e}catch(t){throw Su.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var Mu=Lu({complex_:function(e,t){var n=Ou(e,"real","complex"),r=Ou(t,"imag","complex");Cr(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return Su.runKernel(Oa,a)}});function zu(e,t,n,r){if(null==r)r=Vr(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if("object"===typeof e&&("texture"in e||"buffer"in e&&!(e.buffer instanceof ArrayBuffer))){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return Su.backend.createTensorFromGPUData(e,t||n,r)}if(!js(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Zr(t);var a=Nr(t),i=Nr(n);wr(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==Nr(t.slice(o));wr(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return js(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Bs(e,r):Hs(e,[],!0),Su.makeTensor(e,t,r)}function Pu(e,t,n){return zu(e,t,_u(e,n),n)}var Bu={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Vu=4;function Wu(e,t){return Uu.apply(this,arguments)}function Uu(){return Uu=mt(ft().mark((function e(t,n){var r,a,i,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=ft().mark((function e(){var o,u,c,l;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i[s],"float32"===(u=Array.isArray(t)?t[s].tensor:t[o]).dtype||"int32"===u.dtype||"bool"===u.dtype||"string"===u.dtype||"complex64"===u.dtype){e.next=4;break}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(u.dtype));case 4:c={name:o,shape:u.shape,dtype:u.dtype},"string"===u.dtype?(l=new Promise(function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o,s,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+Vu*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)s=n[o],c=new Uint8Array(new Uint32Array([s.length]).buffer),a.set(c,i),i+=Vu,a.set(s,i),i+=s.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.push(l)):a.push(u.data()),null!=n&&(c.group=n),r.push(c);case 8:case"end":return e.stop()}}),e)})),s=0;case 5:if(!(s<i.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:++s,e.next=5;break;case 10:return e.next=12,Promise.all(a);case 12:return u=e.sent,e.abrupt("return",{data:Hu(u),specs:r});case 14:case"end":return e.stop()}}),e)}))),Uu.apply(this,arguments)}function ju(e,t){var n,r,a={},i=0,o=K(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,d=Nr(l),p=void 0;if("quantization"in s){var h=s.quantization;if("uint8"===h.dtype||"uint16"===h.dtype){if(!("min"in h)||!("scale"in h))throw new Error("Weight ".concat(s.name," with quantization ").concat(h.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==h.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(h.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(h.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var f=Bu[h.dtype],v=e.slice(i,i+d*f),m="uint8"===h.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===c)if("uint8"===h.dtype||"uint16"===h.dtype){p=new Float32Array(m.length);for(var g=0;g<m.length;g++){var y=m[g];p[g]=y*h.scale+h.min}}else{if("float16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type float32.");void 0===n&&(n=rc()),p=n(m)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type int32.");p=new Int32Array(m.length);for(var b=0;b<m.length;b++){var x=m[b];p[b]=Math.round(x*h.scale+h.min)}}i+=d*f}else if("string"===c){var k=Nr(s.shape);p=[];for(var w=0;w<k;w++){var C=new Uint32Array(e.slice(i,i+Vu))[0];i+=Vu;var S=new Uint8Array(e.slice(i,i+C));p.push(S),i+=C}}else{var N=Bu[c],I=e.slice(i,i+d*N);if("float32"===c)p=new Float32Array(I);else if("int32"===c)p=new Int32Array(I);else if("bool"===c)p=new Uint8Array(I);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));p=new Float32Array(I);for(var T=new Float32Array(p.length/2),E=new Float32Array(p.length/2),_=0;_<T.length;_++)T[_]=p[2*_],E[_]=p[2*_+1];var R=Pu(T,l,"float32"),A=Pu(E,l,"float32");a[u]=Mu(R,A),R.dispose(),A.dispose()}i+=d*N}"complex64"!==c&&(a[u]=Pu(p,l,c))}}catch(O){o.e(O)}finally{o.f()}return a}function Hu(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var Gu="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function qu(e){return Gu?Buffer.byteLength(e):new Blob([e]).size}function Ku(e){if(Gu)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Xu(e){if(Gu){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function Zu(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Yu(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Qu(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function Ju(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function $u(e,t){return ec.apply(this,arguments)}function ec(){return ec=mt(ft().mark((function e(t,n){var r,a,i,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:i=e.sent,o=H(i,2),r=o[0],a=o[1];case 7:return e.abrupt("return",Ju(t,r,a));case 8:case"end":return e.stop()}}),e)}))),ec.apply(this,arguments)}function tc(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:qu(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:qu(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function nc(e){var t,n=[],r=K(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push.apply(n,R(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function rc(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var ac=function(){function e(){A(this,e),this.saveRouters=[],this.loadRouters=[]}return L(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),ic=function(e){return ac.registerSaveRouter(e)},oc=function(e){return ac.registerLoadRouter(e)},sc=function(e){return ac.getSaveHandlers(e)},uc=function(e,t){return ac.getLoadHandlers(e,t)},cc="tensorflowjs",lc="models_store",dc="model_info_store";function pc(){if(!na().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function hc(e){var t=e.result;t.createObjectStore(lc,{keyPath:"modelPath"}),t.createObjectStore(dc,{keyPath:"modelPath"})}var fc=function(){function e(t){if(A(this,e),this.indexedDB=pc(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return L(e,[{key:"save",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(cc,1);a.onupgradeneeded=function(){return hc(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(lc,"readonly"),s=o.objectStore(lc).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=tc(t),l=i.transaction(dc,"readwrite"),d=l.objectStore(dc),p=d.put({modelPath:n.modelPath,modelArtifactsInfo:c});p.onsuccess=function(){var a=(u=i.transaction(lc,"readwrite")).objectStore(lc).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(d=l.objectStore(dc)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},p.onerror=function(e){return i.close(),r(p.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();fc.URL_SCHEME="indexeddb://";var vc=function(e){return na().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(fc.URL_SCHEME)?(t=e.slice(fc.URL_SCHEME.length),new fc(t)):null;var t};ac.registerSaveRouter(vc),ac.registerLoadRouter(vc);var mc=function(){function e(){A(this,e),this.indexedDB=pc()}return L(e,[{key:"listModels",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(cc,1);r.onupgradeneeded=function(){return hc(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(dc,"readonly"),i=a.objectStore(dc).getAll();i.onsuccess=function(){var t,n={},r=K(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=mt(ft().mark((function e(t){var n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(fc.URL_SCHEME)?r.slice(fc.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(cc,1);a.onupgradeneeded=function(){return hc(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(dc,"readwrite"),s=o.objectStore(dc),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(lc,"readwrite")).objectStore(lc).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),gc="/",yc="tensorflowjs_models",bc="info",xc="model_topology",kc="weight_specs",wc="weight_data",Cc="model_metadata";function Sc(e){return{info:[yc,e,bc].join(gc),topology:[yc,e,xc].join(gc),weightSpecs:[yc,e,kc].join(gc),weightData:[yc,e,wc].join(gc),modelMetadata:[yc,e,Cc].join(gc)}}function Nc(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function Ic(e){var t=e.split(gc);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(gc)}var Tc=function(){function e(t){if(A(this,e),!na().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Sc(this.modelPath)}return L(e,[{key:"save",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=tc(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Ku(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 17:throw e.prev=17,e.t0=e.catch(7),Nc(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 21:case"end":return e.stop()}}),e,this,[[7,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Xu(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();Tc.URL_SCHEME="localstorage://";var Ec=function(e){return na().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Tc.URL_SCHEME)?(t=e.slice(Tc.URL_SCHEME.length),new Tc(t)):null;var t};ac.registerSaveRouter(Ec),ac.registerLoadRouter(Ec);var _c=function(){function e(){A(this,e),wr(na().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),wr("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return L(e,[{key:"listModels",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=yc+gc,r=gc+bc,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=Ic(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(Tc.URL_SCHEME)?a.slice(Tc.URL_SCHEME.length):a,n=Sc(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),Nc(n),e.abrupt("return",r);case 7:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Rc="://",Ac=function(){function e(){A(this,e),this.managers={}}return L(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){wr(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(Rc)&&(t=t.slice(0,t.indexOf(Rc))),wr(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();wr(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function Oc(e){if(-1===e.indexOf(Rc))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Ac.getSchemes().join(",")));return{scheme:e.split(Rc)[0],path:e.split(Rc)[1]}}function Fc(e,t){return Dc.apply(this,arguments)}function Dc(){return Dc=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p,h=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],wr(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),wr((a=ac.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),wr(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],wr((o=ac.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),wr(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=Oc(t).scheme,c=Oc(t).path,l=u===Oc(t).scheme,e.next=15,i.load();case 15:if(d=e.sent,!r||!l){e.next=19;break}return e.next=19,Ac.getManager(u).removeModel(c);case 19:return e.next=21,s.save(d);case 21:if(p=e.sent,!r||l){e.next=25;break}return e.next=25,Ac.getManager(u).removeModel(c);case 25:return e.abrupt("return",p.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),Dc.apply(this,arguments)}function Lc(){return Mc.apply(this,arguments)}function Mc(){return(Mc=mt(ft().mark((function e(){var t,n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Ac.getSchemes(),n={},r=K(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,Ac.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+Rc+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function zc(e){return Pc.apply(this,arguments)}function Pc(){return(Pc=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Oc(t),r=Ac.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bc(e,t){return Vc.apply(this,arguments)}function Vc(){return(Vc=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",Fc(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wc(e,t){return Uc.apply(this,arguments)}function Uc(){return(Uc=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",Fc(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jc=function(){function e(){A(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return L(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&na().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}}]),e}();if(na().get("IS_BROWSER")){na().setPlatform("browser",new jc);try{Ac.registerManager(Tc.URL_SCHEME,new _c)}catch(aH){}try{Ac.registerManager(fc.URL_SCHEME,new mc)}catch(aH){}}var Hc,Gc=function(){return n(5410)};var qc=function(){function e(){A(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return L(e,[{key:"fetch",value:function(e,t){return null!=na().global.fetch?na().global.fetch(e,t):(null==Hc&&(Hc=Gc()),Hc(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();function Kc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",Zr(e),new tu(e,t,n)}na().get("IS_NODE")&&!na().get("IS_BROWSER")&&na().setPlatform("node",new qc);var Xc=Lu({cast_:function(e,t){var n=Ou(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return Su.runKernel(_a,r,a)}});var Zc=Lu({clone_:function(e){var t={x:Ou(e,"x","clone","string_or_numeric")};return Su.runKernel(xi,t)}});function Yc(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}function Qc(){return Su}function Jc(){return Su.memory()}function $c(e,t){return Su.tidy(e,t)}function el(e){gu(e).forEach((function(e){return e.dispose()}))}function tl(e){return Su.keep(e)}function nl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Su.registerBackend(e,t,n)}wu(),ru={buffer:Kc,cast:Xc,clone:Zc,print:Yc};var rl=Lu({add_:function(e,t){var n=Ou(e,"a","add"),r=Ou(t,"b","add"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(la,i)}});var al=Lu({floorDiv_:function(e,t){var n=Ou(e,"a","floorDiv"),r=Ou(t,"b","floorDiv"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(fi,i)}});var il=Lu({div_:function(e,t){var n=Ou(e,"a","div"),r=Ou(t,"b","div"),a=H(vu(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return al(n,r);var i={a:n,b:r};return Su.runKernel(ti,i,{})}});var ol=Lu({mul_:function(e,t){var n=Ou(e,"a","mul"),r=Ou(t,"b","mul"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(Yi,i)}});var sl=Lu({sqrt_:function(e){var t={x:Ou(e,"x","sqrt","float32")};return Su.runKernel(Mo,t)}});var ul=Lu({square_:function(e){var t=Ou(e,"x","square");return Su.runKernel("Square",{x:t},{})}});var cl=Lu({zerosLike_:function(e){var t={x:Ou(e,"x","zerosLike")};return Su.runKernel(us,t)}});function ll(e){return Su.customGrad(e)}function dl(e,t){if((js(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&js(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return zu(e,[],[],t)}var pl=function(){function e(){A(this,e)}return L(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),hl=function(){function e(){A(this,e),this.classNameMap={}}return L(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function fl(e){wr(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),wr("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),wr(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),hl.register(e)}var vl=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return el(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){wr(Wr(e),(function(){return"The f passed in variableGrads(f) must be a function"})),wr(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof du})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],Su.registeredVariables)t.push(Su.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),wr(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=Su.gradients(e,t,null,!0),s=o.value,u=o.grads;wr(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),wr(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&el(this.iterations_)}},{key:"saveIterations",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:dl(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(pl);Object.defineProperty(vl,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var ml=function(e){z(n,e);var t=W(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return A(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=Su.backend.epsilon()),a}return L(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Su.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:$c((function(){return cl(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:$c((function(){return cl(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;$c((function(){var e=rl(ol(o,t.rho),ol(ul(i),1-t.rho)),n=ol(il(sl(rl(s,t.epsilon)),sl(rl(o,t.epsilon))),i),r=rl(ol(s,t.rho),ol(ul(n),1-t.rho));o.assign(e),s.assign(r);var u=rl(ol(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(el(this.accumulatedGrads.map((function(e){return e.variable}))),el(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(R(this.accumulatedGrads),R(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(vl);function gl(e,t,n){Zr(e);var r={shape:e,value:t,dtype:n};return Su.runKernel(di,{},r)}var yl=function(e){z(n,e);var t=W(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return A(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return L(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Su.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:$c((function(){return gl(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;$c((function(){var e=rl(o,ul(i));o.assign(e);var n=rl(ol(il(i,sl(rl(e,Su.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&el(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(vl);var bl=Lu({pow_:function(e,t){var n=Ou(e,"base","pow"),r=Ou(t,"exp","pow"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(oo,i)}});var xl=Lu({sub_:function(e,t){var n=Ou(e,"a","sub"),r=Ou(t,"b","sub"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(Jo,i)}}),kl=function(e){z(n,e);var t=W(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return A(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],$c((function(){i.accBeta1=dl(r).variable(),i.accBeta2=dl(a).variable()})),null==o&&(i.epsilon=Su.backend.epsilon()),i}return L(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);$c((function(){var r=xl(1,t.accBeta1),a=xl(1,t.accBeta2);n.forEach((function(n,i){var o=Su.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:$c((function(){return cl(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:$c((function(){return cl(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=rl(ol(u,t.beta1),ol(s,1-t.beta1)),d=rl(ol(c,t.beta2),ol(ul(s),1-t.beta2)),p=il(l,r),h=il(d,a);u.assign(l),c.assign(d);var f=rl(ol(il(p,rl(sl(h),t.epsilon)),-t.learningRate),o);o.assign(f)}})),t.accBeta1.assign(ol(t.accBeta1,t.beta1)),t.accBeta2.assign(ol(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&el(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&el(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(R(this.accumulatedFirstMoment),R(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){var n,r=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,$c((function(){r.accBeta1.assign(bl(r.beta1,r.iterations_+1)),r.accBeta2.assign(bl(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(vl);var wl=Lu({abs_:function(e){var t=Ou(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return Su.runKernel(Fa,n)}var r={x:t};return Su.runKernel(sa,r)}});function Cl(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function Sl(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Nl(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}var Il=Lu({maximum_:function(e,t){var n=Ou(e,"a","maximum"),r=Ou(t,"b","maximum"),a=H(vu(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Xc(n,"int32"),r=Xc(r,"int32")),Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(Pi,i)}}),Tl=function(e){z(n,e);var t=W(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return A(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],$c((function(){i.iteration=dl(0).variable(),i.accBeta1=dl(r).variable()})),null==o&&(i.epsilon=Su.backend.epsilon()),i}return L(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);$c((function(){var r=xl(1,t.accBeta1),a=il(-t.learningRate,rl(ol(t.iteration,t.decay),1));n.forEach((function(n,i){var o=Su.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:cl(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:cl(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=rl(ol(u,t.beta1),ol(s,1-t.beta1)),d=ol(c,t.beta2),p=wl(s),h=Il(d,p);u.assign(l),c.assign(h);var f=rl(ol(il(a,r),il(l,rl(h,t.epsilon))),o);o.assign(f)}})),t.iteration.assign(rl(t.iteration,1)),t.accBeta1.assign(ol(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&el(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&el(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(vl),El=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return L(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=Su.registeredVariables[n];$c((function(){var e=rl(ol(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=tl(dl(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(vl),_l=function(e){z(n,e);var t=W(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=dl(a.momentum),a}return L(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Su.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:$c((function(){return cl(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&$c((function(){var e,n=rl(ol(t.m,i),o);e=t.useNesterov?rl(ol(t.c,rl(o,ol(n,t.m))),a):rl(ol(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&el(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(El),Rl=function(e){z(n,e);var t=W(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=Su.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return L(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Su.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:$c((function(){return cl(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:$c((function(){return cl(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:$c((function(){return cl(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;$c((function(){var e=rl(ol(s,t.decay),ol(ul(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=rl(ol(n,t.decay),ol(o,1-t.decay)),c=il(ol(o,t.learningRate),sl(xl(e,rl(ul(i),t.epsilon)))),l=rl(ol(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var d=xl(a,l);a.assign(d)}else{var p=rl(ol(s,t.decay),ol(ul(o),1-t.decay)),h=rl(ol(u,t.momentum),il(ol(o,t.learningRate),sl(rl(p,t.epsilon))));s.assign(p),u.assign(h);var f=xl(a,h);a.assign(f)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&el(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&el(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&el(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(R(this.accumulatedMeanSquares),R(this.accumulatedMoments)),this.centered&&t.push.apply(t,R(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(vl),Al=[ml,yl,kl,Tl,_l,Rl,El];var Ol="model",Fl=".json",Dl=".weights.bin";function Ll(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var Ml=function(){function e(t){if(A(this,e),!na().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=Ol),this.modelJsonFileName=t+Fl,this.weightDataFileName=t+Dl}return L(e,[{key:"save",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=Qu(t,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=i,e.next=15,Ll((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==t.weightData){e.next=21;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=21,Ll((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 21:return e.abrupt("return",{modelArtifactsInfo:tc(t)});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Ml.URL_SCHEME="downloads://";var zl=function(){function e(t){if(A(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return L(e,[{key:"load",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=$u(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=K(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,R(o.weights)),a.push.apply(a,R(o.paths))}}catch(aH){i.e(aH)}finally{i.f()}var s=this.checkManifestAndWeightFiles(e),u=a.map((function(e){return n.loadWeightsFile(e,s[e])}));return Promise.all(u).then((function(e){return[r,Zu(e)]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return Yu(e.name)})),i={},o=K(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=Yu(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(aH){o.e(aH)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function Pl(e){return new zl(e)}function Bl(e,t,n,r){!function(e){wr(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){wr(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),wr(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),wr(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function Vl(e,t){return Wl.apply(this,arguments)}function Wl(){return(Wl=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?na().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Bl(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,Bl(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return d=e.t1,e.abrupt("return",d);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ul(e){return jl.apply(this,arguments)}function jl(){return jl=mt(ft().mark((function e(t){var n,r,a,i,o=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Hl((function(e){return Vl(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),jl.apply(this,arguments)}function Hl(e){return function(){var t=mt(ft().mark((function t(n){var r,a,i,o,s,u,c,l,d,p,h,f,v=arguments;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=Bu[r]*Nr(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),d=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;d.push(t)}))})),t.next=15,e(d);case 15:return p=t.sent,h={},f=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=p[f+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(p[f+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=ju(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),f+=t})),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}ac.registerSaveRouter((function(e){return na().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ml.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Ml(e)}(e.slice(Ml.URL_SCHEME.length)):null}));var Gl=function(){function e(t,n){if(A(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(wr("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=na().platform.fetch,wr(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&wr(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return L(e,[{key:"save",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=Qu(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=10,this.fetch(this.path,n);case 10:if(!(i=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:tc(t),responses:[i]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",$u(n,(function(e){return o.loadWeights(e)})));case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o,s,u,c,l,d,p,h,f,v,m,g;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=ql(n),a=H(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=nc(t),c=[],l=[],d=K(t);try{for(d.s();!(p=d.n()).done;){h=p.value,f=K(h.paths);try{for(f.s();!(v=f.n()).done;)m=v.value,null!=this.weightUrlConverter?l.push(this.weightUrlConverter(m)):c.push(s+m+o)}catch(aH){f.e(aH)}finally{f.f()}}}catch(aH){d.e(aH)}finally{d.f()}if(!this.weightUrlConverter){e.next=17;break}return e.t0=c.push,e.t1=c,e.t2=R,e.next=14,Promise.all(l);case 14:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 17:return e.next=19,Vl(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return g=e.sent,e.abrupt("return",[u,Zu(g)]);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function ql(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Kl(e){return null!=e.match(Gl.URL_SCHEME_REGEX)}Gl.URL_SCHEME_REGEX=/^https?:\/\//;var Xl=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Kl(e)})):Kl(e))?Zl(e,t):null};function Zl(e,t){return new Gl(e,t)}function Yl(e,t){return Zl(e,t)}ac.registerSaveRouter(Xl),ac.registerLoadRouter(Xl);var Ql,Jl=function(){function e(t){A(this,e),this.modelArtifacts=t}return L(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),$l=function(){function e(t){A(this,e),this.saveHandler=t}return L(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),ed=L((function e(t){A(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function td(e,t,n,r){var a=arguments;return new ed(nd.apply(void 0,R(a)))}function nd(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Jl(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jl({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jl({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function rd(e){return new $l(e)}function ad(e){return new $l(e)}function id(e,t,n){if(Sr(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=_u(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return zu(e,t,r,n)}function od(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(null!=ys(ls,Su.backendName)){var u={pixels:e},c={numChannels:t};return Su.runKernel(ls,u,c)}var l,d,p=H(a?[e.videoWidth,e.videoHeight]:[e.width,e.height],2),h=p[0],f=p[1];if(o)l=e.getContext("2d").getImageData(0,0,h,f).data;else if(r||n)l=e.data;else if(i||a||s){if(null==Ql)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Ql=new OffscreenCanvas(1,1).getContext("2d")}else Ql=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ql.canvas.width=h,Ql.canvas.height=f,Ql.drawImage(e,0,0,h,f),l=Ql.getImageData(0,0,h,f).data}if(4===t)d=new Int32Array(l);else{var v=h*f;d=new Int32Array(v*t);for(var m=0;m<v;m++)for(var g=0;g<t;++g)d[m*t+g]=l[4*m+g]}return id(d,[f,h,t],"int32")}var sd=Lu({fromPixels_:od}),ud=-2,cd=-1;function ld(e,t,n){var r=e.shape.length;wr(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),wr(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){wr(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function dd(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function pd(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function hd(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function fd(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(R(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){wr(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(R(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(wr(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function vd(e,t,n,r,a,i,o,s,u){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},p=0;p<d.dims;p++)l&&0!==(1<<p&s)&&d.numAddAxisAfterEllipsis++,1<<p&o&&(l=!0);l||(d.ellipsisMask|=1<<d.dims,d.dims++);var h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(ud),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(cd),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);for(var f=!0,v=!0,m=!0,g=[],y=[],b=0;b<e.length;++b){if(0===h.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var x=!!(h.shrinkAxisMask&1<<b),k=e[b];if(-1!==k){var w=[h.beginMask&1<<b,h.endMask&1<<b],C=[h.strides[b]>0?0:-1,h.strides[b]>0?k:k-1];if(x&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[b];var S=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(x){var N=h.begin[b]<0?k+h.begin[b]:h.begin[b];if(h.begin[b]=N,h.end[b]=h.begin[b]+1,N<0||N>=k)throw Error("slice index ".concat(h.begin[b]," of dimension ").concat(b," out of bounds."))}else h.begin[b]=md(h.begin[b],0,h.strides[b],k,w,C),h.end[b]=md(h.end[b],1,h.strides[b],k,w,C);var I=1===h.strides[b]&&0===h.begin[b]&&h.end[b]===k;f=f&&I,v=v&&(0===b&&1===h.strides[b]||I)}else f=f&&1===h.strides[b]&&S,v=v&&(0===b&&1===h.strides[b]||S);var T=void 0,E=!1;if(h.beginValid&&h.endValid?(T=h.end[b]-h.begin[b],E=!0):x?(T=1,E=!0):S&&k>=0&&(T=h.strides[b]<0?-k:k,E=!0),E){var _=void 0;_=0===T||T<0!==h.strides[b]<0?0:Math.trunc(T/h.strides[b])+(T%h.strides[b]!==0?1:0),g.push(_)}else g.push(-1)}else g.push(x?1:-1)}for(var R=0;R<h.finalShapeGatherIndices.length;++R){var A=h.finalShapeGatherIndices[R];A>=0?y.push(g[A]):A===ud&&y.push(1)}var O=y.filter((function(e,t){return h.finalShapeGatherIndices[t]!==ud}));return{finalShapeSparse:O,finalShape:y,isIdentity:f,sliceDim0:v,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function md(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}var gd=Lu({acos_:function(e){var t={x:Ou(e,"x","acos")};return Su.runKernel(ua,t)}});var yd=Lu({acosh_:function(e){var t={x:Ou(e,"x","acosh")};return Su.runKernel(ca,t)}});var bd=Lu({addN_:function(e){wr(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),wr(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return Ou(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!Ir(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return Su.runKernel(da,r)}});var xd=Lu({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:Ou(e,"x","all","bool")},a={axis:t,keepDims:n};return Su.runKernel(pa,r,a)}});var kd=Lu({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:Ou(e,"x","any","bool")},a={axis:t,keepDims:n};return Su.runKernel(ha,r,a)}});var wd=Lu({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ou(e,"x","argMax")},r={axis:t};return Su.runKernel(fa,n,r)}});var Cd=Lu({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ou(e,"x","argMin")},r={axis:t};return Su.runKernel(va,n,r)}});var Sd=Lu({asin_:function(e){var t={x:Ou(e,"x","asin")};return Su.runKernel(ma,t)}});var Nd=Lu({asinh_:function(e){var t={x:Ou(e,"x","asinh")};return Su.runKernel(ga,t)}});var Id=Lu({atan_:function(e){var t={x:Ou(e,"x","atan")};return Su.runKernel(ya,t)}});var Td=Lu({atan2_:function(e,t){var n=Ou(e,"a","atan2"),r=Ou(t,"b","atan2"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(xa,i)}});var Ed=Lu({atanh_:function(e){var t={x:Ou(e,"x","atanh")};return Su.runKernel(ba,t)}});function _d(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3];return Od(e,[].concat(R(t),[o]),n,i,r,null,null,Ud(a))}function Rd(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=H(Ld(t),2),c=u[0],l=u[1];if("channelsLast"===s)o=[c,l,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[c,l,e[1],e[1]]}return Od(e,o,n,r,a,i,!1,s)}function Ad(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=H(Md(t),3),l=c[0],d=c[1],p=c[2];if("NDHWC"===u)s="channelsLast",o=[l,d,p,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[l,d,p,e[1],e[1]]}return Fd(e,o,n,r,a,!1,s,i)}function Od(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,l=-1,d=-1;if("channelsLast"===s){var p=H(e,4);u=p[0],c=p[1],l=p[2],d=p[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var h=H(e,4);u=h[0],d=h[1],c=h[2],l=h[3]}var f,v=H(t,4),m=v[0],g=v[1],y=v[3],b=H(Ld(n),2),x=b[0],k=b[1],w=H(Ld(r),2),C=w[0],S=w[1],N=zd(m,C),I=zd(g,S),T=function(e,t,n,r,a,i,o,s,u){var c,l,d;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var p=function(e,t,n,r,a){null==r&&(r=Dd(e,t,n));var i=e[0],o=e[1],s=Pd((i-t+2*r)/n+1,a),u=Pd((o-t+2*r)/n+1,a);return[s,u]}([t,n],i,r,e,s);l=p[0],d=p[1]}else if("same"===e){l=Math.ceil(t/r),d=Math.ceil(n/a);var h=Math.max(0,(l-1)*r+i-t),f=Math.max(0,(d-1)*a+o-n),v=Math.floor(h/2),m=h-v,g=Math.floor(f/2);c={top:v,bottom:m,left:g,right:f-g,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],x="channelsLast"===u?e[2][0]:e[3][0],k="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:x,right:k,type:0===y&&0===b&&0===x&&0===k?"VALID":"EXPLICIT"},l=Pd((t-i+y+b)/r+1,s),d=Pd((n-o+x+k)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:d}}(a,c,l,x,k,N,I,i,s),E=T.padInfo,_=T.outHeight,R=T.outWidth,A=o?y*d:y;return"channelsFirst"===s?f=[u,A,_,R]:"channelsLast"===s&&(f=[u,_,R,A]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:d,outHeight:_,outWidth:R,outChannels:A,padInfo:E,strideHeight:x,strideWidth:k,filterHeight:m,filterWidth:g,effectiveFilterHeight:N,effectiveFilterWidth:I,dilationHeight:C,dilationWidth:S,inShape:e,outShape:f,filterShape:t}}function Fd(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,l=-1,d=-1,p=-1;if("channelsLast"===o){var h=H(e,5);u=h[0],c=h[1],l=h[2],d=h[3],p=h[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var f=H(e,5);u=f[0],p=f[1],c=f[2],l=f[3],d=f[4]}var v,m=H(t,5),g=m[0],y=m[1],b=m[2],x=m[4],k=H(Md(n),3),w=k[0],C=k[1],S=k[2],N=H(Md(r),3),I=N[0],T=N[1],E=N[2],_=zd(g,I),R=zd(y,T),A=zd(b,E),O=function(e,t,n,r,a,i,o,s,u,c,l){var d,p,h,f;"valid"===e&&(e=0);if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=Dd(e,t[0],r[0]));for(var o=[0,0,0,n],s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=Pd((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,u,c],1,[a,i,o],e,l);p=v[0],h=v[1],f=v[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var m=((p=Math.ceil(t/a))-1)*a+s-t,g=((h=Math.ceil(n/i))-1)*i+u-n,y=((f=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(m/2),x=m-b,k=Math.floor(g/2),w=g-k,C=Math.floor(y/2);d={top:k,bottom:w,left:C,right:y-C,front:b,back:x,type:"SAME"}}return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}(a,c,l,d,w,C,S,_,R,A,s),F=O.padInfo,D=O.outDepth,L=O.outHeight,M=O.outWidth,z=i?x*p:x;return"channelsFirst"===o?v=[u,z,D,L,M]:"channelsLast"===o&&(v=[u,D,L,M,z]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:d,inChannels:p,outDepth:D,outHeight:L,outWidth:M,outChannels:z,padInfo:F,strideDepth:w,strideHeight:C,strideWidth:S,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:_,effectiveFilterHeight:R,effectiveFilterWidth:A,dilationDepth:I,dilationHeight:T,dilationWidth:E,inShape:e,outShape:v,filterShape:t}}function Dd(e,t,n){var r=zd(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function Ld(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Md(e){return"number"===typeof e?[e,e,e]:e}function zd(e,t){return t<=1?e:e+(e-1)*(t-1)}function Pd(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Bd(e){var t=H(Ld(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function Vd(e,t){return Bd(e)||Bd(t)}function Wd(e){return Ld(e).every((function(e){return e>0}))}function Ud(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function jd(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)wr(Tr(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){wr(Tr(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}var Hd=Lu({reshape_:function(e,t){var n={x:Ou(e,"x","reshape","string_or_numeric")},r={shape:t};return Su.runKernel(go,n,r)}});var Gd=Lu({avgPool_:function(e,t,n,r,a){var i=Ou(e,"x","avgPool","float32");wr(Vd(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=Hd(i,[1,i.shape[0],i.shape[1],i.shape[2]])),wr(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),jd("avgPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=Su.runKernel(ka,u,c);return l=Xc(l,i.dtype),s?Hd(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var qd=Lu({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=Ou(e,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),wr(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),wr("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),wr("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),jd("avgPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=Su.runKernel(Ca,c,l);return d=Xc(d,s.dtype),u?Hd(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Kd=Lu({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;wr(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Fu(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Zc(n[0]);var r=n,a={axis:t};return Su.runKernel(Da,r,a)}});var Xd=Lu({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ou(e,"a","matMul"),i=Ou(t,"b","matMul"),o=H(vu(a,i),2),s={a:a=o[0],b:i=o[1]},u={transposeA:n,transposeB:r};return Su.runKernel(Na,s,u)}});var Zd=Lu({sigmoid_:function(e){var t={x:Ou(e,"x","sigmoid","float32")};return Su.runKernel(Do,t)}});var Yd=Lu({slice_:function(e,t,n){var r=Ou(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return Su.runKernel(Ro,a,i)}});var Qd=Lu({tanh_:function(e){var t={x:Ou(e,"x","tanh","float32")};return Su.runKernel(es,t)}});var Jd=Lu({basicLSTMCell_:function(e,t,n,r,a,i){var o=Ou(e,"forgetBias","basicLSTMCell"),s=Ou(t,"lstmKernel","basicLSTMCell"),u=Ou(n,"lstmBias","basicLSTMCell"),c=Ou(r,"data","basicLSTMCell"),l=Ou(a,"c","basicLSTMCell"),d=Ou(i,"h","basicLSTMCell"),p=Kd([c,d],1),h=Xd(p,s),f=rl(h,u),v=f.shape[0],m=f.shape[1]/4,g=[v,m],y=Yd(f,[0,0],g),b=Yd(f,[0,m],g),x=Yd(f,[0,2*m],g),k=Yd(f,[0,3*m],g),w=rl(ol(Zd(y),Qd(b)),ol(l,Zd(rl(o,x))));return[w,ol(Qd(w),Zd(k))]}});var $d=Lu({batchToSpaceND_:function(e,t,n){var r=Ou(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));wr(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),wr(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),wr(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return Su.runKernel(Ia,i,o)}});var ep=Lu({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=Ou(e,"x","batchNorm"),c=Ou(t,"mean","batchNorm"),l=Ou(n,"variance","batchNorm");null!=a&&(o=Ou(a,"scale","batchNorm")),null!=r&&(s=Ou(r,"offset","batchNorm")),wr(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),wr(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),wr(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var d={x:function(e){return 0===e.rank||1===e.rank?Hd(e,[1,1,1,e.size]):2===e.rank?Hd(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Hd(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),scale:o,offset:s,mean:c,variance:l},p={varianceEpsilon:i},h=Su.runKernel(vi,d,p);return Hd(h,u.shape)}});var tp=Lu({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=Ou(e,"x","batchNorm"),c=Ou(t,"mean","batchNorm"),l=Ou(n,"variance","batchNorm");return null!=a&&(o=Ou(a,"scale","batchNorm")),null!=r&&(s=Ou(r,"offset","batchNorm")),wr(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),wr(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),wr(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&wr(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&wr(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),ep(u,c,l,s,o,i)}});var np=Lu({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=Ou(e,"x","batchNorm"),c=Ou(t,"mean","batchNorm"),l=Ou(n,"variance","batchNorm");return null!=a&&(o=Ou(a,"scale","batchNorm")),null!=r&&(s=Ou(r,"offset","batchNorm")),wr(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),wr(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),wr(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&wr(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&wr(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),ep(u,c,l,s,o,i)}});var rp=Lu({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=Ou(e,"x","batchNorm"),c=Ou(t,"mean","batchNorm"),l=Ou(n,"variance","batchNorm");return null!=a&&(o=Ou(a,"scale","batchNorm")),null!=r&&(s=Ou(r,"offset","batchNorm")),wr(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),wr(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),wr(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&wr(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&wr(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),ep(u,c,l,s,o,i)}});var ap=Lu({bincount_:function(e,t,n){var r=Ou(e,"x","bincount"),a=Ou(t,"weights","bincount");wr("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),wr(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),wr(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return Su.runKernel(Ta,i,o)}});var ip=Lu({broadcastArgs_:function(e,t){var n=Ou(e,"s0","broadcastArgs","int32"),r=Ou(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var a={s0:n,s1:r};return Su.runKernel(Ea,a)}});var op=Lu({broadcastTo_:function(e,t){var n=Ou(e,"broadcastTo","x"),r=n.shape;if(Zr(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=Hd(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return Zc(n);var u={x:n},c={reps:o};return Su.runKernel(ts,u,c)}});var sp=Lu({ceil_:function(e){var t={x:Ou(e,"x","ceil","float32")};return Su.runKernel(Ra,t)}});var up=Lu({clipByValue_:function(e,t,n){var r=Ou(e,"x","clipByValue");if(wr(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return gl(r.shape,t,r.dtype);var a={x:r},i={clipValueMin:t,clipValueMax:n};return Su.runKernel(Aa,a,i)}});var cp=Lu({concat1d_:function(e){return Kd(e,0)}});var lp=Lu({concat2d_:function(e,t){return Kd(e,t)}});var dp=Lu({concat3d_:function(e,t){return Kd(e,t)}});var pp=Lu({concat4d_:function(e,t){return Kd(e,t)}});var hp=Lu({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Ou(e,"x","conv2d","float32"),u=Ou(t,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2]])),wr(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),wr(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),jd("conv2d",r,o);var d="NHWC"===a?c.shape[3]:c.shape[1];wr(d===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(d,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),wr(Vd(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),wr(Wd(i),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),wr(Wd(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var p={x:c,filter:u},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=Su.runKernel(La,p,h);return l?Hd(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var fp=Lu({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=Ou(e,"x","conv1d"),u=Ou(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=Hd(s,[1,s.shape[0],s.shape[1]])),wr(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),wr(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),jd("conv1d",r,o),wr(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),wr(Vd(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),wr(Wd(i),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),wr(Wd(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),wr("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var d=Hd(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=Hd(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h=hp(p,d,[1,n],r,"NHWC",[1,i],o);return Hd(h,l?[h.shape[2],h.shape[3]]:[h.shape[0],h.shape[2],h.shape[3]])}});var vp=Lu({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;wr(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),wr(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),wr(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),wr(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],d="NHWC"===i?u.shape[3]:u.shape[1];wr(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),wr(d===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(d,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),jd("conv2dDerInput",a,o);var p={dy:u,filter:n},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},f=Su.runKernel(za,p,h);return c?Hd(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var mp=Lu({conv2dTranspose_:function(e,t,n,r,a,i){var o=Ou(e,"x","conv2dTranspose"),s=Ou(t,"filter","conv2dTranspose");return vp(n,o,s,r,a,"NHWC",i)}});var gp=Lu({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=Ou(e,"x","conv3d"),s=Ou(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),wr(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),wr(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),wr(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),wr(Vd(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),wr("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),wr(Wd(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),wr(Wd(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:i},p=Su.runKernel(Pa,l,d);return c?Hd(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var yp=Lu({conv3DBackpropInput_:function(e,t,n,r,a){wr(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];wr(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),wr(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),wr(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),wr(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),wr(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},d={pad:a,strides:r,inputShape:i},p=Su.runKernel(Va,l,d);return s?Hd(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var bp=Lu({conv3dTranspose_:function(e,t,n,r,a){var i=Ou(e,"x","conv3dTranspose"),o=Ou(t,"filter","conv3dTranspose");return yp(n,i,o,r,a)}});var xp=Lu({cos_:function(e){var t={x:Ou(e,"x","cos","float32")};return Su.runKernel(Wa,t)}});var kp=Lu({cosh_:function(e){var t={x:Ou(e,"x","cosh","float32")};return Su.runKernel(Ua,t)}});var wp=Lu({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:Ou(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return Su.runKernel(ja,a,i)}});var Cp=Lu({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:Ou(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return Su.runKernel(Ha,a,i)}});var Sp=Lu({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ou(e,"x","denseBincount"),i=Ou(t,"weights","denseBincount");wr("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),wr(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),wr(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),wr(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},s={size:n,binaryOutput:r};return Su.runKernel(qa,o,s)}});var Np=Lu({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=Ou(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];wr(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),wr(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),wr(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),wr(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return Su.runKernel(Ka,s,u)}});var Ip=Lu({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Ou(e,"x","depthwiseConv2d","float32"),u=Ou(t,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2]])),wr(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),wr(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var d="NHWC"===a?c.shape[3]:c.shape[1];wr(d===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(d,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),jd("depthwiseConv2d",r,o);var p={x:c,filter:u},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=Su.runKernel(Xa,p,h);return l?Hd(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var Tp=Lu({diag_:function(e){var t={x:Ou(e,"x","diag")};return Su.runKernel(Qa,t)}});var Ep=Lu({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=Ou(e,"x","dilation2d"),s=Ou(t,"filter","dilation2d");wr(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),wr(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),wr("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,c=!1;3===o.rank&&(u=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),wr(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},d={strides:n,pad:r,dilations:a},p=Su.runKernel(Ja,l,d);return c?Hd(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var _p=Lu({equal_:function(e,t){var n=Ou(e,"a","equal","string_or_numeric"),r=Ou(t,"b","equal","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(oi,i)}});var Rp=Lu({where_:function(e,t,n){var r=Ou(t,"a","where"),a=Ou(n,"b","where"),i=Ou(e,"condition","where","bool"),o=Nl(Nl(i.shape,r.shape),a.shape),s={condition:op(i,o),t:op(r,o),e:op(a,o)};return Su.runKernel(Eo,s)}});var Ap=Lu({divNoNan_:function(e,t){var n=Ou(e,"a","div"),r=Ou(t,"b","div"),a=H(vu(n,r),2);n=a[0],r=a[1];var i=il(n,r),o=cl(i),s=_p(r,o);return Rp(s,o,i)}});var Op=Lu({dot_:function(e,t){var n=Ou(e,"t1","dot"),r=Ou(t,"t2","dot");wr((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(wr(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=Hd(n,[1,-1]),s=Hd(r,[-1,1]),u=Xd(o,s);return Hd(u,[])}if(1===n.rank&&2===r.rank){var c=Hd(n,[1,-1]),l=Hd(r,[r.shape[0],r.shape[1]]),d=Xd(c,l);return Hd(d,[d.size])}if(2===n.rank&&1===r.rank){var p=Hd(r,[-1,1]),h=Xd(n,p);return Hd(h,[h.size])}var f=Hd(r,[r.shape[0],r.shape[1]]);return Xd(n,f)}});var Fp=Lu({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map((function(e,t){return Ou(e,"tensors".concat(t),"einsum")})),i={equation:e};return Su.runKernel(ni,a,i)}});var Dp=Lu({elu_:function(e){var t={x:Ou(e,"x","elu","float32")};return Su.runKernel(ri,t)}});var Lp=Lu({erf_:function(e){var t=Ou(e,"x","erf");wr("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Xc(t,"float32"));var n={x:t};return Su.runKernel(ii,n)}});function Mp(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function zp(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function Pp(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function Bp(e,t,n){wr(Mp(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function Vp(e,t){if(Mp(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Wp(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Up(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var jp=Lu({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:Ou(e,"x","max")},a={reductionIndices:t,keepDims:n};return Su.runKernel(zi,r,a)}});var Hp=Lu({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:Ou(e,"x","min")},a={axis:t,keepDims:n};return Su.runKernel(Gi,r,a)}});var Gp=Lu({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ou(e,"x","sum");"bool"===r.dtype&&(r=Xc(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return Su.runKernel(zo,a,i)}});function qp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return wl(e);if(1!==e.rank&&null===n)return qp(Hd(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Gp(wl(e),n);if(t===1/0)return jp(wl(e),n);if(t===-1/0)return Hp(wl(e),n);if("euclidean"===t||2===t)return sl(Gp(bl(wl(e),dl(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return jp(Gp(wl(e),n[0]),n[1]-1);if(t===1/0)return jp(Gp(wl(e),n[1]),n[0]);if(t===-1/0)return Hp(Gp(wl(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return sl(Gp(ul(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Kp=Lu({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=qp(e=Ou(e,"x","norm"),t,n),i=a.shape;if(r){var o=Or(n,e.shape);i=Pp(a.shape,o)}return Hd(a,i)}});var Xp=Lu({euclideanNorm_:function(e){return Kp(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});var Zp=Lu({exp_:function(e){var t={x:Ou(e,"x","exp")};return Su.runKernel(si,t)}});var Yp=Lu({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ou(e,"x","expandDims","string_or_numeric");wr(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return Su.runKernel(ui,r,a)}});var Qp=Lu({expm1_:function(e){var t={x:Ou(e,"x","expm1")};return Su.runKernel(ci,t)}});var Jp=Lu({tile_:function(e,t){var n=Ou(e,"x","tile","string_or_numeric");wr(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return Su.runKernel(ts,r,a)}});var $p=Lu({eye_:function(e,t,n){null==t&&(t=e);for(var r=Kc([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t,i=0;i<a;++i)r.set(1,i,i);var o=Hd(r.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return Jp(Yp(o,0),[n[0],1,1]);if(2===n.length)return Jp(Yp(Yp(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return Jp(Yp(Yp(Yp(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var eh=Lu({floor_:function(e){var t={x:Ou(e,"x","floor","float32")};return Su.runKernel(hi,t)}});var th=Lu({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a={x:Ou(e,"x","gather"),indices:Ou(t,"indices","gather","int32")},i={axis:n,batchDims:r};return Su.runKernel(mi,a,i)}});var nh=Lu({greater_:function(e,t){var n=Ou(e,"a","greater","string_or_numeric"),r=Ou(t,"b","greater","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(yi,i)}});var rh=Lu({greaterEqual_:function(e,t){var n=Ou(e,"a","greaterEqual","string_or_numeric"),r=Ou(t,"b","greaterEqual","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(bi,i)}});var ah=Lu({imag_:function(e){var t={input:Ou(e,"input","imag")};return Su.runKernel(wi,t)}});var ih=Lu({isFinite_:function(e){var t={x:Ou(e,"x","isFinite")};return Su.runKernel(Ci,t)}});var oh=Lu({isInf_:function(e){var t={x:Ou(e,"x","isInf")};return Su.runKernel(Si,t)}});var sh=Lu({isNaN_:function(e){var t={x:Ou(e,"x","isNaN")};return Su.runKernel(Ni,t)}});var uh=Lu({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:Ou(e,"x","leakyRelu")},r={alpha:t};return Su.runKernel(Ii,n,r)}});var ch=Lu({less_:function(e,t){var n=Ou(e,"a","less","string_or_numeric"),r=Ou(t,"b","less","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(Ti,i)}});var lh=Lu({lessEqual_:function(e,t){var n=Ou(e,"a","lessEqual","string_or_numeric"),r=Ou(t,"b","lessEqual","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(Ei,i)}});function dh(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return Su.runKernel(_i,{},r)}var ph=Lu({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=Ou(e,"x","localResponseNormalization");wr(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),wr(Tr(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=Hd(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=Su.runKernel(Li,u,c);return s?Hd(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var hh=Lu({log_:function(e){var t={x:Ou(e,"x","log","float32")};return Su.runKernel(Ri,t)}});var fh=Lu({log1p_:function(e){var t={x:Ou(e,"x","log1p")};return Su.runKernel(Ai,t)}});var vh=Lu({neg_:function(e){var t={x:Ou(e,"x","neg")};return Su.runKernel(Qi,t)}});var mh=Lu({softplus_:function(e){var t={x:Ou(e,"x","softplus")};return Su.runKernel(Lo,t)}});var gh=Lu({logSigmoid_:function(e){var t=Ou(e,"x","logSigmoid");return ll((function(e){return{value:vh(mh(vh(e))),gradFunc:function(t){return ol(t,Zd(vh(e)))}}}))(t)}});var yh=Lu({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Ou(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=ll((function(e,n){var r=jp(e,t,!0),a=xl(e,r),i=xl(Xc(a,"float32"),hh(Gp(Zp(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=H(n,1)[0],a=Zp(r);return xl(e,ol(Gp(e,t,!0),a))}}}));return r(n)}});var bh=Lu({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ou(e,"x","logSumExp"),a=Or(t,r.shape),i=jp(r,a,!0),o=xl(r,i),s=Zp(o),u=Gp(s,a),c=hh(u),l=rl(Hd(i,c.shape),c);if(n){var d=Pp(l.shape,a);return Hd(l,d)}return l}});var xh=Lu({logicalAnd_:function(e,t){var n=Ou(e,"a","logicalAnd","bool"),r=Ou(t,"b","logicalAnd","bool");Nl(n.shape,r.shape);var a={a:n,b:r};return Su.runKernel(Oi,a)}});var kh=Lu({logicalNot_:function(e){var t={x:Ou(e,"x","logicalNot","bool")};return Su.runKernel(Fi,t)}});var wh=Lu({logicalOr_:function(e,t){var n=Ou(e,"a","logicalOr","bool"),r=Ou(t,"b","logicalOr","bool");Nl(n.shape,r.shape);var a={a:n,b:r};return Su.runKernel(Di,a)}});var Ch=Lu({logicalXor_:function(e,t){var n=Ou(e,"a","logicalXor","bool"),r=Ou(t,"b","logicalXor","bool");return Nl(n.shape,r.shape),xh(wh(e,t),kh(xh(e,t)))}}),Sh=2147483648;var Nh=Lu({searchSorted_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",r=Ou(e,"sortedSequence","searchSorted"),a=Ou(t,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=Hd(r,[-1,i]),u=Hd(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Nr(u.shape)>=Sh)throw new Error("values tensor size must less than ".concat(Sh));if(s.shape[1]>=Sh)throw new Error("trailing dim_size must less than ".concat(Sh," for int32 output type, was ").concat(s.shape[1]));var c={sortedSequence:s,values:u},l={side:n};return Su.runKernel(To,c,l)}});function Ih(e,t){return Nh(e,t,"left")}var Th=Lu({maxPool_:function(e,t,n,r,a){var i=Ou(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=Hd(i,[1,i.shape[0],i.shape[1],i.shape[2]])),wr(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),wr(Vd(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),jd("maxPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=Su.runKernel(Bi,u,c);return s?Hd(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var Eh=Lu({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=Ou(e,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),wr(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),wr("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),jd("maxPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=Su.runKernel(Wi,c,l);return u?Hd(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var _h=Lu({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={x:Ou(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=Su.runKernel(ji,i,o);return{result:s[0],indexes:s[1]}}});var Rh=Lu({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:Ou(e,"x","mean")},a={axis:t,keepDims:n};return Su.runKernel(Hi,r,a)}});function Ah(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Zr(e),"complex64"===t){var n=Ah(e,"float32"),r=Ah(e,"float32");return Mu(n,r)}var a=Kr(Nr(e),t);return Su.makeTensor(a,e,t)}function Oh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Zr(e),"complex64"===t){var n=Oh(e,"float32"),r=Ah(e,"float32");return Mu(n,r)}var a=qr(Nr(e),t);return Su.makeTensor(a,e,t)}function Fh(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).indexing,r=void 0===n?"xy":n;if("xy"!==r&&"ij"!==r)throw new TypeError("".concat(r," is not a valid third argument to meshgrid"));if(void 0===e)return[];var a=Ou(e,"x","meshgrid",e instanceof au?e.dtype:"float32");if(void 0===t)return[a];var i=Ou(t,"y","meshgrid",t instanceof au?t.dtype:"float32"),o=Nr(a.shape),s=Nr(i.shape);return"xy"===r?(a=Hd(a,[1,-1]),i=Hd(i,[-1,1]),[Xd(Oh([s,1],a.dtype),a),Xd(i,Oh([1,o],i.dtype))]):(a=Hd(a,[-1,1]),i=Hd(i,[1,-1]),[Xd(a,Oh([1,s],a.dtype)),Xd(Oh([o,1],i.dtype),i)])}var Dh=Lu({minimum_:function(e,t){var n=Ou(e,"a","minimum"),r=Ou(t,"b","minimum"),a=H(vu(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Xc(n,"int32"),r=Xc(r,"int32")),Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(qi,i)}});var Lh=Lu({mirrorPad_:function(e,t,n){wr("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=Ou(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");wr(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){wr(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wr(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return Su.runKernel(Ki,u,s)}});var Mh=Lu({mod_:function(e,t){var n=Ou(e,"a","mod"),r=Ou(t,"b","mod"),a=H(vu(n,r),2),i={a:n=a[0],b:r=a[1]};return Su.runKernel(Xi,i)}});var zh=Lu({moments_:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Or(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=Ou(e,"x","moments")).shape),r=Rh(e,n,t),a=r.shape;t||(a=Pp(r.shape,n));var i=ul(xl(Xc(e,"float32"),Hd(r,a)));return{mean:r,variance:Rh(i,n,t)}}});var Ph=Lu({multiRNNCell_:function(e,t,n,r){for(var a=Ou(t,"data","multiRNNCell"),i=Fu(n,"c","multiRNNCell"),o=Fu(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}for(var d=[],p=[],h=0;h<u.length;h+=2)d.push(u[h]),p.push(u[h+1]);return[d,p]}});var Bh=Lu({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ou(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s={logits:1===o?Hd(a,[1,-1]):a},u={numSamples:t,seed:n,normalized:r},c=Su.runKernel(Zi,s,u);return 1===o?Hd(c,[c.size]):c}});var Vh=Lu({notEqual_:function(e,t){var n=Ou(e,"a","notEqual","string_or_numeric"),r=Ou(t,"b","notEqual","string_or_numeric"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(Ji,i)}});var Wh=Lu({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var i={indices:Ou(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return Su.runKernel(ro,i,o)}});var Uh=Lu({onesLike_:function(e){var t={x:Ou(e,"x","onesLike")};return Su.runKernel(no,t)}});var jh=Lu({outerProduct_:function(e,t){var n=Ou(e,"v1","outerProduct"),r=Ou(t,"v2","outerProduct");wr(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=Hd(n,[-1,1]),i=Hd(r,[1,-1]);return Xd(a,i)}});var Hh=Lu({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Ou(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return Su.runKernel(io,i,a)}});var Gh=Lu({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wr(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Hh(e,[t],n)}});var qh=Lu({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wr(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Hh(e,t,n)}});var Kh=Lu({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wr(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Hh(e,t,n)}});var Xh=Lu({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wr(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Hh(e,t,n)}});var Zh=Lu({spaceToBatchND_:function(e,t,n){var r=Ou(e,"x","spaceToBatchND");wr(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),wr(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),wr(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return Su.runKernel(Po,a,i)}});var Yh=Lu({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var s=Ou(e,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2]])),wr(Vd(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var l,d=Rd(u.shape,t,i,a,r),p=[d.dilationHeight,d.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})),r=n.map((function(e){return e-1})),a=r.map((function(e){return Math.floor(e/2)})),i=r.map((function(e,t){return e-a[t]}));return r.map((function(e,t){return[a[t],i[t]]}))}([d.filterHeight,d.filterWidth],p):[[0,0],[0,0]];var h=1===p[0]&&1===p[1],f=H(function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([d.inHeight,d.inWidth],p,l),2),v=f[0],m=f[1],g=h?r:"valid",y=h?u:Zh(u,p,v),b=("avg"===n?function(){return Gd(y,t,i,g,o)}:function(){return Th(y,t,i,g,o)})(),x=h?b:$d(b,p,m);return c?Hd(x,[x.shape[1],x.shape[2],x.shape[3]]):x}});var Qh=Lu({prelu_:function(e,t){var n={x:Ou(e,"x","prelu"),alpha:Ou(t,"alpha","prelu")};return Su.runKernel(so,n)}});var Jh=Lu({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ou(e,"x","prod");"bool"===r.dtype&&(r=Xc(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return Su.runKernel(uo,a,i)}});var $h=Lu({raggedGather_:function(e,t,n,r){var a={paramsNestedSplits:e.map((function(e,t){return Ou(e,"tensors".concat(t),"raggedGather","int32")})),paramsDenseValues:Ou(t,"paramsDenseValues","raggedGather"),indices:Ou(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=Su.runKernel(co,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});var ef=Lu({raggedRange_:function(e,t,n){var r=Ou(e,"starts","raggedRange"),a={starts:r,limits:Ou(t,"limits","raggedRange",r.dtype),deltas:Ou(n,"deltas","raggedRange",r.dtype)},i=Su.runKernel(lo,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});var tf=Lu({raggedTensorToTensor_:function(e,t,n,r,a){var i=Ou(e,"shape","raggedTensorToTensor","int32"),o=Ou(t,"values","raggedTensorToTensor"),s={shape:i,values:o,defaultValue:Ou(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(e,t){return Ou(e,"tensors".concat(t),"raggedTensorToTensor","int32")}))},u={rowPartitionTypes:a};return Su.runKernel(po,s,u)}});var nf=Lu({rand_:function(e,t,n){Zr(e);var r=Nr(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return Su.makeTensor(a,e,n)}}),rf=n(6699),af=function(){function e(t,n,r,a,i){A(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=rf.alea(o.toString())}return L(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),of=function(){function e(t,n,r,a){A(this,e),this.alpha=t,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=rf.alea(i.toString()),this.randn=new af(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return L(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),sf=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(A(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=rf.alea(i)}return L(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var uf=Lu({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(Zr(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new of(t,n,r,a),o=Kc(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var cf=Lu({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(Zr(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new af(t,n,r,!1,a),o=Kc(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var lf=Lu({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return cf(e,0,1,t,n)}});var df=Lu({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;Zr(e);for(var i=Kc(e,r),o=new sf(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});function pf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return Su.runKernel(ho,{},a)}var hf=Lu({real_:function(e){var t={input:Ou(e,"input","real")};return Su.runKernel(fo,t)}});var ff=Lu({reciprocal_:function(e){var t={x:Ou(e,"x","reciprocal")};return Su.runKernel(vo,t)}});var vf=Lu({relu_:function(e){var t={x:Ou(e,"x","relu")};return Su.runKernel(mo,t)}});var mf=Lu({relu6_:function(e){var t={x:Ou(e,"x","relu6")};return Su.runKernel(wo,t)}});var gf=Lu({reverse_:function(e,t){var n={x:Ou(e,"x","reverse")},r={dims:t};return Su.runKernel(Co,n,r)}});var yf=Lu({reverse1d_:function(e){var t=Ou(e,"x","reverse");return wr(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),gf(t,0)}});var bf=Lu({reverse2d_:function(e,t){var n=Ou(e,"x","reverse");return wr(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),gf(n,t)}});var xf=Lu({reverse3d_:function(e,t){var n=Ou(e,"x","reverse");return wr(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),gf(n,t)}});var kf=Lu({reverse4d_:function(e,t){var n=Ou(e,"x","reverse");return wr(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),gf(n,t)}});var wf=Lu({round_:function(e){var t={x:Ou(e,"x","round")};return Su.runKernel(So,t)}});var Cf=Lu({rsqrt_:function(e){var t={x:Ou(e,"x","rsqrt","float32")};return Su.runKernel(No,t)}});var Sf=Lu({selu_:function(e){var t={x:Ou(e,"x","selu")};return Su.runKernel(_o,t)}});var Nf=Lu({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=Ou(e,"x","separableConv2d"),u=Ou(t,"depthwiseFilter","separableConv2d"),c=Ou(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(3===s.rank&&(d=!0,l=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");wr(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),wr(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),wr(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),wr(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),wr(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var p=u.shape[2],h=u.shape[3];wr(c.shape[2]===p*h,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(p*h,", ")+"but got ".concat(c.shape[2],".")}));var f=Ip(l,u,r,a,o,i),v=hp(f,c,1,"valid",o);return d?Hd(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});function If(){return If=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p,h;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ou(t,"x","setdiff1d"),a=Ou(n,"y","setdiff1d"),wr(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),wr(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),wr(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return i=e.sent,e.next=10,a.data();case 10:for(o=e.sent,s=new Set(o),u=0,c=0;c<i.length;c++)s.has(i[c])||u++;for(l=new tu([u],r.dtype),d=new tu([u],"int32"),p=0,h=0;p<i.length;p++)s.has(i[p])||(l.values[h]=i[p],d.values[h]=p,h++);return e.abrupt("return",[l.toTensor(),d.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),If.apply(this,arguments)}var Tf=function(e,t){return If.apply(this,arguments)};var Ef=Lu({sign_:function(e){var t={x:Ou(e,"x","sign")};return Su.runKernel(Fo,t)}});var _f=Lu({sin_:function(e){var t={x:Ou(e,"x","sin","float32")};return Su.runKernel(Ao,t)}});var Rf=Lu({sinh_:function(e){var t={x:Ou(e,"x","sinh")};return Su.runKernel(Oo,t)}});var Af=Lu({slice1d_:function(e,t,n){var r=Ou(e,"x","slice1d");return wr(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Yd(r,[t],[n])}});var Of=Lu({slice2d_:function(e,t,n){var r=Ou(e,"x","slice2d");return wr(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Yd(r,t,n)}});var Ff=Lu({slice3d_:function(e,t,n){var r=Ou(e,"x","slice3d");return wr(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Yd(r,t,n)}});var Df=Lu({slice4d_:function(e,t,n){var r=Ou(e,"x","slice4d");return wr(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Yd(r,t,n)}});var Lf=Lu({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Ou(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return Su.runKernel(Vo,r,a)}});var Mf=Lu({fft_:function(e){wr("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return Su.runKernel(li,t)}});var zf=Lu({ifft_:function(e){wr("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return Su.runKernel(ki,t)}});var Pf=Lu({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=Hd(e,[r,n]);t=zf(a)}else{var i=[r,2*(n-1)],o=Hd(hf(e),[r,n]),s=Hd(ah(e),[r,n]),u=gf(Yd(o,[0,1],[r,n-2]),1),c=ol(gf(Yd(s,[0,1],[r,n-2]),1),dl(-1)),l=Kd([o,u],1),d=Kd([s,c],1),p=Hd(Mu(l,d),[i[0],i[1]]);t=zf(p)}if(t=hf(t),3===e.rank&&0!==e.shape[0]){var h=t,f=e.shape[0];t=Hd(t,[f,t.shape[0]/f,t.shape[1]]),h.dispose()}return t}});var Bf=Lu({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={x:Ou(e,"x","split")},a={numOrSizeSplits:t,axis:n};return Su.runKernel(Bo,r,a)}});var Vf=Lu({rfft_:function(e,t){wr("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=Yd(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=Kd([e,Ah(s)],e.shape.length-1),r=t}else n=e;var u=cl(n),c=Hd(Mu(n,u),[a,r]),l=Mf(c),d=Math.floor(r/2)+1,p=hf(l),h=ah(l),f=Bf(p,[d,r-d],p.shape.length-1),v=Bf(h,[d,r-d],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=d,Hd(Mu(f[0],v[0]),m)}});var Wf=Lu({squaredDifference_:function(e,t){var n=Ou(e,"a","squaredDifference"),r=Ou(t,"b","squaredDifference"),a=H(vu(n,r),2);n=a[0],r=a[1],Nl(n.shape,r.shape);var i={a:n,b:r};return Su.runKernel(qo,i,{})}});var Uf=Lu({squeeze_:function(e,t){var n=Ou(e,"x","squeeze","string_or_numeric");return Hd(n,Fr(n.shape,t).newShape)}});var jf=Lu({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Fu(e,"tensors","stack","string_or_numeric");wr(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&wr(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return Su.runKernel(ao,r,a)}});var Hf=Lu({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ou(e,"x","step")},r={alpha:t};return Su.runKernel(cs,n,r)}});var Gf=Lu({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c={x:Ou(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return Su.runKernel(Xo,c,l)}});var qf=Lu({tan_:function(e){var t={x:Ou(e,"x","tan","float32")};return Su.runKernel($o,t)}});function Kf(e,t){Sr(e);var n=_u(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return zu(e,null,n,t)}function Xf(e,t,n){if(Sr(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=_u(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return zu(e,t,r,n)}function Zf(e,t,n){if(Sr(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=_u(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return zu(e,t,r,n)}function Yf(e,t,n){if(Sr(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=_u(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return zu(e,t,r,n)}function Qf(e,t,n){if(Sr(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=_u(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return zu(e,t=t||r,r,n)}var Jf=Lu({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Ou(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=H(Su.runKernel(ns,i,o),2);return{values:s[0],indices:s[1]}}});var $f=Lu({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(Zr(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new af(t,n,r,!0,a),o=Kc(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var ev=Lu({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ou(e,"x","unique","string_or_numeric");wr(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=H(Su.runKernel(is,r,a),2);return{values:i[0],indices:i[1]}}});var tv=Lu({unsortedSegmentSum_:function(e,t,n){var r=Ou(e,"x","unsortedSegmentSum"),a=Ou(t,"segmentIds","unsortedSegmentSum","int32");wr(Tr(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return Su.runKernel(ss,i,o)}});var nv=Lu({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ou(e,"x","unstack","string_or_numeric");wr(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return Su.runKernel(os,r,a)}});function rv(e,t){return Nh(e,t,"right")}function av(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Su.makeVariable(e,t,n,r)}function iv(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=Kc(e,"int32"),i=Kc([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}function ov(){return(ov=mt(ft().mark((function e(t){var n,r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ou(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=iv(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var sv=function(e){return ov.apply(this,arguments)};function uv(){return(uv=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f,v,m;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=Ou(t,"tensor","boolMask"),i=Ou(n,"mask","boolMask","bool"),o=null==r?0:r,s=i.rank,u=a.shape,wr(s>0,(function(){return"mask cannot be scalar"})),Cr(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+s;l++)c*=u[l];return d=u.slice(0,o).concat([c],u.slice(o+s)),p=Hd(a,d),h=Hd(i,[-1]),e.next=14,sv(h);case 14:return f=e.sent,v=Uf(f,[1]),m=th(p,v,o),t!==a&&a.dispose(),n!==i&&i.dispose(),v.dispose(),p.dispose(),h.dispose(),f.dispose(),e.abrupt("return",m);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var cv=function(e,t,n){return uv.apply(this,arguments)};var lv=Lu({transpose_:function(e,t,n){var r=Ou(e,"x","transpose");if(null==t&&(t=r.shape.map((function(e,t){return t})).reverse()),wr(r.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){wr(e>=0&&e<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)}))})),r.rank<=1)return r.clone();var a={x:r},i={perm:t};return"complex64"===r.dtype?$c((function(){var e=hf(r),t=ah(r);return e=Su.runKernel(as,{x:e},i),t=Su.runKernel(as,{x:t},i),n&&(t=vh(t)),Mu(e,t)})):Su.runKernel(as,a,i)}});var dv=Lu({movingAverage_:function(e,t,n,r){var a,i,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=Ou(e,"v","movingAverage"),u=Ou(t,"x","movingAverage"),c=Ou(n,"decay","movingAverage");i=u,wr((a=s).dtype===i.dtype,(function(){return"The dtypes of the first(".concat(a.dtype,") and")+" second(".concat(i.dtype,") input must match")})),wr(Ir(s.shape,u.shape),(function(){return"Shape mismatch in v and x"}));var l=dl(1),d=xl(l,c),p=ol(xl(u,s),d);if(o){wr(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=Ou(r,"step","movingAverage");p=il(p,xl(l,bl(c,h)))}return rl(s,p)}});function pv(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}(n,t,e)}function hv(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:Nr(t.shape)/u,sliceSize:o,strides:[].concat(R(jr(n.slice(0,a))),[1]),outputSize:Nr(n)}}var fv=Lu({scatterND_:function(e,t,n){Zr(n);var r=Ou(e,"indices","scatterND","int32"),a=Ou(t,"updates","scatterND");pv(a,r,n);var i={indices:r,updates:a},o={shape:n};return Su.runKernel(Io,i,o)}});var vv=Lu({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Zr(n);var a=Ou(e,"sparseIndices","sparseToDense","int32"),i=Ou(t,"sparseValues","sparseToDense","string_or_numeric"),o=Ou(r,"defaultValue","sparseToDense",i.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o);var s={sparseIndices:a,sparseValues:i,defaultValue:o},u={outputShape:n};return Su.runKernel(Go,s,u)}});var mv=Lu({gatherND_:function(e,t){var n=Ou(t,"indices","gatherND","int32"),r={params:Ou(e,"x","gatherND","string_or_numeric"),indices:n};return Su.runKernel(gi,r)}});var gv=Lu({dropout_:function(e,t,n,r){var a=Ou(e,"x","dropout");if(wr("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),wr(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof au?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(Ir(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=il(eh(rl(df(i,0,1,"float32",r),o)),o);return ol(a,s)}});function yv(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function bv(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Kf(a,"float32")}function xv(){return xv=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p,h,f,v,m,g,y=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,a=Ou(t,"predictions","inTopK"),i=Ou(n,"targets","inTopK"),wr(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),wr(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),Cr(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],wr(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return s=e.sent,e.next=13,i.data();case 13:u=e.sent,c=s.length/o,l=o,d=Dr("bool",c),p=0;case 17:if(!(p<c)){e.next=35;break}for(h=p*l,f=s.subarray(h,h+l),v=[],m=0;m<f.length;m++)v.push({value:f[m],index:m});v.sort((function(e,t){return t.value-e.value})),d[p]=0,g=0;case 25:if(!(g<r)){e.next=32;break}if(v[g].index!==u[p]){e.next=29;break}return d[p]=1,e.abrupt("break",32);case 29:g++,e.next=25;break;case 32:p++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",Pu(d,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)}))),xv.apply(this,arguments)}var kv=function(e,t){return xv.apply(this,arguments)};var wv=Lu({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Hd(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2]])),wr(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),wr(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),wr(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];wr(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),wr(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),jd("conv2dDerFilter",a,o);var d={x:s,dy:u},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return Su.runKernel(Ma,d,p)}});function Cv(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return ol(e,Hf(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Sv(e,t){var n=t,r=Sl(e.shape,t.shape);return r.length>0&&(n=Gp(n,r)),Hd(n,e.shape)}function Nv(e,t,n,r){if("linear"===t)return e;if("relu"===t)return vf(e);if("elu"===t)return Dp(e);if("relu6"===t)return mf(e);if("prelu"===t)return Qh(e,n);if("leakyrelu"===t)return uh(e,r);if("sigmoid"===t)return Zd(e);throw new Error("Unknown fused activation ".concat(t,"."))}var Iv=function(e,t){return!(e>0)||"linear"===t};var Tv=Lu({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,p=void 0===d?"linear":d,h=e.preluActivationWeights,f=e.leakyreluAlpha;if(p=p||"linear",!1===Iv(Su.state.gradientDepth,p)){wr("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var v=hp(t,n,r,a,o,u,c);return null!=l&&(v=rl(v,l)),Nv(v,p,h,f)}var m=Ou(t,"x","conv2d","float32"),g=Ou(n,"filter","conv2d","float32"),y=m,b=!1;3===m.rank&&(b=!0,y=Hd(m,[1,m.shape[0],m.shape[1],m.shape[2]])),wr(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),wr(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),jd("fused conv2d",a,c);var x="NHWC"===o?y.shape[3]:y.shape[1];wr(g.shape[2]===x,(function(){return"Error in conv2d: depth of input (".concat(x,") must match ")+"input depth for filter ".concat(g.shape[2],".")})),wr(Vd(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")}));var k,w,C=Od(y.shape,g.shape,r,u,a,c);if(null!=l){var S=H(vu(k=Ou(l,"bias","fused conv2d"),m),1);k=S[0],"NHWC"===o?Nl(C.outShape,k.shape):(wr(k.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(k.shape.length,".")})),wr(0===k.shape.length||k.shape[0]===C.outChannels||1===k.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(k.shape,") is not ")+"compatible with the number of output channels "+"(".concat(C.outChannels,")")})))}if(null!=h){var N=h.shape;if(wr(N.length<=1||3===N.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(N.length,".")})),1===N.length)wr(1===N[0]||N[0]===C.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(N,") is not compatible with the number of output ")+"channels (".concat(C.outChannels,").")}));else if(3===N.length)try{Nl(N,C.outShape)}catch(O){var I="Error in fused conv2d: PReLU activation weights (".concat(N,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(C.outShape,").");throw Error(I)}w=Ou(h,"prelu weights","fused conv2d")}var T=function(e,t){wr("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=H(t,4),i=n[0],s=n[1],c=n[2],l=n[3],d=Cv(e,c,p);wr(Bd(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var h=[vp(s.shape,d,i,r,a),wv(s,d,i.shape,r,a)];if(null!=l){var f=Sv(l,d);h.push(f)}return h},E={x:y,filter:g,bias:k,preluActivationWeights:w},_={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:p,leakyreluAlpha:f};if(null==l){var R=ll((function(e,t,n){var r=Su.runKernel(hs,E,_);return n([t,e,r]),b&&(r=Hd(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:T}}));return R(y,g)}var A=ll((function(e,t,n,r){var a=Su.runKernel(hs,E,_);return r([t,e,a,n]),b&&(a=Hd(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:T}}));return A(y,g,k)}});var Ev=Lu({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Hd(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return Su.runKernel(Za,c,l)}});var _v=Lu({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},d=Su.runKernel(Ya,c,l);return u?Hd(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var Rv=Lu({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,p=void 0===d?"linear":d,h=e.preluActivationWeights,f=e.leakyreluAlpha;if(!1===Iv(Su.state.gradientDepth,p)){var v=Ip(t,n,r,a,o,u,c);return null!=l&&(v=rl(v,l)),Nv(v,p,h,f)}var m=Ou(t,"x","depthwiseConv2d","float32"),g=Ou(n,"filter","depthwiseConv2d","float32"),y=m,b=!1;3===m.rank&&(b=!0,y=Hd(m,[1,m.shape[0],m.shape[1],m.shape[2]])),wr(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),wr(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),wr(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==u&&(u=[1,1]),wr(Vd(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(u,"'")})),jd("fused depthwiseConv2d",a,c);var x,k,w=Od(y.shape,g.shape,r,u,a,c,!0);if(null!=l){var C=H(vu(x=Ou(l,"bias","fused conv2d"),m),1);x=C[0],Nl(w.outShape,x.shape)}null!=h&&(k=Ou(h,"prelu weights","fused depthwiseConv2d"));var S=function(e,t){wr(Bd(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var n=H(t,4),i=n[0],o=n[1],s=n[2],l=n[3],d=Cv(e,s,p),h=_v(o.shape,d,i,r,a,u,c),f=Ev(o,d,i.shape,r,a,u,c);return null!=l?[h,f,Sv(x,d)]:[h,f]},N={x:y,filter:g,bias:x,preluActivationWeights:k},I={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:p,leakyreluAlpha:f};if(null==l){var T=ll((function(e,t,n){var r=Su.runKernel(fs,N,I);return n([t,e,r]),b&&(r=Hd(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}));return T(y,g)}var E=ll((function(e,t,n,r){var a=Su.runKernel(fs,N,I);return r([t,e,a,n]),b&&(a=Hd(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}));return E(y,g,x)}});var Av=Lu({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,c=void 0===u?"linear":u,l=e.preluActivationWeights,d=e.leakyreluAlpha,p=void 0===d?.2:d;if(!1===Iv(Su.state.gradientDepth,c)){var h=Xd(t,n,a,o);return null!=s&&(h=rl(h,s)),Nv(h,c,l,p)}var f=Ou(t,"a","fused matMul"),v=Ou(n,"b","fused matMul"),m=H(vu(f,v),2);f=m[0],v=m[1];var g=a?f.shape[f.rank-2]:f.shape[f.rank-1],y=o?v.shape[v.rank-1]:v.shape[v.rank-2],b=a?f.shape[f.rank-1]:f.shape[f.rank-2],x=o?v.shape[v.rank-2]:v.shape[v.rank-1],k=f.shape.slice(0,-2),w=v.shape.slice(0,-2),C=Nr(k),S=Nr(w);wr(g===y,(function(){return"Error in fused matMul: inner shapes (".concat(g,") and (")+"".concat(y,") of Tensors with shapes ").concat(f.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var N,I,T=Nl(f.shape.slice(0,-2),v.shape.slice(0,-2)).concat([b,x]),E=Hd(f,a?[C,g,b]:[C,b,g]),_=Hd(v,o?[S,x,y]:[S,y,x]);null!=s&&(N=H(vu(N=Ou(s,"bias","fused matMul"),f),1)[0],Nl(T,N.shape)),null!=l&&(I=Ou(l,"prelu weights","fused matMul"));var R=function(e,t){var n,r,i=H(t,4),u=i[0],l=i[1],d=i[2],p=i[3],h=Cv(Hd(e,d.shape),d,c);return a||o?!a&&o?(n=Xd(h,l,!1,!1),r=Xd(h,u,!0,!1)):a&&!o?(n=Xd(l,h,!1,!0),r=Xd(u,h,!1,!1)):(n=Xd(l,h,!0,!0),r=Xd(h,u,!0,!0)):(n=Xd(h,l,!1,!0),r=Xd(u,h,!0,!1)),null!=s?[n,r,Sv(p,h)]:[n,r]},A={a:E,b:_,bias:N,preluActivationWeights:I},O={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:p};if(null==s){var F=ll((function(e,t,n){var r=Su.runKernel(ps,A,O);return n([e,t,r]),{value:Hd(r,T),gradFunc:R}}));return F(E,_)}var D=ll((function(e,t,n,r){var a=Su.runKernel(ps,A,O);return r([e,t,a,n]),{value:Hd(a,T),gradFunc:R}}));return D(E,_,N)}});var Ov=Lu({hammingWindow_:function(e){return bv(e,.54,.46)}});var Fv=Lu({hannWindow_:function(e){return bv(e,.5,.5)}});var Dv=Lu({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Yd(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Kd([Yd(e,i,t-s),gl([s],a)]);o.push(u),i+=n}return 0===o.length?Xf([],[0,t]):Hd(Kd(o),[o.length,t])}});var Lv=Lu({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fv;null==r&&(r=yv(t));var i=Dv(e,t,n),o=ol(i,a(t));return Vf(o,r)}});var Mv=Lu({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Ou(e,"image","cropAndResize"),s=Ou(t,"boxes","cropAndResize","float32"),u=Ou(n,"boxInd","cropAndResize","int32"),c=s.shape[0];wr(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),wr(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),wr(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),wr(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),wr(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),wr("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},d={method:a,extrapolationValue:i,cropSize:r};return Su.runKernel(Ga,l,d)}});var zv=Lu({flipLeftRight_:function(e){var t=Ou(e,"image","flipLeftRight","float32");wr(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return Su.runKernel(pi,n,{})}});var Pv=Lu({grayscaleToRGB_:function(e){var t=Ou(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];wr(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),wr(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,Jp(t,a)}});var Bv=Lu({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Ou(e,"image","rotateWithOffset","float32");wr(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r};return Su.runKernel(ds,i,o)}});function Vv(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),wr(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),wr(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),wr(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),wr(1===t.rank,(function(){return"scores must be a 1D tensor"})),wr(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),wr(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var Wv=Lu({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Ou(e,"boxes","nonMaxSuppression","float32"),o=Ou(t,"scores","nonMaxSuppression","float32"),s=Vv(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return Su.runKernel($i,{boxes:i,scores:o},u)}});function Uv(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||jv)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function jv(e,t){return e>t?1:e<t?-1:0}function Hv(e,t,n,r,a){return Kv(e,t,n,r,a,0)}function Gv(e,t,n,r,a,i){return Kv(e,t,n,r,a,0,!1,i,!0)}function qv(e,t,n,r,a,i){return Kv(e,t,n,r,a,i,!0)}function Kv(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(Yv);for(var d=i>0?-.5/i:0,p=[],h=[];p.length<n&&c.length>0;){var f=c.pop(),v=f.score,m=f.boxIndex,g=f.suppressBeginIndex;if(v<a)break;for(var y=!1,b=p.length-1;b>=g;--b){var x=Xv(e,m,p[b]);if(x>=r){y=!0;break}if(f.score=f.score*Zv(r,d,x),f.score<=a)break}f.suppressBeginIndex=p.length,y||(f.score===v?(p.push(m),h.push(f.score)):f.score>a&&Uv(c,f,Yv))}var k=p.length,w=n-k;s&&w>0&&(p.push.apply(p,R(new Array(w).fill(0))),h.push.apply(h,R(new Array(w).fill(0))));var C={selectedIndices:p};return o&&(C.selectedScores=h),u&&(C.validOutputs=k),C}function Xv(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(s-i)*(u-o),f=(d-c)*(p-l);if(h<=0||f<=0)return 0;var v=Math.max(i,c),m=Math.max(o,l),g=Math.min(s,d),y=Math.min(u,p),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(h+f-b)}function Zv(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Yv(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Qv(){return Qv=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=f.length>3&&void 0!==f[3]?f[3]:.5,i=f.length>4&&void 0!==f[4]?f[4]:Number.NEGATIVE_INFINITY,o=Ou(t,"boxes","nonMaxSuppressionAsync"),s=Ou(n,"scores","nonMaxSuppressionAsync"),u=Vv(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return c=e.sent,l=c[0],d=c[1],p=Hv(l,d,r,a,i),h=p.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",Kf(h,"int32"));case 17:case"end":return e.stop()}}),e)}))),Qv.apply(this,arguments)}var Jv=function(e,t,n){return Qv.apply(this,arguments)};var $v=Lu({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Ou(e,"boxes","nonMaxSuppression"),s=Ou(t,"scores","nonMaxSuppression"),u=Vv(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},d=Su.runKernel(to,c,l);return{selectedIndices:d[0],selectedScores:d[1]}}});function em(){return em=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f,v,m=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:.5,i=m.length>4&&void 0!==m[4]?m[4]:Number.NEGATIVE_INFINITY,o=m.length>5&&void 0!==m[5]?m[5]:0,s=Ou(t,"boxes","nonMaxSuppressionAsync"),u=Ou(n,"scores","nonMaxSuppressionAsync"),c=Vv(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return l=e.sent,d=l[0],p=l[1],h=qv(d,p,r,a,i,o),f=h.selectedIndices,v=h.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:Kf(f,"int32"),selectedScores:Kf(v)});case 19:case"end":return e.stop()}}),e)}))),em.apply(this,arguments)}var tm=function(e,t,n){return em.apply(this,arguments)};var nm=Lu({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Ou(e,"boxes","nonMaxSuppression"),s=Ou(t,"scores","nonMaxSuppression"),u=Vv(o,s,n,r,a,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i},d=Su.runKernel(eo,c,l);return{selectedIndices:d[0],validOutputs:d[1]}}});function rm(){return rm=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],s=Ou(t,"boxes","nonMaxSuppressionAsync"),u=Ou(n,"scores","nonMaxSuppressionAsync"),c=Vv(s,u,r,a,i,null),l=c.maxOutputSize,d=c.iouThreshold,p=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return h=e.sent,f=H(h,2),v=f[0],m=f[1],g=Gv(v,m,l,d,p,o),y=g.selectedIndices,b=g.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:Kf(y,"int32"),validOutputs:dl(b,"int32")});case 19:case"end":return e.stop()}}),e)}))),rm.apply(this,arguments)}var am=function(e,t,n){return rm.apply(this,arguments)};var im=Lu({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ou(e,"images","resizeBilinear");wr(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),wr(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),wr(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Hd(a,[1,a.shape[0],a.shape[1],a.shape[2]])),H(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=Su.runKernel(xo,s,u);return o?Hd(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var om=Lu({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ou(e,"images","resizeNearestNeighbor");wr(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),wr(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),wr("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),wr(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Hd(a,[1,a.shape[0],a.shape[1],a.shape[2]])),H(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=Su.runKernel(yo,s,u);return o?Hd(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var sm=Lu({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,u=Ou(e,"image","threshold"),c=u.shape[0]*u.shape[1],l=ol(Kf([s]),255);if(wr(3===u.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(u.rank,".")})),wr(3===u.shape[2]||1===u.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(u.shape[2],".")})),wr("int32"===u.dtype||"float32"===u.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(u.dtype,".")})),wr("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===u.shape[2]){var d=H(Bf(u,[1,1,1],-1),3);t=d[0],n=d[1],r=d[2];var p=ol(t,.2989),h=ol(n,.587),f=ol(r,.114);a=rl(rl(p,h),f)}else a=e;"otsu"===i&&(l=function(e,t){for(var n,r,a,i,o,s,u=Kf([-1]),c=Kf([0]),l=Kf([0]),d=0;d<e.size-1;d++){n=Yd(e,0,d+1),r=Yd(e,d+1),o=il(Gp(n),t),s=il(Gp(r),t);var p=Gp(ol(n,pf(0,n.size)));a=il(p,Gp(n));var h=gl(r.shape,n.size),f=rl(pf(0,r.size),h),v=ol(r,f);i=il(Gp(v),Gp(r));var m=xl(a,i),g=xl(a,i),y=ol(o,s);l=ol(ol(y,m),g);var b=nh(l,c);c=Rp(b,l,c),u=Rp(b,Kf([d]),u)}return u}(ap(Xc(wf(a),"int32"),Pu([]),256),c));var v=o?lh(a,l):nh(a,l);return Xc(ol(v,255),"int32")}});var um=Lu({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=Ou(e,"image","transform","float32"),s=Ou(t,"transforms","transform","float32");wr(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),wr(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),wr(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return Su.runKernel(rs,u,c)}});var cm=Lu({bandPart_:function(e,t,n){wr(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),wr(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Ou(e,"a","bandPart");wr(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=H(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=Hd(pf(0,o,1,"int32"),[-1,1]),c=pf(0,s,1,"int32"),l=xl(u,c),d=xh(lh(l,dl(+t,"int32")),rh(l,dl(-n,"int32"))),p=Ah([o,s],r.dtype);return Hd(jf(nv(Hd(r,[-1,o,s])).map((function(e){return Rp(d,e,p)}))),a)}});var lm=Lu({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,wr(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){wr(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}else t=!0,e=Bf(e,e.shape[0],0).map((function(e){return Uf(e,[0])}));wr(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var i=[],o=e,s=function(e){i.push(Su.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=ol(Gp(ol(i[n],t)),i[n]);t=xl(t,r)}return il(t,Kp(t,"euclidean"))})))},u=0;u<e.length;++u)s(u);return t?jf(i,0):i}});function dm(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Su.tidy((function(){wr(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=$p(n),i=Zc(e),o=Xf([[1]],[1,1]),s=Zc(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,l=H(Su.tidy((function(){var t=Yd(i,[e,e],[n-e,1]),u=Kp(t),c=Yd(i,[e,e],[1,1]),l=Rp(nh(c,0),Xf([[-1]]),Xf([[1]])),d=xl(c,ol(l,u)),p=il(t,d);s=1===p.shape[0]?Zc(o):Kd([o,Yd(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);var h=vh(il(Xd(l,d),u)),f=Yd(i,[e,0],[n-e,r]),v=ol(h,s),m=lv(s);if(0===e)i=xl(f,Xd(v,Xd(m,f)));else{var g=xl(f,Xd(v,Xd(m,f)));i=Kd([Yd(i,[0,0],[e,r]),g],0)}var y=lv(v),b=Yd(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=xl(b,Xd(Xd(b,s),y));else{var x=xl(b,Xd(Xd(b,s),y));a=Kd([Yd(a,[0,0],[n,e]),x],1)}return[s,i,a]})),3);s=l[0],i=l[1],a=l[2],el([t,u,c])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=Yd(a,[0,0],[n,r]),i=Yd(i,[0,0],[r,r])),[a,i]}))}var pm,hm=Lu({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(wr(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return dm(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=nv(Hd(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=H(dm(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)})),[Hd(jf(a,0),e.shape),Hd(jf(i,0),e.shape)]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(pm||(pm={}));var fm=Lu({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pm.SUM_BY_NONZERO_WEIGHTS,r=Ou(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Ou(t,"weights","computeWeightedLoss"));var i=null==a?r:ol(r,a);if(n===pm.NONE)return i;if(n===pm.SUM)return Gp(i);if(n===pm.MEAN){if(null==a)return Rh(i);var o=r.size/a.size,s=il(Gp(i),Gp(a));return o>1?il(s,dl(o)):s}if(n===pm.SUM_BY_NONZERO_WEIGHTS){if(null==a)return il(Gp(i),dl(r.size));var u=ol(a,Oh(r.shape)),c=Xc(Gp(Vh(u,dl(0))),"float32");return il(Gp(i),c)}throw Error("Unknown reduction: ".concat(n))}});var vm=Lu({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pm.SUM_BY_NONZERO_WEIGHTS,a=Ou(e,"labels","absoluteDifference"),i=Ou(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=Ou(n,"weights","absoluteDifference")),Cr(a.shape,i.shape,"Error in absoluteDifference: ");var s=wl(xl(a,i));return fm(s,o,r)}});var mm=Lu({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pm.SUM_BY_NONZERO_WEIGHTS,i=Ou(e,"labels","cosineDistance"),o=Ou(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Ou(r,"weights","cosineDistance")),Cr(i.shape,o.shape,"Error in cosineDistance: ");var u=dl(1),c=xl(u,Gp(ol(i,o),n,!0));return fm(c,s,a)}});var gm=Lu({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pm.SUM_BY_NONZERO_WEIGHTS,a=Ou(e,"labels","hingeLoss"),i=Ou(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Ou(n,"weights","hingeLoss")),Cr(a.shape,i.shape,"Error in hingeLoss: ");var s=dl(1);a=xl(ol(dl(2),a),s);var u=vf(xl(s,ol(a,i)));return fm(u,o,r)}});var ym=Lu({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pm.SUM_BY_NONZERO_WEIGHTS,i=Ou(e,"labels","huberLoss"),o=Ou(t,"predictions","huberLoss"),s=null;null!=n&&(s=Ou(n,"weights","huberLoss")),Cr(i.shape,o.shape,"Error in huberLoss: ");var u=dl(r),c=wl(xl(o,i)),l=Dh(c,u),d=xl(c,l),p=rl(ol(dl(.5),ul(l)),ol(u,d));return fm(p,s,a)}});var bm=Lu({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pm.SUM_BY_NONZERO_WEIGHTS,i=Ou(e,"labels","logLoss"),o=Ou(t,"predictions","logLoss"),s=null;null!=n&&(s=Ou(n,"weights","logLoss")),Cr(i.shape,o.shape,"Error in logLoss: ");var u=dl(1),c=dl(r),l=vh(ol(i,hh(rl(o,c)))),d=ol(xl(u,i),hh(rl(xl(u,o),c))),p=xl(l,d);return fm(p,s,a)}});var xm=Lu({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pm.SUM_BY_NONZERO_WEIGHTS,a=Ou(e,"labels","meanSquaredError"),i=Ou(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Ou(n,"weights","meanSquaredError")),Cr(a.shape,i.shape,"Error in meanSquaredError: ");var s=Wf(a,i);return fm(s,o,r)}});var km=Lu({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pm.SUM_BY_NONZERO_WEIGHTS,i=Ou(e,"multiClassLabels","sigmoidCrossEntropy"),o=Ou(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Ou(n,"weights","sigmoidCrossEntropy")),Cr(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=dl(r),c=dl(1),l=dl(.5);i=rl(ol(i,xl(c,u)),ol(l,u))}var d=function(e,t){var n=Ou(e,"labels","sigmoidCrossEntropyWithLogits"),r=Ou(t,"logits","sigmoidCrossEntropyWithLogits");Cr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=vf(r),i=ol(r,n),o=fh(Zp(vh(wl(r))));return rl(xl(a,i),o)}(i,o);return fm(d,s,a)}});var wm=Lu({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pm.SUM_BY_NONZERO_WEIGHTS,i=Ou(e,"onehotLabels","softmaxCrossEntropy"),o=Ou(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Ou(n,"weights","softmaxCrossEntropy")),Cr(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=dl(r),c=dl(1),l=dl(i.shape[1]);i=rl(ol(i,xl(c,u)),il(u,l))}var d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=ll((function(e,t,r){var a=bh(t,[n],!0),i=xl(Xc(t,"float32"),a);r([e,i]);var o=vh(ol(i,e));return{value:Gp(o,[n]),gradFunc:function(e,t){var r=H(t,2),a=r[0],i=r[1],o=Pp(e.shape,[n]);return[ol(Hd(e,o),xl(Xc(a,"float32"),Zp(i))),ol(Hd(e,o),xl(Zp(i),Xc(a,"float32")))]}}}));return r(e,t)}(i,o);return fm(d,s,a)}});var Cm=Lu({sparseFillEmptyRows_:function(e,t,n,r){var a=Ou(e,"indices","sparseFillEmptyRows","int32"),i=Ou(t,"values","sparseFillEmptyRows"),o=Ou(n,"denseShape","sparseFillEmptyRows","int32"),s=Ou(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));var u={indices:a,values:i,denseShape:o,defaultValue:s},c=Su.runKernel(Wo,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});var Sm=Lu({sparseReshape_:function(e,t,n){var r=Ou(e,"inputIndices","sparseReshape","int32"),a=Ou(t,"inputShape","sparseReshape","int32"),i=Ou(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},s=Su.runKernel(Uo,o);return{outputIndices:s[0],outputShape:s[1]}}});var Nm=Lu({sparseSegmentMean_:function(e,t,n){var r=Ou(e,"data","sparseSegmentMean"),a=Ou(t,"indices","sparseSegmentMean","int32"),i=Ou(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return Su.runKernel(jo,o)}});var Im=Lu({sparseSegmentSum_:function(e,t,n){var r=Ou(e,"data","sparseSegmentSum"),a=Ou(t,"indices","sparseSegmentSum","int32"),i=Ou(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return Su.runKernel(Ho,o)}});var Tm=Lu({stringNGrams_:function(e,t,n,r,a,i,o,s){var u=Ou(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=Ou(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},d={data:u,dataSplits:c},p=Su.runKernel(Zo,d,l);return{nGrams:p[0],nGramsSplits:p[1]}}});var Em=Lu({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Ou(e,"input","stringSplit","string"),a=Ou(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},s=Su.runKernel(Yo,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});var _m,Rm=Lu({stringToHashBucketFast_:function(e,t){var n=Ou(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return Su.runKernel(Qo,a,r)}}),Am={fft:Mf,ifft:zf,rfft:Vf,irfft:Pf},Om={hammingWindow:Ov,hannWindow:Fv,frame:Dv,stft:Lv},Fm={flipLeftRight:zv,grayscaleToRGB:Pv,resizeNearestNeighbor:om,resizeBilinear:im,rotateWithOffset:Bv,cropAndResize:Mv,nonMaxSuppression:Wv,nonMaxSuppressionAsync:Jv,nonMaxSuppressionWithScore:$v,nonMaxSuppressionWithScoreAsync:tm,nonMaxSuppressionPadded:nm,nonMaxSuppressionPaddedAsync:am,threshold:sm,transform:um},Dm={bandPart:cm,gramSchmidt:lm,qr:hm},Lm={absoluteDifference:vm,computeWeightedLoss:fm,cosineDistance:mm,hingeLoss:gm,huberLoss:ym,logLoss:bm,meanSquaredError:xm,sigmoidCrossEntropy:km,softmaxCrossEntropy:wm},Mm={sparseFillEmptyRows:Cm,sparseReshape:Sm,sparseSegmentMean:Nm,sparseSegmentSum:Im},zm={stringNGrams:Tm,stringSplit:Em,stringToHashBucketFast:Rm},Pm=function(){function e(){A(this,e)}return L(e,null,[{key:"sgd",value:function(e){return new El(e)}},{key:"momentum",value:function(e,t){return new _l(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}},{key:"rmsprop",value:function(e){return new Rl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},{key:"adam",value:function(){return new kl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}},{key:"adadelta",value:function(){return new ml(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"adamax",value:function(){return new Tl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}},{key:"adagrad",value:function(e){return new yl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}]),e}(),Bm=Pm,Vm="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function Wm(){return new Promise((function(e){return Vm((function(){return e()}))}))}function Um(e,t){var n=e[0].length;e.forEach((function(e,t){wr(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),wr(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)wr(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function jm(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(_m||(_m={}));var Hm=30;function Gm(e){return e<=Hm?e:Ur(e,Math.floor(Math.sqrt(e)))}function qm(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Km(e,t,n){var r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var a=t.length,i=0;i<a;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(a+1))}return r}function Xm(e,t){var n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(var r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{for(var a=[],i=[],o=1;o<e;++o)o>=2*t+1||o%2===1?i.push(o):a.push(o);n.push.apply(n,a),n.push(0),n.push.apply(n,i)}return n}function Zm(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Ym(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Qm(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function Jm(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===Nr(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,d=i;d<n;++d)l*=u[d],c.push(u[d]);var p=[].concat(R(jr(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,p]}var $m=1.7580993408473768,eg=1.0507009873554805,tg=.3275911,ng=.254829592,rg=-.284496736,ag=1.421413741,ig=-1.453152027,og=1.061405429;function sg(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function ug(e,t){return{real:e[2*t],imag:e[2*t+1]}}function cg(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function lg(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var dg="->",pg=/->/g,hg=",",fg="...";function vg(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(pg,"").length)/dg.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(dg,'").'));var r=H(e.split(dg),2),a=r[0],i=r[1];wr(-1===a.indexOf(fg),(function(){return'The ellipsis notation ("'.concat(fg,'") is not supported yet.')}));var o=a.split(hg),s=o.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var u=[],c=function(){var e=i[l];if(!o.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===u.indexOf(e)&&u.push(e)},l=0;l<i.length;++l)c();for(var d=0;d<a.length;++d){var p=a[d];-1===u.indexOf(p)&&p!==hg&&u.push(p)}for(var h=new Array(o.length),f=0;f<s;++f){if(new Set(o[f].split("")).size!==o[f].length)throw new Error("Found duplicate axes in input component ".concat(o[f],". ")+"Support for duplicate axes in input is not implemented yet.");h[f]=[];for(var v=0;v<o[f].length;++v)h[f].push(u.indexOf(o[f][v]))}for(var m=u.length,g=[],y=i.length;y<m;++y)g.push(y);return{allDims:u,summedDims:g,idDims:h}}function mg(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function gg(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:wr(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function yg(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=K(xg(t,r[s]));try{for(c.s();!(u=c.n()).done;){var l=u.value;-1===o.indexOf(l)&&(a[s].push(l),o.push(l))}}catch(aH){c.e(aH)}finally{c.f()}}return{path:r,steps:a}}function bg(e){return e.every((function(e,t){return e===t}))}function xg(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function kg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)wr(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);wr(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}wr(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function wg(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function Cg(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function Sg(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function Ng(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,d=1,p=0;p<r;++p)u.push(e.shape[p]),c*=e.shape[p];for(var h=r;h<n;h++)u.push(e.shape[h]),l*=e.shape[h];for(var f=r;f<a;f++)u.push(t.shape[f]);for(var v=n+1;v<i;v++)u.push(e.shape[v]),d*=e.shape[v];return{batchSize:c,sliceSize:d,outerSize:l,dimSize:s,outputShape:u}}function Ig(e){try{return e.map((function(e){return Us(e)}))}catch(aH){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(aH))}}!function(){var e,t=K(Al);try{for(t.s();!(e=t.n()).done;){fl(e.value)}}catch(aH){t.e(aH)}finally{t.f()}}();var Tg={kernelName:sa,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,Hf(Xc(n,"float32"),-1))}}}},Eg={kernelName:ua,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){var t=ul(Xc(n,"float32")),r=sl(xl(dl(1),t));return vh(il(e,r))}}}},_g={kernelName:ca,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){var t=sl(xl(ul(Xc(n,"float32")),1));return il(e,t)}}}},Rg={kernelName:la,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=e,n=Sl(r.shape,i);return n.length>0&&(t=Gp(t,n)),Hd(t,r.shape)},b:function(){var t=e,n=Sl(a.shape,i);return n.length>0&&(t=Gp(t,n)),Hd(t,a.shape)}}}},Ag={kernelName:da,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},Og={kernelName:fa,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return cl(n)}}}},Fg={kernelName:va,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return cl(n)}}}},Dg={kernelName:ma,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,sl(xl(dl(1),ul(Xc(n,"float32")))))}}}},Lg={kernelName:ga,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){var t=sl(rl(dl(1),ul(Xc(n,"float32"))));return il(e,t)}}}},Mg={kernelName:xa,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=rl(ul(r),ul(a)),n=ol(e,il(a,t)),o=Sl(r.shape,i);return o.length>0&&(n=Gp(n,o)),Hd(n,r.shape)},b:function(){var t=rl(ul(r),ul(a)),n=vh(ol(e,il(r,t))),o=Sl(a.shape,i);return o.length>0&&(n=Gp(n,o)),Hd(n,a.shape)}}}},zg={kernelName:ya,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,rl(ul(Xc(n,"float32")),1))}}}},Pg={kernelName:ba,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,xl(dl(1),ul(Xc(n,"float32"))))}}}};var Bg=Lu({avgPool3dGrad_:function(e,t,n,r,a,i){var o=Ou(e,"dy","avgPool3dGrad"),s=Ou(t,"input","avgPool3dGrad"),u=o,c=s,l=!1;4===s.rank&&(l=!0,u=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),wr(5===u.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")})),wr(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),jd("avgPool3dGrad",a,i);var d={dy:u,input:c},p={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=Su.runKernel(Sa,d,p);return l?Hd(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Vg={kernelName:Ca,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad,s=n.dimRoundingMode;return{x:function(){return Bg(e,r,a,i,o,s)}}}};var Wg=Lu({avgPoolGrad_:function(e,t,n,r,a){var i=Ou(e,"dy","avgPoolGrad"),o=Ou(t,"input","avgPoolGrad");wr(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=Hd(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Hd(i,[1,i.shape[0],i.shape[1],i.shape[2]])),wr(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),wr(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l={dy:u,input:s},d={filterSize:n,strides:r,pad:a},p=Su.runKernel(wa,l,d);return c?Hd(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Ug={kernelName:ka,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return Wg(e,r,a,i,o)}}}},jg={kernelName:Na,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Xd(e,i,!1,!1)},b:function(){return Xd(e,a,!0,!1)}}:o&&!s?{a:function(){return Xd(i,e,!1,!0)},b:function(){return Xd(a,e,!1,!1)}}:{a:function(){return Xd(i,e,!0,!0)},b:function(){return Xd(e,a,!0,!0)}}:{a:function(){return Xd(e,i,!1,!0)},b:function(){return Xd(a,e,!0,!1)}}}},Hg={kernelName:Ia,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Zh(e,r,a)}}}},Gg={kernelName:"BroadcastTo",gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],c=0;c<o.length;c++)o[c]>1&&u.push(c);return{x:function(){return Gp(e,u,!0)}}}},qg={kernelName:_a,gradFunc:function(e){return{x:function(){return e.clone()}}}},Kg={kernelName:Ra,gradFunc:function(e){return{x:function(){return cl(e)}}}},Xg={kernelName:Aa,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return Rp(xh(rh(r,a),lh(r,i)),e,cl(e))}}}},Zg={kernelName:Fa,inputsToSave:["x"],gradFunc:Tg.gradFunc},Yg={kernelName:Da,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=Or(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return Bf(e,i,a).map((function(e){return function(){return e}}))}},Qg={kernelName:La,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return wr(Bd(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return vp(a.shape,e,i,s,u,c)},filter:function(){return wv(a,e,i.shape,s,u,c)}}}},Jg={kernelName:za,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return hp(e,i,o,s,u,1,c)},filter:function(){return wv(e,a,i.shape,o,s,u,c)}}}};var $g=Lu({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=Hd(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=Hd(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),wr(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),wr(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),wr(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),wr(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),wr(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return Su.runKernel(Ba,s,u)}}),ey={kernelName:Pa,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;wr(Bd(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=H(t,2),s=o[0],u=o[1];return{x:function(){return yp(s.shape,e,u,a,i)},filter:function(){return $g(s,e,u.shape,a,i)}}}},ty={kernelName:Wa,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(vh(_f(Xc(n,"float32"))),e)}}}},ny={kernelName:Ua,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(Rf(Xc(n,"float32")),e)}}}},ry={kernelName:Ha,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=Vp([a],r.rank),n=Cp(e,a,i,!o);return null!=t&&(n=lv(n,t)),n}}}},ay={kernelName:Xa,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;wr(Bd(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=H(t,2),c=u[0],l=u[1];return wr(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),wr(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),wr(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),wr(Vd(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),jd("depthwiseConv2d",i,o),{x:function(){return _v(c.shape,e,l,a,i,s,o)},filter:function(){return Ev(c,e,l.shape,a,i,s,o)}}}},iy={kernelName:Ja,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return Su.runKernel($a,o,n)},filter:function(){return Su.runKernel(ei,s,n)}}}},oy={kernelName:ri,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:H(t,1)[0]};return{x:function(){return Su.runKernel(ai,n)}}}},sy={kernelName:ii,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0],r=ol(Zp(vh(ul(n))),2/Math.sqrt(Math.PI));return{x:function(){return ol(e,r)}}}},uy={kernelName:si,outputsToSave:[!0],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,n)}}}},cy={kernelName:ui,inputsToSave:["input"],gradFunc:function(e,t){var n=H(t,1)[0];return{input:function(){return Hd(e,n.shape)}}}},ly={kernelName:ci,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,Zp(n))}}}},dy={kernelName:hi,gradFunc:function(e){return{x:function(){return cl(e)}}}},py={kernelName:fi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=il(e,Xc(a,"float32")),n=Sl(r.shape,i);return n.length>0?Hd(Gp(t,n),r.shape):t},b:function(){var t=ol(e,Xc(r,"float32")),n=Sl(a.shape,i);n.length>0&&(t=Hd(Gp(t,n),a.shape));var o=ul(a);return vh(il(t,Xc(o,"float32")))}}}},hy={kernelName:vi,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=H(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?dl(1):u,l=Sl(o.shape,i.shape),d=[];if(1===o.rank){for(var p=0;p<i.shape.length-1;++p)d.push(i.shape[p]);d.push(1)}var h=xl(i,o),f=ol(e,c),v=Cf(rl(s,dl(r))),m=ol(ol(ol(v,v),v),dl(-.5));return{x:function(){return 1===o.rank?Hd(ol(ol(e,Jp(Hd(v,[1,1,1,o.shape[0]]),d)),c),i.shape):Hd(ol(ol(e,v),c),i.shape)},mean:function(){var e=ol(ol(v,dl(-1)),f);return 1===o.rank&&(e=Gp(e,l)),Hd(e,o.shape)},variance:function(){var e=ol(ol(m,h),f);return 1===o.rank&&(e=Gp(e,l)),Hd(e,o.shape)},scale:function(){var t=ol(h,v),n=ol(e,t);return 1===o.rank&&(n=Gp(n,l)),Hd(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=Gp(t,l)),Hd(t,o.shape)}}}},fy={kernelName:mi,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.axis,s=Or(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,c=t.slice(o,t.length).slice(1),l=c.length,d=vy(0,u),p=vy(u+1,u+1+l),h=my([r,[n],c]),f=Hd(e,h),v=Hd(i,[n]),m=my([[u],d,p]),g=lv(f,m),y=tv(g,v,a.shape[s]),b=Wp(m);return y=lv(y,b)},indices:function(){return i}}}};function vy(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function my(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var gy={kernelName:bi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1];return{a:function(){return cl(r)},b:function(){return cl(a)}}}},yy={kernelName:xi,gradFunc:function(e){return{x:function(){return Xc(e,"float32")}}}},by={kernelName:Ci,gradFunc:function(e){return{x:function(){return cl(e)}}}},xy={kernelName:Si,gradFunc:function(e){return{x:function(){return cl(e)}}}},ky={kernelName:Ni,gradFunc:function(e){return{x:function(){return cl(e)}}}},wy={kernelName:Ii,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.alpha,i=nh(r,0);return{x:function(){return Rp(i,e,ol(e,a))}}}},Cy={kernelName:Ai,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,rl(n,1))}}}},Sy={kernelName:Ri,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,Xc(n,"float32"))}}}},Ny={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.axis;return{logits:function(){var t=Zp(r);return xl(e,ol(Gp(e,a,!0),t))}}}};var Iy=Lu({localResponseNormalizationBackprop_:function(e,t,n){var r={x:e,y:t,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return Su.runKernel(Mi,r,a)}}),Ty={kernelName:Li,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return Iy(a,i,e,o,s,u,c)}}}};function Ey(e,t,n,r){return t.rank<n.rank&&(t=Hd(t,Pp(t.shape,r))),e.rank<n.rank&&(e=Hd(e,Pp(e.shape,r))),{x:function(){return ol(e,Xc(_p(n,t),e.dtype))}}}var _y={kernelName:zi,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=Ey(e,t[1],a,Or(r,a.shape));return{x:function(){return i.x()}}}},Ry={kernelName:Pi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1];return{a:function(){return ol(e,Xc(rh(r,a),"float32"))},b:function(){return ol(e,Xc(ch(r,a),"float32"))}}}};var Ay=Lu({maxPool3dGrad_:function(e,t,n,r,a,i,o){var s=Ou(e,"dy","maxPool3dGrad"),u=Ou(t,"input","maxPool3dGrad"),c=Ou(n,"output","maxPool3dGrad"),l=s,d=u,p=c,h=!1;4===u.rank&&(h=!0,l=Hd(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=Hd(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=Hd(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),wr(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),wr(5===d.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,".")})),wr(5===p.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(p.rank,".")})),jd("maxPool3dGrad",i,o);var f={dy:l,input:d,output:p},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},m=Su.runKernel(Ui,f,v);return h?Hd(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),Oy={kernelName:Wi,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad,c=n.dimRoundingMode;return{x:function(){return Ay(e,a,i,o,s,u,c)}}}};var Fy=Lu({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=Ou(e,"dy","maxPoolGrad"),u=Ou(t,"input","maxPoolGrad"),c=Ou(n,"output","maxPoolGrad");wr(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),wr(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),wr(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),jd("maxPoolGrad",i,o);var l={dy:s,input:u,output:c},d={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return Su.runKernel(Vi,l,d)}}),Dy={kernelName:Bi,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=H(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return Fy(e,a,i,o,s,u)}}}},Ly={kernelName:Ki,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Yd(e,a,r.shape)}}}},My={kernelName:io,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Yd(e,a,r.shape)}}}},zy={kernelName:oo,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=H(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=Nl(o.shape,s.shape);return{a:function(){var t=Xc(s,"float32"),n=ol(e,ol(t,bl(o,xl(t,dl(1))))),r=Sl(o.shape,u);return r.length>0&&(n=Gp(n,r)),Hd(n,o.shape)},b:function(){var t=nh(o,0),n=Rp(t,hh(o),cl(o)),r=ol(e,ol(i,n)),a=Sl(s.shape,u);return a.length>0&&(r=Gp(r,a)),Hd(r,s.shape)}}}};function Py(e,t,n){var r=e.shape.length,a=r-n.length,i=Vp(n,r),o=e;null!=i&&(o=lv(e,i));var s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce((function(e,t){return e*t}),1);s.push(u);var c=function(e,t,n){var r=e.shape.slice();r[n]=1;var a=Hd(t,r),i=wp(e,n,!0,!1),o=wp(e,n,!0,!0),s=ol(i,o);return ol(a,s)}(o.reshape(s),t,a);if(c=c.reshape(o.shape),null!=i){var l=Wp(i);c=lv(c,l)}return c}var By={kernelName:_o,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){var t=nh(n,dl(0)),r=dl($m),a=dl(eg),i=ol(e,a),o=ol(ol(e,r),Zp(Xc(n,"float32")));return Rp(t,i,o)}}}},Vy={kernelName:Po,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return $d(e,r,a)}}}},Wy={kernelName:Bo,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Kd(e,r)}}}},Uy={kernelName:ts,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.reps;return{x:function(){var t=cl(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=rl(t,Yd(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=rl(t,Yd(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=rl(t,Yd(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var d=0;d<a[1];++d)for(var p=0;p<a[2];++p)for(var h=0;h<a[3];++h)t=rl(t,Yd(e,[l*r.shape[0],d*r.shape[1],p*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}};for(var jy=0,Hy=[Tg,Eg,_g,Rg,Ag,Og,Fg,Dg,Lg,Mg,zg,Pg,Vg,Ug,jg,Hg,Gg,qg,Kg,Xg,Zg,Yg,Jg,Qg,ey,ty,ny,ry,ay,iy,{kernelName:ti,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=il(e,Xc(a,"float32")),n=Sl(r.shape,i);return n.length>0?Hd(Gp(t,n),r.shape):t},b:function(){var t=ol(e,Xc(r,"float32")),n=Sl(a.shape,i);n.length>0&&(t=Hd(Gp(t,n),a.shape));var o=ul(a);return vh(il(t,Xc(o,"float32")))}}}},oy,sy,uy,cy,ly,py,dy,hy,fy,gy,yy,by,xy,ky,wy,Cy,Sy,Ny,Ty,_y,_y,Ry,Oy,Dy,{kernelName:Hi,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=Or(n.axis,r.shape),i=Nr(zp(r.shape,a)[1]);return{x:function(){var t=r.shape.slice();a.forEach((function(e){t[e]=1}));var n=Hd(e,t);return il(ol(n,Oh(r.shape,"float32")),i)}}}},{kernelName:Gi,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=H(t,2),i=a[0],o=Ey(e,a[1],i,Or(r,i.shape));return{x:function(){return o.x()}}}},{kernelName:qi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1];return{a:function(){return ol(e,Xc(lh(r,a),"float32"))},b:function(){return ol(e,Xc(nh(r,a),"float32"))}}}},Ly,{kernelName:Xi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=Sl(r.shape,i);return t.length>0?Hd(Gp(e,t),r.shape):e},b:function(){var t=ol(e,vh(eh(il(r,a)))),n=Sl(a.shape,i);return n.length>0?Hd(Gp(t,n),a.shape):t}}}},{kernelName:Yi,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=ol(e,Xc(a,"float32")),n=Sl(r.shape,i);return n.length>0?Hd(Gp(t,n),r.shape):t},b:function(){var t=ol(e,Xc(r,"float32")),n=Sl(a.shape,i);return n.length>0?Hd(Gp(t,n),a.shape):t}}}},{kernelName:Qi,gradFunc:function(e){return{x:function(){return vh(e)}}}},{kernelName:ro,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Ah(n.shape,"float32")}}}},{kernelName:no,gradFunc:function(e){return{x:function(){return cl(e)}}}},{kernelName:ao,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return nv(e,r).map((function(e){return function(){return e}}))}},My,My,zy,{kernelName:so,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=nh(r,0);return{x:function(){return Rp(i,e,ol(e,a))},alpha:function(){var t=Rp(i,cl(e),ol(e,r)),n=Sl(a.shape,e.shape);return n.length>0&&(t=Gp(t,n)),Hd(t,a.shape)}}}},{kernelName:uo,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.axis,i=[];return i=void 0===a||null===a?r.shape.map((function(e,t){return t})):"number"===typeof a?[a]:a,{x:function(){return Py(r,e,i)}}}},{kernelName:vo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,vh(ul(n)))}}}},{kernelName:wo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0],r=ol(lh(n,6),Hf(n));return{x:function(){return ol(e,Xc(r,"float32"))}}}},{kernelName:mo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,Xc(Hf(n),"float32"))}}}},{kernelName:go,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return Hd(e,n.shape)}}}},{kernelName:xo,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:H(t,1)[0]};return{images:function(){return Su.runKernel(ko,r,n)}}}},{kernelName:yo,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:H(t,1)[0]};return{images:function(){return Su.runKernel(bo,r,n)}}}},{kernelName:Co,gradFunc:function(e,t,n){var r=Or(n.dims,e.shape);return{x:function(){return gf(e,r)}}}},{kernelName:So,gradFunc:function(e){return{x:function(){return cl(e)}}}},{kernelName:No,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return vh(il(e,ol(bl(n,1.5),2)))}}}},{kernelName:Eo,inputsToSave:["condition"],gradFunc:function(e,t){var n=H(t,1)[0];return{condition:function(){return Xc(cl(n),"float32")},t:function(){return ol(e,Xc(n,e.dtype))},e:function(){return ol(e,Xc(kh(n),e.dtype))}}}},By,{kernelName:Do,outputsToSave:[!0],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,ol(n,xl(dl(1),n)))}}}},{kernelName:Fo,gradFunc:function(e){return{x:function(){return cl(e)}}}},{kernelName:Ao,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(xp(Xc(n,"float32")),e)}}}},{kernelName:Oo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(kp(Xc(n,"float32")),e)}}}},{kernelName:Ro,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=H(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=H(fd(r,a,i),2),u=s[0],c=s[1],l=[],d=0;d<e.rank;d++)l.push([u[d],o[d]-u[d]-c[d]]);return{x:function(){return Hh(e,l)}}}},{kernelName:Vo,outputsToSave:[!0],gradFunc:function(e,t,n){var r=H(t,1)[0],a=n.dim,i=ol(e,r);return{logits:function(){return xl(i,ol(Gp(i,[a],true),r))}}}},{kernelName:Lo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,Zd(n))}}}},Vy,Vy,Wy,Wy,{kernelName:Mo,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,ol(sl(Xc(n,"float32")),2))}}}},{kernelName:qo,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=dl(2);return{a:function(){return ol(e,ol(i,xl(r,a)))},b:function(){return ol(e,ol(i,xl(a,r)))}}}},{kernelName:Ko,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(e,ol(Xc(n,"float32"),2))}}}},{kernelName:cs,gradFunc:function(e){return{x:function(){return cl(e)}}}},{kernelName:Jo,inputsToSave:["a","b"],gradFunc:function(e,t){var n=H(t,2),r=n[0],a=n[1],i=Nl(r.shape,a.shape);return{a:function(){var t=e,n=Sl(r.shape,i);return n.length>0&&(t=Gp(t,n)),Hd(t,r.shape)},b:function(){var t=e,n=Sl(a.shape,i);return n.length>0&&(t=Gp(t,n)),Hd(vh(t),a.shape)}}}},{kernelName:zo,inputsToSave:["x"],gradFunc:function(e,t,n){var r=H(t,1)[0],a=r.shape.slice();Or(n.axis,r.shape).forEach((function(e){a[e]=1}));var i=Hd(e,a),o=ol(i,Oh(r.shape,"float32"));return{x:function(){return o}}}},{kernelName:$o,inputsToSave:["x"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return il(e,ul(xp(n)))}}}},{kernelName:es,outputsToSave:[!0],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return ol(xl(dl(1),ul(n)),e)}}}},Uy,{kernelName:as,gradFunc:function(e,t,n){var r=Wp(n.perm);return{x:function(){return lv(e,r)}}}},{kernelName:os,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return jf(e,r)}}}},{kernelName:ss,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=H(t,1)[0];return{x:function(){return function(e,t){for(var n=Il(t,cl(t)),r=th(e,n),a=rh(t,dl(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Yp(a,o+1);a=xh(a,Oh(r.shape,"bool"));var s=cl(r);return Rp(a,r,s)}(e,n)}}}},{kernelName:us,gradFunc:function(e){return{x:function(){return cl(e)}}}}];jy<Hy.length;jy++){ws(Hy[jy])}iu().prototype.abs=function(){return this.throwIfDisposed(),wl(this)},iu().prototype.acos=function(){return this.throwIfDisposed(),gd(this)},iu().prototype.acosh=function(){return this.throwIfDisposed(),yd(this)},iu().prototype.add=function(e){return this.throwIfDisposed(),rl(this,e)},iu().prototype.all=function(e,t){return this.throwIfDisposed(),xd(this,e,t)},iu().prototype.any=function(e,t){return this.throwIfDisposed(),kd(this,e,t)},iu().prototype.argMax=function(e){return this.throwIfDisposed(),wd(this,e)},iu().prototype.argMin=function(e){return this.throwIfDisposed(),Cd(this,e)},iu().prototype.asScalar=function(){return this.throwIfDisposed(),wr(1===this.size,(function(){return"The array must have only 1 element."})),Hd(this,[])},iu().prototype.asType=function(e){return this.throwIfDisposed(),Xc(this,e)},iu().prototype.as1D=function(){return this.throwIfDisposed(),Hd(this,[this.size])},iu().prototype.as2D=function(e,t){return this.throwIfDisposed(),Hd(this,[e,t])},iu().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Hd(this,[e,t,n])},iu().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Hd(this,[e,t,n,r])},iu().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),Hd(this,[e,t,n,r,a])},iu().prototype.asin=function(){return this.throwIfDisposed(),Sd(this)},iu().prototype.asinh=function(){return this.throwIfDisposed(),Nd(this)},iu().prototype.atan=function(){return this.throwIfDisposed(),Id(this)},iu().prototype.atan2=function(e){return this.throwIfDisposed(),Td(this,e)},iu().prototype.atanh=function(){return this.throwIfDisposed(),Ed(this)},iu().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Gd(this,e,t,n,r)},iu().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),$d(this,e,t)},iu().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),ep(this,e,t,n,r,a)},iu().prototype.broadcastTo=function(e){return this.throwIfDisposed(),op(this,e)},iu().prototype.cast=function(e){return this.throwIfDisposed(),Xc(this,e)},iu().prototype.ceil=function(){return this.throwIfDisposed(),sp(this)},iu().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),up(this,e,t)},iu().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof au&&(e=[e]),Kd([this].concat(R(e)),t)},iu().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),fp(this,e,t,n,r,a,i)},iu().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),mp(this,e,t,n,r,a)},iu().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),hp(this,e,t,n,r,a,i)},iu().prototype.cos=function(){return this.throwIfDisposed(),xp(this)},iu().prototype.cosh=function(){return this.throwIfDisposed(),kp(this)},iu().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),wp(this,e,t,n)},iu().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Cp(this,e,t,n)},iu().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Np(this,e,t)},iu().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Ip(this,e,t,n,r,a,i)},iu().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),Ep(this,e,t,n,r,a)},iu().prototype.divNoNan=function(e){return this.throwIfDisposed(),Ap(this,e)},iu().prototype.div=function(e){return this.throwIfDisposed(),il(this,e)},iu().prototype.dot=function(e){return this.throwIfDisposed(),Op(this,e)},iu().prototype.elu=function(){return this.throwIfDisposed(),Dp(this)},iu().prototype.equal=function(e){return this.throwIfDisposed(),_p(this,e)},iu().prototype.erf=function(){return this.throwIfDisposed(),Lp(this)},iu().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),Xp(this,e,t)},iu().prototype.exp=function(){return this.throwIfDisposed(),Zp(this)},iu().prototype.expandDims=function(e){return this.throwIfDisposed(),Yp(this,e)},iu().prototype.expm1=function(){return this.throwIfDisposed(),Qp(this)},iu().prototype.fft=function(){return this.throwIfDisposed(),Mf(this)},iu().prototype.flatten=function(){return this.throwIfDisposed(),Hd(this,[this.size])},iu().prototype.floor=function(){return this.throwIfDisposed(),eh(this)},iu().prototype.floorDiv=function(e){return this.throwIfDisposed(),al(this,e)},iu().prototype.gather=function(e,t){return this.throwIfDisposed(),th(this,e,t)},iu().prototype.greaterEqual=function(e){return this.throwIfDisposed(),rh(this,e)},iu().prototype.greater=function(e){return this.throwIfDisposed(),nh(this,e)},iu().prototype.ifft=function(){return this.throwIfDisposed(),zf(this)},iu().prototype.irfft=function(){return this.throwIfDisposed(),Pf(this)},iu().prototype.isFinite=function(){return this.throwIfDisposed(),ih(this)},iu().prototype.isInf=function(){return this.throwIfDisposed(),oh(this)},iu().prototype.isNaN=function(){return this.throwIfDisposed(),sh(this)},iu().prototype.leakyRelu=function(e){return this.throwIfDisposed(),uh(this,e)},iu().prototype.lessEqual=function(e){return this.throwIfDisposed(),lh(this,e)},iu().prototype.less=function(e){return this.throwIfDisposed(),ch(this,e)},iu().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),ph(this,e,t,n,r)},iu().prototype.logSigmoid=function(){return this.throwIfDisposed(),gh(this)},iu().prototype.logSoftmax=function(e){return this.throwIfDisposed(),yh(this,e)},iu().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),bh(this,e,t)},iu().prototype.log=function(){return this.throwIfDisposed(),hh(this)},iu().prototype.log1p=function(){return this.throwIfDisposed(),fh(this)},iu().prototype.logicalAnd=function(e){return this.throwIfDisposed(),xh(this,e)},iu().prototype.logicalNot=function(){return this.throwIfDisposed(),kh(this)},iu().prototype.logicalOr=function(e){return this.throwIfDisposed(),wh(this,e)},iu().prototype.logicalXor=function(e){return this.throwIfDisposed(),Ch(this,e)},iu().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Xd(this,e,t,n)},iu().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Th(this,e,t,n,r)},iu().prototype.max=function(e,t){return this.throwIfDisposed(),jp(this,e,t)},iu().prototype.maximum=function(e){return this.throwIfDisposed(),Il(this,e)},iu().prototype.mean=function(e,t){return this.throwIfDisposed(),Rh(this,e,t)},iu().prototype.min=function(e,t){return this.throwIfDisposed(),Hp(this,e,t)},iu().prototype.minimum=function(e){return this.throwIfDisposed(),Dh(this,e)},iu().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Lh(this,e,t)},iu().prototype.mod=function(e){return this.throwIfDisposed(),Mh(this,e)},iu().prototype.mul=function(e){return this.throwIfDisposed(),ol(this,e)},iu().prototype.neg=function(){return this.throwIfDisposed(),vh(this)},iu().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Kp(this,e,t,n)},iu().prototype.notEqual=function(e){return this.throwIfDisposed(),Vh(this,e)},iu().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Wh(this,e,t,n)},iu().prototype.onesLike=function(){return this.throwIfDisposed(),Uh(this)},iu().prototype.pad=function(e,t){return this.throwIfDisposed(),Hh(this,e,t)},iu().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),Yh(this,e,t,n,r,a,i)},iu().prototype.pow=function(e){return this.throwIfDisposed(),bl(this,e)},iu().prototype.prelu=function(e){return this.throwIfDisposed(),Qh(this,e)},iu().prototype.prod=function(e,t){return this.throwIfDisposed(),Jh(this,e,t)},iu().prototype.reciprocal=function(){return this.throwIfDisposed(),ff(this)},iu().prototype.relu=function(){return this.throwIfDisposed(),vf(this)},iu().prototype.relu6=function(){return this.throwIfDisposed(),mf(this)},iu().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Hd(this,e.shape)},iu().prototype.reshape=function(e){return this.throwIfDisposed(),Hd(this,e)},iu().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),im(this,e,t,n)},iu().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),om(this,e,t,n)},iu().prototype.reverse=function(e){return this.throwIfDisposed(),gf(this,e)},iu().prototype.rfft=function(){return this.throwIfDisposed(),Vf(this)},iu().prototype.round=function(){return this.throwIfDisposed(),wf(this)},iu().prototype.rsqrt=function(){return this.throwIfDisposed(),Cf(this)},iu().prototype.selu=function(){return this.throwIfDisposed(),Sf(this)},iu().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Nf(this,e,t,n,r,a,i)},iu().prototype.sigmoid=function(){return this.throwIfDisposed(),Zd(this)},iu().prototype.sign=function(){return this.throwIfDisposed(),Ef(this)},iu().prototype.sin=function(){return this.throwIfDisposed(),_f(this)},iu().prototype.sinh=function(){return this.throwIfDisposed(),Rf(this)},iu().prototype.slice=function(e,t){return this.throwIfDisposed(),Yd(this,e,t)},iu().prototype.softmax=function(e){return this.throwIfDisposed(),Lf(this,e)},iu().prototype.softplus=function(){return this.throwIfDisposed(),mh(this)},iu().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Zh(this,e,t)},iu().prototype.split=function(e,t){return this.throwIfDisposed(),Bf(this,e,t)},iu().prototype.sqrt=function(){return this.throwIfDisposed(),sl(this)},iu().prototype.square=function(){return this.throwIfDisposed(),ul(this)},iu().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Wf(this,e)},iu().prototype.squeeze=function(e){return this.throwIfDisposed(),Uf(this,e)},iu().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof au?[this,e]:[this].concat(R(e));return jf(n,t)},iu().prototype.step=function(e){return this.throwIfDisposed(),Hf(this,e)},iu().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),Gf(this,e,t,n,r,a,i,o,s)},iu().prototype.sub=function(e){return this.throwIfDisposed(),xl(this,e)},iu().prototype.sum=function(e,t){return this.throwIfDisposed(),Gp(this,e,t)},iu().prototype.tan=function(){return this.throwIfDisposed(),qf(this)},iu().prototype.tanh=function(){return this.throwIfDisposed(),Qd(this)},iu().prototype.tile=function(e){return this.throwIfDisposed(),Jp(this,e)},iu().prototype.toBool=function(){return this.throwIfDisposed(),Xc(this,"bool")},iu().prototype.toFloat=function(){return this.throwIfDisposed(),Xc(this,"float32")},iu().prototype.toInt=function(){return this.throwIfDisposed(),Xc(this,"int32")},iu().prototype.topk=function(e,t){return this.throwIfDisposed(),Jf(this,e,t)},iu().prototype.transpose=function(e){return this.throwIfDisposed(),lv(this,e)},iu().prototype.unique=function(e){return this.throwIfDisposed(),ev(this,e)},iu().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),tv(this,e,t)},iu().prototype.unstack=function(e){return this.throwIfDisposed(),nv(this,e)},iu().prototype.where=function(e,t){return this.throwIfDisposed(),Rp(e,this,t)},iu().prototype.zerosLike=function(){return this.throwIfDisposed(),cl(this)};var Gy=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(V(r),n.prototype),r}return L(n)}(q(Error)),qy=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(V(r),n.prototype),r}return L(n)}(q(Error)),Ky=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(V(r),n.prototype),r}return L(n)}(q(Error)),Xy=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(V(r),n.prototype),r}return L(n)}(q(Error)),Zy=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(V(r),n.prototype),r}return L(n)}(q(Error)),Yy=(Error,function(){function e(t){A(this,e),this.maxEntries=t||100,this.cache=new Map}return L(e,[{key:"get",value:function(e){var t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}},{key:"put",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"getMaxEntries",value:function(){return this.maxEntries}},{key:"setMaxEntries",value:function(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(var t=0;t<this.maxEntries-e;t++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}]),e}());function Qy(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function Jy(e,t){if(!e)throw new Zy(t)}function $y(e,t){var n,r=0,a=K(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(aH){a.e(aH)}finally{a.f()}return r}function eb(e){return 1===e.length?e[0]:e}function tb(e){return Array.isArray(e)?e:[e]}function nb(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function rb(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var ab={};function ib(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function ob(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return ob(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?ob(a):e[r]=a.value)}}function sb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in ab)i=ab[o];else if(null==(i=t[o]))throw new Ky("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s=e;if(null==s.className||null==s.config)throw new Ky("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var u,c,l=s.className;if(l in n){var d=H(n[l],2);u=d[0],c=d[1]}else if(l in ab){var p=H(ab.className,2);u=p[0],c=p[1]}else if(l in t){var h=H(t[l],2);u=h[0],c=h[1]}if(null==u)throw new Ky("Unknown ".concat(r,": ").concat(l,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){for(var f={},v=0,m=Object.keys(ab);v<m.length;v++){var g=m[v];f[g]=ab[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var x=b[y];f[x]=n[x]}s.config.customObjects=f;for(var k=Object.assign({},ab),w=0,C=Object.keys(n);w<C.length;w++){var S=C[w];ab[S]=n[S]}ob(s.config);var N=c(u,s.config,n,a);return ab=Object.assign({},k),N}for(var I=Object.assign({},ab),T=0,E=Object.keys(n);T<E.length;T++){var _=E[T];ab[_]=n[_]}var R=new u(s.config);return ab=Object.assign({},I),R}function ub(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function cb(e){if(null==e)return e;var t,n=[],r=K(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(aH){r.e(aH)}finally{r.f()}return n}function lb(e){if(null==e)throw new Ky("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function db(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Ky("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function pb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Jy(n>=0),Jy(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function hb(e,t){Array.isArray(e)?(wr(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return hb(e,"element ".concat(n+1," of ").concat(t))}))):wr(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(fb(e),".")}))}function fb(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return fb(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function vb(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var mb=0;function gb(){return mb++}var yb={};function bb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in yb||(yb[e]=0),yb[e]+=1,e+yb[e].toString()}var xb=["channelsFirst","channelsLast"],kb=["nearest","bilinear"],wb=["valid","same","causal"],Cb=["max","avg"],Sb=["sum","mul","concat","ave"],Nb=new Map;function Ib(e){db(xb,"DataFormat",e)}function Tb(e){db(wb,"PaddingMode",e)}function Eb(e){db(Cb,"PoolMode",e)}var _b=[],Rb="/";function Ab(e,t){_b.push(e);try{var n=t();return _b.pop(),n}catch(r){throw _b.pop(),r}}function Ob(e){if(!Mb(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===_b.length?"":_b.join(Rb)+Rb)+e}function Fb(e){if(!Mb(e))throw new Error("Not a valid tensor name: '"+e+"'");Nb.has(e)||Nb.set(e,0);var t=Nb.get(e);if(Nb.set(e,Nb.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return Nb.set(n,1),n}return e}var Db,Lb=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Mb(e){return!!e.match(Lb)}function zb(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function Pb(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function Bb(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function Vb(e,t){if(t<e)throw new Ky("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function Wb(){return null==Db&&(Db=Su.backend.epsilon()),Db}function Ub(e,t){return Xc(e,t)}function jb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Hd(e,n)}function Hb(e,t,n){return $c((function(){switch(e.rank){case 1:return Af(e,t,n);case 2:return Of(e,[t,0],[n,e.shape[1]]);case 3:return Ff(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Df(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Yd(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Yd(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Ky("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Gb(e,t,n){return $c((function(){switch(e.rank){case 1:return Af(e,t,n);case 2:return Of(e,[0,t],[e.shape[0],n]);case 3:return Ff(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Df(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Ky("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function qb(e,t,n,r){return $c((function(){switch(e.rank){case 1:return Af(e,t,n);case 2:switch(r){case 1:return Hb(e,t,n);case 2:return Gb(e,t,n);default:throw new Ky("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return Hb(e,t,n);case 2:return Ff(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return Gb(e,t,n);default:throw new Ky("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return Hb(e,t,n);case 2:return Df(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Df(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return Gb(e,t,n);default:throw new Ky("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Ky("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Kb(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),Kd(e,n)}function Xb(e,t){switch(e.rank){case 1:return cp([e,t]);case 2:return lp([e,t],0);case 3:return dp([e,t],0);case 4:return pp([e,t],0);default:throw new Ky("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function Zb(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Ky("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return Jp(e,t)}function Yb(e){return cf(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function Qb(e,t,n,r){if(e.rank<2||t.rank<2)throw new Xy("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Xy("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return Av({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?ex(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=Hd(e,[-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(R(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=Hd(lv(t,l),[u,-1]);var d=[].concat(R(a),R(c));return Hd(Av({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?ex(e.rank,r,"channelsLast"):null,activation:n}),d)}function Jb(e,t,n){return $c((function(){return t=Array.isArray(t)?Kf(t,"int32"):Xc(t,"int32"),th(e,t,n)}))}function $b(e){return ol(e,e)}function ex(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Ky("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?Hd(t,[1,r[0],1,1,1]):Hd(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?Hd(t,[1,1,1,1,r[0]]):Hd(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?Hd(t,[1,r[0],1,1]):Hd(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?Hd(t,[1,1,1,r[0]]):Hd(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?Hd(t,[1,r[0],1]):Hd(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?Hd(t,[1,1,r[0]]):Hd(t,[1].concat(r))}else if(e<3)return t;throw new Ky("Unsupported input rank by biasAdd: ".concat(t.rank))}function tx(e,t,n){return $c((function(){return null==n&&(n="channelsLast"),Ib(n),rl(e,ex(e.rank,t,n))}))}function nx(e,t,n,r){return $c((function(){return gv(e,t,n,r)}))}function rx(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}var ax=["fanIn","fanOut","fanAvg"],ix=["normal","uniform","truncatedNormal"];var ox=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(pl),sx=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e,t){return Ah(e,t)}}]),n}(ox);sx.className="Zeros",fl(sx);var ux=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e,t){return Oh(e,t)}}]),n}(ox);ux.className="Ones",fl(ux);var cx=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),r=t.call(this),"object"!==typeof e)throw new Ky("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new Ky("config must have value set but got ".concat(e));return r.value=e.value,r}return L(n,[{key:"apply",value:function(e,t){var n=this;return $c((function(){return ol(dl(n.value),Oh(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(ox);cx.className="Constant",fl(cx);var lx=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return L(n,[{key:"apply",value:function(e,t){return df(e,this.minval,this.maxval,t,this.seed)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(ox);lx.className="RandomUniform",fl(lx);var dx=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return L(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Xy("randomNormal does not support dType ".concat(t,"."));return Yb(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ox);dx.className="RandomNormal",fl(dx);var px=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return L(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Xy("truncatedNormal does not support dType ".concat(t,"."));return $f(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ox);px.className="TruncatedNormal",fl(px);var hx=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return L(n,[{key:"apply",value:function(e,t){var n=this;return $c((function(){if(2!==e.length||e[0]!==e[1])throw new Ky("Identity matrix initializer can only be used for 2D square matrices.");return ol(n.gain,$p(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(ox);hx.className="Identity",fl(hx);var fx=function(e){z(n,e);var t=W(n);function n(e){var r,a;if(A(this,n),r=t.call(this),e.scale<0)throw new Ky("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,db(ax,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){db(ix,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return L(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Ib(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=zb(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=zb(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=zb(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Xy("".concat(this.getClassName()," does not support dType ").concat(t,"."));return $f(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return df(e,-s,s,t,this.seed)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(ox);fx.className="VarianceScaling",fl(fx);var vx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);vx.className="GlorotUniform",fl(vx);var mx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);mx.className="GlorotNormal",fl(mx);var gx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);gx.className="HeNormal",fl(gx);var yx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);yx.className="HeUniform",fl(yx);var bx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);bx.className="LeCunNormal",fl(bx);var xx=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return L(n,[{key:"getClassName",value:function(){return fx.className}}]),n}(fx);xx.className="LeCunUniform",fl(xx);var kx=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new Xy("Random seed is not implemented for Orthogonal Initializer yet.");return r}return L(n,[{key:"apply",value:function(e,t){var n=this;return $c((function(){if(e.length<2)throw new Xy("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=Yb(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=Dm.gramSchmidt(t);return e[0]>e[1]&&(r=lv(r)),ol(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(ox);kx.className="Orthogonal",fl(kx);var wx={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Cx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sb(e,hl.getMap().classNameMap,t,"initializer")}function Sx(e){return ib(e)}function Nx(e){if("string"===typeof e){var t=e in wx?wx[e]:e;if("GlorotNormal"===t)return new mx;if("GlorotUniform"===t)return new vx;if("HeNormal"===t)return new gx;if("HeUniform"===t)return new yx;if("LeCunNormal"===t)return new bx;if("LeCunUniform"===t)return new xx;var n={};return n.className=t,n.config={},Cx(n)}return e instanceof ox?e:Cx(e)}function Ix(e){return Array.isArray(e)&&Array.isArray(e[0])}function Tx(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Ex(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new Ky("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function _x(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new Ky("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Rx(e){var t,n=0,r=K(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(aH){r.e(aH)}finally{r.f()}return n}var Ax="Variable",Ox=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ax,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;A(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=gb(),r=null==r?Ax:r,this.originalName=Ob(r),this.name=Fb(this.originalName),this.trainable_=a,this.constraint=i,this.val=av(t,this.trainable_,this.name,this.dtype)}return L(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function Fx(e){return e.map((function(e){return e.read()}))}function Dx(e){e.forEach((function(e){e[0].write(e[1])}))}var Lx=L((function e(t){A(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),Mx=L((function e(t,n,r,a,i,o,s){A(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=gb(),null!=o&&(this.originalName=Ob(o),this.name=Fb(this.originalName)),this.rank=n.length})),zx=0,Px=function(){function e(t,n){A(this,e),this.callArgs=n,this.id=zx++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=K(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(aH){a.e(aH)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return L(e,[{key:"getConfig",value:function(){var e,t=[],n=K(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(aH){n.e(aH)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),Bx=0,Vx=function(e){z(n,e);var t=W(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=Bx++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=nb(i)+"_"+bb(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return L(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new qy("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new Ky("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return eb(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return eb(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new Gy("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new Gy("Layer ".concat(this.name)+" is not connected, no input to return.");return eb(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new Gy("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Gy("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return eb(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=tb(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=tb(this.inputSpec);if(e.length!==t.length)throw new Ky("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new Ky("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new Ky("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new Ky("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new Ky("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new Ky("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var d=0;d<a.shape.length;++d){var p=a.shape[d],h=r.shape[d];if(null!=p&&null!=h&&p!==h)throw new Ky("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=tb(e),i=!0,o=K(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof Mx)){i=!1;break}}}catch(aH){o.e(aH)}finally{o.f()}var s,u=!0,c=K(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof Mx){u=!1;break}}}catch(aH){c.e(aH)}finally{c.f()}if(i===u)throw new Ky("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ab(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=K(tb(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(aH){o.e(aH)}finally{o.f()}n.build(eb(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,l=n.call(e,t),d=[],p=K(tb(l));try{for(p.s();!(c=p.n()).done;){var h=c.value;-1!==a.indexOf(h)&&(h=h.clone()),d.push(h)}}catch(aH){p.e(aH)}finally{p.f()}if(l=eb(d),null!=n.activityRegularizer)throw new Xy("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}var f,v=function(e){e=tb(e);var t,n=[],r=K(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(aH){r.e(aH)}finally{r.f()}return eb(n)}(e),m=n.computeOutputShape(v),g="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?v[0]:v),f=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((function(r,a){return new Mx(g,r,n,tb(e),t,n.name,a)})):new Mx(g,m,n,tb(e),t,n.name),n.addInboundNode(e,f,null,null,v,m,t),n._refCount++,null!=n.activityRegularizer)throw new Xy("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Gy("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=K(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(aH){n.e(aH)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new Gy("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new qy("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Rx(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){return Fx(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;$c((function(){var n=t.weights;if(n.length!==e.length)throw new Ky('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=Fx(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!Ir(o.shape,u.shape))throw new Ky("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(u.shape));r.push([s,u])}Dx(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(e))throw new Ky("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():Nx("zeros"));var u=r.apply(t,n),c=new Ox(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=tb(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,R(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=tb(e);t=tb(t),n=tb(n),r=tb(r),a=Tx(a),i=Tx(i);var u,c=[],l=[],d=[],p=K(s);try{for(p.s();!(u=p.n()).done;){var h=u.value;c.push(h.sourceLayer),l.push(h.nodeIndex),d.push(h.tensorIndex)}}catch(aH){p.e(aH)}finally{p.f()}new Px({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:d,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(pl);function Wx(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=K(Wx(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]));try{for(s.s();!(o=s.n()).done;){var u=o.value;-1===a.indexOf(u)&&a.push(u)}}catch(aH){s.e(aH)}finally{s.f()}}return a}var Ux=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:bb("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Ky("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new Ky("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Ky("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new Mx(r.dtype,r.batchInputShape,V(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new Px({outboundLayer:V(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return L(n,[{key:"apply",value:function(e,t){throw new Ky("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(Vx);Ux.className="InputLayer",fl(Ux);var jx=function(){function e(t){if(A(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=K(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(aH){a.e(aH)}finally{a.f()}}}return L(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new Ky("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Xc(t,e.dtype)}catch(aH){throw new Ky("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof Mx){if(null==this.id2Value[e.id])throw new Ky("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new Ky("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof Mx){if(null==this.id2Value[e.id])throw new Ky("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new Ky("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&el(this.id2Mask)}}]),e}(),Hx=new Yy,Gx=new Yy;function qx(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),c=[],l=t.names(),d=K(u);try{for(d.s();!(a=d.n()).done;){var p=a.value;-1!==l.indexOf(p)?c.push(t.getValue(p)):c.push(null)}}catch(aH){d.e(aH)}finally{d.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,f=u.join(",")+"|"+t.names().sort().join(","),v=Hx.get(f);if(null==v){var m=function(e,t){wr(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Xx(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=K(e);try{for(s.s();!(i=s.n()).done;){var u,c=Xx(i.value,t),l=c.sorted,d=c.recipientMap,p=K(l);try{for(p.s();!(u=p.n()).done;){var h=u.value;o.has(h.name)||(n.push(h),o.add(h.name))}}catch(aH){p.e(aH)}finally{p.f()}var f=function(e){null==r[e]&&(r[e]=new Set),d[e].forEach((function(t){return r[e].add(t)}))};for(var v in d)f(v)}}catch(aH){s.e(aH)}finally{s.f()}}return{sorted:n,recipientCounts:Kx(r)}}(s,t);v=m.sorted,h=m.recipientCounts,Hx.put(f,v),Gx.put(f,h)}h={},i||Object.assign(h,Gx.get(f));for(var g=new jx(t),y=0;y<v.length;++y){if(null!=r){var b=Jc().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=v[y],k=x.sourceLayer;if(!(k instanceof Ux)){var w,C=[],S=[],N=[],I=!1,T=K(x.inputs);try{for(T.s();!(w=T.n()).done;){var E=w.value,_=g.getValue(E),R=g.getMask(E);C.push(_),S.push(R),null!=R&&(I=!0),i||(h[E.name]--,0!==h[E.name]||t.hasKey(E)||-1!==u.indexOf(E.name)||_.isDisposed||!0===E.sourceLayer.stateful||N.push(_))}}catch(aH){T.e(aH)}finally{T.f()}I&&((n=n||{}).mask=S[0]);var A=tb(k.apply(C,n)),O=null;k.supportsMasking&&(O=k.computeMask(C,S));for(var F=Zx(x),D=Array.isArray(F)?F:[F],L=0;L<D.length;++L){g.hasKey(D[L])||g.add(D[L],A[L],Array.isArray(O)?O[0]:O);var M=u.indexOf(D[L].name);-1!==M&&(c[M]=A[L])}i||el(N)}}return g.disposeMasks(),o?c:c[0]}function Kx(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Xx(e,t){var n,r=new Set,a=[],i={},o=K(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(aH){o.e(aH)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var d=c[c.length-1]===u.length-1;if(0===l.inputs.length||d)u.pop(),a.push(l),r.add(l.name),d&&c.pop();else{c.push(u.length-1);var p,h=K(l.inputs);try{for(h.s();!(p=h.n()).done;){var f=p.value;null==i[f.name]&&(i[f.name]=new Set),i[f.name].add(l.name),r.has(f.name)||u.push(f)}}catch(aH){h.e(aH)}finally{h.f()}}}}return{sorted:a,recipientMap:i}}function Zx(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=K(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(aH){i.e(aH)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function Yx(e,t){return $c((function(){return sl(Gp(ol(e,e),t,!0))}))}na().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(e){null!=Hx&&Hx.setMaxEntries(e),null!=Gx&&Gx.setMaxEntries(e)}));var Qx=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"getConfig",value:function(){return{}}}]),n}(pl),Jx=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return L(n,[{key:"apply",value:function(e){var t=this;return $c((function(){var n=Yx(e,t.axis),r=up(n,0,t.maxValue);return ol(e,il(r,rl(Wb(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(Qx);Jx.className="MaxNorm",fl(Jx);var $x=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return L(n,[{key:"apply",value:function(e){var t=this;return $c((function(){return il(e,rl(Wb(),Yx(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(Qx);$x.className="UnitNorm",fl($x);var ek=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return vf(e)}}]),n}(Qx);ek.className="NonNeg",fl(ek);var tk=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return L(n,[{key:"apply",value:function(e){var t=this;return $c((function(){var n=Yx(e,t.axis),r=rl(ol(t.rate,up(n,t.minValue,t.maxValue)),ol(1-t.rate,n));return ol(e,il(r,rl(Wb(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(Qx);tk.className="MinMaxNorm",fl(tk);var nk,rk={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ak(e){return ib(e)}function ik(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sb(e,hl.getMap().classNameMap,t,"constraint")}function ok(e){return null==e?null:"string"===typeof e?ik({className:e in rk?rk[e]:e,config:{}}):e instanceof Qx?e:ik(e)}function sk(e){return uk.apply(this,arguments)}function uk(){return(uk=mt(ft().mark((function e(t){var n,r,a,i,o,s,u,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];el(a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ck(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(nk||(nk={}));var lk=125,dk=function(){function e(){A(this,e),this.validationData=null}return L(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),pk=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;A(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return L(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=K(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(aH){n.e(aH)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=K(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(aH){n.e(aH)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=K(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=K(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=K(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=K(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=mt(ft().mark((function e(t){var n,r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=K(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=mt(ft().mark((function e(t){var n,r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=K(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),hk=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.call(this)}return L(n,[{key:"onEpochBegin",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i,o=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=ft().mark((function e(t){var a,i,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"number"===typeof(a=n[t])?(o.totals.hasOwnProperty(t)||(o.totals[t]=0),o.totals[t]=o.totals[t]+a*r):(t in o.totals?i=o.totals[t]:o.totals[t]=0,s=$c((function(){return rl(o.totals[t],ol(a,r))})),o.totals[t]=s,null!=i&&i.dispose());case 2:case"end":return e.stop()}}),e)})),e.t0=ft().keys(n);case 5:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,e.delegateYield(a(i),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i,o=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=20;break}r=K(this.params.metrics),e.prev=2,i=ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,null!=o.totals[t]){e.next=3;break}return e.abrupt("return","continue");case 3:"number"===typeof o.totals[t]?n[t]=o.totals[t]/o.seen:$c((function(){var e=ol(il(1,o.seen),o.totals[t]);n[t]=e,o.totals[t].dispose(),tl(n[t])}));case 4:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",7);case 7:if("continue"!==e.t0){e.next=10;break}return e.abrupt("continue",10);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(2),r.e(e.t1);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(dk),fk=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"onTrainBegin",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s,u,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,c=0;c<u.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=u[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(dk),vk=function(e){z(n,e);var t=W(n);function n(e,r){var a;if(A(this,n),(a=t.call(this)).currentEpoch=0,a.nowFunc=e.nowFunc,a.nextFrameFunc=e.nextFrameFunc||Wm,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=lk),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Br(a.yieldEvery)&&(a.maybeWait=function(e,t,n){var r,a=null!=n?n():Vs();return function(){var i=null!=n?n():Vs();return i-a<t?r:(a=i,r=e.apply(void 0,arguments))}}(a.maybeWait.bind(V(a)),a.yieldEvery,a.nowFunc)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return L(n,[{key:"maybeWait",value:function(){var e=mt(ft().mark((function e(t,n,r){var a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,sk(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(this.nextFrameFunc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,sk(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,sk(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(this.nextFrameFunc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,sk(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,sk(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(this.nextFrameFunc()):Br(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,sk(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,sk(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(dk);function mk(e,t){return null==e&&(e={}),e instanceof dk?[e]:Array.isArray(e)&&e[0]instanceof dk?e:tb(e).map((function(e){return new vk(e,t)}))}var gk=function(){function e(){A(this,e)}return L(e,null,[{key:"registerCallbackConstructor",value:function(t,n){wr(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new Ky("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,R(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function yk(e,t,n,r,a,i,o,s,u){var c=new fk,l=[new hk].concat(R(gk.createCallbacks(t)));null!=e&&l.push.apply(l,R(e)),l.push(c);var d=new pk(l);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:d,history:c}}function bk(){return bk="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},bk.apply(this,arguments)}function xk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return sb(e,hl.getMap().classNameMap,t,"layer",n)}function kk(e,t){return $c((function(){"float32"!==e.dtype&&(e=Xc(e,"float32"));var n=Gp($b(e),t,!0),r=gl(n.shape,Wb()),a=sl(Il(n,r));return il(e,a)}))}function wk(e,t){return $c((function(){return Rh($b(xl(t,e)),-1)}))}function Ck(e,t){return $c((function(){return Rh(wl(xl(t,e)),-1)}))}function Sk(e,t){return $c((function(){var n=xl(e,t),r=up(wl(e),Wb(),Number.MAX_VALUE),a=wl(il(n,r));return ol(100,Rh(a,-1))}))}function Nk(e,t){return $c((function(){var n=up(t,Wb(),Number.MAX_VALUE),r=hh(rl(1,n)),a=up(e,Wb(),Number.MAX_VALUE),i=hh(rl(1,a));return Rh($b(xl(r,i)),-1)}))}function Ik(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return $c((function(){if(n)t=Lf(t);else{var r=Gp(t,t.shape.length-1,!0);t=il(t,r)}return t=up(t,Wb(),1-Wb()),vh(Gp(ol(Xc(e,"float32"),hh(t)),t.shape.length-1))}))}function Tk(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return $c((function(){var r=Xc(eh(function(e){var t=[zb(e.shape)];return Hd(e,t)}(e)),"int32"),a=(t=up(t,Wb(),1-Wb())).shape;return Ik(Hd(Wh(r,a[a.length-1]),a),t,n)}))}function Ek(e,t){return $c((function(){var n;return n=up(t,Wb(),1-Wb()),n=hh(il(n,xl(1,n))),Rh(function(e,t){if(!Ir(e.shape,t.shape))throw new Ky("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return $c((function(){var n=vf(t),r=vh(wl(t));return rl(xl(n,ol(t,e)),fh(Zp(r)))}))}(e,n),-1)}))}function _k(e,t){return $c((function(){var n=up(e,Wb(),1),r=up(t,Wb(),1);return Gp(ol(e,hh(il(n,r))),-1)}))}function Rk(e,t){return $c((function(){var n=kk(e,-1),r=kk(t,-1),a=ol(n,r);return vh(Gp(a,-1))}))}gk.constructors={};var Ak={meanSquaredError:wk,meanAbsoluteError:Ck,meanAbsolutePercentageError:Sk,meanSquaredLogarithmicError:Nk,squaredHinge:function(e,t){return $c((function(){var n=Il(0,xl(1,ol(e,t)));return Rh($b(n),-1)}))},hinge:function(e,t){return $c((function(){var n=Il(0,xl(1,ol(e,t)));return Rh(n,-1)}))},categoricalHinge:function(e,t){return $c((function(){var n=Gp(ol(e,t),-1),r=jp(ol(xl(1,e),t),-1);return Il(0,rl(1,xl(r,n)))}))},logcosh:function(e,t){return $c((function(){var n=Math.log(2),r=xl(t,e),a=xl(rl(r,mh(ol(-2,r))),n);return Rh(a,-1)}))},categoricalCrossentropy:Ik,sparseCategoricalCrossentropy:Tk,binaryCrossentropy:Ek,kullbackLeiblerDivergence:_k,poisson:function(e,t){return $c((function(){var n=hh(rl(Wb(),t));return Rh(xl(t,ol(e,n)),-1)}))},cosineProximity:Rk};function Ok(e){if("string"===typeof e){if(e in Ak)return Ak[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Ky(t)}return e}function Fk(e,t){return $c((function(){var n=ol(.5,Uh(t)),r=Ub(nh(t,n),e.dtype);return Rh(_p(e,r),-1)}))}function Dk(e,t){return $c((function(){return Ub(_p(wd(e,-1),wd(t,-1)),"float32")}))}function Lk(e,t){return $c((function(){return Xc(Gp(xh(_p(e,1),_p(t,1))),"float32")}))}function Mk(e,t){return Ek(e,t)}function zk(e,t){return e.rank===t.rank&&(e=Uf(e,[e.rank-1])),(t=wd(t,-1)).dtype!==e.dtype&&(t=Xc(t,e.dtype)),Xc(_p(e,t),"float32")}var Pk=Ik,Bk=Tk,Vk={binaryAccuracy:Fk,categoricalAccuracy:Dk,precision:function(e,t){return $c((function(){var n=Lk(e,t),r=function(e,t){return $c((function(){return Xc(Gp(xh(_p(e,0),_p(t,1))),"float32")}))}(e,t),a=rl(n,r);return Xc(Rp(nh(a,0),il(n,a),0),"float32")}))},categoricalCrossentropy:Pk,sparseCategoricalCrossentropy:Bk,mse:wk,MSE:wk,mae:Ck,MAE:Ck,mape:Sk,MAPE:Sk,cosine:Rk};function Wk(e){if(Jy(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(Ak);n<r.length;n++){var a=r[n];if(Ak[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(Vk);i<o.length;i++){var s=o[i];if(Vk[s]===e){t=s;break}}return void 0!==t?t:e.name}var Uk=1048576;function jk(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!Hk(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>Uk&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(Uk,"."))}}function Hk(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!Hk(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=K(e);try{for(i.s();!(a=i.n()).done;){if(!Hk(a.value))return!1}}catch(aH){i.e(aH)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function Gk(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,R(s))}if(t){var u,c=K(e.layers);try{for(c.s();!(u=c.n()).done;){var l,d=u.value,p=!1,h=K(d.inboundNodes);try{for(h.s();!(l=h.n()).done;){var f=l.value;if(-1!==r.indexOf(f)){if(p){t=!1;break}p=!0}}}catch(aH){h.e(aH)}finally{h.f()}if(!t)break}}catch(aH){c.e(aH)}finally{c.f()}}return t}(e),o=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,R(e.nodesByDepth[s]))}a("_".repeat(t)),qk(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?Kk(c[l],n,a):Xk(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var d=function(e){var t;t=null!=e.collectedTrainableWeights?Rx(e.collectedTrainableWeights):Rx(e.trainableWeights);return t}(e),p=Rx(e.nonTrainableWeights);a("Total params: ".concat(d+p)),a("Trainable params: ".concat(d)),a("Non-trainable params: ".concat(p)),a("_".repeat(t))}function qk(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function Kk(e,t,n){var r,a;try{a=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(aH){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(aH){r="multiple"}var i=e.name,o=e.getClassName();qk(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function Xk(e,t,n,r){var a,i;try{i=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(aH){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(aH){a="multiple"}var o,s=[],u=K(e.inboundNodes);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var l=0;l<c.inboundLayers.length;++l){var d=c.inboundLayers[l].name,p=c.nodeIndices[l],h=c.tensorIndices[l];s.push("".concat(d,"[").concat(p,"][").concat(h,"]"))}}}catch(aH){u.e(aH)}finally{u.f()}var f=e.name,v=e.getClassName(),m=0===s.length?"":s[0];qk(["".concat(f," (").concat(v,")"),i,a,e.countParams().toString(),m],t,r);for(var g=1;g<s.length;++g)qk(["","","","",s[g]],t,r)}function Zk(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function Yk(e,t){if(null===e)return null;if("string"===typeof e)return rb(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Zk(t,a,i)?n.push(i):n.push(Yk(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var d=rb(c);o[d]=Yk(l,d)}}return o}function Qk(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return nb(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Zk(t,a,i)?n.push(i):n.push(Qk(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c],d=nb(c);o[d]="name"!==c&&"className"!==c||"string"!==typeof l?Qk(l,c):l}return o}var Jk="4.2.0",$k=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=bb(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],cb(r.inputs).length!==r.inputs.length)throw new Ky("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));cb(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=K(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.sourceLayer,c=s.nodeIndex,l=s.tensorIndex;r.outputLayers.push(u),r.outputLayersNodeIndices.push(c),r.outputLayersTensorIndices.push(l)}}catch(aH){o.e(aH)}finally{o.f()}var d,p=K(r.inputs);try{for(p.s();!(d=p.n()).done;){var h=d.value,f=h.sourceLayer,v=h.nodeIndex,m=h.tensorIndex;Jy(0===v,"input layer has >1 nodes"),Jy(0===m,"input layer has >1 tensors"),r.inputLayers.push(f),r.inputLayersNodeIndices.push(v),r.inputLayersTensorIndices.push(m)}}catch(aH){p.e(aH)}finally{p.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var g=0;g<r.inputLayers.length;g++){var y=r.inputLayers[g];if(!(y instanceof Ux))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(g," (0-based) originates ")+"from layer type ".concat(y.getClassName(),"."));r.inputNames.push(y.name),r.feedInputShapes.push(y.batchInputShape),r.feedInputNames.push(y.name)}var b,x=K(r.outputLayers);try{for(x.s();!(b=x.n()).done;){var k=b.value;r.outputNames.push(k.name)}}catch(aH){x.e(aH)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var w,C={},S={},N={},I={},T={},E=[],_=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new qy("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in T||(T[o.id]=Object.keys(T).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,d=0;d<l;d++){e(c.inputTensors[d],a,i,c.inboundLayers[d],c.nodeIndices[d],c.tensorIndices[d])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);E.push(c)}},R=[],O=[],F=K(r.outputs);try{for(F.s();!(w=F.n()).done;){_(w.value,R,O)}}catch(aH){F.e(aH)}finally{F.f()}var D,L=K(E.slice().reverse());try{for(L.s();!(D=L.n()).done;){var M=D.value;S[M.id]=M,M.id in C||(C[M.id]=0);var z=C[M.id],P=null==N[M.outboundLayer.id]?0:N[M.outboundLayer.id];z=Math.max(z,P),N[M.outboundLayer.id]=z,I[M.outboundLayer.id]=M.outboundLayer,C[M.id]=z;for(var B=0;B<M.inboundLayers.length;B++){var W=M.inboundLayers[B],U=M.nodeIndices[B],j=W.inboundNodes[U],H=null==C[j.id]?0:C[j.id];C[j.id]=Math.max(z+1,H),S[j.id]=j}}}catch(aH){L.e(aH)}finally{L.f()}var G={};for(var q in C){var X=C[q];X in G||(G[X]=[]),G[X].push(S[q])}var Z={};for(var Y in N){var Q=N[Y];Q in Z||(Z[Q]=[]),Z[Q].push(I[Y])}var J=Object.keys(Z).map((function(e){return parseInt(e,10)})).sort(ub);r.layers=[];var $,ee=K(J);try{for(ee.s();!($=ee.n()).done;){var te=Z[$.value];te.sort((function(e,t){var n=T[e.id],r=T[t.id];return n<r?-1:n>r?1:0}));var ne,re=K(te);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value;ae instanceof n&&r.internalContainerRefs.push(ae),r.layers.push(ae)}}catch(aH){re.e(aH)}finally{re.f()}}}catch(aH){ee.e(aH)}finally{ee.f()}r.layersByDepth=Z,J=Object.keys(G).map((function(e){return parseInt(e,10)})).sort(ub);var ie,oe=r.inputs.slice(),se=[],ue=K(J);try{for(ue.s();!(ie=ue.n()).done;){var ce,le=K(G[ie.value]);try{for(le.s();!(ce=le.n()).done;){var de=ce.value,pe=de.outboundLayer;if(null!=pe){var he,fe=K(de.inputTensors);try{for(fe.s();!(he=fe.n()).done;){var ve=he.value;if(-1===oe.indexOf(ve))throw new qy("Graph disconnected: cannot obtain value for tensor ".concat(ve)+' at layer "'.concat(pe.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(se))}}catch(aH){fe.e(aH)}finally{fe.f()}var me,ge=K(de.outputTensors);try{for(ge.s();!(me=ge.n()).done;){var ye=me.value;oe.push(ye)}}catch(aH){ge.e(aH)}finally{ge.f()}se.push(pe.name)}}}catch(aH){le.e(aH)}finally{le.f()}}}catch(aH){ue.e(aH)}finally{ue.f()}r.nodesByDepth=G;var be,xe=r.layers.map((function(e){return e.name})),ke=K(xe);try{var we=function(){var e=be.value,t=xe.filter((function(t){return t===e})).length;if(1!==t)throw new qy('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(xe))};for(ke.s();!(be=ke.n()).done;)we()}catch(aH){ke.e(aH)}finally{ke.f()}return r.outboundNodes=[],r.inboundNodes=[],new Px({outboundLayer:V(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return L(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=K(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(aH){n.e(aH)}finally{n.f()}var a,i=K(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(aH){i.e(aH)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new Ky("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=K(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(aH){n.e(aH)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=K(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,R(r.nonTrainableWeights))}}catch(aH){n.e(aH)}finally{n.f()}if(!this.trainable){var a,i=[],o=K(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,R(s.trainableWeights))}}catch(aH){o.e(aH)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=K(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=K(t.value.weights);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(null!=r[u.originalName])throw new Ky("Duplicate weight name: ".concat(u.originalName));r[u.originalName]=u,a++}}catch(aH){s.e(aH)}finally{s.f()}}}catch(aH){i.e(aH)}finally{i.f()}var c=[];for(var l in e){var d=l;if(null==r[l]){var p=l.split("/");d=p.slice(0,-2).concat([p[p.length-1]]).join("/")}if(null!=r[d])c.push([r[d],e[l]]);else if(n)throw new Ky("Provided weight data has no target variable: ".concat(l));delete r[d]}if(n){var h=[];for(var f in r)h.push(f);if(h.length>0)throw new Ky("".concat(h.length," of ").concat(a," weights are not set: ")+"".concat(h))}Dx(c)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(Jk),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Qk(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return $c((function(){e=tb(e);for(var r=new jx,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return qx(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return $c((function(){var r;return e=tb(e),r=null==t?Qy(null,e.length):tb(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=Tx(e);if(t.length!==this.inputLayers.length)throw new Ky("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ub);if(o.length>1){var s,u=K(o);try{for(u.s();!(s=u.n()).done;){var c,l=s.value,d=K(this.nodesByDepth[l]);try{for(d.s();!(c=d.n()).done;){var p=c.value,h=p.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(h.id)){for(var f=[],v=0;v<p.inboundLayers.length;v++){var m=p.inboundLayers[v],g=p.nodeIndices[v],y=p.tensorIndices[v],b=n["".concat(m.name,"_").concat(g,"_").concat(y)];f.push(b)}for(var x=Tx(h.computeOutputShape(eb(f))),k=h.inboundNodes.indexOf(p),w=0;w<x.length;w++){n["".concat(h.name,"_").concat(k,"_").concat(w)]=x[w]}}}}catch(aH){d.e(aH)}finally{d.f()}}}catch(aH){u.e(aH)}finally{u.f()}}for(var C=[],S=[],N=0;N<this.outputLayers.length;N++){var I=this.outputLayers[N],T=this.outputLayersNodeIndices[N],E=this.outputLayersTensorIndices[N],_="".concat(I.name,"_").concat(T,"_").concat(E);S.push(_)}for(var R=0;R<S.length;R++){var A=S[R];Jy(A in n),C.push(n[A])}return eb(C)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=Qy(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var s,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ub),c=K(u);try{for(c.s();!(s=c.n()).done;){var l,d=s.value,p=K(this.nodesByDepth[d]);try{for(p.s();!(l=p.n()).done;){var h,f=l.value,v=f.outboundLayer,m=f.inputTensors,g=f.outputTensors,y=new Array,b=K(m);try{for(b.s();!(h=b.n()).done;){var x=h.value;x.id in n&&y.push(n[x.id])}}catch(aH){b.e(aH)}finally{b.f()}if(y.length===m.length){var k={},w=void 0,C=void 0,S=void 0,N=void 0;if(null!=f.callArgs&&(k=f.callArgs),1===y.length){var I=H(y[0],2),T=I[0],E=I[1];null==k.mask&&(k.mask=E),S=tb(v.call(T,k)),N=tb(v.computeMask(T,E)),w=[T],C=[E]}else w=y.map((function(e){return e[0]})),C=y.map((function(e){return e[1]})),null==k.mask&&(k.mask=C),S=tb(v.call(w,k)),N=tb(v.computeMask(w,C));if(v.activityRegularizer)throw new Xy("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var _=0;_<g.length;++_){var R=g[_],A=S[_],O=N[_];n[R.id]=[A,O]}}}}catch(aH){p.e(aH)}finally{p.f()}}}catch(aH){c.e(aH)}finally{c.f()}var F,D=[],L=[],M=[],z=K(this.outputs);try{for(z.s();!(F=z.n()).done;){var P=F.value;Jy(P.id in n,"Could not compute output ".concat(P.name," : ").concat(P.id));var B=H(n[P.id],2),V=B[0],W=B[1];M.push(V.shape),D.push(V),L.push(W)}}catch(aH){z.e(aH)}finally{z.f()}return[D,L,M]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=K(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(aH){i.e(aH)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new Ky("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new Ky("Provide either a layer name or layer index");var n,r=K(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(aH){r.e(aH)}finally{r.f()}throw new Ky("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return $c((function(){var t,r=[],a=K(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,R(i.calculateLosses()))}}catch(aH){a.e(aH)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=K(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var d=o.inboundNodes[l],p=n.nodeKey(o,l),h={};if(this.containerNodes.has(p)){if(d.callArgs)try{JSON.stringify(d.callArgs),h=d.callArgs}catch(aH){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(d.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),h={}}if(d.inboundLayers.length>0){for(var f=[],v=0;v<d.inboundLayers.length;v++){var m=d.inboundLayers[v],g=d.nodeIndices[v],y=d.tensorIndices[v],b=r[n.nodeKey(m,g)];null==b&&(b=0),f.push([m.name,b,y,h])}c.push(f)}}}var x={};x.name=o.name,x.className=s,x.config=u,x.inboundNodes=c,a.push(x)}}catch(aH){i.e(aH)}finally{i.f()}t.layers=a;for(var k=[],w=0;w<this.inputLayers.length;w++){var C=this.inputLayers[w],S=this.inputLayersNodeIndices[w],N=n.nodeKey(C,S);if(this.containerNodes.has(N)){var I=r[N];null!==I&&void 0!==I||(I=0);var T=this.inputLayersTensorIndices[w];k.push([C.name,I,T])}}t.inputLayers=k;for(var E=[],_=0;_<this.outputLayers.length;_++){var R=this.outputLayers[_],A=this.outputLayersNodeIndices[_],O=n.nodeKey(R,A);if(this.containerNodes.has(O)){var F=r[O];null!==F&&void 0!==F||(F=0);var D=this.outputLayersTensorIndices[_];E.push([R.name,F,D])}}return t.outputLayers=E,t}},{key:"stateful",get:function(){if(this._stateful)throw new Ky("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=K(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(aH){t.e(aH)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;$c((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=K(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],d=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var p=r[c];if(p.inboundNodes.length<=l)return void i(e,t);var h=p.inboundNodes[l];o.push(h.outputTensors[d])}}catch(aH){s.e(aH)}finally{s.f()}o.length>0&&e.apply(eb(o),n)}function s(e){var a=e.name,o=xk(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new Ky("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,d=K(l);try{for(d.s();!(u=d.n()).done;){s(u.value)}}catch(aH){d.e(aH)}finally{d.f()}for(;!lb(a);){var p,h=K(l);try{for(h.s();!(p=h.n()).done;){var f=p.value,v=r[f.name];if(v.name in a){var m=a[v.name];delete a[v.name];var g,y=K(m);try{for(y.s();!(g=y.n()).done;){o(v,g.value)}}catch(aH){y.e(aH)}finally{y.f()}}}}catch(aH){h.e(aH)}finally{h.f()}}var b,x=[],k=[],w=K(t.inputLayers);try{for(w.s();!(b=w.n()).done;){var C=b.value,S=C[0],N=C[1],I=C[2];Jy(S in r);var T=r[S].inboundNodes[N].outputTensors;x.push(T[I])}}catch(aH){w.e(aH)}finally{w.f()}var E,_=K(t.outputLayers);try{for(_.s();!(E=_.n()).done;){var R=E.value,A=R[0],O=R[1],F=R[2];Jy(A in r);var D=r[A].inboundNodes[O].outputTensors;k.push(D[F])}}catch(aH){_.e(aH)}finally{_.f()}return new e({inputs:x,outputs:k,name:c})}}]),n}(Vx);function ew(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function tw(e,t){return ew(e,t,"classWeight")}function nw(e,t,n,r){return rw.apply(this,arguments)}function rw(){return(rw=mt(ft().mark((function e(t,n,r,a){var i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=$c((function(){if(1===t.shape.length)return Zc(t);if(2===t.shape.length){if(t.shape[1]>1){return wd(t,1)}if(1===t.shape[1])return Hd(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),el(i),s=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),e.abrupt("return",Kf(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aw(e,t){return ol(e,t)}var iw=32;function ow(e,t){var n,r,a=t;n=a.xs,r=a.ys,wr(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=sw("input",e.inputNames,n),o=sw("output",e.outputNames,r),s=i[0].shape[0];wr(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),wr(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){wr(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)u(c);for(var l=function(t){wr(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},d=0;d<o.length;d++)l(d);return{xs:i,ys:o}}function sw(e,t,n){if(n instanceof au)return[n];if(Array.isArray(n))return wr(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=K(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new Ky("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(aH){i.e(aH)}finally{i.f()}return a}function uw(e){if(3===e.length)throw new Xy("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function cw(e,t,n){return lw.apply(this,arguments)}function lw(){return lw=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,w,C,S,N,I,T,E,_,R,A,O,F,D,L,M;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,wr(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),wr(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),wr(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),wr(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),wr(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(pw(r.validationData)?wr(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(u=uw(r.validationData),o=u.xs,s=u.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),d=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),p=mk(r.callbacks,r.yieldEvery),h=null==r.verbose?1:r.verbose,f=yk(p,h,r.epochs,null,null,dw(n,r),null,i,d),v=f.callbackList,m=f.history,v.setModel(t),t.history=m,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(g<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(g);case 31:if(x=0,k=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(x<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(x," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return C=ow(t,w.value),S=C.xs,N=C.ys,(I={}).batch=k,I.size=S[0].shape[0],e.next=51,v.onBatchBegin(k,I);case 51:if(T=[],null==r.classWeight){e.next=64;break}E=tw(r.classWeight,t.outputNames),_=0;case 55:if(!(_<E.length)){e.next=64;break}return e.t0=T,e.next=59,nw(N[_],null,E[_]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++_,e.next=55;break;case 64:for(R=S.concat(N).concat(T),A=c(R),el(R),O=0;O<l.length;++O)F=l[O],D=A[O],I[F]=D,tl(D);return e.next=70,v.onBatchEnd(k,I);case 70:ck(I),k++,x++;case 73:if(!(a?x>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!i){e.next=86;break}if(L=void 0,!pw(r.validationData)){e.next=84;break}return e.t2=tb,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,L=(0,e.t2)(e.t3),e.next=85;break;case 84:L=tb(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?iw:r.validationBatchSize,verbose:0}));case 85:for(M=0;M<t.metricsNames.length;++M)b["val_".concat(t.metricsNames[M])]=L[M];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(g,b);case 93:if(g++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),lw.apply(this,arguments)}function dw(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function pw(e){return"function"===typeof e.iterator}function hw(e,t,n){return fw.apply(this,arguments)}function fw(){return fw=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new Xy("Verbose mode is not implemented yet.");case 6:if(wr(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),"function"!==typeof n.next){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,u=0,c=0,l=ft().mark((function e(){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=$c((function(){if(n.value){var e=ow(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),l=$c((function(){return i(s)}));if(el(s),0===c)for(var d=0;d<l.length;++d)o.push(dl(0));for(var p=s[0].shape[0],h=function(e){var t=l[e],n=o[e];o[e]=$c((function(){return rl(o[e],ol(p,t))})),c>0&&el(n)},f=0;f<l.length;++f)h(f);el(l),u+=p,++c}return o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(d=0;d<o.length;++d)p=o[d],o[d]=il(o[d],u),el(p);return e.abrupt("return",eb(o));case 27:case"end":return e.stop()}}),e)}))),fw.apply(this,arguments)}function vw(e){wr(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function mw(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return Hb(e,t,n-t)})):Hb(e,t,n-t)}function gw(e,t){return $c((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return gw(e,t)})):Jb(e,"int32"===t.dtype?t:Xc(t,"int32"))}))}function yw(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function bw(e){var t=[];e instanceof au&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(jb(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function xw(e,t){if(null!=e){var n=[];if(t instanceof au)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof au)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var s=e[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function kw(e){return Array.isArray(e)}function ww(e){return!function(e){return e instanceof au}(e)&&!kw(e)}function Cw(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(kw(e)&&e.length>0)o=!0;else if(ww(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new Ky("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(ww(e)){r=[];var u,c=K(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new Ky('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(aH){c.e(aH)}finally{c.f()}}else if(kw(e)){if(e.length!==t.length)throw new Ky("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new Ky("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=bw(r),null!=n)for(var d=0;d<t.length;++d)if(null!=n[d]){var p=r[d];if(p.shape.length!==n[d].length)throw new Ky("Error when checking ".concat(i,": expected ").concat(t[d]," ")+"to have ".concat(n[d].length," dimension(s). but got array with ")+"shape ".concat(p.shape));for(var h=0;h<n[d].length;++h)if(0!==h||a){var f=p.shape[h],v=n[d][h];if(null!=v&&v>=0&&f!==v)throw new Ky("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[d].slice(1,n[d].length),"] ")+"(i.e.,tensor shape [*,".concat(n[d].slice(1,n[d].length),"])")+" but the ".concat(i," received an input with ").concat(p.shape[0])+" examples, each with shape [".concat(p.shape.slice(1,p.shape.length),"]")+" (tensor shape [".concat(p.shape,"])"))}}return r}function Sw(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new Ky("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new Ky("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new Ky("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new Ky("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var Nw=function(t){z(r,t);var n=W(r);function r(e){var t;return A(this,r),(t=n.call(this,e)).isTraining=!1,t}return L(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Ky("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Gk(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return Bm.adagrad(.01)},Adadelta:function(){return Bm.adadelta(1,.95,Wb())},Adam:function(){return Bm.adam(.001,.9,.999,Wb())},Adamax:function(){return Bm.adamax(.002,.9,.999,Wb(),0)},RMSProp:function(){return Bm.rmsprop(.001,.9,0,Wb())},SGD:function(){return Bm.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Ky("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof vl))throw new Ky("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Ky("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return Ok(e)}))}else{var a=Ok(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new Ky('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,s=K(this.outputNames);try{for(s.s();!(o=s.n()).done;){var u=o.value;null==e.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),n.push(Ok(e.loss[u]))}}catch(aH){s.e(aH)}finally{s.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],d=this.outputNames[c];this.feedOutputNames.push(d),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var p=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ab("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===p.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var h=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=K(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(aH){i.e(aH)}finally{i.f()}return a}(e.metrics,this.outputNames);Ab("metric",(function(){for(var e=function(e){if(-1!==p.indexOf(e))return"continue";!function(n){var r,a,i,o,s=K(n);try{var u=function(){var n,s=o.value;if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){var u,c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===Ek?-1!==["accuracy","acc"].indexOf(s)?a=Fk:-1!==["crossentropy","ce"].indexOf(s)&&(a=Mk):t.lossFunctions[e]===Tk?-1!==["accuracy","acc"].indexOf(s)?a=zk:-1!==["crossentropy","ce"].indexOf(s)&&(a=Bk):-1!==["accuracy","acc"].indexOf(s)?a=Dk:-1!==["crossentropy","ce"].indexOf(s)&&(a=Pk),-1!==["accuracy","acc"].indexOf(s)?u="acc":-1!==["crossentropy","ce"].indexOf(s)&&(u="ce"),i=a,r=""+u}else{var l=function(e){if("string"===typeof e&&e in Vk)return Vk[e];if("string"!==typeof e&&null!=e)return e;throw new Ky("Unknown metric ".concat(e))}(s);i=l,r=""+Wk(s)}Ab(r,(function(){n=i})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,r,n)};for(s.s();!(o=s.n()).done;)u()}catch(aH){s.e(aH)}finally{s.f()}}(h[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;vw(r);var a=this.standardizeUserDataXY(e,t,!0,r);try{var i=a[0].concat(a[1]);this.makeTestFunction();var o=this.testFunction;return eb(this.testLoop(o,i,r,n.verbose,n.steps))}finally{xw(a[0],e),xw(a[1],t)}}},{key:"evaluateDataset",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",hw(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new Ky("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new Ky("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new Ky("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new jx;if(e instanceof au&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Ky("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var s,u=K(this.inputs);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e[c.name];if(null==l)throw new Ky("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(aH){u.e(aH)}finally{u.f()}}var d=qx(a,i);return n?d:d[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=Qy(null,e.length),r=e.length,a=K(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(aH){a.e(aH)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new Ky("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return $c((function(){var a=t.checkNumSamples(e);if(r)throw new Xy("Verbose predictLoop() is not implemented yet.");for(var i=yw(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){$c((function(){var r=i[n][0],a=i[n][1],o=mw(e,r,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:t.inputs[u],value:o[u]});else s.push({key:t.inputs[0],value:o});var c=new jx(s);return qx(t.outputs,c)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return eb(o.map((function(e){return Kd(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=bw(e);Sw(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return vw(r),this.predictLoop(n,r)}finally{xw(n,e)}}},{key:"predictOnBatch",value:function(e){Sw(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new qy("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a];this.feedLossFns[a]===Tk?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(function(e,t,n){var r=cb(e.map((function(e){return e.shape[0]})));r.sort();var a=cb(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new Ky("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new Ky("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!Ir(r,a))throw new Ky("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(e=Cw(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Cw(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){for(var r=[wk,Ek,Ik],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===Ik&&1===i.shape[i.shape.length-1])throw new Ky("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var d=u[l],p=c[l];if(null!=p&&d!==p)throw new Ky("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new Ky("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=mt(ft().mark((function e(t,n,r,a){var i,o,s,u,c,l,d,p,h,f=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(f.length>4&&void 0!==f[4])||f[4],o=f.length>5?f[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=H(s,2),c=u[0],l=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(d=null,null==a){e.next=19;break}p=tw(a,this.outputNames),d=[],h=0;case 10:if(!(h<p.length)){e.next=19;break}return e.t0=d,e.next=14,nw(l[h],null,p[h]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++h,e.next=10;break;case 19:return e.abrupt("return",[c,l,d]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return $c((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new Xy("Verbose mode is not implemented yet.");if(null!=i)throw new Xy("steps mode in testLoop() is not implemented yet");for(var u=yw(o,n),c=Kf(Vb(0,o)),l=0;l<u.length;++l){var d=u[l][0],p=u[l][1],h=Hb(c,d,p-d),f=gw(t,h),v=e(f);if(0===l)for(var m=0;m<v.length;++m)s.push(dl(0));for(var g=0;g<v.length;++g){var y=v[g];s[g]=rl(s[g],ol(p-d,y))}}for(var b=0;b<s.length;++b)s[b]=il(s[b],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if($y(e,r)>1){var i=$y(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new jx(t),l=qx(e.outputs,c,{training:!0}),d=0;d<e.lossFunctions.length;++d){var p=(0,e.lossFunctions[d])(a[d],l[d]);null!=i[d]&&(p=aw(p,i[d]));var h=Rh(p);n.push(h),u=0===d?p:rl(u,p)}for(var f=0;f<e.metricsTensors.length;++f){var v=void 0;if(e.outputs.length>1&&f<e.outputs.length)v=n[f];else{var m=e.metricsTensors[f][0],g=e.metricsTensors[f][1];v=Rh(m(a[g],l[g]))}tl(v),o.push(v)}return u=Rh(u),e.calculateLosses().forEach((function(e){u=rl(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return $c((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new jx(o),c=qx(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var d=e.lossFunctions[l],p=Rh(d(i[l],c[l]));n=0===l?p:rl(n,p),r.push(n)}for(var h=0;h<e.metricsTensors.length;++h){var f=e.metricsTensors[h][0],v=e.metricsTensors[h][1],m=Rh(f(i[v],c[v]));r.push(m)}return r}))}}},{key:"fit",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,w,C,S,N,I,T=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=T.length>2&&void 0!==T[2]?T[2]:{},!this.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return this.isTraining=!0,e.prev=4,vw(h=null==r.batchSize?32:r.batchSize),!1,e.next=10,this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,false,h);case 10:if(f=e.sent,a=f[0],i=f[1],p=f[2],v=!1,!(null!=r.validationData&&r.validationData.length>0)){e.next=36;break}if(v=!0,2!==r.validationData.length){e.next=22;break}u=r.validationData[0],c=r.validationData[1],e.next=27;break;case 22:if(3!==r.validationData.length){e.next=26;break}throw new Xy("validationData including sample weights is not supported yet.");case 26:throw new Ky("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(r.validationData," is invalid."));case 27:return!0,e.next=30,this.standardizeUserData(u,c,null,null,true,h);case 30:g=e.sent,l=g[0],d=g[1],m=l.concat(d),e.next=37;break;case 36:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(v=!0,y=Math.floor(a[0].shape[0]*(1-r.validationSplit)),b=a[0].shape[0],l=mw(a,y,b),o=a,a=mw(a,0,y),d=mw(i,y,b),s=i,i=mw(i,0,y),m=l.concat(d)):null!=r.validationSteps&&(v=!0);case 37:return x=a.concat(i).concat(p),this.checkTrainableWeightsConsistency(),k=this.makeTrainFunction(),w=this.getDedupedMetricsNames(),v?(this.makeTestFunction(),C=this.testFunction,S=w.slice().concat(w.map((function(e){return"val_"+e})))):(C=null,m=[],S=w.slice()),N=mk(r.callbacks,r.yieldEvery),e.next=45,this.fitLoop(k,x,w,h,r.epochs,r.verbose,N,C,m,r.shuffle,S,r.initialEpoch,null,null);case 45:return I=e.sent,e.abrupt("return",I);case 47:return e.prev=47,this.isTraining=!1,xw(a,t),xw(i,n),xw(o,t),xw(s,n),xw(l,u),xw(d,c),null!=p&&el(p),e.finish(47);case 57:case"end":return e.stop()}}),e,this,[[4,,47,57]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitLoop",value:function(){var e=mt(ft().mark((function e(t,n,r,a,i,o,s,u,c,l,d,p,h,f){var v,m,g,y,b,x,k,w,C=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==p&&(p=0),v=!1,null!=u&&null!=c&&(v=!0),null==f){e.next=10;break}if(v=!0,null!=h){e.next=10;break}throw new Ky("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(m=this.checkNumSamples(n,a,h,"steps_per_epoch"))&&(g=Vb(0,m)),null==o&&(o=1),y=yk(s,o,i,p,m,h,a,v,d),b=y.callbackList,x=y.history,b.setModel(this),this.history=x,e.next=18,b.onTrainBegin();case 18:this.stopTraining_=!1,k=ft().mark((function e(){var i,o,s,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.onEpochBegin(w);case 2:if(i={},null==h){e.next=7;break}throw new Xy("stepsPerEpoch mode is not implemented yet.");case 7:if("batch"!==l){e.next=11;break}throw new Xy("batch shuffling is not implemneted yet");case 11:l&&gr(g);case 12:o=Kf(g),s=yw(m,a),d=ft().mark((function e(l){var d;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d={},e.next=3,b.onBatchBegin(l,d);case 3:return $c((function(){var e=s[l][0],p=s[l][1],h=Hb(o,e,p-e);d.batch=l,d.size=p-e;for(var f=gw(n,h),m=t(f),g=0;g<r.length;++g){var y=r[g],b=m[g];d[y]=b,tl(b)}if(l===s.length-1&&v)for(var x=C.testLoop(u,c,a),k=0;k<r.length;++k){var w=r[k],S=x[k];tl(S),i["val_"+w]=S}})),e.next=6,b.onBatchEnd(l,d);case 6:if(ck(d),!C.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),p=0;case 16:if(!(p<s.length)){e.next=24;break}return e.delegateYield(d(p),"t0",18);case 18:if("break"!==e.t0){e.next=21;break}return e.abrupt("break",24);case 21:++p,e.next=16;break;case 24:o.dispose();case 25:return e.next=27,b.onEpochEnd(w,i);case 27:if(!C.stopTraining_){e.next=29;break}return e.abrupt("return","break");case 29:case"end":return e.stop()}}),e)})),w=p;case 21:if(!(w<i)){e.next=29;break}return e.delegateYield(k(),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++w,e.next=21;break;case 29:return e.next=31,b.onTrainEnd();case 31:return e.next=33,this.history.syncData();case 33:return e.abrupt("return",this.history);case 34:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,o,s,u,c,l,d,p,h,f){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",cw(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),s=o(a.concat(i)),u=[],c=K(s),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return d=l.value,e.next=15,d.data();case 15:p=e.sent,u.push(p[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return el(s),xw(r[0],t),xw(r[1],n),e.abrupt("return",eb(u));case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=bk(P(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=Jc().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Jc().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=nb(this.loss);else if(Array.isArray(this.loss)){var t,n=K(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(aH){n.e(aH)}finally{n.f()}e=this.loss.map((function(e){return nb(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=nb(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[nb(Wk(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return nb(Wk(e))}));var e={};for(var t in this.metrics)e[t]=nb(Wk(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=xk(Yk(e.optimizer_config));if("string"===typeof e.loss)t=rb(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return rb(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=rb(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return rb(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=rb(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var t=mt(ft().mark((function t(n,r){var a,i,o,s,u,c,l,d,p;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof n){t.next=9;break}if(0!==(a=sc(n)).length){t.next=6;break}throw new Ky("Cannot find any save handlers for URL '".concat(n,"'"));case 6:if(!(a.length>1)){t.next=8;break}throw new Ky("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(n,"'"));case 8:n=a[0];case 9:if(null!=n.save){t.next=11;break}throw new Ky("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.next=13,Wu(this.getNamedWeights(r));case 13:if(i=t.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Jk),convertedBy:null},!(null!=r&&r.includeOptimizer)||null==this.optimizer){t.next=34;break}return s.trainingConfig=this.getTrainingConfig(),c="optimizer",t.t0=e,t.next=25,this.optimizer.getWeights();case 25:return t.t1=t.sent,t.t2=c,t.next=29,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 29:l=t.sent,d=l.data,p=l.specs,(u=i.specs).push.apply(u,R(p)),i.data=Zu([i.data,d]);case 34:return null!=this.userDefinedMetadata&&(!0,jk(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=i.data,s.weightSpecs=i.specs,t.abrupt("return",n.save(s));case 38:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){jk(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}($k);Nw.className="Model",fl(Nw);var Iw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n)}(Nw);Iw.className="Functional",fl(Iw);var Tw=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:bb("sequential_"),null!=e.layers){var a,i=K(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(aH){i.e(aH)}finally{i.f()}}return r}return L(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new Ky("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof Nw;if(r){if(1!==(t=e).outputs.length)throw new Ky("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new Ky("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Ky("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Ky("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new Ux({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new Ky("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new Ky("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Wx(this.outputs[0])}this.inboundNodes=[],new Px({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Qy(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(_x(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Nw({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),bk(P(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),bk(P(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new qy("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new qy("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=mt(ft().mark((function e(t,n){var r,a=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new qy("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new qy("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new Ky("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new Ky("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=K(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(aH){n.e(aH)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Ky("Legacy serialization format not supported yet.");r=t}else wr(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new Xy("Sequential.fromConfig called on non-Sequential input: ".concat(o));var s,u=K(r);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=xk(c,undefined,a);a&&l.setFastWeightInitDuringBuild(!0),o.add(l)}}catch(aH){u.e(aH)}finally{u.f()}return o}}]),n}(Nw);Tw.className="Sequential",fl(Tw);var Ew=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"getConfig",value:function(){return{}}}]),n}(pl),_w=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new Xy("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Dp(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}]),n}(Ew);_w.className="elu",fl(_w);var Rw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return Sf(e)}}]),n}(Ew);Rw.className="selu",fl(Rw);var Aw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return vf(e)}}]),n}(Ew);Aw.className="relu",fl(Aw);var Ow=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return $c((function(){return Dh(6,vf(e))}))}}]),n}(Ew);Ow.className="relu6",fl(Ow);var Fw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return e}}]),n}(Ew);Fw.className="linear",fl(Fw);var Dw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return Zd(e)}}]),n}(Ew);Dw.className="sigmoid",fl(Dw);var Lw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return function(e){return $c((function(){var t=rl(.5,ol(.2,e));return up(t,0,1)}))}(e)}}]),n}(Ew);Lw.className="hardSigmoid",fl(Lw);var Mw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return mh(e)}}]),n}(Ew);Mw.className="softplus",fl(Mw);var zw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return function(e){return $c((function(){return il(e,rl(wl(e),1))}))}(e)}}]),n}(Ew);zw.className="softsign",fl(zw);var Pw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return Qd(e)}}]),n}(Ew);Pw.className="tanh",fl(Pw);var Bw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return Lf(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(Ew);Bw.className="softmax",fl(Bw);var Vw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return yh(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(Ew);Vw.className="logSoftmax",fl(Vw);var Ww=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return $c((function(){return ol(Zd(ol(e,t)),e)}))}}]),n}(Ew);Ww.className="swish",fl(Ww);var Uw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e){return $c((function(){return ol(e,Qd(mh(e)))}))}}]),n}(Ew);function jw(e){return e.getClassName()}function Hw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sb(e,hl.getMap().classNameMap,t,"activation")}function Gw(e){if(null==e){var t={className:"linear",config:{}};return Hw(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},Hw(n)}return e instanceof Ew?e:Hw(e)}function qw(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}Uw.className="mish",fl(Uw);var Kw=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n)}(pl),Xw=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this),qw(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return L(n,[{key:"apply",value:function(e){var t=this;return $c((function(){var n=Ah([1]);return t.hasL1&&(n=rl(n,Gp(ol(t.l1,wl(e))))),t.hasL2&&(n=rl(n,Gp(ol(t.l2,$b(e))))),Hd(n,[])}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(Kw);Xw.className="L1L2",fl(Xw);var Zw={l1l2:"L1L2"};function Yw(e){return ib(e)}function Qw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sb(e,hl.getMap().classNameMap,t,"regularizer")}function Jw(e){return null==e?null:"string"===typeof e?Qw({className:e in Zw?Zw[e]:e,config:{}}):e instanceof Kw?e:Qw(e)}var $w=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return L(n,[{key:"call",value:function(e,t){e=Ex(e);var n=vf(e);return null!=this.maxValue&&(n=up(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);$w.className="ReLU",fl($w);var eC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return L(n,[{key:"call",value:function(e,t){var n=Ex(e);return uh(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);eC.className="LeakyReLU",fl(eC);var tC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Nx(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Jw(e.alphaRegularizer),r.alphaConstraint=ok(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new Ky("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return L(n,[{key:"build",value:function(e){var t=(e=_x(e)).slice(1);if(null!=this.sharedAxes){var n,r=K(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(aH){r.e(aH)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new Lx({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=Ex(e),Qh(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:Sx(this.alphaInitializer),alphaRegularizer:Yw(this.alphaRegularizer),alphaConstraint:ak(this.alphaConstraint),sharedAxes:this.sharedAxes},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);tC.className="PReLU",fl(tC);var nC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new Xy("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return L(n,[{key:"call",value:function(e,t){var n=Ex(e);return Dp(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);nC.className="ELU",fl(nC);var rC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return L(n,[{key:"call",value:function(e,t){var n=Ex(e);return ol(n,Xc(nh(n,this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);rC.className="ThresholdedReLU",fl(rC);var aC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new Bw).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return L(n,[{key:"call",value:function(e,t){var n=Ex(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);function iC(e,t,n){if("number"===typeof e)return Qy(e,t);if(e.length!==t)throw new Ky("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new Ky("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function oC(e,t,n,r){var a;return null==e?e:(a="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r))}function sC(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+Bb([n-t,0]);else{if("same"!==r)throw new Ky("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function uC(e,t){return $c((function(){return Ib(t),"channelsFirst"===t?lv(e,[0,2,3,1]):e}))}function cC(e,t){return $c((function(){return Ib(t),"channelsFirst"===t?lv(e,[0,2,3,4,1]):e}))}function lC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return $c((function(){if(null==i&&(i="channelsLast"),Ib(i),3!==e.shape.length)throw new Ky("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new Ky("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Ky("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=lv(e,[0,2,1])),"causal"===a)throw new Xy("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=fp(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=tx(s,n)),s}))}function dC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return $c((function(){if(null==i&&(i="channelsLast"),Ib(i),3!==e.rank&&4!==e.rank)throw new Ky("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new Ky("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=uC(e,i);if("causal"===a)throw new Xy("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Tv({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=lv(u,[0,3,1,2])),u}))}function pC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return $c((function(){if(null==i&&(i="channelsLast"),Ib(i),4!==e.rank&&5!==e.rank)throw new Ky("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new Ky("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=cC(e,i);if("causal"===a)throw new Xy("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=gp(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=tx(s,n)),"channelsFirst"===i&&(s=lv(s,[0,4,1,2,3])),s}))}aC.className="Softmax",fl(aC);var hC=function(e){z(n,e);var t=W(n);function n(e,r){var a;if(A(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,hb(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Xy("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=iC(r.kernelSize,e,"kernelSize"),a.strides=iC(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,Tb(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Ib(a.dataFormat),a.activation=Gw(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Nx(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=ok(r.biasConstraint),a.biasRegularizer=Jw(r.biasRegularizer),a.activityRegularizer=Jw(r.activityRegularizer),a.dilationRate=iC(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Ky("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Ky("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Ky("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return L(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:jw(this.activation),useBias:this.useBias,biasInitializer:Sx(this.biasInitializer),biasRegularizer:Yw(this.biasRegularizer),activityRegularizer:Yw(this.activityRegularizer),biasConstraint:ak(this.biasConstraint)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(Jy("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!pb(e.kernelSize,"number",1,3))throw new Ky("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Vx),fC=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,hb(a.filters,"filters"),a.kernelInitializer=Nx(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=ok(r.kernelConstraint),a.kernelRegularizer=Jw(r.kernelRegularizer),a}return L(n,[{key:"build",value:function(e){e=_x(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Ky("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:gt({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t;e=Ex(e);var r=null==n.bias?null:n.bias.read(),a=vb(n.activation.getClassName());if(null!=a&&2===n.rank)t=dC(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=lC(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=dC(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Xy("convolutions greater than 3D are not implemented yet.");t=pC(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=_x(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=oC(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:Sx(this.kernelInitializer),kernelRegularizer:Yw(this.kernelRegularizer),kernelConstraint:ak(this.kernelConstraint)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new Ky("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(hC),vC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return L(n,[{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!pb(e.kernelSize,"number",1,2))throw new Ky("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(fC);vC.className="Conv2D",fl(vC);var mC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return L(n,[{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Ky("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(fC);mC.className="Conv3D",fl(mC);var gC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).inputSpec=[new Lx({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new Ky("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return L(n,[{key:"build",value:function(e){if(4!==(e=_x(e)).length)throw new Ky("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Ky("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Lx({ndim:4,axes:gt({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e);if(4!==t.shape.length)throw new Ky("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],c=n.kernelSize[0],l=n.kernelSize[1],d=n.strides[0],p=n.strides[1],h=[o,sC(s,d,c,n.padding),sC(u,p,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=lv(t,[0,2,3,1]));var f=mp(t,n.kernel.read(),h,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(f=lv(f,[0,3,1,2])),null!=n.bias&&(f=tx(f,n.bias.read(),n.dataFormat)),null!=n.activation&&(f=n.activation.apply(f)),f}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=_x(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=sC(a[n],s,i,this.padding),a[r]=sC(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(vC);gC.className="Conv2DTranspose",fl(gC);var yC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).inputSpec=[new Lx({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new Ky("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return L(n,[{key:"build",value:function(e){if(5!==(e=_x(e)).length)throw new Ky("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Ky("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Lx({ndim:5,axes:gt({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e);if(5!==t.shape.length)throw new Ky("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i,o=t.shape,s=o[0];"channelsFirst"===n.dataFormat?(i=2,r=3,a=4):(i=1,r=2,a=3);var u=o[i],c=o[r],l=o[a],d=n.kernelSize[0],p=n.kernelSize[1],h=n.kernelSize[2],f=n.strides[0],v=n.strides[1],m=n.strides[2],g=[s,sC(u,f,d,n.padding),sC(c,v,p,n.padding),sC(l,m,h,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=lv(t,[0,2,3,4,1]));var y=bp(t,n.kernel.read(),g,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=lv(y,[0,4,1,2,3])),null!==n.bias&&(y=tx(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=_x(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],d=this.strides[2];return i[t]=this.filters,i[n]=sC(i[n],c,o,this.padding),i[r]=sC(i[r],l,s,this.padding),i[a]=sC(i[a],d,u,this.padding),i}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(mC);yC.className="Conv3DTranspose",fl(yC);var bC=function(e){z(n,e);var t=W(n);function n(e,r){var a;if(A(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new Ky("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new Ky("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new Ky("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Nx(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Jw(r.depthwiseRegularizer),a.depthwiseConstraint=ok(r.depthwiseConstraint),a.pointwiseInitializer=Nx(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Jw(r.pointwiseRegularizer),a.pointwiseConstraint=ok(r.pointwiseConstraint),a}return L(n,[{key:"build",value:function(e){if((e=_x(e)).length<this.rank+2)throw new Ky("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Ky("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Lx({ndim:this.rank+2,axes:gt({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t;if(e=Ex(e),1===n.rank)throw new Xy("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=lv(e,[0,2,3,1])),t=Nf(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=tx(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=lv(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Sx(this.depthwiseInitializer),e.pointwiseInitializer=Sx(this.pointwiseInitializer),e.depthwiseRegularizer=Yw(this.depthwiseRegularizer),e.pointwiseRegularizer=Yw(this.pointwiseRegularizer),e.depthwiseConstraint=ak(this.depthwiseConstraint),e.pointwiseConstraint=ak(this.pointwiseConstraint),e}}]),n}(fC);bC.className="SeparableConv";var xC=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,2,e)}return L(n)}(bC);xC.className="SeparableConv2D",fl(xC);var kC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return L(n,[{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!pb(e.kernelSize,"number",1,1))throw new Ky("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(fC);kC.className="Conv1D",fl(kC);var wC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return L(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(e=Ex(e),"channelsLast"===n.dataFormat){var t=qb(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return qb(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=qb(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return qb(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);wC.className="Cropping2D",fl(wC);var CC=function(e){z(n,e);var t=W(n);function n(e){var r,a;return A(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ib(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,db(kb,"InterpolationFormat",a),r}return L(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=lv(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?Fm.resizeNearestNeighbor(t,[a,i]):Fm.resizeBilinear(t,[a,i]);return lv(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?Fm.resizeNearestNeighbor(t,[s,u]):Fm.resizeBilinear(t,[s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);CC.className="UpSampling2D",fl(CC);var SC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Nx(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=ok(e.depthwiseConstraint),r.depthwiseRegularizer=Jw(e.depthwiseRegularizer),r}return L(n,[{key:"build",value:function(e){if((e=_x(e)).length<4)throw new Ky("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Ky("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return $c((function(){null==a&&(a="channelsLast"),Ib(a);var o=uC(e,a);if(4!==e.rank)throw new Ky("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new Ky("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=Ip(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=lv(o,[0,3,1,2])),o}))}(e=Ex(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=tx(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=_x(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=oC(t,this.kernelSize[0],this.padding,this.strides[0]),i=oC(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Sx(this.depthwiseInitializer),e.depthwiseRegularizer=Yw(this.depthwiseRegularizer),e.depthwiseConstraint=ak(this.depthwiseRegularizer),e}}]),n}(hC);function NC(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Ky("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function IC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return $c((function(){var u=t.shape.length;if(u<3)throw new Ky("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(Vb(2,u));if(t=lv(t,c),null!=i)throw new Xy("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=Xc(Xc(a,"bool"),"float32")).rank===u-1&&(a=Yp(a,-1)),a=lv(a,c)),r&&(t=gf(t,0),null!=a&&(a=gf(a,0)));var l,d,p=[],h=n,f=t.shape[0],v=nv(t);null!=a&&(d=nv(a));for(var m,g=function(t){var n=v[t],r=$c((function(){return e(n,h)}));if(null==a)l=r[0],h=r[1];else{var i=$c((function(){var e=d[t],n=xl(Uh(e),e);return{output:rl(ol(r[0],e),ol(h[0],n)),newStates:h.map((function(t,a){return rl(ol(r[1][a],e),ol(t,n))}))}}));l=i.output,h=i.newStates}s&&p.push(l)},y=0;y<f;++y)g(y);if(s){m=jf(p,1)}return[l,m,h]}))}SC.className="DepthwiseConv2D",fl(SC);var TC=function(e){z(n,e);var t=W(n);function n(e){var r,a;if(A(this,n),r=t.call(this,e),null==e.cell)throw new Ky("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new LC({cells:e.cell}):e.cell).stateSize)throw new Ky("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new Lx({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return L(n,[{key:"getStates",value:function(){return null==this.states_?Vb(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){Ix(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=K(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(aH){o.e(aH)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return $c((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new Xy("Constants support is not implemented in RNN yet.");Ix(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Lx({shape:[t,null].concat(R(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Ir(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new Ky("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new Lx({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$c((function(){if(!t.stateful)throw new Gy("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new Ky("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Ah([r,e])})):t.states_=[Ah([r,t.cell.stateSize])];else if(null==e)el(t.states_),null!=t.keptStates&&(el(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Ah([r,e])})):t.states_[0]=Ah([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Ky("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):el(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!Ir(i.shape,s))throw new Ky("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return tl(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=NC(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=K(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new Lx({shape:l.shape}))}}catch(aH){c.e(aH)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof Mx){var d=[e].concat(o),p=this.inputSpec.concat(s),h=this.inputSpec;this.inputSpec=p;var f=bk(P(n.prototype),"apply",this).call(this,d,t);return this.inputSpec=h,f}return bk(P(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=Ex(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new Ky("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=IC((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],d=u[2];n.stateful&&n.resetStates(d,a);var p=n.returnSequences?l:c;return n.returnState?[p].concat(d):p}))}},{key:"getInitialState",value:function(e){var t=this;return $c((function(){var n=Ah(e.shape);return n=jb(n=Gp(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?Zb(n,[1,e]):n})):t.cell.stateSize>1?[Zb(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){bk(P(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=xk(t.cell,n);return new e(Object.assign(t,{cell:r}))}}]),n}(Vx);TC.className="RNN",fl(TC);var EC=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n)}(Vx),_C=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,hb(r.units,"units"),r.activation=Gw(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Nx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Nx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Nx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Jw(e.kernelRegularizer),r.recurrentRegularizer=Jw(e.recurrentRegularizer),r.biasRegularizer=Jw(e.biasRegularizer),r.kernelConstraint=ok(e.kernelConstraint),r.recurrentConstraint=ok(e.recurrentConstraint),r.biasConstraint=ok(e.biasConstraint),r.dropout=Pb([1,Bb([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Pb([1,Bb([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return L(n,[{key:"build",value:function(e){e=_x(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(2!==e.length)throw new Ky("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=MC({ones:function(){return Uh(e)},rate:n.dropout,training:i,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=MC({ones:function(){return Uh(r)},rate:n.recurrentDropout,training:i,dropoutFunc:n.dropoutFunc}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=Qb(null!=o?ol(e,o):e,n.kernel.read()),null!=n.bias&&(a=tx(a,n.bias.read())),null!=s&&(r=ol(r,s));var u=rl(a,Qb(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jw(this.activation),useBias:this.useBias,kernelInitializer:Sx(this.kernelInitializer),recurrentInitializer:Sx(this.recurrentInitializer),biasInitializer:Sx(this.biasInitializer),kernelRegularizer:Yw(this.kernelRegularizer),recurrentRegularizer:Yw(this.recurrentRegularizer),biasRegularizer:Yw(this.biasRegularizer),activityRegularizer:Yw(this.activityRegularizer),kernelConstraint:ak(this.kernelConstraint),recurrentConstraint:ak(this.recurrentConstraint),biasConstraint:ak(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}]),n}(EC);_C.className="SimpleRNNCell",fl(_C);var RC=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),e.cell=new _C(e),t.call(this,e)}return L(n,[{key:"call",value:function(e,t){var r=this;return $c((function(){null!=r.cell.dropoutMask&&(el(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(el(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return bk(P(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(TC);RC.className="SimpleRNN",fl(RC);var AC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Ky("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,hb(r.units,"units"),r.activation=Gw(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Gw(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Nx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Nx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Nx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Jw(e.kernelRegularizer),r.recurrentRegularizer=Jw(e.recurrentRegularizer),r.biasRegularizer=Jw(e.biasRegularizer),r.kernelConstraint=ok(e.kernelConstraint),r.recurrentConstraint=ok(e.recurrentConstraint),r.biasConstraint=ok(e.biasConstraint),r.dropout=Pb([1,Bb([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Pb([1,Bb([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return L(n,[{key:"build",value:function(e){var t=(e=_x(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(2!==e.length)throw new Ky("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=MC({ones:function(){return Uh(e)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=MC({ones:function(){return Uh(a)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var i,o,s,u=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=ol(e,u[0]));var l=Qb(e,n.kernel.read());n.useBias&&(l=tx(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=ol(a,c[0]));var d=n.recurrentKernel.read(),p=H(Bf(d,[2*n.units,n.units],d.rank-1),2),h=p[0],f=p[1],v=Qb(a,h),m=H(Bf(l,3,l.rank-1),3),g=m[0],y=m[1],b=m[2],x=H(Bf(v,2,v.rank-1),2),k=x[0],w=x[1];i=n.recurrentActivation.apply(rl(g,k)),o=n.recurrentActivation.apply(rl(y,w));var C=Qb(ol(o,a),f);s=n.activation.apply(rl(b,C));var S=rl(ol(i,a),ol(rl(1,vh(i)),s));return[S,S]}))}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jw(this.activation),recurrentActivation:jw(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Sx(this.kernelInitializer),recurrentInitializer:Sx(this.recurrentInitializer),biasInitializer:Sx(this.biasInitializer),kernelRegularizer:Yw(this.kernelRegularizer),recurrentRegularizer:Yw(this.recurrentRegularizer),biasRegularizer:Yw(this.biasRegularizer),activityRegularizer:Yw(this.activityRegularizer),kernelConstraint:ak(this.kernelConstraint),recurrentConstraint:ak(this.recurrentConstraint),biasConstraint:ak(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}]),n}(EC);AC.className="GRUCell",fl(AC);var OC=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new AC(e),t.call(this,e)}return L(n,[{key:"call",value:function(e,t){var r=this;return $c((function(){null!=r.cell.dropoutMask&&(el(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(el(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return bk(P(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(TC);OC.className="GRU",fl(OC);var FC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,hb(r.units,"units"),r.activation=Gw(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Gw(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Nx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Nx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Nx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=Jw(e.kernelRegularizer),r.recurrentRegularizer=Jw(e.recurrentRegularizer),r.biasRegularizer=Jw(e.biasRegularizer),r.kernelConstraint=ok(e.kernelConstraint),r.recurrentConstraint=ok(e.recurrentConstraint),r.biasConstraint=ok(e.biasConstraint),r.dropout=Pb([1,Bb([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Pb([1,Bb([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return L(n,[{key:"build",value:function(e){var t,n,r=(e=_x(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new ux).apply([i]),o=a.apply([2*i]);return Xb(Xb(n,r),o)}}]),n}(ox),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new Ky("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=MC({ones:function(){return Uh(e)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=MC({ones:function(){return Uh(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var o,s,u,c,l=n.dropoutMask,d=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=ol(e,l[0]));var p=Qb(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=ol(a,d[0])),p=rl(p,Qb(a,n.recurrentKernel.read())),n.useBias&&(p=tx(p,n.bias.read()));var h=H(Bf(p,4,p.rank-1),4),f=h[0],v=h[1],m=h[2],g=h[3];o=n.recurrentActivation.apply(f),s=n.recurrentActivation.apply(v),u=rl(ol(s,i),ol(o,n.activation.apply(m))),c=n.recurrentActivation.apply(g);var y=ol(c,n.activation.apply(u));return[y,y,u]}))}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jw(this.activation),recurrentActivation:jw(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Sx(this.kernelInitializer),recurrentInitializer:Sx(this.recurrentInitializer),biasInitializer:Sx(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Yw(this.kernelRegularizer),recurrentRegularizer:Yw(this.recurrentRegularizer),biasRegularizer:Yw(this.biasRegularizer),activityRegularizer:Yw(this.activityRegularizer),kernelConstraint:ak(this.kernelConstraint),recurrentConstraint:ak(this.recurrentConstraint),biasConstraint:ak(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}]),n}(EC);FC.className="LSTMCell",fl(FC);var DC=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new FC(e),t.call(this,e)}return L(n,[{key:"call",value:function(e,t){var r=this;return $c((function(){null!=r.cell.dropoutMask&&(el(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(el(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return bk(P(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(TC);DC.className="LSTM",fl(DC);var LC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).cells=e.cells,r}return L(n,[{key:"stateSize",get:function(){var e,t=[],n=K(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,R(r.stateSize)):t.push(r.stateSize)}}catch(aH){n.e(aH)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r,a=e.slice(1),i=[],o=K(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(aH){o.e(aH)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var d=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=d.call(u,t),c.push(u.slice(1))}a=[];var p,h=K(c.slice().reverse());try{for(h.s();!(p=h.n()).done;){var f,v=p.value;(f=a).push.apply(f,R(v))}}catch(aH){h.e(aH)}finally{h.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;Ix(e)&&(e=e[0]),this.cells.forEach((function(n,r){Ab("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign(Object.assign({},e),t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=K(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,R(r.trainableWeights))}}catch(aH){n.e(aH)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=K(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,R(r.nonTrainableWeights))}}catch(aH){n.e(aH)}finally{n.f()}if(!this.trainable){var a,i=[],o=K(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,R(s.trainableWeights))}}catch(aH){o.e(aH)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=K(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,R(r.weights))}}catch(aH){n.e(aH)}finally{n.f()}return Fx(t)}},{key:"setWeights",value:function(e){var t,n=[],r=K(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch(aH){r.e(aH)}finally{r.f()}Dx(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=K(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(xk(o,r))}}catch(aH){i.e(aH)}finally{i.f()}return new e({cells:a})}}]),n}(EC);function MC(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=e.dropoutFunc,u=function(){return null!=s?s(t(),n):nx(t(),n)},c=function(){return rx(u,t,a)};return!o||o<=1?tl(c().clone()):Array(o).fill(void 0).map(c).map((function(e){return tl(e.clone())}))}LC.className="StackedRNNCells",fl(LC);var zC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},PC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),e.unroll)throw new Xy("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Xy("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new Lx({ndim:5})],r}return L(n,[{key:"call",value:function(e,t){var r=this;return $c((function(){if(null!=r.cell.dropoutMask&&(el(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(el(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new Ky("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return bk(P(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(R(t.slice(2)))),this.returnState&&(t=[t].concat(R(Array(2).fill([e[0]].concat(R(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return $c((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=Ah([a[0]].concat(R(a.slice(2))));return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$c((function(){if(!t.stateful)throw new Gy("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(R(a.slice(2)));if(null==r[0])throw new Ky("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Ah(i)})):t.states_=[Ah(i)];else if(null==e)el(t.states_),null!=t.keptStates&&(el(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Ah(i)})):t.states_[0]=Ah(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Ky("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):el(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!Ir(s.shape,u))throw new Ky("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return tl(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?3:2],l=e[u?4:3],d=oC(c,a[0],i,o[0],s[0]),p=oC(l,a[1],i,o[1],s[1]);return[].concat(R(e.slice(0,2)),R(u?[r,d,p]:[d,p,r]))}}]),n}(TC);PC.className="ConvRNN2D";var BC=function(e){z(n,e);var t=W(n);function n(e){var r;A(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign(Object.assign({},e),{units:a}))).filters=a,hb(r.filters,"filters"),r.kernelSize=iC(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return hb(e,"kernelSize")})),r.strides=iC(o||1,2,"strides"),r.strides.forEach((function(e){return hb(e,"strides")})),r.padding=s||"valid",Tb(r.padding),r.dataFormat=u||"channelsLast",Ib(r.dataFormat),r.dilationRate=iC(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return hb(e,"dilationRate")})),r}return L(n,[{key:"build",value:function(e){var t;e=_x(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Ky("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var s=this.biasInitializer,u=this.filters;o=new(t=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"apply",value:function(e,t){return Kb([s.apply([u]),Oh([u]),s.apply([2*u])])}}]),n}(ox),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(3!==e.length)throw new Ky("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=MC({ones:function(){return Uh(a)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?ol(t[n],e):e},c=u(a,s,0),l=u(a,s,1),d=u(a,s,2),p=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=MC({ones:function(){return Uh(i)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var h=n.recurrentDropoutMask,f=u(i,h,0),v=u(i,h,1),m=u(i,h,2),g=u(i,h,3),y=H(Bf(n.kernel.read(),4,3),4),b=y[0],x=y[1],k=y[2],w=y[3],C=H(n.useBias?Bf(n.bias.read(),4):[null,null,null,null],4),S=C[0],N=C[1],I=C[2],T=C[3];c=n.inputConv(c,b,S,n.padding),l=n.inputConv(l,x,N,n.padding),d=n.inputConv(d,k,I,n.padding),p=n.inputConv(p,w,T,n.padding);var E=H(Bf(n.recurrentKernel.read(),4,3),4),_=E[0],R=E[1],A=E[2],O=E[3];f=n.recurrentConv(f,_),v=n.recurrentConv(v,R),m=n.recurrentConv(m,A),g=n.recurrentConv(g,O);var F=n.recurrentActivation.apply(rl(c,f)),D=n.recurrentActivation.apply(rl(l,v)),L=rl(ol(D,o),ol(F,n.activation.apply(rl(d,m)))),M=ol(n.recurrentActivation.apply(rl(p,g)),n.activation.apply(L));return[M,M,L]}))}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t=(e.units,zC(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}},{key:"inputConv",value:function(e,t,n,r){var a=hp(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?tx(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return hp(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(FC);BC.className="ConvLSTM2DCell",fl(BC);var VC=function(e){z(n,e);var t=W(n);function n(e){A(this,n);var r=new BC(e);return t.call(this,Object.assign(Object.assign({},e),{cell:r}))}return L(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(PC);VC.className="ConvLSTM2D",fl(VC);var WC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return L(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return rx((function(){return nx(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return bk(P(n.prototype),"dispose",this).call(this)}}]),n}(Vx);WC.className="Dropout",fl(WC);var UC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return L(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(WC);UC.className="SpatialDropout1D",fl(UC);var jC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,hb(r.units,"units"),r.activation=Gw(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Nx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Nx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=ok(e.kernelConstraint),r.biasConstraint=ok(e.biasConstraint),r.kernelRegularizer=Jw(e.kernelRegularizer),r.biasRegularizer=Jw(e.biasRegularizer),r.activityRegularizer=Jw(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return L(n,[{key:"build",value:function(e){var t=(e=_x(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:gt({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=_x(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r,a=Ex(e),i=vb(n.activation.getClassName());return null!=i?r=Qb(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=Qb(a,n.kernel.read()),null!=n.bias&&(r=tx(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:jw(this.activation),useBias:this.useBias,kernelInitializer:Sx(this.kernelInitializer),biasInitializer:Sx(this.biasInitializer),kernelRegularizer:Yw(this.kernelRegularizer),biasRegularizer:Yw(this.biasRegularizer),activityRegularizer:Yw(this.activityRegularizer),kernelConstraint:ak(this.kernelConstraint),biasConstraint:ak(this.biasConstraint)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);jC.className="Dense",fl(jC);var HC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return L(n,[{key:"computeOutputShape",value:function(e){var t,n=K((e=_x(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new Ky('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(aH){n.e(aH)}finally{n.f()}return[e[0],zb(e,1)]}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=lv(r,a)}return function(e){if(e.rank<=1)throw new Ky("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],zb(e.shape,1)];return Hd(e,t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);HC.className="Flatten",fl(HC);var GC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=Gw(e.activation),r}return L(n,[{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:jw(this.activation)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);GC.className="Activation",fl(GC);var qC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return L(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){return e=Ex(e),t=e,r=n.n,$c((function(){if(2!==t.shape.length)throw new Ky("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return Zb(jb(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);qC.className="RepeatVector",fl(qC);var KC=function(e){z(n,e);var t=W(n);function n(e){var r;A(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return L(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new Ky("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=zb(e);if(null!==i){if(0===a||u%a!==0)throw new Ky(n);r[i]=u/a}else if(u!==a)throw new Ky(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return Hd(r,i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);KC.className="Reshape",fl(KC);var XC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=Vb(1,e.dims.length+1);if(!Ir(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Lx({ndim:r.dims.length+1})],r}return L(n,[{key:"computeOutputShape",value:function(e){var t=(e=_x(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return lv(Ex(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);XC.className="Permute",fl(XC);var ZC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return L(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=Ex(e);return kd(Vh(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e),a=kd(Vh(r,n.maskValue),-1,!0);return ol(r,Xc(a,r.dtype))}))}}]),n}(Vx);ZC.className="Masking",fl(ZC);var YC=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(tb(e.inputLength))}return r.inputDim=e.inputDim,hb(r.inputDim,"inputDim"),r.outputDim=e.outputDim,hb(r.outputDim,"outputDim"),r.embeddingsInitializer=Nx(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Jw(e.embeddingsRegularizer),r.activityRegularizer=Jw(e.activityRegularizer),r.embeddingsConstraint=ok(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return L(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return $c((function(){return n.maskZero?(e=Ex(e),Vh(e,cl(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=_x(e),null==this.inputLength)return[].concat(R(e),[this.outputDim]);var t=tb(this.inputLength);if(t.length!==e.length-1)throw new Ky('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new Ky('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(R(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);"int32"!==r.dtype&&(r=Ub(r,"int32"));var a=Jb(n.embeddings.read(),Hd(r,[r.size]));return Hd(a,_x(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Sx(this.embeddingsInitializer),embeddingsRegularizer:Yw(this.embeddingsRegularizer),activityRegularizer:Yw(this.activityRegularizer),embeddingsConstraint:ak(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);YC.className="Embedding",fl(YC);var QC=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return L(n,[{key:"mergeFunction",value:function(e){throw new Xy}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Ky("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[_x(e)]),e.length<2)throw new Ky("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=K(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(aH){r.e(aH)}finally{r.f()}if((n=cb(n)).length>1)throw new Ky("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===cb(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=Bb(r),o=K(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=jb(s,1);t.push(s)}}catch(aH){o.e(aH)}finally{o.f()}return n.mergeFunction(t)}var l,d=!1,p=K(e);try{for(p.s();!(l=p.n()).done;){var h=l.value,f=h.rank;if(null==f){var v=h.shape,m=v[0],g=v.slice(1).concat([m]),y=Hd(h,[m].concat(zb(v.slice(1))));y=lv(y,[1,0]),y=Hd(y,g),t.push(y),d=!0}else if(f>1){var b=Vb(1,f).concat([0]);t.push(lv(h,b)),d=!0}else t.push(h)}}catch(aH){p.e(aH)}finally{p.f()}var x=n.mergeFunction(t),k=x.rank;if(d)if(null==k){var w=x.shape,C=w[w.length-1],S=[C].concat(w.slice(0,w.length-1));x=Hd(lv(Hd(x,[-1,C]),[1,0]),S)}else if(k>1){var N=[k-1].concat(Vb(0,k-1));x=lv(x,N)}return x}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=K(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(aH){o.e(aH)}finally{o.f()}return t=1===(i=cb(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return $c((function(){if(null==t)return null;if(!Array.isArray(t))throw new Ky("`mask` should be an Array");if(!Array.isArray(e))throw new Ky("`inputs` should be an Array");if(t.length!==e.length)throw new Ky("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:Yp(e,0)})))[0],r=1;r<t.length-1;++r)n=xh(n,t[r]);return n}))}}]),n}(Vx),JC=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"mergeFunction",value:function(e){return $c((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=rl(t,e[n]);return t}))}}]),n}(QC);JC.className="Add",fl(JC);var $C=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"mergeFunction",value:function(e){return $c((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=ol(t,e[n]);return t}))}}]),n}(QC);$C.className="Multiply",fl($C);var eS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"mergeFunction",value:function(e){return $c((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=rl(t,e[n]);return ol(1/e.length,t)}))}}]),n}(QC);eS.className="Average",fl(eS);var tS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"mergeFunction",value:function(e){return $c((function(){for(var t=e[0],n=1;n<e.length;++n)t=Il(t,e[n]);return t}))}}]),n}(QC);tS.className="Maximum",fl(tS);var nS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"mergeFunction",value:function(e){return $c((function(){for(var t=e[0],n=1;n<e.length;++n)t=Dh(t,e[n]);return t}))}}]),n}(QC);nS.className="Minimum",fl(nS);var rS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return L(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Ky("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=K(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(aH){r.e(aH)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,c=K(a);try{for(c.s();!(s=c.n()).done;){if(Ir(s.value,o)){u=!0;break}}}catch(aH){c.e(aH)}finally{c.f()}u||a.push(o)}if(a.length>1)throw new Ky("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return $c((function(){return Kb(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Ky("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=K(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(aH){i.e(aH)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new Ky("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Ky("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Ky("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return $c((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(Xc(Uh(e[i]),"bool")):t[i].rank<e[i].rank?a.push(Yp(t[i],-1)):a.push(t[i]);var o=Kd(a,n.axis);return xd(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(QC);function aS(e,t){for(;e<0;)e+=t;return e}rS.className="Concatenate",fl(rS);var iS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return L(n,[{key:"build",value:function(e){wr(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Xy("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Ky("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new Ky("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return aS(t,e[n].shape.length)})):[aS(this.axes,n.shape.length),aS(this.axes,r.shape.length)],this.normalize&&(n=kk(n,t[0]),r=kk(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Xy("batchDot is not implemented for tensors of 4D or higher rank yet");if(wr(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),wr(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Xy("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return $c((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=Hd(t,t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=Hd(e,e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?Gp(ol(e,t),i[0]):Gp(ol(lv(e,[1,0]),t),i[1]);else{var d=i[0]!==e.shape.length-1,p=i[1]===t.shape.length-1;o=Xd(e,t,d,p)}if(n>0){for(var h,f=[],v=h=r>a?r+a-3:r-1;v<h+n;++v)f.push(v);o=Uf(o,f)}return 1===o.shape.length&&(o=Yp(o,1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[aS(this.axes,e.length),aS(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){wr(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Xy("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(QC);iS.className="Dot",fl(iS);var oS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return L(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);return rx((function(){return rl(Yb(r.shape,0,n.stddev),r)}),(function(){return r}),t.training||!1)}))}}]),n}(Vx);oS.className="GaussianNoise",fl(oS);var sS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return L(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t);var r=Ex(e);if(n.rate>0&&n.rate<1){return rx((function(){var e=Math.sqrt(n.rate/(1-n.rate));return ol(r,Yb(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(Vx);sS.className="GaussianDropout",fl(sS);var uS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return L(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||Ex(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=bk(P(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return $c((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return rx((function(){var t=Ex(e),a=-1.7580993408473766,i=rh(df(r),n.rate);i=Ub(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate,u=rl(ol(t,i),ol(rl(i,-1),a));return rl(ol(u,o),s)}),(function(){return Ex(e)}),t.training||!1)}return e}))}}]),n}(Vx);function cS(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=tp(e,t,n,r,a,o);else if(3===e.rank)i=np(e,t,n,r,a,o);else{if(4!==e.rank)throw new Xy("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=rp(e,t,n,r,a,o)}return i}function lS(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Ir(r.slice().sort(),Vb(0,e.rank-1))?function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return $c((function(){var i=zh(e,r),o=i.mean,s=i.variance;return[cS(e,o,s,n,t,a),o,s]}))}(e,t,n,r,a):function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return $c((function(){var i,o=zh(e,r),s=o.mean,u=o.variance,c=[],l=K(Vb(0,e.rank));try{for(l.s();!(i=l.n()).done;){var d=i.value;-1!==r.indexOf(d)?c.push(1):c.push(e.shape[d])}}catch(aH){l.e(aH)}finally{l.f()}var p=Hd(s,c),h=Hd(u,c),f=null==t?null:Hd(t,c),v=null==n?null:Hd(n,c);return[cS(e,p,h,v,f,a),s,u]}))}(e,t,n,r,a)}uS.className="AlphaDropout",fl(uS);var dS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Nx(e.betaInitializer||"zeros"),r.gammaInitializer=Nx(e.gammaInitializer||"ones"),r.movingMeanInitializer=Nx(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Nx(e.movingVarianceInitializer||"ones"),r.betaConstraint=ok(e.betaConstraint),r.gammaConstraint=ok(e.gammaConstraint),r.betaRegularizer=Jw(e.betaRegularizer),r.gammaRegularizer=Jw(e.gammaRegularizer),r}return L(n,[{key:"build",value:function(e){e=_x(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Ky("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Lx({ndim:e.length,axes:gt({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r=null!=t.training&&t.training,a=Ex(e),i=a.shape,o=i.length,s=Vb(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=Qy(1,o);c[u]=i[u];var l=s.slice();l.sort();var d=!Ir(l,Vb(0,o).slice(0,o-1));if(!r)return function(){if(d){var e=Hd(n.movingMean.read(),c),t=Hd(n.movingVariance.read(),c),r=n.center?Hd(n.beta.read(),c):null,i=n.scale?Hd(n.gamma.read(),c):null;return cS(a,e,t,r,i,n.epsilon)}return cS(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=H(lS(a,n.gamma.read(),n.beta.read(),s,n.epsilon),3),h=p[0],f=p[1],v=p[2],m=function(e,t,n){$c((function(){var r=1-n,a=e.read(),i=ol(xl(a,t),r);e.write(xl(a,i))}))};return m(n.movingMean,f,n.momentum),m(n.movingVariance,v,n.momentum),h}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Sx(this.betaInitializer),gammaInitializer:Sx(this.gammaInitializer),movingMeanInitializer:Sx(this.movingMeanInitializer),movingVarianceInitializer:Sx(this.movingVarianceInitializer),betaRegularizer:Yw(this.betaRegularizer),gammaRegularizer:Yw(this.gammaRegularizer),betaConstraint:ak(this.betaConstraint),gammaConstraint:ak(this.gammaConstraint)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);dS.className="BatchNormalization",fl(dS);var pS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=K(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(aH){i.e(aH)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Nx(e.betaInitializer||"zeros"),r.gammaInitializer=Nx(e.gammaInitializer||"ones"),r.betaRegularizer=Jw(e.betaRegularizer),r.gammaRegularizer=Jw(e.gammaRegularizer),r.supportsMasking=!0,r}return L(n,[{key:"build",value:function(e){var t=(e=_x(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=K(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(aH){a.e(aH)}finally{a.f()}if(this.axis.length!==cb(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=Ex(e),a=r.shape,i=a.length;return $c((function(){var e,t=zh(r,n.axis,!0),o=t.mean,s=t.variance,u=Qy(1,i),c=K(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(aH){c.e(aH)}finally{c.f()}for(var d=function(e){return null!=e&&e.shape.length!==i?Hd(e,u):e},p=n.scale?d(n.gamma.read()):null,h=n.center?d(n.beta.read()):null,f=[],v=[],m=0;m<i;++m)-1!==n.axis.indexOf(m)?(f.push(a[m]),v.push(1)):(f.push(1),v.push(a[m]));return o=Jp(o,f),s=Jp(s,f),null!=p&&(p=Jp(p,v)),null!=h&&(h=Jp(h,v)),cS(r,o,s,h,p,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Sx(this.betaInitializer),gammaInitializer:Sx(this.gammaInitializer),betaRegularizer:Yw(this.betaRegularizer),gammaRegularizer:Yw(this.gammaRegularizer)},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);pS.className="LayerNormalization",fl(pS);var hS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Ky("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Ky("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new Ky("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new Lx({ndim:4})],r}return L(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=_x(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return $c((function(){return t=Ex(e),r=n.padding,a=n.dataFormat,$c((function(){if(4!==t.rank)throw new Ky("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new Ky("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new Ky("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],Hh(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx);function fS(e,t,n,r,a,i){return $c((function(){var o;Ib(a),Eb(i),Tb(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=uC(e,a);var s="same"===r?"same":"valid";return o="max"===i?Th(e,t,n,s):Gd(e,t,n,s),"channelsFirst"===a&&(o=lv(o,[0,3,1,2])),o}))}function vS(e,t,n,r,a,i){return $c((function(){var o;Ib(a),Eb(i),Tb(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=cC(e,a);var s="same"===r?"same":"valid";return o="max"===i?Eh(e,t,n,s):qd(e,t,n,s),"channelsFirst"===a&&(o=lv(o,[0,4,1,2,3])),o}))}hS.className="ZeroPadding2D",fl(hS);var mS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new Ky("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(hb(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new Ky("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return hb(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,Tb(r.padding),r.inputSpec=[new Lx({ndim:3})],r}return L(n,[{key:"computeOutputShape",value:function(e){var t=oC((e=_x(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){n.invokeCallHook(e,t),e=jb(Ex(e),2);var r=n.poolingFunction(Ex(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Uf(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx),gS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),fS(e,t,n,r,a,"max")}}]),n}(mS);gS.className="MaxPooling1D",fl(gS);var yS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),fS(e,t,n,r,a,"avg")}}]),n}(mS);yS.className="AveragePooling1D",fl(yS);var bS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Ky("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return hb(r.poolSize,"poolSize"),hb(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ib(r.dataFormat),Tb(r.padding),r.inputSpec=[new Lx({ndim:4})],r}return L(n,[{key:"computeOutputShape",value:function(e){e=_x(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=oC(t,this.poolSize[0],this.padding,this.strides[0]),n=oC(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){return n.invokeCallHook(e,t),n.poolingFunction(Ex(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx),xS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),fS(e,t,n,r,a,"max")}}]),n}(bS);xS.className="MaxPooling2D",fl(xS);var kS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),fS(e,t,n,r,a,"avg")}}]),n}(bS);kS.className="AveragePooling2D",fl(kS);var wS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Ky("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return hb(r.poolSize,"poolSize"),hb(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ib(r.dataFormat),Tb(r.padding),r.inputSpec=[new Lx({ndim:5})],r}return L(n,[{key:"computeOutputShape",value:function(e){e=_x(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=oC(t,this.poolSize[0],this.padding,this.strides[0]),n=oC(n,this.poolSize[1],this.padding,this.strides[1]),r=oC(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return $c((function(){return n.invokeCallHook(e,t),n.poolingFunction(Ex(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx),CS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),vS(e,t,n,r,a,"max")}}]),n}(wS);CS.className="MaxPooling3D",fl(CS);var SS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e)}return L(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ib(a),Tb(r),vS(e,t,n,r,a,"avg")}}]),n}(wS);SS.className="AveragePooling3D",fl(SS);var NS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).inputSpec=[new Lx({ndim:3})],r}return L(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new Xy}}]),n}(Vx),IS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e||{})}return L(n,[{key:"call",value:function(e,t){return $c((function(){var t=Ex(e);return Rh(t,1)}))}}]),n}(NS);IS.className="GlobalAveragePooling1D",fl(IS);var TS=function(e){z(n,e);var t=W(n);function n(e){return A(this,n),t.call(this,e||{})}return L(n,[{key:"call",value:function(e,t){return $c((function(){var t=Ex(e);return jp(t,1)}))}}]),n}(NS);TS.className="GlobalMaxPooling1D",fl(TS);var ES=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ib(r.dataFormat),r.inputSpec=[new Lx({ndim:4})],r}return L(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new Xy}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vx),_S=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e);return"channelsLast"===n.dataFormat?Rh(t,[1,2]):Rh(t,[2,3])}))}}]),n}(ES);_S.className="GlobalAveragePooling2D",fl(_S);var RS=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.apply(this,arguments)}return L(n,[{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e);return"channelsLast"===n.dataFormat?jp(t,[1,2]):jp(t,[2,3])}))}}]),n}(ES);RS.className="GlobalMaxPooling2D",fl(RS);var AS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).layer=e.layer,r}return L(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){bk(P(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=xk(t.layer,n);delete t.layer;var a={layer:r};return Object.assign(a,t),new e(a)}}]),n}(Vx),OS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return L(n,[{key:"build",value:function(e){if((e=_x(e)).length<3)throw new Ky("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),bk(P(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=_x(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return $c((function(){return IC((function(e,r){return[Ex(n.layer.call(e,t)),[]]}),e=Ex(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(AS);OS.className="TimeDistributed",fl(OS);var FS="concat",DS=function(e){z(n,e);var t=W(n);function n(e){var r;A(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=xk(i),a.goBackwards=!0!==a.goBackwards;var o,s={};if(s.className=e.layer.getClassName(),s.config=a,r.backwardLayer=xk(s),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?FS:e.mergeMode,o=r.mergeMode,db(Sb,"BidirectionalMergeMode",o),e.weights)throw new Xy("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return L(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):eb(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=NC(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return bk(P(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new Ky("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,R(r));var c=r.map((function(e){return new Lx({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,R(c))}if(null!=a)throw new Xy("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof Mx,d=0,p=o;d<p.length;d++){if(p[d]instanceof Mx!==l)throw new Ky("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var h=[e].concat(o),f=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=f;var m=bk(P(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=v,m}return bk(P(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=gf(a,1)),"concat"===n.mergeMode?o=Kb([r,a]):"sum"===n.mergeMode?o=rl(r,a):"ave"===n.mergeMode?o=ol(.5,rl(r,a)):"mul"===n.mergeMode?o=ol(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Ab(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Ab(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){bk(P(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=xk(t.layer);if(delete t.layer,null!=t.numConstants)throw new Xy("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(AS);DS.className="Bidirectional",fl(DS);var LS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).scale=e.scale,e.offset?r.offset=e.offset:r.offset=0,r}return L(n,[{key:"getConfig",value:function(){var e={scale:this.scale,offset:this.offset},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return $c((function(){return"float32"!==(e=Ex(e)).dtype&&(e=Ub(e,"float32")),rl(ol(e,n.scale),n.offset)}))}}]),n}(Vx);LS.className="Rescaling",fl(LS);var MS=Fm.resizeBilinear,zS=Fm.cropAndResize,PS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,r}return L(n,[{key:"centerCrop",value:function(e,t,n,r,a,i,o,s){return $c((function(){var u,c=!1,l=[t/i,n/o,(r+t)/i,(a+n)/o],d=[];3===e.rank?(c=!0,u=jf([e])):u=e;for(var p=0;p<u.shape[0];p++)d.push(l);var h=Pu(d,[d.length,4]),f=pf(0,d.length,1,"int32"),v=zS(u,h,f,[r,a],"nearest");return Ub(c?Ex(nv(v)):v,s)}))}},{key:"upsize",value:function(e,t,n,r){return $c((function(){return Ub(MS(e,[t,n]),r)}))}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=Ex(e),r=t.dtype,a=t.shape,i=a[a.length-3],o=a[a.length-2],s=0;i!==n.height&&(s=Math.floor((i-n.height)/2));var u=0;return o!==n.width&&0===(u=Math.floor((o-n.width)/2))&&(u=1),s>=0&&u>=0?n.centerCrop(t,s,u,n.height,n.width,i,o,r):n.upsize(e,n.height,n.width,r)}))}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=_x(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}]),n}(Vx);PS.className="CenterCrop",fl(PS);var BS=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).numTokens=e.numTokens,e.outputMode?r.outputMode=e.outputMode:r.outputMode="multiHot",r}return L(n,[{key:"getConfig",value:function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){return null==(e=_x(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}},{key:"call",value:function(e,t){var n=this;return $c((function(){var r;if("int32"!==(e=Ex(e)).dtype&&(e=Ub(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==n.outputMode)throw new Ky("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));r=Ex(t.countWeights)}var a=jp(e),i=Hp(e),o=nh(n.numTokens,a).bufferSync().get(0),s=rh(i,0).bufferSync().get(0);if(!o||!s)throw new Ky("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(e,t,n,r){var a=Ex(e);if("int32"!==a.dtype&&(a=Ub(a,"int32")),"int"===t)return a;var i=a.shape;if(0===a.rank&&(a=Yp(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=Yp(a,-1)),a.rank>2)throw new Ky("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));var o,s=["multiHot","oneHot"].includes(t),u=a;if(o=Sp(u,"undefined"!==typeof r&&"count"===t?r:[],n,s),"tfIdf"!==t)return o;if(r)return ol(o,r);throw new Ky("When outputMode is 'tfIdf', weights must be provided.")}(e,n.outputMode,n.numTokens,r)}))}}]),n}(Vx);BS.className="CategoryEncoding",fl(BS);var VS=new Set(["bilinear","nearest"]),WS=function(e){z(n,e);var t=W(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,e.interpolation){if(!VS.has(e.interpolation))throw new Ky("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));r.interpolation=e.interpolation}else r.interpolation="bilinear";return r.cropToAspectRatio=Boolean(e.cropToAspectRatio),r}return L(n,[{key:"computeOutputShape",value:function(e){var t=(e=_x(e))[2];return[this.height,this.width,t]}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=bk(P(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return $c((function(){var t=[n.height,n.width];if("bilinear"===n.interpolation)return Fm.resizeBilinear(e,t,!n.cropToAspectRatio);if("nearest"===n.interpolation)return Fm.resizeNearestNeighbor(e,t,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat(R(VS)," are supported"))}))}}]),n}(Vx);WS.className="Resizing",fl(WS);var US,jS;na().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(US||(US={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(jS||(jS={}));var HS={};function GS(e){return HS[e]}function qS(e,t,n,r,a){var i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return KS(t.inputNames[i.inputIndexStart],n,r,a);if("tensors"===i.type)return t.inputNames.slice(o,s).map((function(e){return KS(e,n,r,a)}));var u=KS(t.inputNames.slice(o)[0],n,r,a),c=u.dataSync();return"number"===i.type?c[0]:Gr(u.shape,c)}var l=t.attrParams[e];return l&&l.value}function KS(e,t,n,r){var a=H(YS(e),2),i=a[0],o=a[1];if(null!=r){var s=r.getHashTableHandleByName(i);if(null!=s)return s}var u=n.currentContextIds.find((function(e){return!!t[ZS(i,e)]}));return void 0!==u?t[ZS(i,u)][o]:void 0}function XS(e,t){var n=H(YS(e),3),r=n[0],a=n[1],i=n[2];return[ZS(r,t&&t.currentContextId),a,i]}function ZS(e,t){return t?"".concat(e,"-").concat(t):e}function YS(e){var t=e.split(":");if(1===t.length)return[e,0,void 0];var n=t[0],r=3===t.length?t[1]:void 0;return[n,Number(t[t.length-1]),r]}function QS(e,t,n){var r=qS("pad",e,t,n);if("explicit"===r){r=qS("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function JS(e){return e.kept?e:Zc(e)}var $S=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],eN=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],tN=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],nN=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],rN=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],aN=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],iN=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],oN=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],sN=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],uN=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],cN=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],lN=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],dN=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],pN=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],hN=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],fN=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],vN=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],mN=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],gN=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],yN=function(){function e(){var t;A(this,e);var n=[r,a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k],w=(t=[]).concat.apply(t,R(n.map((function(e){return e.json}))));this.opMappers=w.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return L(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.node,a=[],i=[],o=[],s=r.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?a.push(e[n.name]):"Const"===n.op?i.push(e[n.name]):null!=n.input&&0!==n.input.length||o.push(e[n.name]),e}),{}),u=[],c=[],l={},d={};null!=n&&(l=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));var p=Object.keys(s);p.forEach((function(e){var t=s[e];t.inputNames.forEach((function(e,n){var r=H(XS(e),3),a=r[0],i=r[2],o=s[a];if(null!=o.outputs){var u=o.outputs.indexOf(i);if(-1!==u){var c="".concat(a,":").concat(u);t.inputNames[n]=c}}t.inputs.push(o),o.children.push(t)}))})),0===Object.keys(d).length?p.forEach((function(e){var t=s[e];0===t.children.length&&c.push(t)})):Object.keys(d).forEach((function(e){var t=H(XS(e),1)[0],n=s[t];null!=n&&(n.signatureKey=d[e],c.push(n))})),Object.keys(l).length>0?Object.keys(l).forEach((function(e){var t=H(XS(e),1)[0],n=s[t];n&&(n.signatureKey=l[e],u.push(n))})):u=a;var h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var f={nodes:s,inputs:u,outputs:c,weights:i,placeholders:a,signature:n,functions:h};return o.length>0&&(f.initNodes=o),f}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=GS(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.slice(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=xN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=xN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=RN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=RN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=wN(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=wN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=_N(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=_N(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=kN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=kN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=ON(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ON(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=EN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=EN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=AN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=AN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=NN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=NN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=IN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=IN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=SN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=SN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=H(XS(e.name),1)[0],n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:CN(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),a[t]=n})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e,n){var r=H(XS(e),3),i=r[0],o=r[2],s=a[i];if(null!=s.outputs){var u=s.outputs.indexOf(o);if(-1!==u){var c="".concat(i,":").concat(u);t.inputNames[n]=c}}t.inputs.push(s),s.children.push(t)}))}));var s=e.ret;e.signature.outputArg.forEach((function(e){var t=H(XS(s[e.name]),2),n=t[0],r=t[1],i=a[n];null!=i&&(i.defaultOutput=r,o.push(i))}));var u=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function bN(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=na().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function xN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?bN(a.s,r):n}function kN(e,t,n){var r=e[t];return r?r.b:n}function wN(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function CN(e){switch("string"===typeof e&&(e=US[e]),e){case US.DT_FLOAT:case US.DT_HALF:return"float32";case US.DT_INT32:case US.DT_INT64:case US.DT_INT8:case US.DT_UINT8:return"int32";case US.DT_BOOL:return"bool";case US.DT_DOUBLE:return"float32";case US.DT_STRING:return"string";default:return null}}function SN(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function NN(e,t,n){var r=e[t];return r&&r.type?CN(r.type):n}function IN(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return CN(e)})):n}function TN(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function EN(e,t,n){var r=e[t];return r&&r.shape?TN(r.shape):n}function _N(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function RN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return bN(e,r)})):n}function AN(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return TN(e)})):n}function ON(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var FN=function(){function e(t,n,r){var a=this;A(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return L(e,[{key:"getInput",value:function(e){return KS(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return KS(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return wN(this.node.rawAttrs,e,t);if(null!=n.s)return xN(this.node.rawAttrs,e,t);if(null!=n.b)return kN(this.node.rawAttrs,e,t);if(null!=n.shape)return EN(this.node.rawAttrs,e,t);if(null!=n.type)return NN(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return _N(this.node.rawAttrs,e,t);if(null!=n.list.s)return RN(this.node.rawAttrs,e,t);if(null!=n.list.shape)return AN(this.node.rawAttrs,e,t);if(null!=n.list.b)return ON(this.node.rawAttrs,e,t);if(null!=n.list.type)return IN(this.node.rawAttrs,e,t)}return t}}]),e}(),DN=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(qS("a",e,t,n),qS("b",e,t,n))];case"AddN":return[r.addN(qS("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(qS("a",e,t,n),qS("b",e,t,n))];case"Mul":return[r.mul(qS("a",e,t,n),qS("b",e,t,n))];case"RealDiv":case"Div":return[r.div(qS("a",e,t,n),qS("b",e,t,n))];case"DivNoNan":return[r.divNoNan(qS("a",e,t,n),qS("b",e,t,n))];case"FloorDiv":return[r.floorDiv(qS("a",e,t,n),qS("b",e,t,n))];case"Sub":return[r.sub(qS("a",e,t,n),qS("b",e,t,n))];case"Minimum":return[r.minimum(qS("a",e,t,n),qS("b",e,t,n))];case"Maximum":return[r.maximum(qS("a",e,t,n),qS("b",e,t,n))];case"Pow":return[r.pow(qS("a",e,t,n),qS("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(qS("a",e,t,n),qS("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},LN=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(qS("x",e,t,n))];case"Acos":return[r.acos(qS("x",e,t,n))];case"Acosh":return[r.acosh(qS("x",e,t,n))];case"Asin":return[r.asin(qS("x",e,t,n))];case"Asinh":return[r.asinh(qS("x",e,t,n))];case"Atan":return[r.atan(qS("x",e,t,n))];case"Atan2":return[r.atan2(qS("x",e,t,n),qS("y",e,t,n))];case"Atanh":return[r.atanh(qS("x",e,t,n))];case"Ceil":return[r.ceil(qS("x",e,t,n))];case"Complex":return[r.complex(qS("real",e,t,n),qS("imag",e,t,n))];case"Cos":return[r.cos(qS("x",e,t,n))];case"Cosh":return[r.cosh(qS("x",e,t,n))];case"Elu":return[r.elu(qS("x",e,t,n))];case"Erf":return[r.erf(qS("x",e,t,n))];case"Exp":return[r.exp(qS("x",e,t,n))];case"Expm1":return[r.expm1(qS("x",e,t,n))];case"Floor":return[r.floor(qS("x",e,t,n))];case"Log":return[r.log(qS("x",e,t,n))];case"Log1p":return[r.log1p(qS("x",e,t,n))];case"Imag":return[r.imag(qS("x",e,t,n))];case"Neg":return[r.neg(qS("x",e,t,n))];case"Reciprocal":return[r.reciprocal(qS("x",e,t,n))];case"Real":return[r.real(qS("x",e,t,n))];case"Relu":return[r.relu(qS("x",e,t,n))];case"Round":return[r.round(qS("x",e,t,n))];case"Selu":return[r.selu(qS("x",e,t,n))];case"Sigmoid":return[r.sigmoid(qS("x",e,t,n))];case"Sin":return[r.sin(qS("x",e,t,n))];case"Sign":return[r.sign(qS("x",e,t,n))];case"Sinh":return[r.sinh(qS("x",e,t,n))];case"Softplus":return[r.softplus(qS("x",e,t,n))];case"Sqrt":return[r.sqrt(qS("x",e,t,n))];case"Square":return[r.square(qS("x",e,t,n))];case"Tanh":return[r.tanh(qS("x",e,t,n))];case"Tan":return[r.tan(qS("x",e,t,n))];case"ClipByValue":return[r.clipByValue(qS("x",e,t,n),qS("clipValueMin",e,t,n),qS("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(qS("x",e,t,n))];case"Rsqrt":return[r.rsqrt(KS(e.inputNames[0],t,n))];case"Prod":return[r.prod(qS("x",e,t,n),qS("axes",e,t,n))];case"LeakyRelu":return[r.leakyRelu(qS("x",e,t,n),qS("alpha",e,t,n))];case"Prelu":return[r.prelu(qS("x",e,t,n),qS("alpha",e,t,n))];case"IsNan":return[r.isNaN(KS(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function MN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){wr(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var r=0;r<e.length;r++){var a=e[r],i=t[r];wr(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function zN(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function PN(e,t,n){var r=BN(e,n),a=!zN(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=BN(e.shape,r)})),!zN(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function BN(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var VN=function(){function e(t,n,r,a,i,o,s){A(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=dl(0),tl(this.idTensor)}return L(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),MN(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,tl(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return Pu([],[0].concat(this.elementShape));var r=this.readMany(e);return MN(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),jf(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Pu([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return MN(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Kd(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,R(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,nv(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];$c((function(){t=Hd(t,[1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],i];o[s]=Hd(Yd(t,u,c),n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)}}]),e}(),WN=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;A(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));MN(n,e.shape,"TensorList shape mismatch: "),tl(e)})),this.idTensor=dl(0),this.maxNumElements=a,tl(this.idTensor)}return L(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(R(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));MN(e,this.elementShape,"TensorList shape mismatch: ");var a=PN(this.elementShape,this.tensors,e);return $c((function(){var e=n.tensors.map((function(e){return Hd(e,a)}));return jf(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=PN(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,MN(r.shape,e,"TensorList shape mismatch: "),Hd(r,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(MN(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");tl(e),this.tensors.push(e)}},{key:"resize",value:function(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));var n=new e([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(var r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));MN(this.tensors[e].shape,t,"TensorList shape mismatch: ");var r=PN(this.elementShape,this.tensors,t);return Hd(this.tensors[e],r)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));MN(this.elementShape,t.shape,"TensorList shape mismatch: "),tl(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));MN(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=PN(this.elementShape,this.tensors,n);return 0===e.length?Pu([],[0].concat(a)):$c((function(){var t=e.map((function(e){return Hd(r.tensors[e],a)}));return jf(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));MN(this.elementShape,t,"TensorList shape mismatch: ");var r=PN(this.elementShape,this.tensors,t);return 0===this.size()?Pu([],[0].concat(r)):$c((function(){var e=n.tensors.map((function(e){return Hd(e,r)}));return Kd(e,0)}))}}]),e}();function UN(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));MN(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=nv(e);return new WN(a,t,r)}function jN(e,t,n,r){return new WN([],e,t,r)}function HN(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,R(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new WN([],n,e.dtype,r),o=nv(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}function GN(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=BN(e.shape.slice(1),n),o=0===r?0:e.size/r,s=$c((function(){var n=[];e=Hd(e,[1,r,o]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,t[s],o];n[s]=Hd(Yd(e,u,c),i)}return e.dispose(),n})),u=new WN([],n,e.dtype,t.length),c=0;c<s.length;c++)u.setItem(c,s[c]);return u}var qN=function(){var e=mt(ft().mark((function e(t,n,r){var a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,w,C,S,N,I,T,E,_,R,A,O,F,D,L,M,z,P,B,V,W,U,j,H,G,q,K,X,Z,Y,Q,J,$,ee,te,ne,re,ae,ie,oe,se,ue,ce,le,de,pe,he,fe,ve,me,ge,ye,be,xe,ke,we,Ce,Se,Ne,Ie,Te,Ee,_e,Re,Ae,Oe,Fe,De,Le,Me,ze,Pe,Be,Ve,We,Ue,je,He,Ge,qe,Ke,Xe,Ze,Ye,Qe,Je,$e,et,tt,nt,rt,at,it;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?33:"Switch"===e.t0?35:"Merge"===e.t0?46:"Enter"===e.t0?51:"Exit"===e.t0?55:"NextIteration"===e.t0?58:"TensorArrayV3"===e.t0?61:"TensorArrayWriteV3"===e.t0?71:"TensorArrayReadV3"===e.t0?77:"TensorArrayGatherV3"===e.t0?81:"TensorArrayScatterV3"===e.t0?86:"TensorArrayConcatV3"===e.t0?92:"TensorArraySplitV3"===e.t0?96:"TensorArraySizeV3"===e.t0?102:"TensorArrayCloseV3"===e.t0?105:"TensorListSetItem"===e.t0?109:"TensorListGetItem"===e.t0?115:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?121:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?128:"TensorListGather"===e.t0?136:"TensorListStack"===e.t0?142:"TensorListFromTensor"===e.t0?148:"TensorListConcat"===e.t0||"TensorListConcatV2"===e.t0?154:"TensorListPushBack"===e.t0?159:"TensorListPopBack"===e.t0?164:"TensorListSplit"===e.t0?169:"TensorListLength"===e.t0?175:"TensorListResize"===e.t0?178:184;break;case 3:return a=qS("thenBranch",t,n,r),i=qS("elseBranch",t,n,r),o=qS("cond",t,n,r),s=qS("args",t,n,r),e.next=9,o.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[i].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 15:return u=qS("body",t,n,r),c=qS("cond",t,n,r),l=qS("args",t,n,r),e.next=20,r.functionMap[c].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 20:return d=e.sent,p=l.map((function(e){return e.id})),e.next=24,d[0].data();case 24:h=e.sent,d.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||e.dispose()})),f=l,v=ft().mark((function e(){var t,n,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f,e.next=3,r.functionMap[u].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);case 3:return f=e.sent,n=f.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[c].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);case 8:return a=e.sent,e.next=11,a[0].data();case 11:h=e.sent,a.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 28:if(!h[0]){e.next=32;break}return e.delegateYield(v(),"t1",30);case 30:e.next=28;break;case 32:return e.abrupt("return",f);case 33:return m=qS("pred",t,n,r),e.abrupt("return",[JS(m)]);case 35:return g=qS("pred",t,n,r),(y=qS("data",t,n,r)).kept||(y=JS(y)),e.next=40,g.data();case 40:if(!e.sent[0]){e.next=44;break}e.t2=[void 0,y],e.next=45;break;case 44:e.t2=[y,void 0];case 45:return e.abrupt("return",e.t2);case 46:if(b=t.inputNames.find((function(e){return void 0!==KS(e,n,r)})),!b){e.next=50;break}return x=KS(b,n,r),e.abrupt("return",[JS(x)]);case 50:return e.abrupt("return",void 0);case 51:return k=qS("frameName",t,n,r),w=qS("tensor",t,n,r),r.enterFrame(k),e.abrupt("return",[JS(w)]);case 55:return C=qS("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[JS(C)]);case 58:return S=qS("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[JS(S)]);case 61:return N=qS("size",t,n,r),I=qS("dtype",t,n,r),T=qS("elementShape",t,n,r),E=qS("dynamicSize",t,n,r),_=qS("clearAfterRead",t,n,r),R=qS("identicalElementShapes",t,n,r),A=qS("name",t,n,r),O=new VN(A,I,N,T,R,E,_),r.addTensorArray(O),e.abrupt("return",[O.idTensor,dl(1)]);case 71:return F=qS("tensorArrayId",t,n,r),D=qS("index",t,n,r),L=qS("tensor",t,n,r),(M=r.getTensorArray(F.id)).write(D,L),e.abrupt("return",[M.idTensor]);case 77:return z=qS("tensorArrayId",t,n,r),P=qS("index",t,n,r),B=r.getTensorArray(z.id),e.abrupt("return",[B.read(P)]);case 81:return V=qS("tensorArrayId",t,n,r),W=qS("indices",t,n,r),U=qS("dtype",t,n,r),j=r.getTensorArray(V.id),e.abrupt("return",[j.gather(W,U)]);case 86:return H=qS("tensorArrayId",t,n,r),G=qS("indices",t,n,r),q=qS("tensor",t,n,r),(K=r.getTensorArray(H.id)).scatter(G,q),e.abrupt("return",[K.idTensor]);case 92:return X=qS("tensorArrayId",t,n,r),Z=r.getTensorArray(X.id),Y=qS("dtype",t,n,r),e.abrupt("return",[Z.concat(Y)]);case 96:return Q=qS("tensorArrayId",t,n,r),J=qS("tensor",t,n,r),$=qS("lengths",t,n,r),(ee=r.getTensorArray(Q.id)).split($,J),e.abrupt("return",[ee.idTensor]);case 102:return te=qS("tensorArrayId",t,n,r),ne=r.getTensorArray(te.id),e.abrupt("return",[dl(ne.size(),"int32")]);case 105:return re=qS("tensorArrayId",t,n,r),(ae=r.getTensorArray(re.id)).clearAndClose(),e.abrupt("return",[ae.idTensor]);case 109:return ie=qS("tensorListId",t,n,r),oe=qS("index",t,n,r),se=qS("tensor",t,n,r),(ue=r.getTensorList(ie.id)).setItem(oe,se),e.abrupt("return",[ue.idTensor]);case 115:return ce=qS("tensorListId",t,n,r),le=qS("index",t,n,r),de=qS("elementShape",t,n,r),pe=qS("elementDType",t,n,r),he=r.getTensorList(ce.id),e.abrupt("return",[he.getItem(le,de,pe)]);case 121:return fe=qS("indices",t,n,r),ve=qS("tensor",t,n,r),me=qS("elementShape",t,n,r),ge=qS("numElements",t,n,r),ye=HN(ve,fe,me,ge),r.addTensorList(ye),e.abrupt("return",[ye.idTensor]);case 128:return be=qS("elementShape",t,n,r),xe=qS("elementDType",t,n,r),ke="TensorListReserve"===t.op?"numElements":"maxNumElements",we=qS(ke,t,n,r),Ce="TensorListReserve"===t.op?-1:we,Se=jN(be,xe,0,Ce),r.addTensorList(Se),e.abrupt("return",[Se.idTensor]);case 136:return Ne=qS("tensorListId",t,n,r),Ie=qS("indices",t,n,r),Te=qS("elementShape",t,n,r),Ee=qS("elementDType",t,n,r),_e=r.getTensorList(Ne.id),e.abrupt("return",[_e.gather(Ie,Ee,Te)]);case 142:return Re=qS("tensorListId",t,n,r),Ae=qS("elementShape",t,n,r),Oe=qS("elementDType",t,n,r),Fe=qS("numElements",t,n,r),De=r.getTensorList(Re.id),e.abrupt("return",[De.stack(Ae,Oe,Fe)]);case 148:return Le=qS("tensor",t,n,r),Me=qS("elementShape",t,n,r),ze=qS("elementDType",t,n,r),Pe=UN(Le,Me,ze),r.addTensorList(Pe),e.abrupt("return",[Pe.idTensor]);case 154:return Be=qS("tensorListId",t,n,r),Ve=r.getTensorList(Be.id),We=qS("dtype",t,n,r),Ue=qS("elementShape",t,n,r),e.abrupt("return",[Ve.concat(We,Ue)]);case 159:return je=qS("tensorListId",t,n,r),He=qS("tensor",t,n,r),(Ge=r.getTensorList(je.id)).pushBack(He),e.abrupt("return",[Ge.idTensor]);case 164:return qe=qS("tensorListId",t,n,r),Ke=qS("elementShape",t,n,r),Xe=qS("elementDType",t,n,r),Ze=r.getTensorList(qe.id),e.abrupt("return",[Ze.popBack(Ke,Xe)]);case 169:return Ye=qS("tensor",t,n,r),Qe=qS("elementShape",t,n,r),Je=qS("lengths",t,n,r),$e=GN(Ye,Je,Qe),r.addTensorList($e),e.abrupt("return",[$e.idTensor]);case 175:return et=qS("tensorListId",t,n,r),tt=r.getTensorList(et.id),e.abrupt("return",[dl(tt.size(),"int32")]);case 178:return nt=qS("tensorListId",t,n,r),rt=qS("size",t,n,r),at=r.getTensorList(nt.id),it=at.resize(rt),r.addTensorList(it),e.abrupt("return",[it.idTensor]);case 184:throw TypeError("Node type ".concat(t.op," is not implemented"));case 185:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function KN(e,t,n){var r=H(qS("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s=!o,u="prelu"===i,c="fusedbatchnorm"===a,l=qS("numArgs",e,t,n);if(o){if(u&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&o&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var d=qS("strides",e,t,n),p=QS(e,t,n),h=qS("dataFormat",e,t,n).toUpperCase(),f=qS("dilations",e,t,n),v=H(qS("args",e,t,n),2),m=v[0],g=v[1];return s&&(g=m,m=void 0),{stride:d,pad:p,dataFormat:h,dilations:f,biasArg:m,preluArg:g,activationFunc:i,leakyreluAlpha:qS("leakyreluAlpha",e,t,n)}}var XN=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Conv1D":var a=qS("stride",e,t,n),i=qS("pad",e,t,n),o=qS("dataFormat",e,t,n).toUpperCase(),s=qS("dilation",e,t,n);return[r.conv1d(qS("x",e,t,n),qS("filter",e,t,n),a,i,o,s)];case"Conv2D":var u=qS("strides",e,t,n),c=QS(e,t,n),l=qS("dataFormat",e,t,n).toUpperCase(),d=qS("dilations",e,t,n);return[r.conv2d(qS("x",e,t,n),qS("filter",e,t,n),[u[1],u[2]],c,l,[d[1],d[2]])];case"_FusedConv2D":var p=KN(e,t,n),h=p.stride,f=p.pad,v=p.dataFormat,m=p.dilations,g=p.biasArg,y=p.preluArg,b=p.activationFunc,x=p.leakyreluAlpha;return[r.fused.conv2d({x:qS("x",e,t,n),filter:qS("filter",e,t,n),strides:[h[1],h[2]],pad:f,dataFormat:v,dilations:[m[1],m[2]],bias:g,activation:b,preluActivationWeights:y,leakyreluAlpha:x})];case"FusedDepthwiseConv2dNative":var k=KN(e,t,n),C=k.stride,S=k.pad,N=k.dataFormat,I=k.dilations,T=k.biasArg,E=k.preluArg,_=k.activationFunc,R=k.leakyreluAlpha;return[r.fused.depthwiseConv2d({x:qS("x",e,t,n),filter:qS("filter",e,t,n),strides:[C[1],C[2]],pad:S,dataFormat:N,dilations:[I[1],I[2]],bias:T,activation:_,preluActivationWeights:E,leakyreluAlpha:R})];case"Conv2DBackpropInput":case"Conv2dTranspose":var A=qS("outputShape",e,t,n),O=qS("strides",e,t,n),F=QS(e,t,n);return[r.conv2dTranspose(qS("x",e,t,n),qS("filter",e,t,n),A,[O[1],O[2]],F)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var D=qS("strides",e,t,n),L=QS(e,t,n),M=qS("dilations",e,t,n),z=qS("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(qS("input",e,t,n),qS("filter",e,t,n),[D[1],D[2]],L,z,[M[1],M[2]])];case"Conv3D":var P=qS("strides",e,t,n),B=qS("pad",e,t,n),V=qS("dataFormat",e,t,n).toUpperCase(),W=qS("dilations",e,t,n);return[r.conv3d(qS("x",e,t,n),qS("filter",e,t,n),[P[1],P[2],P[3]],B,V,[W[1],W[2],W[3]])];case"AvgPool":var U=qS("strides",e,t,n),j=qS("pad",e,t,n),H=qS("kernelSize",e,t,n);return[r.avgPool(qS("x",e,t,n),[H[1],H[2]],[U[1],U[2]],j)];case"MaxPool":var G=qS("strides",e,t,n),q=qS("pad",e,t,n),K=qS("kernelSize",e,t,n);return[r.maxPool(qS("x",e,t,n),[K[1],K[2]],[G[1],G[2]],q)];case"MaxPoolWithArgmax":var X=qS("strides",e,t,n),Z=qS("pad",e,t,n),Y=qS("kernelSize",e,t,n),Q=qS("includeBatchInIndex",e,t,n),J=r.maxPoolWithArgmax(qS("x",e,t,n),[Y[1],Y[2]],[X[1],X[2]],Z,Q);return[J.result,J.indexes];case"AvgPool3D":var $=qS("strides",e,t,n),ee=qS("pad",e,t,n),te=qS("kernelSize",e,t,n);return[r.avgPool3d(qS("x",e,t,n),[te[1],te[2],te[3]],[$[1],$[2],$[3]],ee)];case"MaxPool3D":var ne=qS("strides",e,t,n),re=qS("pad",e,t,n),ae=qS("kernelSize",e,t,n);return[r.maxPool3d(qS("x",e,t,n),[ae[1],ae[2],ae[3]],[ne[1],ne[2],ne[3]],re)];case"Dilation2D":var ie=qS("strides",e,t,n),oe=qS("pad",e,t,n),se=qS("dilations",e,t,n),ue=ie[1],ce=ie[2],le=se[1],de=se[2];return[r.dilation2d(qS("x",e,t,n),qS("filter",e,t,n),[ue,ce],oe,[le,de],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},ZN=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Fill":var a=qS("shape",e,t,n),i=qS("dtype",e,t,n),o=qS("value",e,t,n);return[r.fill(a,o,i)];case"LinSpace":var s=qS("start",e,t,n),u=qS("stop",e,t,n),c=qS("num",e,t,n);return[r.linspace(s,u,c)];case"Multinomial":var l=qS("logits",e,t,n),d=qS("numSamples",e,t,n),p=qS("seed",e,t,n);return[r.multinomial(l,d,p)];case"OneHot":var h=qS("indices",e,t,n),f=qS("depth",e,t,n),v=qS("onValue",e,t,n),m=qS("offValue",e,t,n),g=qS("dtype",e,t,n);return[r.oneHot(h,f,v,m,g)];case"Ones":return[r.ones(qS("shape",e,t,n),qS("dtype",e,t,n))];case"OnesLike":return[r.onesLike(qS("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(qS("shape",e,t,n),qS("dtype",e,t,n),qS("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(qS("shape",e,t,n),qS("minval",e,t,n),qS("maxval",e,t,n),qS("dtype",e,t,n))];case"Range":var y=qS("start",e,t,n),b=qS("stop",e,t,n),x=qS("step",e,t,n);return[r.range(y,b,x,qS("dtype",e,t,n))];case"TruncatedNormal":var k=qS("shape",e,t,n),C=qS("mean",e,t,n),S=qS("stdDev",e,t,n),N=qS("seed",e,t,n);return[r.truncatedNormal(k,C,S,qS("dtype",e,t,n),N)];case"Zeros":return[r.zeros(qS("shape",e,t,n),qS("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(qS("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function YN(e,t,n){return{boxes:qS("boxes",e,t,n),scores:qS("scores",e,t,n),maxOutputSize:qS("maxOutputSize",e,t,n),iouThreshold:qS("iouThreshold",e,t,n),scoreThreshold:qS("scoreThreshold",e,t,n),softNmsSigma:qS("softNmsSigma",e,t,n)}}var QN=function(){var e=mt(ft().mark((function e(t,n,r,a){var i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,C,S,N,I,T,E,_,R,A=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=A.length>4&&void 0!==A[4]?A[4]:w,e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?4:"NonMaxSuppressionV4"===e.t0?9:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?15:"Where"===e.t0?20:"ListDiff"===e.t0?27:28;break;case 4:return o=YN(t,n,r),s=o.boxes,u=o.scores,c=o.maxOutputSize,l=o.iouThreshold,d=o.scoreThreshold,p=o.softNmsSigma,e.next=7,i.image.nonMaxSuppressionWithScoreAsync(s,u,c,l,d,p);case 7:return h=e.sent,e.abrupt("return",[h.selectedIndices,h.selectedScores]);case 9:return f=YN(t,n,r),v=f.boxes,m=f.scores,g=f.maxOutputSize,y=f.iouThreshold,b=f.scoreThreshold,x=qS("padToMaxOutputSize",t,n,r),e.next=13,i.image.nonMaxSuppressionPaddedAsync(v,m,g,y,b,x);case 13:return k=e.sent,e.abrupt("return",[k.selectedIndices,k.validOutputs]);case 15:return C=YN(t,n,r),S=C.boxes,N=C.scores,I=C.maxOutputSize,T=C.iouThreshold,E=C.scoreThreshold,e.next=18,i.image.nonMaxSuppressionAsync(S,N,I,T,E);case 18:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 20:return _=i.cast(qS("condition",t,n,r),"bool"),e.next=23,i.whereAsync(_);case 23:return e.t2=e.sent,R=[e.t2],_.dispose(),e.abrupt("return",R);case 27:return e.abrupt("return",i.setdiff1dAsync(qS("x",t,n,r),qS("y",t,n,r)));case 28:throw TypeError("Node type ".concat(t.op," is not implemented"));case 29:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),JN=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"LowerBound":var a=qS("sortedSequence",e,t,n),i=qS("values",e,t,n);return[r.lowerBound(a,i)];case"TopKV2":var o=qS("x",e,t,n),s=qS("k",e,t,n),u=qS("sorted",e,t,n),c=r.topk(o,s,u);return[c.values,c.indices];case"UpperBound":var l=qS("sortedSequence",e,t,n),d=qS("values",e,t,n);return[r.upperBound(l,d)];case"Unique":var p=qS("x",e,t,n),h=r.unique(p);return[h.values,h.indices];case"UniqueV2":var f=qS("x",e,t,n),v=qS("axis",e,t,n),m=r.unique(f,v);return[m.values,m.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},$N=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var a=qS("default",e,t,n);return[KS(e.name,t,n)||a];case"Placeholder":return[KS(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[JS(qS("x",e,t,n))];case"IdentityN":return qS("x",e,t,n).map((function(e){return JS(e)}));case"Snapshot":return[JS(qS("x",e,t,n))];case"Shape":return[r.tensor1d(qS("x",e,t,n).shape,"int32")];case"ShapeN":return qS("x",e,t,n).map((function(e){return r.tensor1d(e.shape)}));case"Size":return[r.scalar(qS("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(qS("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":var i=qS("x",e,t,n),o=qS("data",e,t,n),s=qS("message",e,t,n),u=qS("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[i];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},eI=function(){function e(t,n){A(this,e),this.keyDType=t,this.valueDType=n,this.handle=dl(0),this.tensorMap=new Map,tl(this.handle)}return L(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return dl(this.size(),"int32")}},{key:"import",value:function(){var e=mt(ft().mark((function e(t,n){var r,a=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",$c((function(){var e=nv(n),t=r.length,i=e.length;wr(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<t;o++){var s=r[o],u=e[o];tl(u),a.tensorMap.set(s,u)}return a.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=mt(ft().mark((function e(t,n){var r,a=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",$c((function(){for(var e=[],t=0;t<r.length;t++){var i=r[t],o=a.findWithDefault(i,n);e.push(o)}return jf(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),tI=function(){var e=mt(ft().mark((function e(t,n,r,a){var i,o,s,u,c,l,d,p,h,f,v,m,g,y;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"InitializeTable"===e.t0||"InitializeTableV2"===e.t0||"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?13:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?21:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?29:32;break;case 3:if(null==(i=a.getHashTableHandleByName(t.name))){e.next=8;break}return e.abrupt("return",[i]);case 8:return o=qS("keyDType",t,n,r),s=qS("valueDType",t,n,r),u=new eI(o,s),a.addHashTable(t.name,u),e.abrupt("return",[u.handle]);case 13:return c=qS("tableHandle",t,n,r,a),l=qS("keys",t,n,r),d=qS("values",t,n,r),p=a.getHashTableById(c.id),e.next=19,p.import(l,d);case 19:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 21:return h=qS("tableHandle",t,n,r,a),f=qS("keys",t,n,r),v=qS("defaultValue",t,n,r),m=a.getHashTableById(h.id),e.next=27,m.find(f,v);case 27:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 29:return g=qS("tableHandle",t,n,r,a),y=a.getHashTableById(g.id),e.abrupt("return",[y.tensorSize()]);case 32:throw TypeError("Node type ".concat(t.op," is not implemented"));case 33:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),nI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"ResizeBilinear":var a=qS("images",e,t,n),i=qS("size",e,t,n),o=qS("alignCorners",e,t,n),s=qS("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)];case"ResizeNearestNeighbor":var u=qS("images",e,t,n),c=qS("size",e,t,n),l=qS("alignCorners",e,t,n),d=qS("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(u,[c[0],c[1]],l,d)];case"CropAndResize":var p=qS("image",e,t,n),h=qS("boxes",e,t,n),f=qS("boxInd",e,t,n),v=qS("cropSize",e,t,n),m=qS("method",e,t,n),g=qS("extrapolationValue",e,t,n);return[r.image.cropAndResize(p,h,f,v,m,g)];case"ImageProjectiveTransformV3":var y=qS("images",e,t,n),b=qS("transforms",e,t,n),x=qS("outputShape",e,t,n),k=qS("fillValue",e,t,n),C=qS("interpolation",e,t,n),S=qS("fillMode",e,t,n);return[r.image.transform(y,b,C.toLowerCase(),S.toLowerCase(),k,x)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},rI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Equal":return[r.equal(qS("a",e,t,n),qS("b",e,t,n))];case"NotEqual":return[r.notEqual(qS("a",e,t,n),qS("b",e,t,n))];case"Greater":return[r.greater(qS("a",e,t,n),qS("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(qS("a",e,t,n),qS("b",e,t,n))];case"Less":return[r.less(qS("a",e,t,n),qS("b",e,t,n))];case"LessEqual":return[r.lessEqual(qS("a",e,t,n),qS("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(qS("a",e,t,n),qS("b",e,t,n))];case"LogicalNot":return[r.logicalNot(qS("a",e,t,n))];case"LogicalOr":return[r.logicalOr(qS("a",e,t,n),qS("b",e,t,n))];case"Select":case"SelectV2":return[r.where(qS("condition",e,t,n),qS("a",e,t,n),qS("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},aI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(qS("a",e,t,n),qS("b",e,t,n),qS("transposeA",e,t,n),qS("transposeB",e,t,n))];case"Einsum":return[r.einsum.apply(r,[qS("equation",e,t,n)].concat(R(qS("tensors",e,t,n))))];case"Transpose":return[r.transpose(qS("x",e,t,n),qS("perm",e,t,n))];case"_FusedMatMul":var a=H(qS("fusedOps",e,t,n),2),i=a[0],o=a[1],s="biasadd"===i,u="prelu"===o,c=qS("numArgs",e,t,n),l=qS("leakyreluAlpha",e,t,n);if(s){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var d=H(qS("args",e,t,n),2),p=d[0],h=d[1];return[r.fused.matMul({a:qS("a",e,t,n),b:qS("b",e,t,n),transposeA:qS("transposeA",e,t,n),transposeB:qS("transposeB",e,t,n),bias:p,activation:o,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},iI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(qS("x",e,t,n),qS("axis",e,t,n),qS("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(qS("x",e,t,n),qS("mean",e,t,n),qS("variance",e,t,n),qS("offset",e,t,n),qS("scale",e,t,n),qS("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(qS("x",e,t,n),qS("radius",e,t,n),qS("bias",e,t,n),qS("alpha",e,t,n),qS("beta",e,t,n))];case"Softmax":return[r.softmax(qS("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(qS("x",e,t,n))];case"SparseToDense":return[r.sparseToDense(qS("sparseIndices",e,t,n),qS("outputShape",e,t,n),qS("sparseValues",e,t,n),qS("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},oI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"RaggedGather":var a=r.raggedGather(qS("paramsNestedSplits",e,t,n),qS("paramsDenseValues",e,t,n),qS("indices",e,t,n),qS("outputRaggedRank",e,t,n)),i=a.outputNestedSplits,o=a.outputDenseValues;return i.concat(o);case"RaggedRange":var s=r.raggedRange(qS("starts",e,t,n),qS("limits",e,t,n),qS("splits",e,t,n));return[s.rtNestedSplits,s.rtDenseValues];case"RaggedTensorToTensor":return[r.raggedTensorToTensor(qS("shape",e,t,n),qS("values",e,t,n),qS("defaultValue",e,t,n),qS("rowPartitionTensors",e,t,n),qS("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},sI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Max":var a=qS("axis",e,t,n),i=qS("keepDims",e,t,n);return[r.max(qS("x",e,t,n),a,i)];case"Mean":var o=qS("axis",e,t,n),s=qS("keepDims",e,t,n);return[r.mean(qS("x",e,t,n),o,s)];case"Min":var u=qS("axis",e,t,n),c=qS("keepDims",e,t,n);return[r.min(qS("x",e,t,n),u,c)];case"Sum":var l=qS("axis",e,t,n),d=qS("keepDims",e,t,n);return[r.sum(qS("x",e,t,n),l,d)];case"All":var p=qS("axis",e,t,n),h=qS("keepDims",e,t,n);return[r.all(qS("x",e,t,n),p,h)];case"Any":var f=qS("axis",e,t,n),v=qS("keepDims",e,t,n);return[r.any(qS("x",e,t,n),f,v)];case"ArgMax":var m=qS("axis",e,t,n);return[r.argMax(qS("x",e,t,n),m)];case"ArgMin":var g=qS("axis",e,t,n);return[r.argMin(qS("x",e,t,n),g)];case"Prod":var y=qS("axis",e,t,n),b=qS("keepDims",e,t,n);return[r.prod(qS("x",e,t,n),y,b)];case"Cumprod":var x=qS("axis",e,t,n),k=qS("exclusive",e,t,n),C=qS("reverse",e,t,n);return[r.cumprod(qS("x",e,t,n),x,k,C)];case"Cumsum":var S=qS("axis",e,t,n),N=qS("exclusive",e,t,n),I=qS("reverse",e,t,n);return[r.cumsum(qS("x",e,t,n),S,N,I)];case"Bincount":var T=qS("x",e,t,n),E=qS("weights",e,t,n),_=qS("size",e,t,n);return[r.bincount(T,E,_)];case"DenseBincount":var R=qS("x",e,t,n),A=qS("weights",e,t,n),O=qS("size",e,t,n),F=qS("binaryOutput",e,t,n);return[r.denseBincount(R,A,O,F)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},uI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"ConcatV2":case"Concat":var a=qS("n",e,t,n),i=qS("axis",e,t,n),o=qS("tensors",e,t,n);return o=o.slice(0,a),[r.concat(o,i)];case"Gather":var s=qS("x",e,t,n),u=qS("indices",e,t,n);return[r.gather(s,r.cast(u,"int32"),0)];case"GatherV2":var c=qS("axis",e,t,n),l=qS("batchDims",e,t,n),d=qS("x",e,t,n),p=qS("indices",e,t,n);return[r.gather(d,r.cast(p,"int32"),c,l)];case"Reverse":for(var h=qS("dims",e,t,n),f=[],v=0;v<h.length;v++)h[v]&&f.push(v);var m=qS("x",e,t,n);return[r.reverse(m,f)];case"ReverseV2":var g=qS("axis",e,t,n),y=qS("x",e,t,n);return[r.reverse(y,g)];case"Slice":var b=qS("begin",e,t,n),x=qS("size",e,t,n);return[r.slice(qS("x",e,t,n),b,x)];case"StridedSlice":var k=qS("begin",e,t,n),C=qS("end",e,t,n),S=qS("strides",e,t,n),N=qS("beginMask",e,t,n),I=qS("endMask",e,t,n),T=qS("ellipsisMask",e,t,n),E=qS("newAxisMask",e,t,n),_=qS("shrinkAxisMask",e,t,n),R=qS("x",e,t,n);return[r.stridedSlice(R,k,C,S,N,I,T,E,_)];case"Pack":return $c((function(){var a=qS("axis",e,t,n),i=qS("tensors",e,t,n),o=i[0].shape,s=r.squeeze(i[0]).shape,u=i.map((function(e){var t=Ir(e.shape,o);if(!t&&!Ir(r.squeeze(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,o)}));return[r.stack(u,a)]}));case"Unpack":var A=qS("axis",e,t,n),O=qS("tensor",e,t,n);return r.unstack(O,A);case"Tile":var F=qS("reps",e,t,n);return[r.tile(qS("x",e,t,n),F)];case"Split":case"SplitV":var D=qS("axis",e,t,n),L=qS("numOrSizeSplits",e,t,n),M=qS("x",e,t,n);return r.split(M,L,D);case"ScatterNd":var z=qS("indices",e,t,n),P=qS("values",e,t,n),B=qS("shape",e,t,n);return[r.scatterND(z,P,B)];case"GatherNd":var V=qS("x",e,t,n),W=qS("indices",e,t,n);return[r.gatherND(V,W)];case"SparseToDense":var U=qS("sparseIndices",e,t,n),j=qS("outputShape",e,t,n),H=qS("sparseValues",e,t,n),G=qS("defaultValue",e,t,n);return[r.sparseToDense(U,H,j,H.dtype===G.dtype?G:r.cast(G,H.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},cI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"SparseFillEmptyRows":var a=r.sparse.sparseFillEmptyRows(qS("indices",e,t,n),qS("values",e,t,n),qS("denseShape",e,t,n),qS("defaultValue",e,t,n));return[a.outputIndices,a.outputValues,a.emptyRowIndicator,a.reverseIndexMap];case"SparseReshape":var i=r.sparse.sparseReshape(qS("inputIndices",e,t,n),qS("inputShape",e,t,n),qS("newShape",e,t,n));return[i.outputIndices,i.outputShape];case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(qS("data",e,t,n),qS("indices",e,t,n),qS("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(qS("data",e,t,n),qS("indices",e,t,n),qS("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},lI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"FFT":return[r.fft(qS("x",e,t,n))];case"IFFT":return[r.ifft(qS("x",e,t,n))];case"RFFT":return[r.rfft(qS("x",e,t,n))];case"IRFFT":return[r.irfft(qS("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},dI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"StringNGrams":var a=r.string.stringNGrams(qS("data",e,t,n),qS("dataSplits",e,t,n),qS("separator",e,t,n),qS("nGramWidths",e,t,n),qS("leftPad",e,t,n),qS("rightPad",e,t,n),qS("padWidth",e,t,n),qS("preserveShortSequences",e,t,n));return[a.nGrams,a.nGramsSplits];case"StringSplit":var i=r.string.stringSplit(qS("input",e,t,n),qS("delimiter",e,t,n),qS("skipEmpty",e,t,n));return[i.indices,i.values,i.shape];case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(qS("input",e,t,n),qS("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},pI=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w;switch(e.op){case"Cast":return[r.cast(qS("x",e,t,n),qS("dtype",e,t,n))];case"ExpandDims":var a=qS("axis",e,t,n);return[r.expandDims(qS("x",e,t,n),a)];case"Squeeze":var i=qS("axis",e,t,n);return[r.squeeze(qS("x",e,t,n),i)];case"Reshape":return[r.reshape(qS("x",e,t,n),qS("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(qS("x",e,t,n),qS("padding",e,t,n),qS("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(qS("x",e,t,n),qS("padding",e,t,n),qS("constantValue",e,t,n))];case"SpaceToBatchND":var o=qS("blockShape",e,t,n),s=qS("paddings",e,t,n);return[r.spaceToBatchND(qS("x",e,t,n),o,s)];case"BatchToSpaceND":var u=qS("blockShape",e,t,n),c=qS("crops",e,t,n);return[r.batchToSpaceND(qS("x",e,t,n),u,c)];case"DepthToSpace":var l=qS("blockSize",e,t,n),d=qS("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(qS("x",e,t,n),l,d)];case"BroadcastTo":return[r.broadcastTo(qS("x",e,t,n),qS("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(qS("s0",e,t,n),qS("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function hI(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$c,i=function(e,t,n){switch(e.category){case"arithmetic":return a((function(){return DN(e,t,n)}));case"basic_math":return a((function(){return LN(e,t,n)}));case"control":return qN(e,t,n);case"convolution":return a((function(){return XN(e,t,n)}));case"creation":return a((function(){return ZN(e,t,n)}));case"dynamic":return QN(e,t,n);case"evaluation":return a((function(){return JN(e,t,n)}));case"image":return a((function(){return nI(e,t,n)}));case"graph":return a((function(){return $N(e,t,n)}));case"logical":return a((function(){return rI(e,t,n)}));case"matrices":return a((function(){return aI(e,t,n)}));case"normalization":return a((function(){return iI(e,t,n)}));case"ragged":return a((function(){return oI(e,t,n)}));case"reduction":return a((function(){return sI(e,t,n)}));case"slice_join":return a((function(){return uI(e,t,n)}));case"sparse":return a((function(){return cI(e,t,n)}));case"spectral":return a((function(){return lI(e,t,n)}));case"string":return a((function(){return dI(e,t,n)}));case"transformation":return a((function(){return pI(e,t,n)}));case"hash_table":return tI(e,t,n,r);case"custom":var i=GS(e.op);if(i&&i.customExecutor)return i.customExecutor(new FN(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return Jr(i)?i.then((function(e){return[].concat(e)})):[].concat(i)}var fI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};A(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return L(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function vI(e,t,n,r){var a=new Set,i=[],o=null,s=null,u=new Set,c=Object.keys(e).map((function(e){return YS(e)[0]})),l=[];null!=r&&(l=r.map((function(e){return YS(e.name)[0]})));for(var d=R(t);d.length>0;){var p=d.pop();(bI(p)||xI(p)||kI(p))&&null==o&&(s=(o=p).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(p.name),null==n[p.name]&&(-1===c.indexOf(p.name)&&-1===l.indexOf(p.name)&&(0!==p.inputs.length?p.inputs.forEach((function(e){u.has(e.name)||(u.add(e.name),d.push(e))})):i.push(p.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}var mI=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],gI=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],yI=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function bI(e){return mI.indexOf(e.op)>=0}function xI(e){return gI.indexOf(e.op)>=0}function kI(e){return yI.indexOf(e.op)>=0}var wI=function(){function e(t,n){var r=this;A(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return L(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,R(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=vI(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(e){return YS(e)[0]})).map((function(t){return e.nodes[t]})),s=e.initNodes;o.forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)})),null!=s&&s.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var u=new Set,c=[];i.length>0;){var l=i.pop();u.add(l.name),t[l.name]||c.push(l),l.children.forEach((function(e){!u.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return u.has(e.name)}))&&i.push(e)}))}return c}(this.graph,this.weightMap,n)}},{key:"cloneAndKeepTensor",value:function(e){if(null==e)return null;var t=e.clone();return tl(t),t}},{key:"cloneTensorList",value:function(e){var t=this;return e?e.map((function(e){return t.cloneAndKeepTensor(e)})):null}},{key:"cloneTensorMap",value:function(e){var t=this;return Object.fromEntries(Object.entries(e).map((function(e){var n=H(e,2),r=n[0],a=n[1];return[r,t.cloneTensorList(a)]})))}},{key:"execute",value:function(e,t){var n=this;this.disposeIntermediateTensors(),e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[YS(e)[0]]})),i=t.map((function(e){return YS(e)[0]})),o=i.map((function(e){return n.graph.nodes[e]}));0===o.length&&(o=this._outputs);var s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);null==u&&(u=this.compile(e,o),this.compiledMap.set(s,u));try{this.keepIntermediateTensors=na().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}var c={},l={};return $c((function(){var r=new fI(n.weightMap,c,l,n.functionExecutorMap),a=Object.assign({},n.weightMap);n.keepIntermediateTensors&&(n.clonedTensorsMap=n.cloneTensorMap(n.weightMap)),Object.keys(e).forEach((function(t){var r=H(YS(t),2),i=r[0],o=[];o[r[1]]=e[t],a[i]=o,n.keepIntermediateTensors&&(n.clonedTensorsMap[i]=n.cloneTensorList(o))}));for(var o=n.getFrozenTensorIds(a),s={},d=0;d<u.length;d++){var p=u[d];if(!a[p.name]){var h=hI(p,a,r,n._resourceManager);if(Jr(h))throw new Error("The execution of the op '".concat(p.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[p.name]=h,n.keepIntermediateTensors&&(n.clonedTensorsMap[p.name]=n.cloneTensorList(h)),n.checkTensorForDisposal(p.name,p,a,r,o,i,s)}}return null==n.parent&&r.dispose(o),t.map((function(e){return KS(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[ZS(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!e.kept&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:function(){var e=mt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"disposeIntermediateTensors",value:function(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((function(e){var t,n=K(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&!r.isDisposed&&r.dispose()}}catch(aH){n.e(aH)}finally{n.f()}})),this.clonedTensorsMap=null)}},{key:"getIntermediateTensors",value:function(){return this.clonedTensorsMap}},{key:"_executeAsync",value:function(){var e=mt(ft().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,p=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=p.length>2&&void 0!==p[2]&&p[2],a=p.length>3&&void 0!==p[3]?p[3]:{},i=p.length>4&&void 0!==p[4]?p[4]:{},this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=na().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}return o=new fI(this.weightMap,a,i,this.functionExecutorMap),this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),e.next=10,this.executeWithControlFlow(t,o,n,r);case 10:return s=e.sent,u=n.map((function(e){return KS(e,s,o)})),c=u.map((function(e){return e.id})),l=Object.keys(t).map((function(e){return t[e].id})),d=new Set([].concat(R(c),R(l),R(this.weightIds))),Object.values(s).forEach((function(e){e.forEach((function(e){!e||e.isDisposed||d.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(d),e.abrupt("return",u);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=mt(ft().mark((function e(t,n,r){var a,i=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[i.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=mt(ft().mark((function e(t,n,r,a){var i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,w=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return w.graph.nodes[YS(e)[0]]})),s=r.map((function(e){return YS(e)[0]})),0===(u=s.map((function(e){return w.graph.nodes[e]}))).length&&(u=this._outputs),c=vI(t,u,this.weightMap,this._initNodes),l=c.usedNodes,d=c.missingInputs,p=c.dynamicNode,h=c.syncInputs,f=[].concat(R(o),R(this.graph.weights),R(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),v=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=H(YS(e),2),r=n[0],a=[];a[n[1]]=t[e],v[r]=a})),m={},g=this.getFrozenTensorIds(v),y={};case 12:if(!(f.length>0)){e.next=18;break}return b=this.processStack(o,f,n,v,y,g,s,m,l),e.next=16,Promise.all(b);case 16:e.next=12;break;case 18:if(null!=p||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((x=u.filter((function(e){return!bI(e)&&!KS(e.name,v,n)})).map((function(e){return e.name}))).length>0)){e.next=24;break}throw k="",null!=p&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(x,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(d,"]. ").concat(k));case 24:return e.abrupt("return",v);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],d=function(){var e=t.pop();n.currentContext=e.contexts;var d="";if("Enter"===e.node.op&&qS("isConstant",e.node,r,n)){var p=H(XS(e.node.name,n),1);d=p[0]}if(null==r[e.node.name]){var h=hI(e.node,r,n,c._resourceManager);if(!d){var f=H(XS(e.node.name,n),1);d=f[0]}var v=n.currentContext;Jr(h)?l.push(h.then((function(l){return r[d]=l,c.keepIntermediateTensors&&(c.clonedTensorsMap[d]=c.cloneTensorList(l)),n.currentContext=v,c.checkTensorForDisposal(d,e.node,r,n,i,o,s),c.processChildNodes(e.node,t,n,r,a,u),l}))):(r[d]=h,c.keepIntermediateTensors&&(c.clonedTensorsMap[d]=c.cloneTensorList(h)),c.checkTensorForDisposal(d,e.node,r,n,i,o,s),c.processChildNodes(e.node,t,n,r,a,u))}else c.processChildNodes(e.node,t,n,r,a,u)};t.length>0;)d();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=H(XS(e.name,n),1)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!KS(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!KS(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=H(YS(n),1)[0],i=t.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value;wr(o.length===r.shape.length&&r.shape.every((function(e,t){return-1===o[t]||o[t]===e})),(function(){return"The shape of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be [".concat(o,"], but was ")+"[".concat(r.shape,"]")}))}i.attrParams.dtype&&i.attrParams.dtype.value&&wr(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(i.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t,n,r={};for(var a in e){var i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=i?r[i.name]=e[a]:r[a]=e[a]}return r}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=H(YS(e),1)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){var n,r,a=null===(r=null===(n=t._signature)||void 0===n?void 0:n.outputs)||void 0===r?void 0:r[e];return null!=a?a.name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=H(YS(e),1)[0];if(!t.graph.nodes[n])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),CI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};A(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return L(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),SI="?tfjs-format=file",NI="model.json",II=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;A(this,t),this.modelUrl=n,this.loadOptions=r,this.version="n/a",this.io=a,null==r&&(this.loadOptions={}),this.resourceManager=new CI}return L(t,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"modelStructuredOutputKeys",get:function(){return this.structuredOutputKeys}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{var t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=this;if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");var t=this.handler.load();return Jr(t)?t.then((function(t){return e.loadSync(t)})):this.loadSync(t)}},{key:"loadSync",value:function(e){this.artifacts=e;var t=this.artifacts.modelTopology,n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){var r=this.artifacts.userDefinedMetadata;null!=r.signature&&(n=r.signature),null!=r.structuredOutputKeys&&(this.structuredOutputKeys=r.structuredOutputKeys)}this.signature=n,this.version="".concat(t.versions.producer,".").concat(t.versions.minConsumer);var a=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new wI(yN.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var i=yN.Instance.transformGraph(e.modelInitializer);this.initializer=new wI(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}},{key:"save",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=this.io.getSaveHandlers(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addStructuredOutputNames",value:function(e){var t=this;if(this.structuredOutputKeys){var n={};return(e instanceof au?[e]:e).forEach((function(e,r){return n[t.structuredOutputKeys[r]]=e})),n}return e}},{key:"predict",value:function(e,t){var n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}},{key:"predictAsync",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.executeAsync(t,this.outputNodes);case 2:return r=e.sent,e.abrupt("return",this.addStructuredOutputNames(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"normalizeInputs",value:function(e){var t,n=this;if(!(e instanceof au)&&!Array.isArray(e)){var r=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=r)for(var a in r){var i=r[a];null!=i.resourceId&&(e[a]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];var o=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+o!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-o," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));var s=0;return this.inputNodes.reduce((function(t,r){var a,i,o,u=null===(o=null===(i=null===(a=n.signature)||void 0===a?void 0:a.inputs)||void 0===i?void 0:i[r])||void 0===o?void 0:o.resourceId;return t[r]=null!=u?n.resourceIdToCapturedInput[u]:e[s++],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"executeInitializerGraph",value:function(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}},{key:"executeInitializerGraphAsync",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.initializer){e.next=2;break}return e.abrupt("return",[]);case 2:if(null!=this.initializerSignature){e.next=6;break}return e.abrupt("return",this.initializer.executeAsync({},[]));case 6:return e.abrupt("return",this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResourceIdToCapturedInput",value:function(e){if(this.resourceIdToCapturedInput={},this.initializerSignature)for(var t=this.initializerSignature.outputs,n=Object.keys(t),r=0;r<n.length;r++){var a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}},{key:"execute",value:function(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=mt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.resourceIdToCapturedInput){e.next=6;break}return e.t0=this,e.next=4,this.executeInitializerGraphAsync();case 4:e.t1=e.sent,e.t0.setResourceIdToCapturedInput.call(e.t0,e.t1);case 6:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=10,this.executor.executeAsync(t,n);case 10:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getIntermediateTensors",value:function(){return this.executor.getIntermediateTensors()}},{key:"disposeIntermediateTensors",value:function(){this.executor.disposeIntermediateTensors()}},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&el(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}]),t}();function TI(e){return EI.apply(this,arguments)}function EI(){return EI=mt(ft().mark((function t(n){var r,a,i,o=arguments;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},a=o.length>2&&void 0!==o[2]?o[2]:e,null!=n){t.next=4;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 4:return null==r&&(r={}),r.fromTFHub&&"string"===typeof n&&(n=_I(n)),i=new II(n,r,a),t.next=9,i.load();case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t)}))),EI.apply(this,arguments)}function _I(e){return e.endsWith("/")||(e+="/"),"".concat(e).concat(NI).concat(SI)}function RI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(DI(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=RI(e[o],t,n,r);i[o]=s}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function AI(e){return OI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:FI)}function OI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(DI(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=OI(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function FI(e){return null===e?null:DI(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function DI(e){var t=!1;na().get("IS_BROWSER")?t=e instanceof TextDecoder:t=e instanceof n(4977).StringDecoder;return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof au)&&!(e instanceof Promise)&&!t)}function LI(e){return function(e,t){return RI(e,t)}(e,MI)}function MI(e){return e instanceof au?{value:e.clone(),recurse:!1}:DI(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var zI=function(){function e(t){if(A(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return L(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=K(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(aH){n.e(aH)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),PI=function(e){z(n,e);var t=W(n);function n(){return A(this,n),t.call(this,n.INITIAL_CAPACITY)}return L(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){bk(P(n.prototype),"isFull",this).call(this)&&this.expand(),bk(P(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){bk(P(n.prototype),"isFull",this).call(this)&&this.expand(),bk(P(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(zI);function BI(e){return new HI(e)}function VI(e,t){return new tT(e,t)}PI.INITIAL_CAPACITY=32;var WI,UI=function(){function e(){A(this,e)}return L(e,[{key:"toArray",value:function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=mt(ft().mark((function e(){var t,n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new QI(this,e)}},{key:"filter",value:function(e){return new ZI(this,e)}},{key:"map",value:function(e){return new YI(this,e)}},{key:"mapAsync",value:function(e){return new JI(this,e)}},{key:"serialMapAsync",value:function(e){return new JI(this,e).serial()}},{key:"flatmap",value:function(e){return new eT(this,e)}},{key:"forEachAsync",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){return new XI(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:FI;return this.rowMajorBatch(e,t).map((function(e){return AI(e,n)}))}},{key:"concatenate",value:function(e,t){return new tT(new jI([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new KI(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new qI(this,e)}},{key:"prefetch",value:function(e){return new nT(this,e)}},{key:"shuffle",value:function(e,t){return new rT(this,e,t)}},{key:"serial",value:function(){return new GI(this)}}]),e}(),jI=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).items=e,r.trav=0,r}return L(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:LI(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),HI=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).nextFn=e,r}return L(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),GI=function(e){z(n,e);var t=W(n);function n(e){var r;return A(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),qI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:el(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),KI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),XI=function(e){z(n,e);var t=W(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return A(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),ZI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:el(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),YI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=gu(t.value),r=this.transform(t.value),a=gu(r),i=K(n);try{for(i.s();!(o=i.n()).done;)mu(s=o.value,a)||s.dispose()}catch(aH){i.e(aH)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),QI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),JI=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=gu(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=gu(r),i=K(n);try{for(i.s();!(o=i.n()).done;)mu(s=o.value,a)||s.dispose()}catch(aH){i.e(aH)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),$I=function(e){z(n,e);var t=W(n);function n(){var e;return A(this,n),(e=t.call(this)).outputQueue=new PI,e.lastRead=Promise.resolve({value:null,done:!1}),e}return L(n,[{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UI),eT=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=gu(t.value),r=this.transform(t.value),a=gu(r),this.outputQueue.pushAll(r),i=K(n);try{for(i.s();!(o=i.n()).done;)mu(s=o.value,a)||s.dispose()}catch(aH){i.e(aH)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($I),tT=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return L(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(UI);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(WI||(WI={}));var nT=function(e){z(n,e);var t=W(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new zI(r),a}return L(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(UI),rT=function(e){z(n,e);var t=W(n);function n(e,r,a){var i;return A(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=rf.alea(a||Vs().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return L(n,[{key:"next",value:function(){var e=mt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(nT),aT=function(){function e(){A(this,e),this.size=null}return L(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return wr(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),iT(mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,oT));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,iT(mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,iT(mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return $c((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return iT(mt(ft().mark((function n(){return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return $c((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return iT(mt(ft().mark((function n(){return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return iT(mt(ft().mark((function n(){return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,iT(mt(ft().mark((function t(){var r;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=BI(mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",VI(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,iT(mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=rf.alea(t||Vs().toString());return iT(mt(ft().mark((function t(){var i;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,iT(mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=mt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function iT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){z(a,n);var r=W(a);function a(){var e;return A(this,a),(e=r.apply(this,arguments)).size=t,e}return L(a,[{key:"iterator",value:function(){var t=mt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(aT))}function oT(e){return null===e?null:function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof au||js(e);var t}(e[0])?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof au?jf(e):Pu(e)}(e),recurse:!1}:{value:null,recurse:!0}}aT.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function sT(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&wr("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var uT=iv,cT=function(e){z(n,e);var t=W(n);function n(){var e;return A(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new fr(V(e),Qc()),e}return L(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,na().get("IS_NODE")&&vs("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&Pr(n[0])){var a=n.map((function(e){return Ws(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;return"complex64"===n?sg(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,n)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return Us(e)}));return Kc(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Kc(e.shape,e.dtype,t)}},{key:"makeOutput",value:function(e,t,n){return Qc().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e).complexTensorInfos;null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=mt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vs(),t(),r=Vs()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){sT([e],"where");var t=this.readSync(e.dataId);return uT(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return bk(P(n.prototype),"epsilon",this).call(this)}}]),n}(vr);cT.nextDataId=0;function lT(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(sT(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var u=o,c=u.data.get(s.dataId).values,l=Nr(s.shape),d=n||s.dtype,p=Lr(d,l),h=0;h<l;++h)p[h]=t(c[h],i);return u.makeTensorInfo(s.shape,d,p)}}function dT(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(sT(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,d=t(c,l,i);return u.makeTensorInfo(s.shape,l,d)}}nl("cpu",(function(){return new cT}),1);var pT=lT(ri,(function(e){return e>=0?e:Math.exp(e)-1})),hT={kernelName:ri,backendName:"cpu",kernelFunc:pT};function fT(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var vT={kernelName:xi,backendName:"cpu",kernelFunc:fT};function mT(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;sT([a],"leakyRelu");for(var o=Nr(a.shape),s=n.data.get(a.dataId).values,u=Dr("float32",o),c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}var gT={kernelName:Ii,backendName:"cpu",kernelFunc:mT};function yT(e){return function(t,n,r,a,i){var o=Nl(t,n),s=o.length,u=jr(o),c=Dr(i,Nr(o)),l=t.length,d=n.length,p=jr(t),h=jr(n),f=Cl(t,o),v=Cl(n,o);if(f.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=e(r[m%r.length],a[m%a.length]);else for(var g=function(){var t=Qr(y,s,u),n=t.slice(-l);f.forEach((function(e){return n[e]=0}));var i=Yr(n,l,p),o=t.slice(-d);v.forEach((function(e){return o[e]=0}));var m=Yr(o,d,h);c[y]=e(r[i],a[m])},y=0;y<c.length;++y)g();return[c,o]}}var bT=yT((function(e,t){return e<0?t*e:e}));function xT(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;sT([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=H(bT(r.shape,a.shape,i,o,"float32"),2),u=s[0],c=s[1];return n.makeTensorInfo(c,"float32",u)}var kT={kernelName:so,backendName:"cpu",kernelFunc:xT},wT=lT(mo,(function(e){return Math.max(0,e)})),CT={kernelName:mo,backendName:"cpu",kernelFunc:wT},ST=lT(wo,(function(e){return Math.min(Math.max(0,e),6)})),NT={kernelName:wo,backendName:"cpu",kernelFunc:ST};function IT(e){return function(t,n,r){for(var a=Dr(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var TT=IT((function(e){return 1/(1+Math.exp(-e))})),ET=lT(Do,(function(e){return 1/(1+Math.exp(-e))})),_T={kernelName:Do,backendName:"cpu",kernelFunc:ET};function RT(e,t,n,r,a){if("linear"===n)return fT({inputs:{x:t},backend:e});if("relu"===n)return wT({inputs:{x:t},backend:e});if("elu"===n)return pT({inputs:{x:t},backend:e});if("relu6"===n)return ST({inputs:{x:t},backend:e});if("prelu"===n)return xT({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return mT({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return ET({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function AT(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var OT={kernelName:Oa,backendName:"cpu",kernelFunc:AT};function FT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return AT({inputs:{real:FT(e,t,"float32"),imag:FT(e,t,"float32")},backend:e});var r=Kr(Nr(t),n);return e.makeTensorInfo(t,n,r)}function DT(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var LT={kernelName:fo,backendName:"cpu",kernelFunc:DT};function MT(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=Bs([0],n),i=H(yT((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),2),o=i[0];return[i[1],"bool",o]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function zT(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return fT({inputs:{x:a},backend:n});var o=FT(n,a.shape,a.dtype),s=zT({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=AT({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=DT({inputs:{input:a},backend:n}),l=zT({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!Mr(a.dtype,i)){var d=fT({inputs:{x:a},backend:n});return{dataId:d.dataId,shape:d.shape,dtype:i}}var p=H(MT(n.data.get(a.dataId).values,a.shape,a.dtype,i),3),h=p[0],f=p[1],v=p[2];return n.makeTensorInfo(h,f,v)}var PT={kernelName:_a,backendName:"cpu",kernelFunc:zT};function BT(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;sT([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,d="string"===o.dtype?Ig(c):c,p="string"===o.dtype?Ig(l):l,h=r||o.dtype,f=H(t(o.shape,s.shape,d,p,h),2),v=f[0],m=f[1];return u.makeTensorInfo(m,h,v)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=zT({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),d=l.complexTensorInfos.real,p=l.complexTensorInfos.imag,h=u.data.get(d.dataId).values,f=u.data.get(p.dataId).values,v=zT({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),m=u.data.get(v.dataId),g=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=u.data.get(g.dataId).values,x=u.data.get(y.dataId).values,k=H(n(o.shape,s.shape,h,f,b,x),3),w=k[0],C=k[1],S=k[2],N=u.makeTensorInfo(S,"float32",w),I=u.makeTensorInfo(S,"float32",C),T=AT({inputs:{real:N,imag:I},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(N),u.disposeIntermediateTensorInfo(I),T}var E=u.data.get(o.dataId).values,_=u.data.get(s.dataId).values,R=r||o.dtype,A=H(t(o.shape,s.shape,E,_,R),2),O=A[0],F=A[1];return u.makeTensorInfo(F,R,O)}}function VT(e){return function(t,n,r,a,i,o){var s=Nl(t,n),u=Nr(s),c=s.length,l=jr(s),d=Dr("float32",u),p=Dr("float32",u),h=Cl(t,s),f=Cl(n,s),v=sg(r,a),m=sg(i,o),g=t.length,y=jr(t),b=n.length,x=jr(n);if(h.length+f.length===0)for(var k=0;k<d.length;k++){var w=k%v.length,C=k%m.length,S=e(v[2*w],v[2*w+1],m[2*C],m[2*C+1]);d[k]=S.real,p[k]=S.imag}else for(var N=function(){var t=Qr(I,c,l),n=t.slice(-g);h.forEach((function(e){return n[e]=0}));var r=Yr(n,g,y),a=t.slice(-b);f.forEach((function(e){return a[e]=0}));var i=Yr(a,b,x),o=e(v[2*r],v[2*r+1],m[2*i],m[2*i+1]);d[I]=o.real,p[I]=o.imag},I=0;I<d.length;I++)N();return[d,p,s]}}var WT=yT((function(e,t){return e+t})),UT=VT((function(e,t,n,r){return{real:e+n,imag:t+r}})),jT=BT(la,WT,UT),HT={kernelName:la,backendName:"cpu",kernelFunc:jT};function GT(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=Nr(a.shape),s=Ar(i,o),u=Nr(s);wr(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;l.shape=s,d.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var qT={kernelName:go,backendName:"cpu",kernelFunc:GT};function KT(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;sT([a,i],"matMul");var u=a.shape.length,c=i.shape.length,l=o?a.shape[u-2]:a.shape[u-1],d=s?i.shape[c-1]:i.shape[c-2],p=o?a.shape[u-1]:a.shape[u-2],h=s?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),v=i.shape.slice(0,-2),m=Nr(f),g=Nr(v),y=Nl(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);wr(l===d,(function(){return"Error in matMul: inner shapes (".concat(l,") and (")+"".concat(d,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));for(var b=s?[g,h,d]:[g,d,h],x=GT({inputs:{x:a},backend:n,attrs:{shape:o?[m,l,p]:[m,p,l]}}),k=GT({inputs:{x:i},backend:n,attrs:{shape:b}}),w=o?x.shape[1]:x.shape[2],C=o?x.shape[2]:x.shape[1],S=s?k.shape[1]:k.shape[2],N=Math.max(m,g),I=n.data.get(x.dataId).values,T=n.data.get(k.dataId).values,E=jr(x.shape),_=jr(k.shape),R=H(o?[E[0],1,E[1]]:[E[0],E[1],1],3),A=R[0],O=R[1],F=R[2],D=H(s?[1,_[1],_[0]]:[_[1],1,_[0]],3),L=D[0],M=D[1],z=D[2],P=C*S,B=Kc([N,C,S],x.dtype),V=B.values,W=n.blockSize,U=0;U<N;U++)for(var j=U%m,G=U%g,q=0;q<C;q+=W)for(var K=Math.min(q+W,C),X=0;X<S;X+=W)for(var Z=Math.min(X+W,S),Y=0;Y<w;Y+=W)for(var Q=Math.min(Y+W,w),J=q;J<K;J++)for(var $=X;$<Z;$++){for(var ee=0,te=Y;te<Q;te++){ee+=I[j*A+J*O+te*F]*T[te*L+$*M+G*z]}V[U*P+(J*S+$)]+=ee}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(y,B.dtype,B.values)}var XT={kernelName:Na,backendName:"cpu",kernelFunc:KT};var ZT={kernelName:ps,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,d=o.transposeA,p=o.transposeB,h=o.activation,f=o.leakyreluAlpha,v=[];t=KT({inputs:{a:s,b:u},attrs:{transposeA:d,transposeB:p},backend:i}),c&&(n=jT({inputs:{a:t,b:c},backend:i}),v.push(t),t=n),h&&(r=RT(i,t,h,l,f),v.push(t),t=r);for(var m=0,g=v;m<g.length;m++){var y=g[m];i.disposeIntermediateTensorInfo(y)}return t}};function YT(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var QT={kernelName:sa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;sT(t,"abs");var r=new Float32Array(Nr(t.shape));return r=YT(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},JT=lT(ua,(function(e){return Math.acos(e)})),$T={kernelName:ua,backendName:"cpu",kernelFunc:JT},eE=lT(ca,(function(e){return Math.acosh(e)})),tE={kernelName:ca,backendName:"cpu",kernelFunc:eE};var nE={kernelName:da,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;sT(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=Kc(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],c=0;c<o.length;c++)o[c]+=u[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function rE(e,t,n,r,a){for(var i=t.length,o=Nr(t),s=jr(t),u=jr(a),c=Dr(n,Nr(a)),l=0;l<o;++l){for(var d=Qr(l,i,s),p=new Array(d.length),h=0;h<p.length;h++)p[h]=d[r[h]];c[Yr(p,i,u)]=e[l]}return c}function aE(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;sT(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=rE(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}var iE={kernelName:as,backendName:"cpu",kernelFunc:aE};var oE={kernelName:pa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;sT(a,"all");var s=Or(i,a.shape),u=s,c=Vp(u,a.shape.length),l=a;null!=c&&(l=aE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Up(u.length,a.shape.length)),Bp("all",u,l.shape.length);for(var d=H(zp(l.shape,u),2),p=d[0],h=Nr(d[1]),f=Kr(Nr(p),l.dtype),v=n.data.get(l.dataId).values,m=0;m<f.length;++m){for(var g=m*h,y=v[g],b=0;b<h;++b){var x=v[g+b];y=y&&x}f[m]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(p,l.dtype,f);if(o){var w=GT({inputs:{x:k},backend:n,attrs:{shape:Pp(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var sE={kernelName:ha,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;sT(a,"any");var s=Or(i,a.shape),u=s,c=Vp(u,a.shape.length),l=a;null!=c&&(l=aE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Up(u.length,a.shape.length)),Bp("any",u,l.shape.length);for(var d=H(zp(l.shape,u),2),p=d[0],h=Nr(d[1]),f=Kr(Nr(p),l.dtype),v=n.data.get(l.dataId).values,m=0;m<f.length;++m){for(var g=m*h,y=v[g],b=0;b<h;++b){var x=v[g+b];y=y||x}f[m]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(p,l.dtype,f);if(o){var w=GT({inputs:{x:k},backend:n,attrs:{shape:Pp(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var uE={kernelName:fa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;sT(a,"argMax");var o=Or(i,a.shape),s=Vp(o,a.shape.length),u=a,c=[];null!=s&&(u=aE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=Up(o.length,u.shape.length)),Bp("argMax",o=[o[0]],u.shape.length);for(var l=H(zp(u.shape,o),2),d=l[0],p=l[1],h=Kr(Nr(d),"int32"),f=Nr(p),v=n.data.get(u.dataId).values,m=0;m<h.length;++m){for(var g=m*f,y=v[g],b=0,x=0;x<f;++x){var k=v[g+x];k>y&&(y=k,b=x)}h[m]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d,"int32",h)}};var cE={kernelName:va,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;sT(a,"argMin");var o=Or(i,a.shape),s=Vp(o,a.shape.length),u=a,c=[];null!=s&&(u=aE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=Up(o.length,u.shape.length)),Bp("argMin",o=[o[0]],u.shape.length);for(var l=H(zp(u.shape,o),2),d=l[0],p=l[1],h=Kr(Nr(d),"int32"),f=Nr(p),v=n.data.get(u.dataId).values,m=0;m<h.length;++m){for(var g=m*f,y=v[g],b=0,x=0;x<f;++x){var k=v[g+x];k<y&&(y=k,b=x)}h[m]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d,"int32",h)}},lE=lT(ma,(function(e){return Math.asin(e)})),dE={kernelName:ma,backendName:"cpu",kernelFunc:lE},pE=lT(ga,(function(e){return Math.asinh(e)})),hE={kernelName:ga,backendName:"cpu",kernelFunc:pE},fE=lT(ya,(function(e){return Math.atan(e)})),vE={kernelName:ya,backendName:"cpu",kernelFunc:fE},mE=yT((function(e,t){return Math.atan2(e,t)})),gE=BT(xa,mE),yE={kernelName:xa,backendName:"cpu",kernelFunc:gE},bE=lT(ba,(function(e){return Math.atanh(e)})),xE={kernelName:ba,backendName:"cpu",kernelFunc:bE};function kE(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Kc(a.outShape,n),m=v.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var k=x*g,w=x*r[0],C=0;C<a.inChannels;++C)for(var S=0;S<a.outHeight;++S)for(var N=S*o-p,I=Math.max(0,N),T=Math.min(a.inHeight,l+N),E=k+S*y,_=0;_<a.outWidth;++_){for(var R=_*s-h,A=Math.max(0,R),O=Math.min(a.inWidth,d+R),F=f,D=0,L=0,M=I;M<T;M+=u){for(var z=w+M*r[1],P=A;P<O;P+=c){var B=e[z+P*r[2]+C];"max"===i&&B>F?F=B:"avg"===i&&(D+=B,L++)}if(isNaN(F))break}m[E+_*b+C]="avg"===i?D/L:F}return v}function wE(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Kc(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,v=Kc(t,n,e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=c;for(var k=Math.min(r.inHeight,d+b),w=0;w<r.outWidth;++w){for(var C=w*u-f,S=C;S<0;)S+=l;for(var N=Math.min(r.inWidth,p+C),I=Number.NEGATIVE_INFINITY,T=-1,E=x;E<k;E+=c)for(var _=E-b,R=S;R<N;R+=l){var A=R-C,O=v.get(m,E,R,g);O>I&&(I=O,T=a?i?((m*r.inHeight+E)*r.inWidth+R)*r.inChannels+g:(E*r.inWidth+R)*r.inChannels+g:_*p+A)}o.set(T,m,y,w,g)}}return o}function CE(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,v=a.padInfo.front,m=a.padInfo.top,g=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Kc(a.outShape,n),x=b.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],S=a.outShape[4],N=0;N<a.batchSize;++N)for(var I=N*k,T=N*r[0],E=0;E<a.inChannels;++E)for(var _=0;_<a.outDepth;++_){for(var R=_*o-v,A=R;A<0;)A+=c;for(var O=Math.min(a.inDepth,p+R),F=I+_*w,D=0;D<a.outHeight;++D){for(var L=D*s-m,M=L;M<0;)M+=l;for(var z=Math.min(a.inHeight,h+L),P=F+D*C,B=0;B<a.outWidth;++B){for(var V=B*u-g,W=V;W<0;)W+=d;for(var U=Math.min(a.inWidth,f+V),j=P+B*S,H=y,G=0,q=0,K=A;K<O;K+=c){for(var X=T+K*r[1],Z=M;Z<z;Z+=l){for(var Y=X+Z*r[2],Q=W;Q<U;Q+=d){var J=e[Y+Q*r[3]+E];if("max"===i&&J>H?H=J:"avg"===i&&(G+=J,q++),isNaN(H))break}if(isNaN(H))break}if(isNaN(H))break}x[j+E]="avg"===i?G/Math.max(q,1):H}}}return b}var SE={kernelName:ka,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sT(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;wr(Vd(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Rd(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&Ir(l.inShape,l.outShape))c=fT({inputs:{x:a},backend:n});else{var d=n.data.get(a.dataId).values,p=jr(a.shape),h=kE(d,a.shape,a.dtype,p,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var NE={kernelName:Ca,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;sT(a,"avgPool3d");var l=Ad(a.shape,i,o,1,s,u,c),d=CE(n.data.get(a.dataId).values,a.shape,a.dtype,jr(a.shape),l,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};var IE={kernelName:Sa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;sT([a,i],"avgPool3DGrad");for(var l=Ad(i.shape,o,s,1,u,c),d=l.strideDepth,p=l.strideHeight,h=l.strideWidth,f=l.filterDepth,v=l.filterHeight,m=l.filterWidth,g=l.dilationDepth,y=l.dilationHeight,b=l.dilationWidth,x=l.effectiveFilterDepth,k=l.effectiveFilterHeight,w=l.effectiveFilterWidth,C=x-1-l.padInfo.front,S=w-1-l.padInfo.left,N=k-1-l.padInfo.top,I=Kc(i.shape,"float32"),T=1/(f*v*m),E=n.bufferSync(a),_=0;_<l.batchSize;++_)for(var R=0;R<l.inChannels;++R)for(var A=0;A<l.inDepth;++A)for(var O=0;O<l.inHeight;++O)for(var F=0;F<l.inWidth;++F){for(var D=A-C,L=O-N,M=F-S,z=0,P=0;P<x;P+=g){var B=(D+P)/d;if(!(B<0||B>=l.outDepth||Math.floor(B)!==B))for(var V=0;V<k;V+=y){var W=(L+V)/p;if(!(W<0||W>=l.outHeight||Math.floor(W)!==W))for(var U=0;U<w;U+=b){var j=(M+U)/h;if(!(j<0||j>=l.outWidth||Math.floor(j)!==j))z+=E.get(_,B,W,j,R)}}}I.set(z*T,_,A,O,F,R)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};var TE={kernelName:wa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sT([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=Rd(o.shape,s,u,1,c),d=l.strideHeight,p=l.strideWidth,h=l.filterHeight,f=l.filterWidth,v=l.dilationHeight,m=l.dilationWidth,g=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,x=g-1-l.padInfo.top,k=Kc(o.shape,"float32"),w=1/(h*f),C=n.data.get(a.dataId).values,S=Kc(a.shape,"float32",C),N=0;N<l.batchSize;++N)for(var I=0;I<l.inChannels;++I)for(var T=0;T<l.inHeight;++T)for(var E=0;E<l.inWidth;++E){for(var _=T-x,R=E-b,A=0,O=0;O<g;O+=v){var F=(_+O)/d;if(!(F<0||F>=l.outHeight||Math.floor(F)!==F))for(var D=0;D<y;D+=m){var L=(R+D)/p;if(!(L<0||L>=l.outWidth||Math.floor(L)!==L))A+=S.get(N,F,L,I)}}k.set(A*w,N,T,E,I)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var EE={kernelName:vi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;wr(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),wr(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),wr(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),sT([a,s,u,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,p=n.data.get(u.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(l.length),m=f.length,g=h.length,y=p.length,b=d.length,x=0,k=0,w=0,C=0,S=0;S<l.length;++S)v[S]=f[x++]+(l[S]-d[k++])*h[w++]/Math.sqrt(p[C++]+c),x>=m&&(x=0),k>=b&&(k=0),w>=g&&(w=0),C>=y&&(C=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function _E(e,t,n,r,a){var i=pd(r,t,n),o=Nr(n),s=jr(r);if(i){var u=hd(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c=Kc(r,a,"string"===a?Ig(e):e),l=Kc(n,a),d=0;d<l.size;++d){var p=l.indexToLoc(d),h=p.map((function(e,n){return e+t[n]}));l.set.apply(l,[c.get.apply(c,R(h))].concat(R(p)))}return"string"===a?l.values.map((function(e){return Ws(e)})):l.values}function RE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;sT(a,"slice");var s=H(fd(a,i,o),2),u=s[0],c=s[1];ld(a,u,c);var l=_E(n.data.get(a.dataId).values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,l)}var AE={kernelName:Ro,backendName:"cpu",kernelFunc:RE};var OE={kernelName:Ia,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;sT([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=Km(a.shape,i,s),c=Xm(u.length,i.length),l=Zm(a.shape,i,s),d=Ym(o,i.length),p=Qm(l,o,i.length),h=GT({inputs:{x:a},backend:n,attrs:{shape:u}}),f=aE({inputs:{x:h},backend:n,attrs:{perm:c}}),v=GT({inputs:{x:f},backend:n,attrs:{shape:l}}),m=RE({inputs:{x:v},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),m}};function FE(e,t,n,r,a){for(var i=Nr(r),o=Kr(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function DE(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=Kc([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,s,c):t.size>0?o.set(o.get(s,c)+t.get(s,u),s,c):o.set(o.get(s,c)+1,s,c))}return o}var LE={kernelName:Ta,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=FE(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};var ME={kernelName:Ea,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=Nl(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},zE=IT((function(e){return Math.ceil(e)})),PE=dT(Ra,zE),BE={kernelName:Ra,backendName:"cpu",kernelFunc:PE},VE=lT(Aa,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),WE={kernelName:Aa,backendName:"cpu",kernelFunc:VE},UE={kernelName:Fa,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(Nr(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=0;c<s.length;c++){var l=s[c],d=u[c];r[c]=Math.hypot(l,d)}return n.makeOutput(r,t.shape,"float32")}};function jE(e,t,n,r){var a=Lr(n,Nr(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=Nr(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?Ig(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}function HE(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var GE={kernelName:wi,backendName:"cpu",kernelFunc:HE};function qE(e){var t=e.inputs,n=e.backend,r=Or(e.attrs.axis,t[0].shape)[0];Um(t.map((function(e){return e.shape})),r);var a=jm(t.map((function(e){return e.shape})),r);if(0===Nr(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return Nr(e.shape)>0}));if(1===i.length)return fT({inputs:{x:i[0]},backend:n});if("complex64"===i[0].dtype){var o=i.map((function(e){return DT({inputs:{input:e},backend:n})})),s=i.map((function(e){return HE({inputs:{input:e},backend:n})})),u=qE({inputs:o,backend:n,attrs:{axis:r}}),c=qE({inputs:s,backend:n,attrs:{axis:r}}),l=AT({inputs:{real:u,imag:c},backend:n});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}var d=i.map((function(e){var t=Nr(e.shape.slice(r));return GT({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=d.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));a=jm(d.map((function(e){return e.shape})),1);var h=1===d[0].shape[0],f=jE(p,a,t[0].dtype,h),v=jm(i.map((function(e){return e.shape})),r),m=n.makeTensorInfo(v,t[0].dtype,f);return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}var KE={kernelName:Da,backendName:"cpu",kernelFunc:qE};function XE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;sT([a,i],"conv2d");for(var d=Ud(u),p=Od(a.shape,i.shape,o,c,s,l,!1,d),h=p.filterHeight,f=p.filterWidth,v=p.dilationHeight,m=p.dilationWidth,g=p.padInfo.left,y=p.padInfo.top,b="channelsLast"===p.dataFormat,x=new tu(p.outShape,a.dtype),k=jr(a.shape),w=jr(i.shape),C=k[0],S=b?k[1]:k[2],N=b?k[2]:1,I=b?1:k[1],T=x.strides[0],E=b?x.strides[1]:x.strides[2],_=b?x.strides[2]:1,R=b?1:x.strides[1],A=n.data.get(a.dataId).values,O=n.data.get(i.dataId).values,F=x.values,D=0;D<p.batchSize;++D)for(var L=D*C,M=D*T,z=0;z<p.outHeight;++z)for(var P=M+z*E,B=z*p.strideHeight-y,V=0;V<h;++V){var W=B+V*v;if(!(W<0||W>=p.inHeight))for(var U=V*w[0],j=L+W*S,H=0;H<p.outWidth;++H)for(var G=P+H*_,q=H*p.strideWidth-g,K=0;K<f;++K){var X=q+K*m;if(!(X<0||X>=p.inWidth))for(var Z=j+X*N,Y=U+K*w[1],Q=0;Q<p.inChannels;++Q){for(var J=A[Z+Q*I],$=0;$<p.outChannels;++$)F[G+$*R]+=J*O[Y+$];Y+=p.outChannels}}}return n.makeTensorInfo(x.shape,x.dtype,F)}var ZE={kernelName:La,backendName:"cpu",kernelFunc:XE};var YE={kernelName:Ma,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;sT([a,i],"conv2dBackpropFilter");for(var d=Ud(u),p=Od(a.shape,l,o,1,s,c,!1,d),h=p.strideHeight,f=p.strideWidth,v=p.filterHeight,m=p.filterWidth,g="channelsLast"===p.dataFormat,y=new tu(p.filterShape,"float32"),b=p.padInfo.left,x=p.padInfo.top,k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,C=new tu(a.shape,a.dtype,k),S=new tu(i.shape,i.dtype,w),N=0;N<v;++N)for(var I=Math.max(0,Math.ceil((x-N)/h)),T=Math.min(p.outHeight,(p.inHeight+x-N)/h),E=0;E<m;++E)for(var _=Math.max(0,Math.ceil((b-E)/f)),R=Math.min(p.outWidth,(p.inWidth+b-E)/f),A=0;A<p.inChannels;++A)for(var O=0;O<p.outChannels;++O){for(var F=0,D=0;D<p.batchSize;++D)for(var L=I;L<T;++L)for(var M=N+L*h-x,z=_;z<R;++z){var P=E+z*f-b;F+=g?C.get(D,M,P,A)*S.get(D,L,z,O):C.get(D,A,M,P)*S.get(D,O,L,z)}y.set(F,N,E,A,O)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var QE={kernelName:za,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode;sT([a,i],"conv2dBackpropInput");var d=jr(i.shape),p=jr(a.shape),h=Ud(c),f=Od(o,i.shape,s,1,u,l,!1,h),v=new tu(f.inShape,"float32"),m=v.values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=H(d,3),x=b[0],k=b[1],w=b[2],C=f.batchSize,S=f.filterHeight,N=f.filterWidth,I=f.inChannels,T=f.inHeight,E=f.inWidth,_=f.outChannels,R=f.outHeight,A=f.outWidth,O=f.strideHeight,F=f.strideWidth;h=f.dataFormat;for(var D=S-1-f.padInfo.top,L=N-1-f.padInfo.left,M="channelsLast"===h,z=v.strides[0],P=M?v.strides[1]:v.strides[2],B=M?v.strides[2]:1,V=M?1:v.strides[1],W=p[0],U=M?p[1]:p[2],j=M?p[2]:1,G=M?1:p[1],q=0;q<C;++q)for(var K=0;K<I;++K)for(var X=0;X<T;++X)for(var Z=X-D,Y=Math.max(0,Math.ceil(Z/O)),Q=Math.min(R,(S+Z)/O),J=0;J<E;++J){for(var $=J-L,ee=Math.max(0,Math.ceil($/F)),te=Math.min(A,(N+$)/F),ne=0,re=Y;re<Q;++re)for(var ae=re*O-Z,ie=ee;ie<te;++ie)for(var oe=W*q+U*re+j*ie,se=x*(S-1-ae)+k*(N-1-(ie*F-$))+w*K,ue=0;ue<_;++ue){ne+=g[oe+G*ue]*y[se+ue]}m[z*q+P*X+B*J+V*K]=ne}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var JE={kernelName:Pa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;sT([a,i],"conv3d");for(var c=Fd(a.shape,i.shape,o,u,s),l=c.filterDepth,d=c.filterHeight,p=c.filterWidth,h=c.dilationDepth,f=c.dilationHeight,v=c.dilationWidth,m=c.padInfo,g=m.front,y=m.left,b=m.top,x=new tu(c.outShape,a.dtype),k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,C=x.values,S=jr(a.shape),N=jr(i.shape),I=0;I<c.batchSize;++I)for(var T=I*S[0],E=I*x.strides[0],_=0;_<c.outDepth;++_)for(var R=E+_*x.strides[1],A=_*c.strideDepth-g,O=0;O<l;++O){var F=A+O*h;if(!(F<0||F>=c.inDepth))for(var D=O*N[0],L=T+F*S[1],M=0;M<c.outHeight;++M)for(var z=R+M*x.strides[2],P=M*c.strideHeight-b,B=0;B<d;++B){var V=P+B*f;if(!(V<0||V>=c.inHeight))for(var W=D+B*N[1],U=L+V*S[2],j=0;j<c.outWidth;++j)for(var H=z+j*c.outChannels,G=j*c.strideWidth-y,q=0;q<p;++q){var K=G+q*v;if(!(K<0||K>=c.inWidth))for(var X=W+q*N[2],Z=U+K*c.inChannels,Y=X,Q=0;Q<c.inChannels;++Q){for(var J=k[Z+Q],$=0;$<c.outChannels;++$)C[H+$]+=J*w[Y+$];Y+=c.outChannels}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var $E={kernelName:Ba,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;sT([a,i],"conv3dBackpropFilterV2");for(var c=jr(a.shape),l=jr(i.shape),d=Fd(a.shape,u,o,1,s),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,v=d.filterDepth,m=d.filterHeight,g=d.filterWidth,y=new tu(d.filterShape,"float32"),b=y.values,x=H(y.strides,4),k=x[0],w=x[1],C=x[2],S=x[3],N=n.data.get(i.dataId).values,I=H(l,4),T=I[0],E=I[1],_=I[2],R=I[3],A=n.data.get(a.dataId).values,O=H(c,4),F=O[0],D=O[1],L=O[2],M=O[3],z=d.padInfo.front,P=d.padInfo.left,B=d.padInfo.top,V=0;V<v;++V)for(var W=Math.max(0,Math.ceil((z-V)/p)),U=Math.min(d.outDepth,(d.inDepth+z-V)/p),j=V*k,G=0;G<m;++G)for(var q=Math.max(0,Math.ceil((B-G)/h)),K=Math.min(d.outHeight,(d.inHeight+B-G)/h),X=G*w+j,Z=0;Z<g;++Z)for(var Y=Math.max(0,Math.ceil((P-Z)/f)),Q=Math.min(d.outWidth,(d.inWidth+P-Z)/f),J=Z*C+X,$=0;$<d.inChannels;++$)for(var ee=$*S+J,te=0;te<d.outChannels;++te){for(var ne=0,re=0;re<d.batchSize;++re)for(var ae=re*F,ie=re*T,oe=W;oe<U;++oe)for(var se=(V+oe*p-z)*D+ae,ue=oe*E+ie,ce=q;ce<K;++ce)for(var le=(G+ce*h-B)*L+se,de=ce*_+ue,pe=Y;pe<Q;++pe){var he=pe*R+de;ne+=A[(Z+pe*f-P)*M+le+$]*N[he+te]}b[ee+te]=ne}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var e_={kernelName:Va,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;sT([a],"conv3dBackpropInputV2");for(var c=jr(a.shape),l=jr(i.shape),d=Fd(u,i.shape,s,1,o),p=new tu(d.inShape,"float32"),h=p.values,f=H(p.strides,4),v=f[0],m=f[1],g=f[2],y=f[3],b=n.data.get(a.dataId).values,x=H(c,4),k=x[0],w=x[1],C=x[2],S=x[3],N=n.data.get(i.dataId).values,I=H(l,4),T=I[0],E=I[1],_=I[2],R=I[3],A=d.batchSize,O=d.filterDepth,F=d.filterHeight,D=d.filterWidth,L=d.inChannels,M=d.inDepth,z=d.inHeight,P=d.inWidth,B=d.outChannels,V=d.outDepth,W=d.outHeight,U=d.outWidth,j=d.strideDepth,G=d.strideHeight,q=d.strideWidth,K=O-1-d.padInfo.front,X=F-1-d.padInfo.top,Z=D-1-d.padInfo.left,Y=0;Y<A;++Y)for(var Q=0;Q<L;++Q)for(var J=0;J<M;++J)for(var $=J-K,ee=Math.max(0,Math.ceil($/j)),te=Math.min(V,(O+$)/j),ne=0;ne<z;++ne)for(var re=ne-X,ae=Math.max(0,Math.ceil(re/G)),ie=Math.min(W,(F+re)/G),oe=0;oe<P;++oe){for(var se=oe-Z,ue=Math.max(0,Math.ceil(se/q)),ce=Math.min(U,(D+se)/q),le=0,de=ee;de<te;++de)for(var pe=de*j-$,he=ae;he<ie;++he)for(var fe=he*G-re,ve=ue;ve<ce;++ve)for(var me=k*Y+w*de+C*he+S*ve,ge=T*(O-1-pe)+E*(F-1-fe)+_*(D-1-(ve*q-se))+R*Q,ye=0;ye<B;++ye){le+=b[me+ye]*N[ge+ye]}h[v*Y+m*J+g*ne+y*oe+Q]=le}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},t_=lT(Wa,(function(e){return Math.cos(e)})),n_={kernelName:Wa,backendName:"cpu",kernelFunc:t_},r_=lT(Ua,(function(e){return Math.cosh(e)})),a_={kernelName:Ua,backendName:"cpu",kernelFunc:r_};var i_={kernelName:Ga,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=H(a.shape,4),d=l[0],p=l[1],h=l[2],f=l[3],v=i.shape[0],m=H(s,2),g=m[0],y=m[1],b=Kc([v,g,y,f],"float32"),x=n.data.get(i.dataId).values,k=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,C=jr(a.shape),S=jr(b.shape),N=0;N<v;N++){var I=4*N,T=x[I],E=x[I+1],_=x[I+2],R=x[I+3],A=k[N];if(!(A>=d))for(var O=g>1?(_-T)*(p-1)/(g-1):0,F=y>1?(R-E)*(h-1)/(y-1):0,D=0;D<g;D++){var L=g>1?T*(p-1)+D*O:.5*(T+_)*(p-1);if(L<0||L>p-1)for(var M=0;M<y;M++)for(var z=0;z<f;z++){var P=z+M*S[2]+D*S[1]+N*S[0];b.values[P]=c}else if("bilinear"===u)for(var B=Math.floor(L),V=Math.ceil(L),W=L-B,U=0;U<y;U++){var j=y>1?E*(h-1)+U*F:.5*(E+R)*(h-1);if(j<0||j>h-1)for(var G=0;G<f;G++){var q=G+U*S[2]+D*S[1]+N*S[0];b.values[q]=c}else for(var K=Math.floor(j),X=Math.ceil(j),Z=j-K,Y=0;Y<f;Y++){var Q=Y+K*C[2]+B*C[1]+A*C[0],J=w[Q],$=w[Q=Y+X*C[2]+B*C[1]+A*C[0]],ee=w[Q=Y+K*C[2]+V*C[1]+A*C[0]],te=J+($-J)*Z,ne=ee+(w[Q=Y+X*C[2]+V*C[1]+A*C[0]]-ee)*Z;Q=Y+U*S[2]+D*S[1]+N*S[0],b.values[Q]=te+(ne-te)*W}}else for(var re=0;re<y;++re){var ae=y>1?E*(h-1)+re*F:.5*(E+R)*(h-1);if(ae<0||ae>h-1)for(var ie=0;ie<f;ie++){var oe=ie+re*S[2]+D*S[1]+N*S[0];b.values[oe]=c}else for(var se=Math.round(ae),ue=Math.round(L),ce=0;ce<f;ce++){var le=ce+se*C[2]+ue*C[1]+A*C[0],de=ce+re*S[2]+D*S[1]+N*S[0];b.values[de]=w[le]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var o_={kernelName:ja,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;sT(a,"cumprod");var u=Vp([i],a.shape.length),c=a;null!=u&&(c=aE({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=Up(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var d=hu(c.dtype,"int32"),p=qr(Nr(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],v=s?function(e,t){return e+f-t-1}:function(e,t){return e+t},m=0;m<h.length;m+=f)for(var g=0;g<f;g++){var y=v(m,g);if(0===g)p[y]=o?1:h[y];else{var b=v(m,g-1);p[y]=o?h[b]*p[b]:h[y]*p[b]}}var x=n.makeTensorInfo(c.shape,d,p);if(null!=u){var k=aE({inputs:{x:x},backend:n,attrs:{perm:Wp(u)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var s_={kernelName:Ha,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;sT(a,"cumsum");var u=Vp([i],a.shape.length),c=a;null!=u&&(c=aE({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=Up(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var d=hu(c.dtype,"int32"),p=Kr(Nr(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],v=s?function(e,t){return e+f-t-1}:function(e,t){return e+t},m=0;m<h.length;m+=f)for(var g=0;g<f;g++){var y=v(m,g);if(0===g)p[y]=o?0:h[y];else{var b=v(m,g-1);p[y]=o?h[b]+p[b]:h[y]+p[b]}}var x=n.makeTensorInfo(c.shape,d,p);if(null!=u){var k=aE({inputs:{x:x},backend:n,attrs:{perm:Wp(u)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var u_={kernelName:qa,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=FE(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=DE(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var c_={kernelName:Ka,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;wr("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)}));for(var s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],d=u*i,p=c*i,h=l/(i*i),f=n.data.get(a.dataId).values,v=new Float32Array(s*d*p*h),m=0,g=0;g<s;++g)for(var y=0;y<d;++y)for(var b=Math.floor(y/i),x=y%i,k=0;k<p;++k)for(var w=Math.floor(k/i),C=(x*i+k%i)*h,S=0;S<h;++S){var N=S+C+l*(w+c*(b+u*g));v[m++]=f[N]}return n.makeTensorInfo([s,d,p,h],a.dtype,v)}};function l_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode;sT([a,i],"depthwiseConv2DNative");var l=jr(a.shape),d=jr(i.shape),p=u;null==p&&(p=[1,1]),wr(Vd(o,p),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(p,"'")}));for(var h=Od(a.shape,i.shape,o,p,s,c,!0),f=h.filterHeight,v=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo,b=y.left,x=y.top,k=h.outChannels/h.inChannels,w=new tu(h.outShape,a.dtype),C=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,N=w.values,I=0;I<h.batchSize;++I)for(var T=I*l[0],E=I*w.strides[0],_=0;_<h.outHeight;++_)for(var R=E+_*w.strides[1],A=_*h.strideHeight-x,O=0;O<f;++O){var F=A+O*m;if(!(F<0||F>=h.inHeight))for(var D=O*d[0],L=T+F*l[1],M=0;M<h.outWidth;++M)for(var z=R+M*w.strides[2],P=M*h.strideWidth-b,B=0;B<v;++B){var V=P+B*g;if(!(V<0||V>=h.inWidth))for(var W=D+B*d[1],U=L+V*h.inChannels,j=z,H=W,G=0;G<h.inChannels;++G){for(var q=C[U+G],K=0;K<k;++K)N[j+K]+=q*S[H+K];j+=k,H+=k}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var d_={kernelName:Xa,backendName:"cpu",kernelFunc:l_};var p_={kernelName:Za,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape;sT([a,i],"depthwiseConv2dNativeBackpropFilter");for(var d=Od(a.shape,l,o,s,u,c,!0),p=d.strideHeight,h=d.strideWidth,f=d.filterHeight,v=d.filterWidth,m=new tu(d.filterShape,"float32"),g=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,x=n.data.get(a.dataId).values,k=new tu(a.shape,a.dtype,x),w=n.data.get(i.dataId).values,C=new tu(i.shape,i.dtype,w),S=0;S<f;++S)for(var N=Math.max(0,Math.ceil((y-S)/p)),I=Math.min(d.outHeight,(d.inHeight+y-S)/p),T=0;T<v;++T)for(var E=Math.max(0,Math.ceil((g-T)/h)),_=Math.min(d.outWidth,(d.inWidth+g-T)/h),R=0;R<d.outChannels;++R){for(var A=Math.trunc(R/b),O=R%b,F=0,D=0;D<d.batchSize;++D)for(var L=N;L<I;++L)for(var M=S+L*p-y,z=E;z<_;++z){var P=T+z*h-g;F+=k.get(D,M,P,A)*C.get(D,L,z,R)}m.set(F,S,T,A,O)}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var h_={kernelName:Ya,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.inputShape;sT([a,i],"depthwiseConv2DNativeBackpropInput");for(var d=jr(a.shape),p=jr(i.shape),h=Od(l,i.shape,o,s,u,c,!0),f=new tu(h.inShape,"float32"),v=f.values,m=H(f.strides,3),g=m[0],y=m[1],b=m[2],x=n.data.get(a.dataId).values,k=H(d,3),w=k[0],C=k[1],S=k[2],N=n.data.get(i.dataId).values,I=H(p,3),T=I[0],E=I[1],_=I[2],R=h.batchSize,A=h.filterHeight,O=h.filterWidth,F=h.inChannels,D=h.inHeight,L=h.inWidth,M=h.outChannels,z=h.outHeight,P=h.outWidth,B=h.strideHeight,V=h.strideWidth,W=A-1-h.padInfo.top,U=O-1-h.padInfo.left,j=M/F,G=0;G<R;++G)for(var q=0;q<F;++q)for(var K=0;K<D;++K)for(var X=K-W,Z=Math.max(0,Math.ceil(X/B)),Y=Math.min(z,(A+X)/B),Q=0;Q<L;++Q){for(var J=Q-U,$=Math.max(0,Math.ceil(J/V)),ee=Math.min(P,(O+J)/V),te=0,ne=Z;ne<Y;++ne)for(var re=ne*B-X,ae=$;ae<ee;++ae)for(var ie=w*G+C*ne+S*ae,oe=T*(A-1-re)+E*(O-1-(ae*V-J))+_*q,se=0;se<j;++se){te+=x[ie+(q*j+se)]*N[oe+se]}v[g*G+y*K+b*Q+q]=te}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};var f_={kernelName:Qa,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=Nr(r.shape),i=n.data.get(r.dataId).values,o=Kc([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var c=[].concat(R(r.shape),R(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},v_={kernelName:Ja,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=n,l=c.data.get(a.dataId).values,d=a.shape.length,p=c.data.get(i.dataId).values,h=i.shape.length,f=_d(a.shape,i.shape,o,s,"NHWC",u),v=f.batchSize,m=f.inHeight,g=f.inWidth,y=f.inChannels,b=f.outHeight,x=f.outWidth,k=f.padInfo,w=f.strideHeight,C=f.strideWidth,S=f.filterHeight,N=f.filterWidth,I=f.dilationHeight,T=f.dilationWidth,E=f.outShape,_=Nr(E),R=E.length,A=Lr(a.dtype,_),O=0;O<v;++O)for(var F=0;F<b;++F)for(var D=F*w-k.top,L=0;L<x;++L)for(var M=L*C-k.left,z=0;z<y;++z){for(var P=Number.MIN_SAFE_INTEGER,B=0;B<S;++B){var V=D+B*I;if(V>=0&&V<m)for(var W=0;W<N;++W){var U=M+W*T;if(U>=0&&U<g){var j=Yr([O,V,U,z],d,jr(a.shape)),H=Yr([B,W,z],h,jr(i.shape)),G=l[j]+p[H];G>P&&(P=G)}}}A[Yr([O,F,L,z],R,jr(E))]=P}return{dataId:c.write(Bs(A,a.dtype),E,a.dtype),shape:E,dtype:a.dtype}}},m_={kernelName:ei,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,d=Gr(a.shape,l.data.get(a.dataId).values),p=Gr(i.shape,l.data.get(i.dataId).values),h=_d(a.shape,i.shape,s,u,"NHWC",c),f=h.batchSize,v=h.inHeight,m=h.inWidth,g=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,k=h.strideHeight,w=h.strideWidth,C=h.filterHeight,S=h.filterWidth,N=h.dilationHeight,I=h.dilationWidth,T=h.outShape;wr(o.rank===T.length,(function(){return"Error in ".concat(ei,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var E=Gr(T,l.data.get(o.dataId).values),_=Xr(i.shape,i.dtype),R=0;R<f;++R)for(var A=0;A<y;++A)for(var O=A*k-x.top,F=0;F<b;++F)for(var D=F*w-x.left,L=0;L<g;++L){for(var M=Number.MIN_SAFE_INTEGER,z=0,P=0,B=0;B<C;++B){var V=O+B*N;if(V>=0&&V<v)for(var W=0;W<S;++W){var U=D+W*I;if(U>=0&&U<m){var j=d[R][V][U][L]+p[B][W][L];j>M&&(M=j,z=B,P=W)}}}_[z][P][L]+=E[R][A][F][L]}return{dataId:l.write(Bs(_,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},g_={kernelName:$a,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,d=Gr(a.shape,l.data.get(a.dataId).values),p=Gr(i.shape,l.data.get(i.dataId).values),h=_d(a.shape,i.shape,s,u,"NHWC",c),f=h.batchSize,v=h.inHeight,m=h.inWidth,g=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,k=h.strideHeight,w=h.strideWidth,C=h.filterHeight,S=h.filterWidth,N=h.dilationHeight,I=h.dilationWidth,T=h.outShape;wr(o.rank===T.length,(function(){return"Error in ".concat($a,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var E=Gr(T,l.data.get(o.dataId).values),_=Xr(a.shape,a.dtype),R=0;R<f;++R)for(var A=0;A<y;++A)for(var O=A*k-x.top,F=0;F<b;++F)for(var D=F*w-x.left,L=0;L<g;++L){for(var M=Number.MIN_SAFE_INTEGER,z=O<0?0:O,P=D<0?0:D,B=0;B<C;++B){var V=O+B*N;if(V>=0&&V<v)for(var W=0;W<S;++W){var U=D+W*I;if(U>=0&&U<m){var j=d[R][V][U][L]+p[B][W][L];j>M&&(M=j,z=V,P=U)}}}_[R][z][P][L]+=E[R][A][F][L]}return{dataId:l.write(Bs(_,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},y_=yT((function(e,t){return e*t})),b_=VT((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),x_=BT(Yi,y_,b_),k_={kernelName:Yi,backendName:"cpu",kernelFunc:x_};function w_(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;sT(i,"sum");var u=(t="bool"===i.dtype?zT({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):fT({inputs:{x:i},backend:r})).shape.length,c=Or(o,t.shape),l=Vp(c,u),d=c,p=t;null!=l&&(p=aE({inputs:{x:t},backend:r,attrs:{perm:l}}),d=Up(d.length,u)),Bp("sum",d,p.shape.length);for(var h=H(zp(p.shape,d),2),f=h[0],v=h[1],m=FT(r,f,hu(p.dtype,"int32")),g=Nr(v),y=r.data.get(m.dataId).values,b=r.data.get(p.dataId).values,x=0;x<y.length;++x){for(var k=x*g,w=0,C=0;C<g;++C)w+=b[k+C];y[x]=w}if(s){var S=m;m=GT({inputs:{x:m},backend:r,attrs:{shape:Pp(m.shape,c)}}),r.disposeIntermediateTensorInfo(S)}return r.disposeIntermediateTensorInfo(t),null!=l&&r.disposeIntermediateTensorInfo(p),m}var C_={kernelName:zo,backendName:"cpu",kernelFunc:w_};var S_={kernelName:ni,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=vg(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;gg(i.length,s,r);for(var u=yg(o,s),c=u.path,l=u.steps,d=l.length,p=null,h=i.length,f=[],v=0;v<d;++v){var m,g=K(l[v]);try{for(g.s();!(m=g.n()).done;){var y=m.value,b=mg(h,s[y]),x=b.permutationIndices,k=b.expandDims,w=void 0;bg(x)?w=r[y]:(w=aE({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),f.push(w));for(var C=w.shape.slice(),S=0;S<k.length;++S)C.splice(k[S],0,1);Ir(w.shape,C)||(w=GT({inputs:{x:w},backend:n,attrs:{shape:C}}),f.push(w)),null===p?p=w:(p=x_({inputs:{a:w,b:p},backend:n}),f.push(p))}}catch(aH){g.e(aH)}finally{g.f()}v<d-1&&(c[v]>=0&&(p=w_({inputs:{x:p},backend:n,attrs:{axis:c[v]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(var N=0,I=f;N<I.length;N++){var T=I[N];T!==p&&n.disposeIntermediateTensorInfo(T)}return p}};var N_={kernelName:ai,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;sT([r,a],"eluGrad");for(var i=new Float32Array(Nr(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var c=o[u];i[u]=c>=1?s[u]:s[u]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},I_=yT((function(e,t){return e===t?1:0})),T_=BT(oi,I_,null,"bool"),E_={kernelName:oi,backendName:"cpu",kernelFunc:T_},__=lT(ii,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+.3275911*n);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-n*n))})),R_={kernelName:ii,backendName:"cpu",kernelFunc:__},A_=IT((function(e){return Math.exp(e)})),O_=dT(si,A_,"float32"),F_={kernelName:si,backendName:"cpu",kernelFunc:O_};function D_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(wr(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),GT({inputs:{x:a},backend:n,attrs:{shape:s}})}var L_={kernelName:ui,backendName:"cpu",kernelFunc:D_},M_=IT((function(e){return Math.expm1(e)})),z_=dT(ci,M_),P_={kernelName:ci,backendName:"cpu",kernelFunc:z_},B_=yT((function(e,t){return e/t})),V_=BT(ti,B_),W_={kernelName:ti,backendName:"cpu",kernelFunc:V_},U_=yT((function(e,t){return e-t})),j_=VT((function(e,t,n,r){return{real:e-n,imag:t-r}})),H_=BT(Jo,U_,j_),G_={kernelName:Jo,backendName:"cpu",kernelFunc:H_};function q_(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=Nr(c),d=Dr("float32",l),p=Dr("float32",l),h=0;h<a;h++){for(var f=RE({inputs:{x:s},backend:n,attrs:{begin:[h,0],size:[1,i]}}),v=RE({inputs:{x:u},backend:n,attrs:{begin:[h,0],size:[1,i]}}),m=AT({inputs:{real:f,imag:v},backend:n}),g=K_(m,t,n),y=sg(g.real,g.imag),b=0;b<i;b++){var x=ug(y,b);d[h*i+b]=x.real,p[h*i+b]=x.imag}n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m)}var k=n.makeTensorInfo(c,"float32",d),w=n.makeTensorInfo(c,"float32",p),C=AT({inputs:{real:k,imag:w},backend:n});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(w),C}function K_(e,t,n){var r=Nr(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((g=r)&g-1)){var s=X_(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(u,"float32",s.real),l=n.makeTensorInfo(u,"float32",s.imag),d=n.makeTensorInfo([],"float32",Ps(r,"float32")),p=fT({inputs:{x:d},backend:n}),h=W_.kernelFunc({inputs:{a:c,b:d},backend:n}),f=W_.kernelFunc({inputs:{a:l,b:p},backend:n}),v=n.data.get(h.dataId).values,m=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),{real:v,imag:m}}return s}var g,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=lg(a*s,t,n),c=ug(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),cg(r,i,o,a)}return r}(sg(i,o),r,t);return function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(y)}function X_(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=sg(e,t),o=n/2,s=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),u=s.real,c=s.imag,l=[u.length],d=a.makeTensorInfo(l,"float32",u),p=a.makeTensorInfo(l,"float32",c),h=AT({inputs:{real:d,imag:p},backend:a}),f=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),v=f.real,m=f.imag,g=[v.length],y=a.makeTensorInfo(g,"float32",v),b=a.makeTensorInfo(g,"float32",m),x=AT({inputs:{real:y,imag:b},backend:a}),k=X_(u,c,o,r,a),w=k.real,C=k.imag,S=[w.length],N=a.makeTensorInfo(S,"float32",w),I=a.makeTensorInfo(S,"float32",C),T=AT({inputs:{real:N,imag:I},backend:a}),E=X_(v,m,o,r,a),_=E.real,R=E.imag,A=[_.length],O=a.makeTensorInfo(A,"float32",_),F=a.makeTensorInfo(A,"float32",R),D=AT({inputs:{real:O,imag:F},backend:a}),L=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(n,r),M=[L.real.length],z=a.makeTensorInfo(M,"float32",L.real),P=a.makeTensorInfo(M,"float32",L.imag),B=AT({inputs:{real:z,imag:P},backend:a}),V=x_({inputs:{a:B,b:D},backend:a}),W=jT({inputs:{a:T,b:V},backend:a}),U=H_({inputs:{a:T,b:V},backend:a}),j=DT({inputs:{input:W},backend:a}),H=DT({inputs:{input:U},backend:a}),G=HE({inputs:{input:W},backend:a}),q=HE({inputs:{input:U},backend:a}),K=qE({inputs:[j,H],backend:a,attrs:{axis:0}}),X=qE({inputs:[G,q],backend:a,attrs:{axis:0}}),Z=a.data.get(K.dataId).values,Y=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),{real:Z,imag:Y}}var Z_={kernelName:li,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Nr(r.shape),i=r.shape[r.shape.length-1],o=GT({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=q_(o,!1,n),u=GT({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function Y_(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||Vr(a),o=Lr(i,Nr(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var Q_={kernelName:di,backendName:"cpu",kernelFunc:Y_};var J_={kernelName:pi,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=Dr(r.dtype,Nr(r.shape)),o=H(r.shape,4),s=o[0],u=o[1],c=o[2],l=o[3],d=a.data.get(r.dataId).values,p=0;p<s;p++)for(var h=p*c*u*l,f=0;f<u;f++)for(var v=f*(c*l),m=0;m<c;m++)for(var g=m*l,y=0;y<l;y++){var b=Math.round(c-m-1),x=h+v+g+y,k=d[x];if(b>=0&&b<c)k=d[h+v+b*l+y];i[x]=k}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},$_=IT((function(e){return Math.floor(e)})),eR=dT(hi,$_),tR={kernelName:hi,backendName:"cpu",kernelFunc:eR},nR=yT((function(e,t){return Math.floor(e/t)})),rR=BT(fi,nR,null,"int32"),aR={kernelName:fi,backendName:"cpu",kernelFunc:rR};var iR={kernelName:hs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,d=r.dilations,p=r.dimRoundingMode,h=r.activation,f=r.leakyreluAlpha,v=XE({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:p}});if(o){var m=v;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var g=GT({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=jT({inputs:{a:v,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else v=jT({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(m)}if(h){var y=v;if("NCHW"===l&&"prelu"===h&&1===s.shape.length&&1!==s.shape[0]){var b=GT({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});v=RT(n,v,h,b,f),n.disposeIntermediateTensorInfo(b)}else v=RT(n,v,h,s,f);n.disposeIntermediateTensorInfo(y)}return v}};var oR={kernelName:fs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,d=r.dilations,p=r.dimRoundingMode,h=r.activation,f=r.leakyreluAlpha,v=l_({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:p}});if(o){var m=v;v=jT({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(h){var g=v;v=RT(n,v,h,s,f),n.disposeIntermediateTensorInfo(g)}return v}};function sR(e,t,n,r,a,i,o,s,u){for(var c=Kc([r,i],n),l=0;l<r;l++){for(var d=[],p=0,h=0;h<a;h++){var f=e[l*a+h];p+=f*o[h],d.push(f)}if(p<0||p>=u/i)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(s));for(var v=0;v<i;v++)c.values[l*i+v]=t.get.apply(t,R(t.indexToLoc(p*i+v)))}return c}var uR={kernelName:gi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=Nr(r.shape),o=a.shape,s=o[o.length-1],u=H(Jm(r,a),4),c=u[0],l=u[1],d=u[2],p=u[3];if(0===l)return n.makeTensorInfo(c,r.dtype,[]);var h=sR(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,l,s,d,p,r.shape,i);return n.makeTensorInfo(c,r.dtype,h.values)}};function cR(e,t,n){for(var r=Kc(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var lR={kernelName:mi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;sT([a,i],"gatherV2");for(var u=Or(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[u],d=function(){var e=c[p];wr(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},p=0;p<c.length;++p)d();var h=s;null==s&&(h=0);var f=Nr(i.shape),v=Ng(a,i,u,h),m=GT({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),g=GT({inputs:{x:i},backend:n,attrs:{shape:[v.batchSize,f/v.batchSize]}}),y=[v.batchSize,v.outerSize,f/v.batchSize,v.sliceSize],b=n.bufferSync(g),x=cR(n.bufferSync(m),b,y);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(v.outputShape,x.dtype,x.values)}},dR=yT((function(e,t){return e>t?1:0})),pR=BT(yi,dR,null,"bool"),hR={kernelName:yi,backendName:"cpu",kernelFunc:pR},fR=yT((function(e,t){return e>=t?1:0})),vR=BT(bi,fR,null,"bool"),mR={kernelName:bi,backendName:"cpu",kernelFunc:vR};var gR={kernelName:ki,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Nr(r.shape),i=r.shape[r.shape.length-1],o=GT({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=q_(o,!0,n),u=GT({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},yR=lT(Ci,(function(e){return Number.isFinite(e)?1:0}),"bool"),bR={kernelName:Ci,backendName:"cpu",kernelFunc:yR},xR=lT(Si,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),kR={kernelName:Si,backendName:"cpu",kernelFunc:xR},wR=lT(Ni,(function(e){return Number.isNaN(e)?1:0}),"bool"),CR={kernelName:Ni,backendName:"cpu",kernelFunc:wR},SR=yT((function(e,t){return e<t?1:0})),NR=BT(Ti,SR,null,"bool"),IR={kernelName:Ti,backendName:"cpu",kernelFunc:NR},TR=yT((function(e,t){return e<=t?1:0})),ER=BT(Ei,TR,null,"bool"),_R={kernelName:Ei,backendName:"cpu",kernelFunc:ER};function RR(e,t,n){var r=(t-e)/(n-1),a=Kr(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var AR={kernelName:_i,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=RR(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},OR=IT((function(e){return Math.log(e)})),FR=dT(Ri,OR),DR={kernelName:Ri,backendName:"cpu",kernelFunc:FR},LR=lT(Ai,(function(e){return Math.log1p(e)})),MR={kernelName:Ai,backendName:"cpu",kernelFunc:LR},zR=yT((function(e,t){return e&&t})),PR=BT(Oi,zR,null,"bool"),BR={kernelName:Oi,backendName:"cpu",kernelFunc:PR},VR=lT(Fi,(function(e){return e?0:1}),"bool"),WR={kernelName:Fi,backendName:"cpu",kernelFunc:VR},UR=yT((function(e,t){return e||t})),jR=BT(Di,UR,null,"bool"),HR={kernelName:Di,backendName:"cpu",kernelFunc:jR};var GR={kernelName:Li,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;sT(a,"LRN");var c=a.shape[3],l=c-1,d=n.data.get(a.dataId).values,p=Nr(a.shape),h=new Float32Array(p);function f(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=d[n];a+=o*o}return a}for(var v=0;v<p;v++){var m=f(v),g=d[v]*Math.pow(o+s*m,-u);h[v]=g}return n.makeTensorInfo(a.shape,a.dtype,h)}};var qR={kernelName:Mi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta;sT(o,"LRNGrad");for(var d=Nr(o.shape),p=o.shape[3],h=n.data.get(o.dataId).values,f=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,m=new Float32Array(d),g=d,y=0;y<g;y++){for(var b=y%p,x=y-b+Math.max(0,b-s),k=y-b+Math.min(p,b+s+1),w=0,C=x;C<k;C++)w+=Math.pow(f[C],2);w=c*w+u;for(var S=x;S<k;S++){var N=-2*c*l*f[S]*v[y]/w;y===S&&(N+=Math.pow(w,-l)),N*=h[y],m[S]+=N}}return n.makeTensorInfo(o.shape,a.dtype,m)}};function KR(e,t,n,r){for(var a=Dr(r,Nr(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];(Number.isNaN(c)||c>s)&&(s=c)}a[i]=s}return a}function XR(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,c=u.length,l=Or(i,u),d=l,p=Vp(d,c),h=s.data.get(a.dataId).values;if(null!=p){for(var f=new Array(c),v=0;v<f.length;v++)f[v]=u[p[v]];h=rE(h,u,a.dtype,p,f),d=Up(d.length,c),u=f}sT(a,"max"),Bp("max",d,c);var m=H(zp(u,d),2),g=m[0],y=KR(h,Nr(m[1]),g,a.dtype),b=s.write(y,g,a.dtype),x=g;o&&(x=Pp(g,l));return{dataId:b,shape:x,dtype:a.dtype}}var ZR={kernelName:zi,backendName:"cpu",kernelFunc:XR},YR=yT((function(e,t){return Math.max(e,t)})),QR=BT(Pi,YR),JR={kernelName:Pi,backendName:"cpu",kernelFunc:QR};var $R={kernelName:Bi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sT(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;wr(Vd(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Rd(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&Ir(l.inShape,l.outShape))c=fT({inputs:{x:a},backend:n});else{var d=n.data.get(a.dataId).values,p=jr(a.shape),h=kE(d,a.shape,a.dtype,p,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var eA={kernelName:Wi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;sT(a,"maxPool3d");var l=Ad(a.shape,i,o,1,s,u,c),d=CE(n.data.get(a.dataId).values,a.shape,a.dtype,jr(a.shape),l,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};var tA={kernelName:Ui,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;sT([a,i],"maxPool3DGrad");for(var l=Ad(i.shape,o,s,1,u,c),d=function(e,t){for(var n=Kc(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left,v=0;v<t.batchSize;++v)for(var m=0;m<t.inChannels;++m)for(var g=0;g<t.outDepth;++g){for(var y=g*r-p,b=y;b<0;)b+=o;for(var x=Math.min(t.inDepth,c+y),k=0;k<t.outHeight;++k){for(var w=k*a-h,C=w;C<0;)C+=s;for(var S=Math.min(t.inHeight,l+w),N=0;N<t.outWidth;++N){for(var I=N*i-f,T=I;T<0;)T+=u;for(var E=Math.min(t.inWidth,d+I),_=Number.NEGATIVE_INFINITY,R=-1,A=b;A<x;A+=o)for(var O=A-y,F=C;F<S;F+=s)for(var D=F-w,L=T;L<E;L+=u){var M=L-I,z=e.get(v,A,F,L,m);z>=_&&(_=z,R=O*l*d+D*l+M)}n.set(R,v,g,k,N,m)}}}return n}(n.bufferSync(i),l),p=l.strideDepth,h=l.strideHeight,f=l.strideWidth,v=l.dilationDepth,m=l.dilationHeight,g=l.dilationWidth,y=l.effectiveFilterDepth,b=l.effectiveFilterHeight,x=l.effectiveFilterWidth,k=y-1-l.padInfo.front,w=x-1-l.padInfo.left,C=b-1-l.padInfo.top,S=Kc(i.shape,"float32"),N=n.bufferSync(a),I=0;I<l.batchSize;++I)for(var T=0;T<l.inChannels;++T)for(var E=0;E<l.inDepth;++E)for(var _=0;_<l.inHeight;++_)for(var R=0;R<l.inWidth;++R){for(var A=E-k,O=_-C,F=R-w,D=0,L=0;L<y;L+=v){var M=(A+L)/p;if(!(M<0||M>=l.outDepth||Math.floor(M)!==M))for(var z=0;z<b;z+=m){var P=(O+z)/h;if(!(P<0||P>=l.outHeight||Math.floor(P)!==P))for(var B=0;B<x;B+=g){var V=(F+B)/f;if(!(V<0||V>=l.outWidth||Math.floor(V)!==V)){var W=y*b*x-1-d.get(I,M,P,V,T)===L*b*x+z*x+B?1:0;if(0!==W)D+=N.get(I,M,P,V,T)*W}}}}S.set(D,I,E,_,R,T)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var nA={kernelName:Vi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sT([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,d=Rd(o.shape,s,u,1,c,l),p=n.data.get(o.dataId).values,h=Kc(d.outShape,o.dtype,wE(p,o.shape,o.dtype,d).values),f=d.strideHeight,v=d.strideWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.effectiveFilterHeight,b=d.effectiveFilterWidth,x=b-1-d.padInfo.left,k=y-1-d.padInfo.top,w=Kc(o.shape,"float32"),C=n.data.get(a.dataId).values,S=Kc(a.shape,"float32",C),N=0;N<d.batchSize;++N)for(var I=0;I<d.inChannels;++I)for(var T=0;T<d.inHeight;++T)for(var E=0;E<d.inWidth;++E){for(var _=T-k,R=E-x,A=0,O=0;O<y;O+=m){var F=(_+O)/f;if(!(F<0||F>=d.outHeight||Math.floor(F)!==F))for(var D=0;D<b;D+=g){var L=(R+D)/v;if(!(L<0||L>=d.outWidth||Math.floor(L)!==L)){var M=y*b-1-h.get(N,F,L,I)===O*b+D?1:0;if(0!==M)A+=S.get(N,F,L,I)*M}}}w.set(A,N,T,E,I)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var rA={kernelName:ji,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;sT(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,d=Rd(a.shape,i,o,[1,1],s),p=function(e,t,n,r,a){var i=kE(e,0,n,jr(t),a,"max"),o=wE(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,u,d),h=H(p,2),f=h[0],v=h[1],m=c.write(f,d.outShape,a.dtype),g=c.write(v,d.outShape,a.dtype);return[{dataId:m,shape:d.outShape,dtype:a.dtype},{dataId:g,shape:d.outShape,dtype:"int32"}]}};var aA={kernelName:Hi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=Or(i,a.shape),u=Nr(zp(a.shape,s)[1]),c=[],l=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(l);var d=zT({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(d);var p=V_({inputs:{a:d,b:l},backend:n});c.push(p);var h=w_({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),h}};var iA={kernelName:Gi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;sT(a,"min");var s=Or(i,a.shape),u=s,c=Vp(u,a.shape.length),l=a;null!=c&&(l=aE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Up(u.length,a.shape.length)),Bp("min",u,l.shape.length);for(var d=H(zp(l.shape,u),2),p=d[0],h=Nr(d[1]),f=Kr(Nr(p),l.dtype),v=n.data.get(l.dataId).values,m=0;m<f.length;++m){for(var g=m*h,y=v[g],b=0;b<h;++b){var x=v[g+b];(Number.isNaN(x)||x<y)&&(y=x)}f[m]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(p,l.dtype,f);if(o){var w=GT({inputs:{x:k},backend:n,attrs:{shape:Pp(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}},oA=yT((function(e,t){return Math.min(e,t)})),sA=BT(qi,oA),uA={kernelName:qi,backendName:"cpu",kernelFunc:sA};var cA={kernelName:Ki,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;sT(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,h=jr(a.shape),f=Nr(s),v=s.length,m=jr(s),g=Dr(a.dtype,f),y=0;y<f;y++){for(var b=Qr(y,v,m),x=0;x<v;x++)b[x]<u[x]?b[x]=2*u[x]-b[x]-l:b[x]>=c[x]&&(b[x]=2*(c[x]-1)-b[x]+l);b=b.map((function(e,t){return e-u[t]}));var k=Yr(b,p,h);g[y]=d[k]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},lA=yT((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),dA=BT(Xi,lA),pA={kernelName:Xi,backendName:"cpu",kernelFunc:dA};function hA(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));var u=Or([s],a.shape),c=XR({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=Pp(c.shape,u),d=GT({inputs:{x:c},backend:n,attrs:{shape:l}}),p=H_({inputs:{a:a,b:d},backend:n}),h=O_({inputs:{x:p},backend:n}),f=w_({inputs:{x:h},backend:n,attrs:{axis:u,keepDims:!1}}),v=GT({inputs:{x:f},backend:n,attrs:{shape:l}}),m=V_({inputs:{a:h,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),m}var fA={kernelName:Vo,backendName:"cpu",kernelFunc:hA};var vA={kernelName:Zi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;sT(a,"multinomial");for(var u=s?a:hA({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],d=n.data.get(u.dataId).values,p=[c,i],h=Kr(Nr(p),"int32"),f=0;f<c;++f){var v=f*l,m=new Float32Array(l-1);m[0]=d[v];for(var g=1;g<m.length;++g)m[g]=m[g-1]+d[v+g];for(var y=rf.alea(o.toString()),b=f*i,x=0;x<i;++x){var k=y();h[b+x]=m.length;for(var w=0;w<m.length;w++)if(k<m[w]){h[b+x]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(p,"int32",h)}};function mA(e,t,n){var r=Ps(-1,n);return y_([],t,r,e,n)}var gA={kernelName:Qi,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;sT(r,"neg");var a=H(mA(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},yA=Hv;var bA={kernelName:$i,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;sT(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,d=yA(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},xA=Gv;var kA={kernelName:eo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;sT(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=xA(l,d,o,s,u,c),h=p.selectedIndices,f=p.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},wA=qv;var CA={kernelName:to,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;sT(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=wA(l,d,o,s,u,c),h=p.selectedIndices,f=p.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([f.length],"float32",new Float32Array(f))]}},SA=yT((function(e,t){return e!==t?1:0})),NA=BT(Ji,SA,null,"bool"),IA={kernelName:Ji,backendName:"cpu",kernelFunc:NA};var TA={kernelName:ro,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue;sT(a,"oneHot");var c=Nr(a.shape),l=new Float32Array(c*o);l.fill(u);for(var d=n.data.get(a.dataId).values,p=0;p<c;++p)d[p]>=0&&d[p]<o&&(l[p*o+d[p]]=s);return n.makeTensorInfo([].concat(R(a.shape),[o]),i,l)}};function EA(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=DT({inputs:{input:r},backend:n}),i=EA({inputs:{x:a},backend:n}),o=HE({inputs:{input:r},backend:n}),s=EA({inputs:{x:o},backend:n}),u=AT({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Y_({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var _A={kernelName:us,backendName:"cpu",kernelFunc:EA};var RA={kernelName:no,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=DT({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=HE({inputs:{input:a},backend:r}),u=EA({inputs:{x:s},backend:r}),c=AT({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Y_({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function AA(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return D_({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Cr(a,e.shape,"All tensors passed to stack must have matching shapes"),wr(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=qE({inputs:t.map((function(e){var t=D_({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}var OA={kernelName:ao,backendName:"cpu",kernelFunc:AA};var FA={kernelName:io,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;sT(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=Nr(a.shape),d=a.shape.length,p=jr(a.shape),h=Nr(s),f=s.length,v=jr(s),m=Dr(a.dtype,h);0!==o&&m.fill(o);for(var g=0;g<l;g++){m[Yr(Qr(g,d,p).map((function(e,t){return e+u[t]})),f,v)]=c[g]}return{dataId:n.write(m,s,a.dtype),shape:s,dtype:a.dtype}}},DA=yT((function(e,t){return Math.pow(e,t)})),LA=BT(oo,DA),MA={kernelName:oo,backendName:"cpu",kernelFunc:LA};function zA(e,t,n,r){for(var a=H(zp(e,r),2),i=a[0],o=a[1],s=hu(t,"int32"),u=Kr(Nr(i),s),c=Nr(o),l=0;l<u.length;++l){for(var d=l*c,p=1,h=0;h<c;++h)p*=n[d+h];u[l]=p}return{outVals:u,outShape:i,outDtype:s}}var PA={kernelName:uo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;sT(a,"prod");var s=a.shape.length,u=Or(i,a.shape),c=Vp(u,s),l=u,d=a,p=[];null!=c&&(d=aE({inputs:{x:a},backend:n,attrs:{perm:c}}),p.push(d),l=Up(l.length,s));var h=n.data.get(d.dataId).values,f=zA(d.shape,d.dtype,h,l),v=f.outVals,m=f.outShape,g=f.outDtype,y=m;return o&&(y=Pp(m,u)),p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,v)}};function BA(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<t.length-1;++c){u*=t[c];for(var l=t[c+1],d=1;d<u+1;++d)s[c].push(d*l)}for(var p=0;p<e.length;++p){for(var h=e[p],f=e[p]+1,v=0;v<n.length;++v){var m=n[v],g=v+t.length-1;if(g>=0)for(var y=s[g],b=y[y.length-1]-m[h],x=h;x<f;++x)s[g].push(m[x+1]+b);h=m[h],f=m[f]}f!==h&&(a.push([h,f]),i+=f-h)}return{outSplits:s,valueSlices:a,numValues:i}}function VA(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function WA(e,t,n,r,a){var i=t.slice();i[0]=a;var o=Lr(n,Nr(i)),s=e.length;return function(e,t,n,r,a,i){var o,s=VA(t,2)[1],u=VA(i,2)[1],c=0,l=K(n);try{for(l.s();!(o=l.n()).done;)for(var d=o.value,p=d[0];p<d[1];++p){for(var h=0;h<r;++h)a[c*u+h]=e[p*s+h];++c}}catch(aH){l.e(aH)}finally{l.f()}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}function UA(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=Qr(r,t.length,jr(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var u=BA(i,o,e,r[0]),c=u.outSplits,l=u.valueSlices,d=u.numValues,p=function(e){for(var t=[],n=function(){var n=Lr("int32",e[r].length);t.push(n),e[r].forEach((function(e,t){return n[t]=e}))},r=0;r<e.length;++r)n();return t}(c),h=WA(n,r,a,l,d);return[p,h[0],h[1]]}var jA={kernelName:co,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=(r.outputRaggedRank,a.map((function(e){return n.data.get(e.dataId).values}))),u=a.map((function(e){return e.shape})),c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,d=H(UA(s,u,c,i.shape,i.dtype,l,o.shape),3),p=d[0],h=d[1],f=d[2],v=p.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),m=n.makeTensorInfo(f,i.dtype,h);return v.concat([m])}},HA=2147483647;function GA(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var s=0===t.length,u=0===a.length,c=0===o.length,l=[];s||l.push(t[0]),u||l.push(a[0]),c||l.push(o[0]);for(var d=1;d<l.length;++d)if(l[d]!==l[d-1])throw new Error("starts, limits, and deltas must have the same shape");var p=0===l.length?1:l[0],h=Lr("int32",p+1);h[0]=0;for(var f=0;f<p;++f){var v=s?e[0]:e[f],m=u?r[0]:r[f],g=c?i[0]:i[f];if(0===g)throw new Error("Requires delta != 0");var y=void 0;if(g>0&&m<v||g<0&&m>v)y=0;else if((y=Math.ceil(Math.abs((m-v)/g)))>HA)throw new Error("Requires ((limit - start) / delta) <= ".concat(HA));h[f+1]=h[f]+y}for(var b=Lr(n,h[p]),x=0,k=0;k<p;++k)for(var w=h[k+1]-h[k],C=s?e[0]:e[k],S=c?i[0]:i[k],N=0;N<w;++N)b[x++]=C,C+=S;return[h,b]}var qA={kernelName:lo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=H(GA(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),l=c[0],d=c[1];return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([d.length],r.dtype,d)]}},KA=_m,XA=function(){function e(t,n,r,a,i,o,s,u,c,l){var d;A(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=function(e){var t,n={FIRST_DIM_SIZE:_m.FIRST_DIM_SIZE,VALUE_ROWIDS:_m.VALUE_ROWIDS,ROW_LENGTHS:_m.ROW_LENGTHS,ROW_SPLITS:_m.ROW_SPLITS,ROW_LIMITS:_m.ROW_LIMITS,ROW_STARTS:_m.ROW_STARTS},r=[],a=K(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(aH){a.e(aH)}finally{a.f()}return r}(l),this.raggedRank=0===(d=this.rowPartitionTypes).length?0:d[0]===_m.FIRST_DIM_SIZE?d.length-1:d.length}return L(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===KA.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===KA.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case KA.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case KA.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(KA[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return YA(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape;!function(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}(this.defaultValueShape,t);var n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=function(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}(this.raggedRank,n,t),a=r;a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var s=r;s<e;++s)a.push(-1);return wr(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var s=e[o+1]-e[o],u=Math.min(r,s),c=t[o];-1===c&&(u=0);for(var l=0;l<u;++l)i.push(c),c+=n;for(var d=0;d<s-u;++d)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));var u=t[s];i.push(u);for(var c=1;c<a;++c){var l=e[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));u=t[l]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case KA.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case KA.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(KA[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case KA.FIRST_DIM_SIZE:return e[0];case KA.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case KA.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(KA[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=YA(t,!1),i=Lr(this.valuesDType,Nr(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),s=1;s<=this.raggedRank;++s){o=this.calculateOutputIndex(s-1,o,n[s],t[s])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice(),s=Nr(o=o.slice(e+1)),u=t.length,c=this.defaultValue;if(c.length!==s&&1!==c.length){var l=this.defaultValueShape;$c((function(){var e=Hd(c,l),t=op(e,o);c=t.dataSync()}))}for(var d=0,p=0,h=0,f=0;f<=u;++f){var v=f<u?t[f]:-1;if(v!==h){if(p<h){var m=a.subarray(d*s);ZA(i.subarray(p*s),m,(h-p)*s)}if(f>=u){var g=n.length;v=Math.floor(g/s)}if(v>h)if(1===this.defaultValue.length)i.subarray(h*s,v*s).fill(this.defaultValue[0]),h=v;else for(;v>h;){ZA(i.slice(h*s),c,s),++h}v<0?(d=f+1,p=h):(d=f,h=(p=h)+1)}else++h}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function ZA(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function YA(e,t){var n,r=[],a=K(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(aH){a.e(aH)}finally{a.f()}return r}function QA(e,t,n,r,a,i,o,s,u,c){return new XA(e,t,n,r,a,i,o,s,u,c).compute()}var JA={kernelName:po,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,p=s.map((function(e){return n.data.get(e.dataId).values})),h=s.map((function(e){return e.shape})),f=H(QA(c,a.shape,l,i.shape,i.dtype,d,o.shape,p,h,u),2),v=f[0],m=f[1];return n.makeTensorInfo(v,i.dtype,m)}};function $A(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return Kr(0,r);var a=Kr(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var eO={kernelName:ho,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=$A(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},tO=lT(vo,(function(e){return 1/e})),nO={kernelName:vo,backendName:"cpu",kernelFunc:tO};var rO={kernelName:xo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;sT(a,"resizeBilinear");for(var u=jr(a.shape),c=H(s,2),l=c[0],d=c[1],p=H(a.shape,4),h=p[0],f=p[1],v=p[2],m=p[3],g=n.data.get(a.dataId).values,y=new Float32Array(Nr([h,l,d,m])),b=[i&&l>1?f-1:f,i&&d>1?v-1:v],x=[i&&l>1?l-1:l,i&&d>1?d-1:d],k=0,w=b[0]/x[0],C=b[1]/x[1],S=0;S<h;S++)for(var N=0;N<l;N++){var I=void 0;I=o?w*(N+.5)-.5:w*N;for(var T=Math.max(0,Math.floor(I)),E=I-T,_=Math.min(f-1,Math.ceil(I)),R=S*u[0]+T*u[1],A=S*u[0]+_*u[1],O=0;O<d;O++){var F=void 0;F=o?C*(O+.5)-.5:C*O;for(var D=Math.max(0,Math.floor(F)),L=F-D,M=Math.min(v-1,Math.ceil(F)),z=R+D*u[2],P=A+D*u[2],B=R+M*u[2],V=A+M*u[2],W=0;W<m;W++){var U=g[z+W],j=g[P+W],G=U+(g[B+W]-U)*L,q=G+(j+(g[V+W]-j)*L-G)*E;y[k++]=q}}}return n.makeTensorInfo([h,l,d,m],"float32",y)}};var aO={kernelName:ko,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;sT([i,a],"resizeBilinearGrad");for(var s=jr(a.shape),u=H(a.shape,4),c=u[0],l=u[1],d=u[2],p=u[3],h=H(i.shape,3),f=h[1],v=h[2],m=new Float32Array(c*l*d*p),g=[o&&f>1?l-1:l,o&&v>1?d-1:d],y=[o&&f>1?f-1:f,o&&v>1?v-1:v],b=g[0]/y[0],x=g[1]/y[1],k=n.data.get(i.dataId).values,w=0,C=0;C<c;C++)for(var S=C*s[0],N=0;N<f;N++)for(var I=N*b,T=Math.floor(I),E=Math.min(Math.ceil(I),l-1),_=S+T*s[1],R=S+E*s[1],A=I-T,O=1-A,F=0;F<v;F++)for(var D=F*x,L=Math.floor(D),M=Math.min(Math.ceil(D),d-1),z=D-L,P=1-z,B=_+L*s[2],V=_+M*s[2],W=R+L*s[2],U=R+M*s[2],j=O*P,G=O*z,q=A*P,K=A*z,X=0;X<p;X++){var Z=k[w++];m[B+X]+=Z*j,m[V+X]+=Z*G,m[W+X]+=Z*q,m[U+X]+=Z*K}return n.makeTensorInfo([c,d,l,p],"float32",m)}};var iO={kernelName:yo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;sT(a,"resizeNearestNeighbor");for(var u=jr(a.shape),c=H(s,2),l=c[0],d=c[1],p=H(a.shape,4),h=p[0],f=p[1],v=p[2],m=p[3],g=n.data.get(a.dataId).values,y=new Float32Array(h*l*d*m),b=[i&&l>1?f-1:f,i&&d>1?v-1:v],x=[i&&l>1?l-1:l,i&&d>1?d-1:d],k=b[0]/x[0],w=b[1]/x[1],C=0,S=0;S<h;S++)for(var N=S*u[0],I=0;I<l;I++){var T=o?k*(I+.5):k*I,E=Math.min(f-1,i?Math.round(T):Math.floor(T));o&&(E=Math.max(0,E));for(var _=N+E*u[1],R=0;R<d;R++){var A=o?w*(R+.5):w*R,O=Math.min(v-1,i?Math.round(A):Math.floor(A));o&&(O=Math.max(0,O));for(var F=_+O*u[2],D=0;D<m;D++){var L=g[F+D];y[C++]=L}}}return n.makeTensorInfo([h,l,d,m],a.dtype,y)}};var oO={kernelName:bo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;sT([i,a],"resizeNearestNeighborGrad");for(var s=jr(a.shape),u=jr(i.shape),c=H(a.shape,4),l=c[0],d=c[1],p=c[2],h=c[3],f=H(i.shape,3),v=f[1],m=f[2],g=new Float32Array(l*d*p*h),y=n.data.get(i.dataId).values,b=[o&&v>1?d-1:d,o&&m>1?p-1:p],x=[o&&v>1?v-1:v,o&&m>1?m-1:m],k=b[0]/x[0],w=b[1]/x[1],C=1/k,S=1/w,N=2*Math.ceil(C)+2,I=2*Math.ceil(S)+2,T=0;T<l;T++)for(var E=T*s[0],_=0;_<d;_++)for(var R=E+_*s[1],A=Math.floor(_*C),O=Math.floor(A-N/2),F=0;F<p;F++)for(var D=R+F*s[2],L=Math.floor(F*S),M=Math.floor(L-I/2),z=0;z<h;z++){for(var P=0,B=0;B<N;B++){var V=B+O;if(!(V<0||V>=v)){var W=E+V*u[1],U=V*k;if(_===Math.min(d-1,o?Math.round(U):Math.floor(U)))for(var j=0;j<I;j++){var G=j+M;if(!(G<0||G>=m)){var q=W+G*u[2],K=G*w;F===Math.min(p-1,o?Math.round(K):Math.floor(K))&&(P+=y[q+z])}}}}g[D+z]=P}return n.makeTensorInfo(a.shape,a.dtype,g)}};var sO={kernelName:Co,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;sT(a,"reverse");var o=a.shape.length,s=Or(i,a.shape);if(0===o)return fT({inputs:{x:a},backend:n});for(var u=new tu(a.shape,a.dtype),c=n.bufferSync(a),l=function(){var e=u.indexToLoc(d),t=e.slice();s.forEach((function(e){return t[e]=a.shape[e]-1-t[e]})),u.set.apply(u,[c.get.apply(c,R(t))].concat(R(e)))},d=0;d<u.size;d++)l();return n.makeTensorInfo(u.shape,u.dtype,u.values)}},uO={kernelName:ds,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=Dr(a.dtype,Nr(a.shape)),l=H(a.shape,4),d=l[0],p=l[1],h=l[2],f=l[3],v=H(qm(s,p,h),2),m=v[0],g=v[1],y=Math.sin(i),b=Math.cos(i),x=u.data.get(a.dataId).values,k=0;k<d;k++)for(var w=k*h*p*f,C=0;C<p;C++)for(var S=C*(h*f),N=0;N<h;N++)for(var I=N*f,T=0;T<f;T++){var E=[d,C,N,T],_=E[2],R=E[1],A=(_-m)*b-(R-g)*y,O=(_-m)*y+(R-g)*b;A=Math.round(A+m),O=Math.round(O+g);var F=o;if("number"!==typeof o&&(F=3===T?255:o[T]),A>=0&&A<h&&O>=0&&O<p)F=x[w+O*(h*f)+A*f+T];c[w+S+I+T]=F}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},cO=lT(So,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),lO={kernelName:So,backendName:"cpu",kernelFunc:cO},dO=IT((function(e){return 1/Math.sqrt(e)})),pO=dT(No,dO),hO={kernelName:No,backendName:"cpu",kernelFunc:pO};function fO(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],d=e.values,p=t.values;if(0===r)return Kc(n,t.dtype);var h=Kc(l,t.dtype);"string"===typeof u||"number"===typeof u?h.values.fill(u):"boolean"===typeof u&&h.values.fill(+u);for(var f=0;f<i;f++){for(var v=[],m=0,g=0;g<o;g++){var y=d[f*o+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?h.values[m*a+b]+=p[f*a+b]:h.values[m*a+b]=0===t.rank?p[0]:p[f*a+b]}return h}var vO={kernelName:Io,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=hv(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,d=s.strides,p=s.outputSize,h=fO(n.bufferSync(a),n.bufferSync(i),o,p,l,c,u,d,0,!0);return n.makeTensorInfo(o,h.dtype,h.values)}};function mO(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}function gO(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}var yO={kernelName:To,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=function(e,t,n,r,a,i){for(var o=Lr("int32",n*a),s=0;s<n;++s)for(var u=e.slice(s*r,(s+1)*r),c=s*a,l=0;l<a;++l)o[c+l]="left"===i?mO(u,t[l+c]):gO(u,t[l+c]);return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};var bO={kernelName:Eo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;sT([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=hu(a.dtype,i.dtype),d=Kr(Nr(a.shape),l),p=0,h=0===o||o>1||1===a.shape.length?1:Nr(a.shape.slice(1)),f=0;f<s.length;f++)for(var v=0;v<h;v++)1===s[f]?d[p++]=u[f]:d[p++]=c[f];return n.makeTensorInfo(a.shape,l,d)}},xO=lT(_o,(function(e){return e>=0?1.0507009873554805*e:1.7580993408473768*(Math.exp(e)-1)})),kO={kernelName:_o,backendName:"cpu",kernelFunc:xO},wO=lT(Fo,(function(e){return e<0?-1:e>0?1:0})),CO={kernelName:Fo,backendName:"cpu",kernelFunc:wO},SO=lT(Ao,(function(e){return Math.sin(e)})),NO={kernelName:Ao,backendName:"cpu",kernelFunc:SO},IO=lT(Oo,(function(e){return Math.sinh(e)})),TO={kernelName:Oo,backendName:"cpu",kernelFunc:IO},EO=Math.log(1.1920928955078125e-7)+2,_O=lT(Lo,(function(e){var t=e>-EO,n=e<EO,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),RO={kernelName:Lo,backendName:"cpu",kernelFunc:_O};var AO={kernelName:Po,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;sT([a],"spaceToBatchND");var s=Nr(i),u=[[0,0]];u.push.apply(u,R(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=FA.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),d=Km(l.shape,i,s,!1),p=Xm(d.length,i.length,!1),h=Zm(l.shape,i,s,!1),f=GT({inputs:{x:l},backend:n,attrs:{shape:d}}),v=aE({inputs:{x:f},backend:n,attrs:{perm:p}}),m=GT({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),m}};function OO(e,t,n,r,a,i,o){var s=t[0],u=i[0],c=new Array(u),l=new Array(s),d=t[1];if(0===u){if(0!==s)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s));return[Lr(n,0),[0,d],Lr(a,0),c,l]}for(var p,h=!0,f=0,v=new Array(u).fill(0),m=0;m<s;++m){var g=e[m*d];if(g<0)throw new Error((p=g,"indices(".concat(m,", 0) is invalid: ").concat(p," < 0")));if(g>=u)throw new Error(wg(m,g,u));++v[g],h=h&&g>=f,f=g}for(var y=!0,b=0;b<u;++b){var x=0===v[b];c[b]=x,y=y&&!x,v[b]=Math.max(v[b],1),b>0&&(v[b]+=v[b-1])}if(y&&h){for(var k=e,w=r,C=0;C<s;++C)l[C]=C;return[k,[s,d],w,c,l]}for(var S=v[u-1],N=Lr(n,S*d),I=Lr(a,S),T=new Array(u).fill(0),E=0;E<s;++E){var _=e[E*d],R=T[_],A=(0===_?0:v[_-1])+R;T[_]++;for(var O=0;O<d;++O)N[A*d+O]=e[E*d+O];I[A]=r[E],l[E]=A}for(var F=0;F<u;++F){if(0===T[F]){var D=0===F?0:v[F-1];N[D*d+0]=F;for(var L=1;L<d;++L)N[D*d+L]=0;I[D]=o}}return[N,[S,d],I,c,l]}var FO={kernelName:Wo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],d=H(OO(s,r.shape,r.dtype,u,a.dtype,c,l),5),p=d[0],h=d[1],f=d[2],v=d[3],m=d[4];return[n.makeTensorInfo(h,r.dtype,p),n.makeTensorInfo([h[0]],a.dtype,f),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function DO(e,t,n,r,a){for(var i,o,s=Nr(r),u=t[0],c=a.length,l=[],d=1,p=-1,h=0;h<c;++h){var f=a[h];if(-1===f){if(-1!==p)throw new Error((o=h,"only one output dimension may be -1, not both ".concat(p," and ").concat(o)));p=h,l.push(1)}else{if(f<0)throw new Error((i=f,"size ".concat(h," must be non-negative, not ").concat(i)));d*=f,l.push(f)}}if(-1!==p){if(d<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var v=Math.trunc(s/d);if(d*v!==s)throw new Error(function(e,t){var n=Nr(e),r=Nr(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}(r,l));l[p]=v}if(Nr(l)!==s)throw new Error(function(e,t){var n=Nr(e),r=Nr(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}(r,l));var m=r.length,g=[];if(m>0){g[m-1]=1;for(var y=m-2;y>=0;--y)g[y]=g[y+1]*r[y+1]}var b=[];if(c>0){b[c-1]=1;for(var x=c-2;x>=0;--x)b[x]=b[x+1]*l[x+1]}for(var k=Lr(n,u*c),w=0;w<u;++w){for(var C=0,S=0;S<m;++S)C+=e[w*m+S]*g[S];for(var N=0;N<c;++N)k[w*c+N]=Math.trunc(C/b[N]),C%=b[N]}return[k,[u,c],l]}var LO={kernelName:Uo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(i.dataId).values),c=H(DO(s,r.shape,r.dtype,o,u),3),l=c[0],d=c[1],p=c[2];return[n.makeTensorInfo(d,r.dtype,l),n.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}};function MO(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=r.length,u=[t[0],e.length/t[0]],c=u[1],l=s>0?a[s-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");var d=t.slice();d[0]=l;var p=Lr(n,d.reduce((function(e,t){return e*t}),1));if(0===s)return l>0&&p.fill(o),[p,d];if(l<=0)throw new Error("segment ids must be >= 0");for(var h=0,f=1,v=0,m=a[h];;){var g=0;if(f<s){if(m===(g=a[f])){++f;continue}if(m>=g)throw new Error("segment ids are not increasing")}if(m<0||m>=l)throw new Error(Cg(m,l));m>v&&p.fill(o,v*c,m*c);for(var y=h;y<f;++y){var b=r[y];if(b<0||b>=u[0])throw new Error(Sg(y,r[y],u[0]));for(var x=0;x<c;x++)p[m*c+x]+=e[b*c+x]}if(i)for(var k=0;k<c;k++)p[m*c+k]/=f-h;if(h=f,v=m+1,m=g,++f>s)break}return v<l&&p.fill(o,v*c,l*c),[p,d]}var zO={kernelName:jo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=H(MO(o,r.shape,r.dtype,s,u,!0),2),l=c[0],d=c[1];return n.makeTensorInfo(d,r.dtype,l)}};var PO={kernelName:Ho,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=H(MO(o,r.shape,r.dtype,s,u),2),l=c[0],d=c[1];return n.makeTensorInfo(d,r.dtype,l)}};var BO={kernelName:Go,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.sparseIndices,o=n.sparseValues,s=n.defaultValue,u=a.outputShape,c=hv(0,i,u),l=c.sliceRank,d=c.numUpdates,p=c.sliceSize,h=c.strides,f=c.outputSize,v=!1,m=r.bufferSync(i);switch(o.dtype){case"bool":t=fO(m,r.bufferSync(o),u,f,p,d,l,h,Boolean(r.data.get(s.dataId).values[0]),v);break;case"float32":t=fO(m,r.bufferSync(o),u,f,p,d,l,h,r.data.get(s.dataId).values[0],v);break;case"int32":t=fO(m,r.bufferSync(o),u,f,p,d,l,h,r.data.get(s.dataId).values[0],v);break;case"string":t=fO(m,r.bufferSync(o),u,f,p,d,l,h,Us(r.data.get(s.dataId).values[0]),v);break;default:throw new Error("Unsupported type ".concat(o.dtype))}return r.makeTensorInfo(u,t.dtype,t.values)}};var VO={kernelName:Bo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=Or(r.axis,a.shape)[0],s=kg(a,i,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return s.map((function(e){var t=R(c);t[o]=e;var r=RE({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},WO=IT((function(e){return Math.sqrt(e)})),UO=lT(Mo,(function(e){return Math.sqrt(e)})),jO={kernelName:Mo,backendName:"cpu",kernelFunc:UO},HO={kernelName:Ko,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;sT(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},GO=yT((function(e,t){var n=e-t;return n*n})),qO=BT(qo,GO),KO={kernelName:qo,backendName:"cpu",kernelFunc:qO},XO=lT(cs,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),ZO={kernelName:cs,backendName:"cpu",kernelFunc:XO};function YO(e,t,n,r){for(var a=Kc(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(R(o)))}return a}var QO={kernelName:Xo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,c=r.endMask,l=r.ellipsisMask,d=r.newAxisMask,p=r.shrinkAxisMask;sT(a,"stridedSlice");var h,f=vd(a.shape,i,o,s,u,c,l,d,p),v=f.finalShapeSparse,m=f.finalShape,g=f.isIdentity,y=f.sliceDim0,b=f.isSimpleSlice,x=f.begin,k=f.end,w=f.strides;if(g)h=GT({inputs:{x:a},backend:n,attrs:{shape:m}});else if(y||b){wr(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var C=dd(x,k,w),S=RE({inputs:{x:a},backend:n,attrs:{begin:x,size:C}});h=GT({inputs:{x:S},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(S)}else{var N=YO(v,n.bufferSync(a),w,x);h=n.makeTensorInfo(m,N.dtype,N.values)}return h}},JO=function(){function e(t,n,r,a,i,o){A(this,e),this.separator=Ws(t),this.nGramWidths=n,this.leftPad=Ws(r),this.rightPad=Ws(a),this.padWidth=i,this.preserveShort=o}return L(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,s=function(){var s=o.getPadWidth(i),c=Math.max(0,s-u),l=Math.max(0,s-(a-(u+1))),d=i-(c+l),p=t+(c>0?0:u-s),h=0;h+=c*o.leftPad.length;for(var f=0;f<d;++f)h+=e[p+f].length;h+=l*o.rightPad.length,h+=(c+l+d-1)*o.separator.length,n[r+u]=new Uint8Array(h);for(var v=n[r+u],m=0,g=function(e){return e.forEach((function(e){return v[m++]=e}))},y=0;y<c;++y)g(o.leftPad),g(o.separator);for(var b=0;b<d-1;++b)g(e[p+b]),g(o.separator);if(d>0){g(e[p+d-1]);for(var x=0;x<l;++x)g(o.separator),g(o.rightPad)}else{for(var k=0;k<l-1;++k)g(o.rightPad),g(o.separator);g(o.rightPad)}},u=0;u<a;++u)s()}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var s=t[o]>=i;if(!(s=s&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var u=a-1,c=Lr("int32",a);if(0===r||0===a){for(var l=new Array(r),d=0;d<=u;++d)c[d]=0;return[l,c]}c[0]=0;for(var p=function(){var e=t[h]-t[h-1],r=0;n.nGramWidths.forEach((function(t){r+=n.getNumNGrams(e,t)})),n.preserveShort&&e>0&&0===r&&(r=1),c[h]=c[h-1]+r},h=1;h<=u;++h)p();for(var f=new Array(c[u]),v=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var s=t[r+1]-t[r],u=n.getNumNGrams(s,o);n.createNGrams(e,a,f,i,u,o),i+=u})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var s=o+2*n.padWidth;n.createNGrams(e,a,f,i,1,s)}},m=0;m<u;++m)v(m);return[f,c]}}]),e}();function $O(e,t,n,r,a,i,o,s){return new JO(n,r,a,i,o,s).compute(e,t)}var eF={kernelName:Zo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,d=t.dataSplits,p=H($O(n.data.get(l.dataId).values,n.data.get(d.dataId).values,a,i,o,s,u,c),2),h=p[0],f=p[1];return[n.makeTensorInfo([h.length],"string",h),n.makeTensorInfo(d.shape,"int32",f)]}};function tF(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var s=t[0],u=e.indexOf(s);-1!==u;){var c=e.subarray(0,u);n&&0===c.length||r.push(c),u=(e=e.subarray(u+1)).indexOf(s)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}function nF(e,t,n){for(var r=e.length,a=[],i=0,o=0,s=new Array(r),u=0;u<r;++u){var c=a.length;tF(e[u],t,n,a);var l=a.length-c;s[u]=l,i+=l,o=Math.max(o,l)}for(var d=Lr("int32",2*i),p=new Array(i),h=[r,o],f=0,v=0;v<r;++v)for(var m=0;m<s[v];++m)d[2*f]=v,d[2*f+1]=m,p[f]=a[f],++f;return[d,p,h]}var rF={kernelName:Yo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=H(nF(n.data.get(a.dataId).values,n.data.get(i.dataId).values[0],r),3),s=o[0],u=o[1],c=o[2],l=u.length;return[n.makeTensorInfo([l,2],"int32",s),n.makeTensorInfo([l],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(c))]}};function aF(e,t){for(var n=Lr("int32",e.length),r=0;r<e.length;++r)n[r]=zs(e[r]).modulo(t).getLowBitsUnsigned();return n}var iF={kernelName:Qo,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=aF(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},oF=lT($o,(function(e){return Math.tan(e)})),sF={kernelName:$o,backendName:"cpu",kernelFunc:oF},uF=lT(es,(function(e){return Math.tanh(e)}));function cF(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=Kc(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}var lF={kernelName:ts,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;sT(a,"tile");var o=cF(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},dF=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function pF(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);pF(e,t,Math.max(n,Math.floor(t-i*s/a+u)),Math.min(r,Math.floor(t+(a-i)*s/a+u)))}var c=e[t],l=n,d=r;for(xr(e,n,t),dF(e[r],c)>0&&xr(e,n,r);l<d;){for(xr(e,l,d),l++,d--;dF(e[l],c)<0;)l+=1;for(;dF(e[d],c)>0;)d-=1}0===dF(e[n],c)?xr(e,n,d):xr(e,d+=1,r),d<=t&&(n=d+1),t<=d&&(r=d-1)}}function hF(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=Dr(n,o*r),c=Dr("int32",o*r),l=function(){var t=d*s,n=e.subarray(t,t+s),i=new Array(n.length);n.forEach((function(e,t){return i[t]={value:e,index:t}})),r<i.length&&(pF(i,r),i=i.slice(0,r)),a&&i.sort(dF);for(var o=d*r,l=u.subarray(o,o+r),p=c.subarray(o,o+r),h=0;h<r;h++)l[h]=i[h].value,p[h]=i[h].index},d=0;d<o;d++)l();var p=t.slice();return p[p.length-1]=r,[Kc(p,n,u),Kc(p,"int32",c)]}var fF={kernelName:ns,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted;sT(a,"topk");var s=H(hF(n.data.get(a.dataId).values,a.shape,a.dtype,i,o),2),u=s[0],c=s[1];return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};var vF={kernelName:rs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=t.transforms,o=n.interpolation,s=n.fillMode,u=n.fillValue,c=n.outputShape,l=H(a.shape,4),d=l[0],p=l[1],h=l[2],f=l[3],v=H(null!=c?c:[p,h],2),m=v[0],g=v[1],y=[d,m,g,f],b=jr(a.shape),x=b[0],k=b[1],w=b[2],C=jr(y),S=C[0],N=C[1],I=C[2],T=Dr(a.dtype,Nr(y));T.fill(u);for(var E=r.data.get(a.dataId).values,_=r.data.get(i.dataId).values,R=0;R<d;++R){for(var A=1===i.shape[0]?_:_.subarray(8*R,8*R+8),O=0;O<m;++O)for(var F=0;F<g;++F)for(var D=0;D<f;++D){var L=void 0,M=A[6]*F+A[7]*O+1;if(0!==M){var z=(A[0]*F+A[1]*O+A[2])/M,P=(A[3]*F+A[4]*O+A[5])/M,B=mF(z,h,s),V=mF(P,p,s);switch(o){case"nearest":L=yF(E,p,h,x,k,w,R,V,B,D,u);break;case"bilinear":L=bF(E,p,h,x,k,w,R,V,B,D,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}T[R*S+O*N+F*I+D]=L}}return r.makeTensorInfo(y,a.dtype,T)}return{dataId:r.write(T,y,a.dtype),shape:a.shape,dtype:a.dtype}}};function mF(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return yr(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return yr(0,n,t-1)}(e,t);case"nearest":return function(e,t){return yr(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function gF(e,t,n,r,a,i,o,s,u,c,l){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+c]:l}function yF(e,t,n,r,a,i,o,s,u,c,l){return gF(e,t,n,r,a,i,o,Math.round(s),Math.round(u),c,l)}function bF(e,t,n,r,a,i,o,s,u,c,l){var d=Math.floor(s),p=Math.floor(u),h=d+1,f=p+1;return(h-s)*((f-u)*gF(e,t,n,r,a,i,o,d,p,c,l)+(u-p)*gF(e,t,n,r,a,i,o,d,f,c,l))+(s-d)*((f-u)*gF(e,t,n,r,a,i,o,h,p,c,l)+(u-p)*gF(e,t,n,r,a,i,o,h,f,c,l))}function xF(e,t,n,r){for(var a=Or(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u={},c=new Int32Array(n[a]),l=new tu(i,r,e),d=[],p=1===i[0]&&1===i[2],h=0;h<n[a];h++){var f=void 0;if(p)f=e[h].toString();else{for(var v=[],m=0;m<i[0];m++)for(var g=0;g<i[2];g++)v.push(l.get(m,h,g));f=v.join(",")}if(void 0!==u[f])c[h]=u[f];else{var y=Object.keys(u).length;u[f]=y,c[h]=y,d.push(h)}}var b=i.slice();b[1]=Object.keys(u).length;var x=new tu(b,r);d.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)x.set(l.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=b[1],{outputValues:x.values,outputShape:k,indices:c}}var kF={kernelName:is,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;sT(i,"unique");var o=xF(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};var wF={kernelName:os,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var d=new Array(o).fill(0),p=a.shape.slice();p[i]=1;for(var h=new Array(s),f=0;f<h.length;f++){d[i]=f;var v=RE({inputs:{x:a},backend:n,attrs:{begin:d,size:p}});h[f]=GT({inputs:{x:v},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(v)}return h}};for(var CF={kernelName:ss,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;sT(a,"unsortedSegmentSum");for(var s=[],u=[],c=a.shape.length-i.shape.length,l=i,d=0;d<c;++d){var p=D_({inputs:{input:l},backend:n,attrs:{dim:d+1}});l=p,u.push(p)}for(var h=0;h<o;++h){var f=Ps(h,"int32"),v=n.makeTensorInfo([],"int32",f),m=T_({inputs:{a:v,b:l},backend:n}),g=zT({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),y=x_({inputs:{a:g,b:a},backend:n}),b=w_({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(v),u.push(m),u.push(g),u.push(y),u.push(b)}var x=AA({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},SF=0,NF=[ZT,QT,$T,tE,HT,nE,oE,sE,uE,cE,dE,hE,vE,yE,xE,SE,NE,IE,TE,XT,EE,OE,LE,ME,PT,BE,WE,OT,UE,KE,ZE,YE,QE,JE,$E,e_,n_,a_,i_,o_,s_,u_,c_,d_,p_,h_,f_,v_,m_,g_,S_,hT,N_,E_,R_,F_,L_,P_,Z_,Q_,J_,tR,aR,iR,oR,uR,lR,hR,mR,vT,gR,GE,bR,kR,CR,gT,IR,_R,AR,DR,MR,BR,WR,HR,GR,qR,ZR,JR,$R,eA,tA,nA,rA,aA,iA,uA,cA,pA,vA,k_,gA,bA,kA,CA,IA,TA,RA,OA,FA,MA,kT,PA,jA,qA,JA,eO,LT,W_,nO,CT,NT,qT,rO,aO,iO,oO,sO,uO,lO,hO,vO,yO,bO,kO,_T,CO,NO,TO,AE,fA,RO,AO,FO,LO,zO,PO,BO,VO,jO,HO,KO,ZO,QO,eF,rF,iF,G_,C_,sF,{kernelName:es,backendName:"cpu",kernelFunc:uF},lF,fF,vF,iE,kF,wF,CF,_A];SF<NF.length;SF++){ks(NF[SF])}var IF,TF,EF,_F={},RF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function AF(e,t){if(!(e in _F)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete _F[e]}),!1),na().getBool("SOFTWARE_WEBGL_ENABLED")&&(RF.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",RF)||n.getContext("experimental-webgl",RF);return n.getContext("webgl2",RF)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;_F[e]=n}var r=_F[e];return null==r||r.isContextLost()?(delete _F[e],AF(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),_F[e])}function OF(e,t){return[t,e]}function FF(e){var t=Nr(e);return Er(Math.ceil(t/4))}function DF(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function LF(e,t){var n,r,a,i,o,s,u,c,l,d,p=e;return 2===na().getNumber("WEBGL_VERSION")?(n=p.R32F,r=p.R16F,a=p.RGBA16F,i=p.RGBA32F,o=p.RED,u=4,c=1,l=p.HALF_FLOAT,d=p.FLOAT,s=p.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=p.RGBA,o=e.RGBA,u=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,s=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:s,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:d}}function MF(e,t){var n=t();return na().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(IF||(IF={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(TF||(TF={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(EF||(EF={}));var zF=5.96e-8,PF=65504;function BF(e){return!!(na().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||zF<Math.abs(e)&&Math.abs(e)<PF)}function VF(e,t){return QF(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var WF,UF,jF=/ERROR: [0-9]+:([0-9]+):/g;function HF(e,t){var n=jF.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return _r((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),d=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(_r(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}function GF(e,t){if(MF(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function qF(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(MF(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),MF(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),MF(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function KF(e,t,n,r){MF(e,(function(){return function(e,t,n){JF(e,n),MF(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),MF(e,(function(){return e.uniform1i(n,r)}))}function XF(e,t,n){MF(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),MF(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function ZF(e,t){MF(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),MF(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function YF(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function QF(e,t,n){var r=MF(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function JF(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function $F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Nr(e.slice(0,e.length-t))}function eD(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function tD(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[$F(e)].concat(R(eD(e)))),t}function nD(e){return e%2===0}function rD(e,t){if(Ir(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(nD(n)&&nD(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&nD(e[0])&&nD(t[0])}function aD(e,t){return null!=e.getExtension(t)}function iD(e){try{if(null!=AF(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function oD(e){if(0===e)return!1;var t=AF(e);if(1!==e){if(aD(t,"EXT_color_buffer_float"))return sD(t);var n="EXT_color_buffer_half_float";if(aD(t,n)){var r=t.getExtension(n);return function(e,t){var n=LF(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!aD(t,"OES_texture_float")&&(!!aD(t,"WEBGL_color_buffer_float")&&sD(t))}function sD(e){var t=LF(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function uD(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&wr("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var cD=na();function lD(){var e,t,n,r,a,i,o,s,u,c;return 2===na().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=na().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function dD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=jr(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function pD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=jr(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function hD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=function(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(e.map((function(e,t){return t})),t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(r[a]),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(r[a]):"index -= ".concat(e[a]," * ").concat(r[a]);return"".concat(i,"; ").concat(o,";")})).join("")}function fD(e){var t=jr(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}cD.registerFlag("HAS_WEBGL",(function(){return cD.getNumber("WEBGL_VERSION")>0})),cD.registerFlag("WEBGL_VERSION",(function(){return iD(2)?2:iD(1)?1:0})),cD.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),cD.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===cD.get("WEBGL_VERSION")})),cD.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),cD.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),cD.registerFlag("WEBGL_PACK",(function(){return cD.getBool("HAS_WEBGL")})),cD.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_CLIP",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_PACK_REDUCE",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_CONV_IM2COL",(function(){return cD.getBool("WEBGL_PACK")})),cD.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==WF){var t=AF(e);WF=t.getParameter(t.MAX_TEXTURE_SIZE)}return WF}(cD.getNumber("WEBGL_VERSION"))})),cD.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==UF){var t=AF(e);UF=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,UF)}(cD.getNumber("WEBGL_VERSION"))})),cD.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=cD.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=AF(e);return aD(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:aD(t,"EXT_disjoint_timer_query")?1:0}(e)})),cD.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return cD.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Iu()})),cD.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=AF(e);if(1===e){if(!aD(t,"OES_texture_float"))return!1}else if(!aD(t,"EXT_color_buffer_float"))return!1;return sD(t)}(cD.getNumber("WEBGL_VERSION"))})),cD.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!cD.getBool("WEBGL_FORCE_F16_TEXTURES")&&cD.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),cD.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return oD(cD.getNumber("WEBGL_VERSION"))})),cD.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=cD.getNumber("WEBGL_VERSION"))&&null!=AF(e).fenceSync;var e})),cD.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return cD.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),cD.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),cD.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return Iu()?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),cD.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),cD.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),cD.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),cD.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),cD.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),cD.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return cD.getBool("IS_TEST")})),cD.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),cD.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),cD.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),cD.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var vD="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",mD=Cl;function gD(e,t,n){var r=[];if(e.forEach((function(e){var t=Nr(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(TD(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?bD(e,r):yD(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=mD(e.shapeInfo.logicalShape,t.logicalShape),c=ID(s),l=s-o,d=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(d[e+l]," = 0;")})).join("\n");var p="";p=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+l])})).join(", ");var h="return outputValue;",f=1===Nr(e.shapeInfo.logicalShape),v=Nr(t.logicalShape),m=1===v;if(1!==o||f||m){if(f&&!m)h=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=o-2,y=o-1;u.indexOf(g)>-1&&u.indexOf(y)>-1?h="return vec4(outputValue.x);":u.indexOf(g)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(p,");\n      ").concat(h,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&Ir(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=ID(u),d=mD(e.shapeInfo.logicalShape,t.logicalShape),p=u-s,h=["x","y","z","w","u","v"];c=0===s?"":u<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords.".concat(h[e+p]," = 0;")})).join("\n");var f="";f=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+p])})).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),u=t.texShape,c=lD(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),d=function(e){var t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(xD,"\n    ").concat(kD,"\n    ").concat(wD,"\n  ");return t}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Ir(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,s="",u="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(Ir(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=pD(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=dD(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=pD(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=dD(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=dD(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=dD(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(d+=CD),[d,l,i,o,a,s,n.userCode].join("\n")}function yD(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=H(e.shapeInfo.texShape,2),i=a[0],o=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=SD(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=H(e.shapeInfo.texShape,2),c=u[0],l=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(ND(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=SD(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&Ir(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],s=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var u=Fr(n),c=u.newShape,l=u.keptDims,d=c;if(d.length<n.length){var p=ED(e,d),h=["row","col"];return"\n      ".concat(yD(p,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(_D(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(ND(e),"\n      }\n    ");var f=i[0],v=i[1],m=SD(r);if(1===v)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(f,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===f)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(v,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(m,";\n    vec2 uv = uvFromFlat(").concat(f,", ").concat(v,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],s=Fr(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var d=ED(e,l),p=["row","col","depth"];return"\n        ".concat(yD(d,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(_D(p,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(ND(e),"\n      }\n    ");var h=e.shapeInfo.texShape,f=h[0],v=h[1],m=e.shapeInfo.flatOffset;if(v===i&&null==m)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(v,".0, ").concat(f,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(v===o&&null==m)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(v,".0, ").concat(f,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var g=SD(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(v,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,u=Fr(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var d=ED(e,c),p=["row","col","depth","depth2"];return"\n      ".concat(yD(d,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(_D(p,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(ND(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,v=f[0],m=f[1],g="int stride2 = ".concat(r,"Shape[3];"),y="int stride1 = ".concat(r,"Shape[2] * stride2;"),b="int stride0 = ".concat(r,"Shape[1] * stride1;");if(m===s&&null==h)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(g,"\n        ").concat(y,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(m===i&&null==h)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var x=SD(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(g,"\n      ").concat(y,"\n      ").concat(b,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=Fr(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var d=ED(e,c),p=["row","col","depth","depth2","depth3"];return"\n      ".concat(yD(d),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(_D(p,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(ND(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,v=f[0],m=f[1];if(m===s&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=SD(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Fr(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=ED(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(yD(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(_D(u,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,d=t[3]*l,p=t[2]*d,h=t[1]*p;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(h,", ").concat(p,", ").concat(d,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(ND(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],g=v[1];if(g===h&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(p,", ").concat(d,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===c&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=SD(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(h," + col * ").concat(p," + depth * ").concat(d," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function bD(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=lD();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=lD();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=lD();if(null!=i&&Ir(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=[1,2],u=ED(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(bD(u,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(_D(c,s),");\n        }\n      ")}var l=lD();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var d=o[0],p=o[1],h=Math.ceil(n[2]/2),f=h*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(d,", ").concat(p,", ").concat(f,", ").concat(h,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=lD();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],d=Math.ceil(i[o-1]/2),p=d*Math.ceil(i[o-2]/2),h="int b, int row, int col",f="b * ".concat(p," + (row / 2) * ").concat(d," + (col / 2)"),v=2;v<o-1;v++)h="int b".concat(v,", ")+h,p*=i[o-v-1],f="b".concat(v," * ").concat(p," + ")+f;return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var xD="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",kD="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",wD="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",CD="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function SD(e){return"offset".concat(e)}function ND(e){var t=e.name,n=Nr(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function ID(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function TD(e,t,n){var r=Fr(t),a=r.newShape,i=r.keptDims,o=t.length,s=e&&3===o&&1===t[0],u=s?t.slice(1):a,c=!e&&o>1&&!Ir(t,n)&&a.length<o||s;return{useSqueezeShape:c,uniformShape:c?u:t,keptDims:i}}function ED(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function _D(e,t){return t.map((function(t){return e[t]})).join(", ")}function RD(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=gD(a,o,t),u=function(e,t){var n=QF(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(MF(e,(function(){return e.shaderSource(n,t)})),MF(e,(function(){return e.compileShader(n)})),na().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw HF(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(u);return na().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},AD(e,t,c))}function AD(e,t,n){var r,a,i,o,s={},u={},c={},l=[],d=null;o=e.getUniformLocation(n,"NAN",!1),1===na().getNumber("WEBGL_VERSION")&&(d=e.getUniformLocation(n,"INFINITY",!1));for(var p=!1,h=0;h<t.variableNames.length;h++){var f=t.variableNames[h];s[f]=e.getUniformLocation(n,f,p),s["offset".concat(f)]=e.getUniformLocation(n,"offset".concat(f),p),t.enableShapeUniforms&&(u["".concat(f,"Shape")]=e.getUniformLocation(n,"".concat(f,"Shape"),p),c["".concat(f,"TexShape")]=e.getUniformLocation(n,"".concat(f,"TexShape"),p))}return t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",p),i=e.getUniformLocation(n,"outShapeStrides",p),a=e.getUniformLocation(n,"outTexShape",p)),t.customUniforms&&t.customUniforms.forEach((function(t,r){l[r]=e.getUniformLocation(n,t.name,p)})),{uniformLocations:s,customUniformLocations:l,infLoc:d,nanLoc:o,inShapesLocations:u,inTexShapesLocations:c,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function OD(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!Ir(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!Ir(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function FD(e){return na().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var DD=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=IF.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=lD();this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?pD(["r","c","d"],t):dD(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),LD=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=IF.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=lD();this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?pD(["r","c","d"],t):dD(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),MD=L((function e(t){A(this,e),this.variableNames=["A"],this.outTexUsage=TF.DOWNLOAD;var n=lD();this.outputShape=t,this.userCode="\n      ".concat(vD,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),zD=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=TF.DOWNLOAD;var n=lD();this.outputShape=t,this.userCode="\n      ".concat(vD,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),PD={R:0,G:1,B:2,A:3},BD=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";A(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=lD();this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",s=0;s<r.length;s++){var u=r[s];o+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(PD[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":fD(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),VD=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=lD();this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var s=0;s<=1;s++){var u=2*o+s;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":fD(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function WD(e){var t=lD();return function(e,t){var n=QF(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(MF(e,(function(){return e.shaderSource(n,t)})),MF(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function UD(e){return function(e,t){var n=QF(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return MF(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),MF(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function jD(e){return function(e,t){var n=QF(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return MF(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),MF(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function HD(e,t,n,r,a,i){!function(e,t){var n=na().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return QF(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return MF(e,(function(){return e.bindTexture(s,o)})),MF(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),MF(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),MF(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),MF(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===na().getNumber("WEBGL_VERSION")?MF(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})):MF(e,(function(){return e.texStorage2D(s,1,r,t,n)})),MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function GD(e){return e.internalFormatFloat}function qD(e){return e.internalFormatHalfFloat}function KD(e){return e.downloadTextureFormat}function XD(e){return e.internalFormatPackedFloat}function ZD(e){return e.internalFormatPackedHalfFloat}function YD(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=H(DF(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}var QD=function(){function e(t){A(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=na().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){_F[e]=t}(n,t)):this.gl=AF(n),t=this.gl,2===na().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return MF(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return MF(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return MF(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return MF(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return MF(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return MF(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return MF(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return MF(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===na().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=VF(this.gl,"OES_texture_float"),aD(this.gl,s))this.textureHalfFloatExtension=VF(this.gl,s);else if(na().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),aD(this.gl,o))this.colorBufferHalfFloatExtension=VF(this.gl,o);else if(na().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",aD(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!aD(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=UD(this.gl),this.indexBuffer=jD(this.gl),this.framebuffer=function(e){return QF(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=LF(this.gl,this.textureHalfFloatExtension)}return L(e,[{key:"debug",get:function(){return na().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;MF(t,(function(){return t.finish()})),MF(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),MF(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),MF(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),MF(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),MF(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=H(OF(t,n),2);return HD(e,a[0],a[1],GD(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=H(OF(t,n),2);return HD(e,a[0],a[1],qD(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=H(OF(t,n),2);return HD(e,a[0],a[1],KD(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===na().getNumber("WEBGL_VERSION")?MF(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):MF(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===na().getNumber("WEBGL_VERSION")?MF(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):MF(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),2===na().getNumber("WEBGL_VERSION")?MF(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)})):MF(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),MF(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=H(DF(t,n),2);return HD(e,a[0],a[1],ZD(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=H(DF(t,n),2);return HD(e,a[0],a[1],XD(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(ZF(this.gl,this.framebuffer),this.outputTexture=null),MF(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=H(OF(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return MF(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return YD(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();MF(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return MF(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),MF(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),MF(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(na().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return MF(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=WD(n));var r,a=function(e){return QF(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);return MF(n,(function(){return n.attachShader(a,t.vertexShader)})),MF(n,(function(){return n.attachShader(a,e)})),function(e,t){if(MF(e,(function(){return e.linkProgram(t)})),!na().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,a),r=Object.assign(a,{vao:this.createVertexArray()}),this.bindVertexArray(r.vao),MF(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),console.assert(function(e,t,n){return MF(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),qF(e,t,"clipSpacePos",n,3,20,0)&&qF(e,t,"uv",n,2,20,12)}(n,r,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&GF(n,r),this.setProgram(r),r}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(MF(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&(this.bindVertexArray(this.program.vao),this.debug&&GF(this.gl,this.program)),MF(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return QF(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),MF(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),KF(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=H(DF(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&GF(this.gl,this.program),YF(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}MF(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),MF(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=VF(this.gl,2===na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=mt(ft().mark((function e(t){var n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rr((function(){return n.disposed||n.isQueryAvailable(t,na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in na().platform&&(r=na().platform.setTimeoutCustom.bind(na().platform)),Rr((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),XF(this.gl,e,this.framebuffer),this.debug&&YF(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(XF(this.gl,this.outputTexture,this.framebuffer),this.debug&&YF(this.gl)):ZF(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;XF(r,e,this.framebuffer),this.debug&&YF(r),this.outputTexture=e,MF(r,(function(){return r.viewport(0,0,t,n)})),MF(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),MF(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var JD=WT,$D=FE,eL=DE,tL=MT,nL=zE,rL=jE,aL=I_,iL=A_,oL=M_,sL=$_,uL=sR,cL=cR,lL=dR,dL=fR,pL=SR,hL=TR,fL=RR,vL=OR,mL=KR,gL=YR,yL=oA,bL=y_,xL=mA,kL=SA,wL=zA,CL=UA,SL=GA,NL=QA,IL=$A,TL=dO,EL=fO,_L=TT,RL=YT,AL=_E,OL=OO,FL=DO,DL=MO,LL=WO,ML=YO,zL=$O,PL=nF,BL=aF,VL=U_,WL=cF,UL=hF,jL=rE,HL=xF;function GL(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function qL(e,t){return 1===t?[e]:GL(e,t)}var KL=function(){function e(t){if(A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=FD(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=qL("rc",this.rank),r=ID(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return L(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),XL=L((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?hD(["r","c","d"],"inputShape"):dD(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":fD(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var ZL=function(){function e(t){A(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return L(e,[{key:"acquireTexture",value:function(e,t,n){var r=QL(t,n),a=JL(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=YL(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===EF.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===EF.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===EF.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===EF.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===EF.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=QL(n,r),i=JL(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=YL(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=na().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function YL(e,t,n,r,a){var i,o=function(e,t){switch(e){case EF.PACKED_2X2_FLOAT32:return XD(t);case EF.PACKED_2X2_FLOAT16:return ZD(t);case EF.UNPACKED_FLOAT32:return GD(t);case EF.UNPACKED_FLOAT16:return qD(t);case EF.PACKED_4X1_UNSIGNED_BYTE:return KD(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=H(DF(e[0],e[1]),2);i=s[0]*s[1]}else{var u=H(OF(e[0],e[1]),2);i=u[0]*u[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*c}function QL(e,t){if(e===TF.UPLOAD)return EF.PACKED_2X2_FLOAT32;if(e===TF.RENDER||null==e)return function(e){return na().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?EF.PACKED_2X2_FLOAT32:EF.UNPACKED_FLOAT32:e?EF.PACKED_2X2_FLOAT16:EF.UNPACKED_FLOAT16}(t);if(e===TF.DOWNLOAD||e===TF.PIXELS)return EF.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function JL(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var $L=L((function e(t,n){A(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),eM="if (isnan(x)) return x;",tM="return x;",nM="return abs(x);";var rM="return (x >= 0.0) ? x : (exp(x) - 1.0);",aM=eM+"\n  return (x < 0.0) ? 0.0 : x;\n",iM=eM+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",oM="return x;",sM="return 1.0 / (1.0 + exp(-1.0 * x));",uM="return x;",cM="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",lM="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",dM="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",pM="return 1.0 / (1.0 + exp(-1.0 * x));",hM=L((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),fM=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length);var n=t.length,r=qL("rc",n),a=ID(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),vM=iv,mM={};var gM=na().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),yM=600;var bM=function(e){z(n,e);var t=W(n);function n(e){var r,a,i;if(A(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!na().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof QD)a=e;else{var o=AF(na().getNumber("WEBGL_VERSION"),e);a=new QD(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var s=AF(na().getNumber("WEBGL_VERSION"));a=new QD(s),r.binaryCache=((i=na().getNumber("WEBGL_VERSION"))in mM||(mM[i]={}),mM[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new ZL(r.gpgpu),r.numMBBeforeWarning=null==na().global.screen?1024:na().global.screen.height*na().global.screen.width*window.devicePixelRatio*yM/1024/1024,r.texData=new fr(V(r),Qc()),r}return L(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];var u=tD(t),c=new BD(u,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if((na().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||na().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:TF.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(na().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:TF.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new hM(o,oM):new $L(o,oM);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var d,p,h=null!=this.activeTimers;(h&&(d=Vs()),"complex64"===r)?p=sg(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):p=this.getValuesFromTexture(e);return h&&(this.downloadWaitMs+=Vs()-d),this.convertAndCacheOnCPU(e,p)}},{key:"read",value:function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o,s,u,c,l,d,p,h,f,v,m,g,y,b,x,k,w,C,S;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new hM(i,oM):new $L(i,oM),d=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),p=this.read(d.dataId),this.disposeIntermediateTensorInfo(d),e.abrupt("return",p);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!na().getBool("DEBUG")){e.next=16;break}if(na().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==na().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(h=null,"complex64"!==s&&na().get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(t),m=this.texData.get(f.dataId),h=(v=this.gpgpu).createBufferFromTexture.apply(v,[m.texture.texture].concat(R(FF(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==s){e.next=31;break}return e.next=25,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 25:y=e.sent,b=y[0],x=y[1],g=sg(b,x),e.next=32;break;case 31:null==h?g=this.getValuesFromTexture(t):(k=Nr(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(h,k));case 32:return null!=f&&this.disposeIntermediateTensorInfo(f),null!=h&&MF(w=this.gpgpu.gl,(function(){return w.deleteBuffer(h)})),C=this.convertAndCacheOnCPU(t,g),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(e){return e(C)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Qc().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",C);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.isPacked,u=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=s?new hM(a,oM):new $L(a,oM);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),d=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),d}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var p=this.decode(e,t.customTexShape),h=Qc().makeTensorFromTensorInfo(p),f=this.texData.get(p.dataId);return Object.assign({tensorRef:h},f.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return Us(e)}));return Kc(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Kc(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!BF(n)){if(na().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=Nr(n);if(na().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture.texture].concat(R(FF(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=na().getBool("WEBGL_PACK")&&!0===a,d=l?tD(n):n,p=l?new zD(d):new MD(d),h=this.runWebGLProgram(p,[{shape:d,dtype:r,dataId:e}],"float32"),f=this.texData.get(h.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(h),v}},{key:"timerAvailable",value:function(){return na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=Hs(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=Hs(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return mt(ft().mark((function e(){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,s.kernelMs=kr(n),s.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Vs(),endMs:null}}},{key:"endTimer",value:function(e){return na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Vs(),e)}},{key:"getQueryTime",value:function(){var e=mt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(na().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e).complexTensorInfos;return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gM;return na().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&Nr(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){vs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return vM(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new hM(e.shape,t),a=this.compileAndRun(r,[e],n);return Qc().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=RL(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(na().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nM,e.dtype);var n=new $L(e.shape,nM),r=this.compileAndRun(n,[e]);return Qc().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&Pr(n[0])){var a=n.map((function(e){return Ws(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return Qc().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new fM(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new KL(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[$F(e.shape)].concat(R(eD(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[$F(t)].concat(R(eD(t))),i=new XL(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;null!=t&&wr(Nr(a)<=t[0]*t[1]*4,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}));var o,s=tD(a);o=r?new LD(s):new DD(s);var u=[null!=t?t:FF(s)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,u,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===IF.DENSE){var c=null!=o?o:FF(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===Nr(s.shape))return u.values=Dr(s.dtype,0),s;var l=[],d=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&Nr(t.shape)<=na().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!rD(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var p,h={shape:s.shape,texData:u,isUniform:!1},f=function(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=TD(e.packedInputs,t.shape,i),s=o.useSqueezeShape,u=o.uniformShape,c=o.keptDims,l="",d="",p="";if(1===u.length&&e.packedInputs){var h=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(h[0]>1,"_").concat(h[1]>1)}else if(2!==u.length||e.packedInputs){if(u.length>2&&!e.packedInputs){var f=jr(u);p="".concat(f[0]===i[1],"_").concat(f[f.length-1]===i[1])}}else d="".concat(u[0]>1,"_").concat(u[1]>1);var v=t.shape.length,m=2===u.length&&Ir(t.shape,i),g=1===Nr(t.shape),y=Cl(t.shape,n.shape),b=!e.packedInputs&&v===n.shape.length&&Ir(i,n.texData.texShape),x=e.packedInputs||u.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(v,"_").concat(b,"_").concat(s?c:"","_").concat(u.length,"_").concat(g,"_").concat(y,"_").concat(m,"_").concat(l,"_").concat(d,"_").concat(p,"_").concat(x,"_").concat(a)}else{var k=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(k,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+"_"+r+"_"+a+"".concat(na().getNumber("WEBGL_VERSION"))}(e,d,h),v=this.getAndSaveBinary(f,(function(){return RD(a.gpgpu,e,d,h)})),m=null!=this.activeTimers;m&&(p=this.startTimer()),na().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(OD(t.inShapeInfos,n),OD([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),1===na().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)],s=t.inShapesLocations["".concat(a,"Shape")],u=t.inTexShapesLocations["".concat(a,"TexShape")];if(s){var c=TD(t.program.packedInputs,n.shape,n.texData.texShape).uniformShape;switch(c.length){case 1:e.gl.uniform1iv(s,new Int32Array(c));break;case 2:e.gl.uniform2iv(s,new Int32Array(c));break;case 3:e.gl.uniform3iv(s,new Int32Array(c));break;case 4:e.gl.uniform4iv(s,new Int32Array(c))}}if(u&&e.gl.uniform2i(u,n.texData.texShape[0],n.texData.texShape[1]),null!=i)if(n.isUniform)if(Nr(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var l=n.uniformValues;l instanceof Float32Array||(l=new Float32Array(l)),e.gl.uniform1fv(i,l)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture.texture,i,r)}));var s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var u=jr(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a&&t.program.customUniforms.forEach((function(n,r){var i=t.customUniformLocations[r],o=a[r];if("float"===n.type)e.gl.uniform1fv(i,o);else if("vec2"===n.type)e.gl.uniform2fv(i,o);else if("vec3"===n.type)e.gl.uniform3fv(i,o);else if("vec4"===n.type)e.gl.uniform4fv(i,o);else if("int"===n.type)e.gl.uniform1iv(i,o);else if("ivec2"===n.type)e.gl.uniform2iv(i,o);else if("ivec3"===n.type)e.gl.uniform3iv(i,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(i,o)}})),e.executeProgram()}(this.gpgpu,v,d,h,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),m&&(p=this.endTimer(p),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(p)}));var g=na().get("WEBGL_FLUSH_THRESHOLD");if(g>0){var y=Vs();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!na().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===i){var b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!na().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=$c((function(){if(!na().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=na().getBool("DEBUG");na().set("DEBUG",!1);var n=e.abs(dl(1e-8)).dataSync()[0];if(na().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=Vs());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=na().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=na().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&na().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?br(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=Fr(e);e=a.newShape}var i=Nr(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);var s=null!=o&&Math.max.apply(Math,R(o))>r&&Math.min.apply(Math,R(o))<=(t?2:1)&&Math.min.apply(Math,R(o))>0;if(null==o||s)if(t){var u=$F(e),c=2,l=2;if(e.length){var d=H(eD(e),2);c=d[0],l=d[1]}o=Er(i=u*(c/2)*(l/2)).map((function(e){return 2*e}))}else o=Er(i);return o}(n,s),t.texShape=l),null!=a){var d,p=tD(n),h=l[1],f=l[0],v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(s||!v){var m=H(DF(l[0],l[1]),2);h=m[0],f=m[1]}d=s?new VD(p,v):new BD(p,v);var g=v?[f,h]:l,y=this.makeTensorInfo(g,r),b=this.texData.get(y.dataId);b.usage=v?TF.PIXELS:TF.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),h,f,a);var x=[[f,h]],k=this.runWebGLProgram(d,[y],r,x,!0),w=this.texData.get(k.dataId);t.texShape=w.texShape,t.isPacked=w.isPacked,t.usage=w.usage,na().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(t.texture=w.texture,t.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=Vs()-u)}else{var C=this.acquireTexture(l,o,r,s);t.texture=C}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*zr(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=H(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=mt(ft().mark((function e(){var t,n,r,a,i,o,s,u,c=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=H(r[n],2),i=a[1],t.push(this.checkCompletionAsync_(i));return e.abrupt("return",Promise.all(t));case 6:o=ft().mark((function e(){var n,r,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=H(u[s],2),r=n[1],a=new Promise((function(e){try{c.checkCompletion_(r),e(!0)}catch(t){throw t}})),t.push(a);case 3:case"end":return e.stop()}}),e)})),s=0,u=Object.entries(this.binaryCache);case 8:if(!(s<u.length)){e.next=13;break}return e.delegateYield(o(),"t0",10);case 10:s++,e.next=8;break;case 13:return e.abrupt("return",Promise.all(t));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=mt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,Wm();case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw HF(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=H(t[e],2)[1],r=AD(this.gpgpu,n.program,n.webGLProgram),a=r.uniformLocations,i=r.customUniformLocations,o=r.infLoc,s=r.nanLoc,u=r.inShapesLocations,c=r.inTexShapesLocations,l=r.outShapeLocation,d=r.outShapeStridesLocation,p=r.outTexShapeLocation;n.uniformLocations=a,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=s,n.inShapesLocations=u,n.inTexShapesLocations=c,n.outShapeLocation=l,n.outShapeStridesLocation=d,n.outTexShapeLocation=p}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,s=Qc().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var u=s.writeTexture(r,t,n,a,i,o);return Qc().makeTensorFromDataId(u,t,n,s)}}]),n}(vr);bM.nextDataId=0;Tu()&&nl("webgl",(function(){return new bM}),2);var xM="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",kM=L((function e(t,n,r){A(this,e),this.variableNames=["A","B"],this.outputShape=Nl(n,r),this.enableShapeUniforms=FD(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),wM="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",CM=L((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];A(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Nl(n,r);var i=this.outputShape.length;this.enableShapeUniforms=FD(i);var o="";if(a)if(0===i||1===Nr(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=ID(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=qL("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function SM(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var NM={kernelName:xi,backendName:"webgl",kernelFunc:SM};function IM(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=SM({inputs:{x:r},backend:n}),u=SM({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var TM={kernelName:Oa,backendName:"webgl",kernelFunc:IM},EM="return (a < 0.) ? b * a : a;",_M="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var RM={kernelName:Ii,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",Ps(i,"float32")),s=na().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new CM(_M,a.shape,o.shape):new kM(EM,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),u}},AM="return (a < 0.) ? b * a : a;",OM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var FM={kernelName:so,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=na().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new CM(OM,r.shape,a.shape):new kM(AM,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},DM="if (isnan(x)) return x;";function LM(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var d=c.texData.get(u.dataId),p=r(d.values,l);return c.makeTensorInfo(u.shape,l,p)}return i=na().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new hM(u.shape,n):new $L(u.shape,t),c.runWebGLProgram(i,[u],l)}}function MM(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,d=i;if(o&&"complex64"===c.dtype){var p=d.texData.get(c.dataId),h=d.texData.get(l.dataId),f=[[p.complexTensorInfos.real,h.complexTensorInfos.real],[p.complexTensorInfos.imag,h.complexTensorInfos.imag]].map((function(e){var n=H(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},s=new kM(t,c.shape,l.shape);return d.runWebGLProgram(s,[i,o],hu(r.dtype,a.dtype))})),v=H(f,2),m=v[0],g=v[1],y=IM({inputs:{real:m,imag:g},backend:d});return d.disposeIntermediateTensorInfo(m),d.disposeIntermediateTensorInfo(g),y}var b,x=u||hu(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||d.shouldExecuteOnCPU([c,l]))&&null!=s){var k=d.texData.get(c.dataId).values,w=d.texData.get(l.dataId).values,C="string"===c.dtype?Ig(k):k,S="string"===c.dtype?Ig(w):w,N=H(s(c.shape,l.shape,C,S,x),2),I=N[0],T=N[1],E=d.makeTensorInfo(T,x);return d.texData.get(E.dataId).values=I,E}return b=na().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new CM(n,c.shape,l.shape,a):new kM(t,c.shape,l.shape),d.runWebGLProgram(b,[c,l],x)}}function zM(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?uM:tM;if("relu"===e)return t?lM:aM;if("elu"===e)return t?cM:rM;if("relu6"===e)return t?dM:iM;if("prelu"===e)return t?OM:AM;if("leakyrelu"===e)return t?_M:EM;if("sigmoid"===e)return t?pM:sM;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var PM=L((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];A(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=FD(this.outputShape.length);var l=a?t[1]:t[2],d=Math.ceil(l/2),p=a?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",f=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(m=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),g="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var b="rc.x",x="rc.x";t[0]<n[0]?b="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(x="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(d,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(d,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(p,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(v[0],");\n          result += (").concat(f[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")})),BM={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},VM=L((function e(t,n,r){A(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Nl(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),WM="return a * b;";function UM(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=hu(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new VM(BM.REAL,a.shape,i.shape),l=new VM(BM.IMAG,a.shape,i.shape),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],p=r.runWebGLProgram(c,d,"float32"),h=r.runWebGLProgram(l,d,"float32"),f=IM({inputs:{real:p,imag:h},backend:r});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(h),f}if(r.shouldExecuteOnCPU([a,i])){var v=r.texData.get(a.dataId),m=r.texData.get(i.dataId),g=H(bL(a.shape,i.shape,v.values,m.values,o),2),y=g[0],b=g[1],x=r.makeTensorInfo(b,o);return r.texData.get(x.dataId).values=y,x}return t=na().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new CM(WM,a.shape,i.shape):new kM(WM,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var jM={kernelName:Yi,backendName:"webgl",kernelFunc:UM};function HM(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=Nr(a.shape),u=Ar(i,s),c=Nr(u);wr(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||rD(a.shape,u)||null!==l.texture&&rD(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[$F(e.shape)].concat(R(eD(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[$F(t)].concat(R(eD(t))),o=new XL(i,r),s=[r],u=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(a,u,o)}var GM={kernelName:go,backendName:"webgl",kernelFunc:HM},qM=L((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(Tr(l)?l.toPrecision(2):l,", ones);")}var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),KM=L((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),d=r%4,p="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===n?(s="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===n&&(s="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}));function XM(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=Gm(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],c=u.inSize,l=u.windowSize,d=u.outSize,p=void 0;p="mean"===n?0===o?new qM({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:d},c):new qM({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:d}):new KM({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:d},n),s=i,i=r.runWebGLProgram(p,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var ZM=L((function e(t,n){A(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=ID(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var YM=L((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=ID(this.rank),o=GL("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),d="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(d,";\n      if(").concat(l,") {\n        result[1] = ").concat(d,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(d,";\n        if(").concat(l,") {\n          result[3] = ").concat(d,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function QM(e,t,n){var r=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new YM(e.shape,t):new ZM(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function JM(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=Or(a,e.shape),s=o,u=Vp(s,i),c=null!=u,l=e;c&&(l=QM(e,u,r),s=Up(s.length,i)),Bp("sum",s,i);var d=H(zp(l.shape,s),2),p=d[0],h=d[1],f=p;n&&(f=Pp(p,o));var v=Nr(h),m=HM({inputs:{x:l},attrs:{shape:[Nr(e.shape)/v,v]},backend:r}),g=XM(m,fu(e.dtype),"sum",r),y=HM({inputs:{x:g},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),c&&r.disposeIntermediateTensorInfo(l),y}(t.x,r.axis,r.keepDims,n)}var $M={kernelName:zo,backendName:"webgl",kernelFunc:JM};function ez(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var d=s.texData.get(i.dataId).values,p=jL(d,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=p}else t=QM(i,o,s);return t}var tz={kernelName:as,backendName:"webgl",kernelFunc:ez},nz=1e3;function rz(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,d=void 0===l?0:l,p=e.activation,h=void 0===p?null:p,f=t.shape.length,v=n.shape.length,m=r?t.shape[f-2]:t.shape[f-1],g=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[f-1]:t.shape[f-2],b=a?n.shape[v-2]:n.shape[v-1],x=t.shape.slice(0,-2),k=n.shape.slice(0,-2),w=Nr(x),C=Nr(k),S=Nl(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);wr(m===g,(function(){return"Error in matMul: inner shapes (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var N,I=r?[w,m,y]:[w,y,m],T=a?[C,b,g]:[C,g,b],E=HM({inputs:{x:t},backend:i,attrs:{shape:I}}),_=HM({inputs:{x:n},backend:i,attrs:{shape:T}}),R=[E,_],A=Math.max(w,C),O=r?E.shape[1]:E.shape[2],F=null!=s,D=null!=c,L="leakyrelu"===h,M=null!=h?zM(h,!0):null;if((1===y||1===b)&&O>nz&&!1===(F||D||L||null!=M)){var z=E,P=_;r&&(z=ez({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),R.push(z)),a&&(P=ez({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),R.push(P));var B=1===b,V=z;1!==b&&(V=HM({inputs:{x:z},backend:i,attrs:{shape:[A,O,1]}}),R.push(V));var W=1===b?2:1,U=P;B&&(U=HM({inputs:{x:P},backend:i,attrs:{shape:[A,1,O]}}),R.push(U));var j=UM({inputs:{a:V,b:U},backend:i});N=JM({inputs:{x:j},backend:i,attrs:{axis:W,keepDims:!0}}),R.push(j)}else{var H=hu(t.dtype,n.dtype),G=new PM(I,T,[A,y,b],r,a,F,M,D,L),q=[E,_];if(null!=s&&q.push(s),D&&q.push(c),L){var K=i.makeTensorInfo([],"float32",Ps(d,"float32"));q.push(K),R.push(K)}N=i.runWebGLProgram(G,q,H)}var X=HM({inputs:{x:N},backend:i,attrs:{shape:S}});R.push(N);for(var Z=0,Y=R;Z<Y.length;Z++){var Q=Y[Z];i.disposeIntermediateTensorInfo(Q)}return X}var az={kernelName:ps,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return rz({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},iz="return abs(x);";var oz={kernelName:sa,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=RL(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=na().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new hM(a.shape,iz):new $L(a.shape,iz),r.runWebGLProgram(t,[a],a.dtype)}},sz=LM({opSnippet:eM+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),uz={kernelName:ua,backendName:"webgl",kernelFunc:sz},cz=LM({opSnippet:eM+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),lz={kernelName:ca,backendName:"webgl",kernelFunc:cz},dz="return a + b;",pz=MM({opSnippet:dz,packedOpSnippet:dz,supportsComplex:!0,cpuKernelImpl:JD}),hz={kernelName:la,backendName:"webgl",kernelFunc:pz},fz=L((function e(t,n){A(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),vz=L((function e(t,n){A(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var mz={kernelName:da,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return SM({inputs:{x:a[0]},backend:r});if(a.length>na().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return hu(e,t)})),c=a.map((function(e){return e.shape})),l=na().getBool("WEBGL_PACK")?new vz(a[0].shape,c):new fz(a[0].shape,c);return r.runWebGLProgram(l,a,u)}};var gz={kernelName:pa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=Or(i,a.shape),c=u,l=Vp(c,s),d=a;null!=l&&(d=ez({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Up(c.length,s)),Bp("all",c,s);var p,h=H(zp(d.shape,c),2),f=h[0],v=HM({inputs:{x:d},backend:n,attrs:{shape:[-1,Nr(h[1])]}}),m=XM(v,v.dtype,"all",n);return p=HM(o?{inputs:{x:m},backend:n,attrs:{shape:Pp(f,u)}}:{inputs:{x:m},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(d),p}};var yz={kernelName:ha,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=Or(i,a.shape),c=u,l=Vp(c,s),d=a;null!=l&&(d=ez({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Up(c.length,s)),Bp("any",c,s);var p,h=H(zp(d.shape,c),2),f=h[0],v=HM({inputs:{x:d},backend:n,attrs:{shape:[-1,Nr(h[1])]}}),m=XM(v,v.dtype,"any",n);return p=HM(o?{inputs:{x:m},backend:n,attrs:{shape:Pp(f,u)}}:{inputs:{x:m},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(d),p}},bz=L((function e(t,n,r){A(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),xz=L((function e(t,n,r,a){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,wr(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,d=ID(l),p=qL("coords",l);if(1===o){var h=ID(u=l+1);s="\n        ".concat(h," sourceLocR = ").concat(h,"(").concat(p.join(),", 0);\n        ++").concat(p[l-1],";\n        ").concat(h," sourceLocG = ").concat(h,"(").concat(p.join(),", 0);\n        ++").concat(p[l-2],";\n        ").concat(h," sourceLocA = ").concat(h,"(").concat(p.join(),", 0);\n        --").concat(p[l-1],";\n        ").concat(h," sourceLocB = ").concat(h,"(").concat(p.join(),", 0);\n        --").concat(p[l-2],";")}else u=l,s="\n        ".concat(d," sourceLocR = coords;\n        ++").concat(p[l-1],";\n        ").concat(d," sourceLocG = coords;\n        ++").concat(p[l-2],";\n        ").concat(d," sourceLocA = coords;\n        --").concat(p[l-1],";\n        ").concat(d," sourceLocB = coords;\n        --").concat(p[l-2],";");var f=["x","y","z","w","u","v"].slice(0,u),v="."+f[u-1],m=f.map((function(e){return"int "+e})),g=qL("sourceLocR",u-1).concat("inIdx.r"),y=qL("sourceLocG",u-1).concat("inIdx.g"),b=qL("sourceLocB",u-1).concat("inIdx.b"),x=qL("sourceLocA",u-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",w=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),C="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(f.join(),"),\n                                          vec2(").concat(f.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(f.join(),"),\n                               vec2(").concat(f.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(d," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(p[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function kz(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=Gm(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new bz(s,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;var d=kz(e,t,n,l);return e.disposeIntermediateTensorInfo(l),d}function wz(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=Gm(a[a.length-1]),o=new xz(a,i,n,null==r),s=null==r?[t]:[t,r],u=e.runWebGLProgram(o,s,"int32");if(u.shape.length===t.shape.length){var c=wz(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function Cz(e,t,n,r){var a=[n];if(Bp("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!na().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=e.texData.get(t.dataId),s=t;null!==o&&o.isPacked&&(s=e.unpackTensor(t),i.push(s));var u=H(zp(s.shape,a),2),c=u[0],l=Nr(u[1]),d=HM({inputs:{x:s},backend:e,attrs:{shape:[-1,l]}});i.push(d);var p=kz(e,d,r);i.push(p);var h=HM({inputs:{x:p},backend:e,attrs:{shape:c}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),h}return wz(e,t,r)}var Sz={kernelName:fa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=Or(r.axis,a.shape),o=Vp(i,a.shape.length),s=a,u=[];null!=o&&(s=ez({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=Up(i.length,s.shape.length)),Bp("argMax",[i[0]],s.shape.length);var c=Cz(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}};var Nz={kernelName:va,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=Or(r.axis,a.shape),o=Vp(i,a.shape.length),s=a,u=[];null!=o&&(s=ez({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=Up(i.length,s.shape.length)),Bp("argMin",[i[0]],s.shape.length);var c=Cz(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},Iz=LM({opSnippet:eM+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Tz={kernelName:ma,backendName:"webgl",kernelFunc:Iz},Ez=LM({opSnippet:eM+"return log(x + sqrt(x * x + 1.0));"}),_z={kernelName:ga,backendName:"webgl",kernelFunc:Ez},Rz=LM({opSnippet:eM+"\n  return atan(x);\n"}),Az={kernelName:ya,backendName:"webgl",kernelFunc:Rz},Oz=MM({opSnippet:xM+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+wM+"\n  return result;\n"}),Fz={kernelName:xa,backendName:"webgl",kernelFunc:Oz},Dz=LM({opSnippet:eM+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Lz={kernelName:ba,backendName:"webgl",kernelFunc:Dz},Mz=L((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,h=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(v||(y="-1.0 / 1e-20"),r){this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:g:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var b="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(b="avgValue / max(count, 1.0)");var x=4*Math.floor(o/4),k=o%4,w="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(f,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}})),zz=L((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,d=t.dilationHeight,p=t.dilationWidth,h=t.effectiveFilterDepth,f=t.effectiveFilterHeight,v=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,x="0.0";if(b||(x="-1.0 / 1e-20"),r){this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(d,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(k="avgValue / max(count, 1.0)");var w=4*Math.floor(o/4),C=o%4,S="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(d,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(k,");\n      }\n    ")}}));var Pz={kernelName:ka,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;uD(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;wr(Vd(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Rd(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&Ir(c.inShape,c.outShape))return SM({inputs:{x:a},backend:n});var l=new Mz(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var Bz={kernelName:Ca,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=Ad(a.shape,i,o,[1,1,1],s,u,c),d=new zz(l,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}},Vz=L((function e(t){A(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=u-1-t.padInfo.top,d=c-1-t.padInfo.left,p=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(d,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Wz=L((function e(t){A(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=d-1-t.padInfo.front,v=p-1-t.padInfo.top,m=h-1-t.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(v,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var Uz={kernelName:Sa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Ad(i.shape,o,s,[1,1,1],u,c),d=new Wz(l);return n.runWebGLProgram(d,[a],i.dtype)}};var jz={kernelName:wa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;uD([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=Rd(o.shape,s,u,1,c),d=new Vz(l);return n.runWebGLProgram(d,[a],o.dtype)}};var Hz={kernelName:Na,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return rz({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},Gz=L((function e(t,n,r,a,i,o){A(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],Nl(t,n),Nl(t,r);var s="0.0";null!=a&&(Nl(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(Nl(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),qz=L((function e(t,n,r,a,i,o){A(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Nl(t,n),Nl(t,r);var s="vec4(0.0)";null!=a&&(Nl(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(Nl(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),Kz={kernelName:vi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;wr(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),wr(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),wr(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],d=null;null!=s&&(d=s.shape,l.push(s));var p=null;null!=u&&(p=u.shape,l.push(u));var h=na().getBool("WEBGL_PACK_NORMALIZATION")?new qz(a.shape,i.shape,o.shape,d,p,c):new Gz(a.shape,i.shape,o.shape,d,p,c);return n.runWebGLProgram(h,l,l[0].dtype)}},Xz=L((function e(t){A(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=ID(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return Zz.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(Zz[t]," = start[").concat(t,"] + coords.").concat(Zz[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),Zz=["x","y","z","w","u","v"];var Yz=L((function e(t){A(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=ID(this.rank),r=qL("coords",this.rank),a=qL("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}));function Qz(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=H(fd(a,r.begin,r.size),2),o=i[0],s=i[1];if(ld(a,o,s),0===Nr(s))return n.makeTensorInfo(s,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var u=n.texData.get(a.dataId),c=AL(u.values,o,s,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,c)}var l=n.texData.get(a.dataId).isPacked,d=pd(a.shape,o,s);if(l||!d){var p=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yz(s):new Xz(s),h=[o];return n.runWebGLProgram(p,[a],a.dtype,h)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=hd(t,jr(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,o,s,n)}var Jz={kernelName:Ro,backendName:"webgl",kernelFunc:Qz},$z={kernelName:Ia,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;wr(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=Km(a.shape,i,s),c=Xm(u.length,i.length),l=Zm(a.shape,i,s),d=Ym(o,i.length),p=Qm(l,o,i.length),h=[],f=HM({inputs:{x:a},backend:n,attrs:{shape:u}}),v=ez({inputs:{x:f},backend:n,attrs:{perm:c}}),m=HM({inputs:{x:v},backend:n,attrs:{shape:l}}),g=Qz({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(v),h.push(m),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var eP={kernelName:Ta,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=$D(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var tP={kernelName:Ea,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=Nl(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},nP=MM({opSnippet:"return float(a != b);",cpuKernelImpl:kL,dtype:"bool"}),rP={kernelName:Ji,backendName:"webgl",kernelFunc:nP};function aP(e){var t=e.inputs,n=e.backend,r=t.input;return SM({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var iP={kernelName:fo,backendName:"webgl",kernelFunc:aP},oP="return float(int(x));";var sP={kernelName:_a,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return SM({inputs:{x:i},backend:r});var s=Ah(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=IM({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var l=aP({inputs:{input:i},backend:r}),d=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),d}if(!Mr(i.dtype,o)){var p=SM({inputs:{x:i},backend:r});return{dataId:p.dataId,shape:p.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var h=r.texData.get(i.dataId).values,f=H(tL(h,i.shape,i.dtype,o),3),v=f[0],m=f[1],g=f[2];return r.makeTensorInfo(v,m,g)}if("int32"===o)return function(e,t){var n=new $L(e.shape,oP),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var y=r.makeTensorInfo([],"bool",Dr("bool",1)),b=nP({inputs:{a:i,b:y},backend:r});return r.disposeIntermediateTensorInfo(y),b}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},uP="return ceil(x);",cP=LM({opSnippet:uP,packedOpSnippet:uP,cpuKernelImpl:nL}),lP={kernelName:Ra,backendName:"webgl",kernelFunc:cP},dP=L((function e(t){A(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),pP=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var hP={kernelName:Aa,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax;t=na().getBool("WEBGL_PACK_CLIP")?new pP(i.shape):new dP(i.shape);var u=[[o],[s]];return r.runWebGLProgram(t,[i],i.dtype,u)}},fP=L((function e(t){A(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function vP(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var mP={kernelName:Fa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new fP(r.shape),o=[vP(r,a.complexTensorInfos.real),vP(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},gP=L((function e(t){A(this,e),this.outputShape=[],this.outputShape=jm(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),yP=L((function e(t,n){A(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=jm(t,n);var r=this.outputShape,a=r.length,i=ID(a),o=qL("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],d=s.slice(-2),p=s.join(),h="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(d.join(),"));\n        }"),f=1;f<u.length;f++){var v=u[f-1];h+="\n        if (".concat(l," < ").concat(u[f],"  && ").concat(l," >= ").concat(u[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(bP(s,l,v),"),\n            vec2(").concat(bP(d,l,v),"));\n        }")}var m=u.length,g=u[u.length-1];h+="\n        return getChannel(\n          getT".concat(m,"(").concat(bP(s,l,g),"),\n          vec2(").concat(bP(d,l,g),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function bP(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function xP(e){var t=e.inputs,n=e.backend,r=t.input;return SM({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var kP={kernelName:wi,backendName:"webgl",kernelFunc:xP};function wP(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return aP({inputs:{input:e},backend:n})})),i=e.map((function(e){return xP({inputs:{input:e},backend:n})})),o=wP(a,t,n),s=wP(i,t,n),u=IM({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=Nr(e.shape.slice(t));return HM({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),d=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),p=jm(l.map((function(e){return e.shape})),1),h=1===l[0].shape[0],f=rL(d,p,r,h),v=jm(e.map((function(e){return e.shape})),t),m=n.makeTensorInfo(v,r,f);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}var g=e.filter((function(e){return Nr(e.shape)>0})),y=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&g[0].shape.length>1;if(1===g.length){var b=y?new $L(e[0].shape,oM):new hM(e[0].shape,oM);return n.runWebGLProgram(b,e,r)}var x=na().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(g.length>x){for(var k=[],w=0;w<g.length;w+=x){var C=g.slice(w,w+x);k.push(wP(C,t,n))}for(var S=wP(k,t,n),N=0,I=k;N<I.length;N++){var T=I[N];n.disposeIntermediateTensorInfo(T)}return S}if(y){var E=new yP(g.map((function(e){return e.shape})),t);return n.runWebGLProgram(E,g,r)}var _=function(e,t,n){var r=jm(e.map((function(e){return e.shape})),t),a=e.map((function(e){return HM({inputs:{x:e},attrs:{shape:[-1,Nr(e.shape.slice(t))]},backend:n})}));return{tensors2D:a,outShape:r}}(g,t,n),R=_.tensors2D,A=_.outShape,O=new gP(R.map((function(e){return e.shape}))),F=n.runWebGLProgram(O,R,r);R.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var D=HM({inputs:{x:F},attrs:{shape:A},backend:n});return n.disposeIntermediateTensorInfo(F),D}function CP(e){var t=e.inputs,n=e.backend,r=Or(e.attrs.axis,t[0].shape)[0];Um(t.map((function(e){return e.shape})),r);var a=jm(t.map((function(e){return e.shape})),r);if(0===Nr(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return Nr(e.shape)>0}));return 1===i.length?SM({inputs:{x:i[0]},backend:n}):wP(i,r,n)}var SP={kernelName:Da,backendName:"webgl",kernelFunc:CP},NP=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),v=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1,x="",k="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),k="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")})),IP=L((function e(t){A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,d=t.filterDepth,p=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(d,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),TP=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=FD(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,d=l,p="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",h=0;h<l;h++)p+="\n           vec4 xTexelC".concat(2*h,";\n           int xTexelC").concat(2*h,"Ready;\n           vec4 xTexelC").concat(2*h+1,";\n           int xTexelC").concat(2*h+1,"Ready;\n           vec4 xC").concat(h,";");p+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var f=0;f<l;f++)p+="\n           xTexelC".concat(2*f," = vec4(0.0);\n           xTexelC").concat(2*f,"Ready = 0;\n           xTexelC").concat(2*f+1," = vec4(0.0);\n           xTexelC").concat(2*f+1,"Ready = 0;\n           xC").concat(f," = vec4(0.0);");p+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var v=0;v<(d+1)/2;v++){var m=2*v;if(p+="\n           xC = xCCorner + ".concat(m*u,";\n           "),1===s){if(m<l&&(o%2===1?(p+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n               "),p+=1===u&&m>0?"\n                 xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                   } else {\n                     xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                   }\n                   ")):p+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xC").concat(m," = xTexelC").concat(m,";\n                 "),m+1<l)){var g=o%2===0?br(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(p+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(g,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                     xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(m+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(m+1,"Ready = 1;\n                   }\n                   "),p+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                     } else {\n                      xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                     }\n                     "):"\n                     xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                     ")):p+=1===g?"\n                     xC".concat(m+1," = xTexelC").concat(m,";\n                     "):"\n                     xCOffset = xC + ".concat(g,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                       xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(m+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(m+1,"Ready = 1;\n                     }\n\n                     xC").concat(m+1," = xTexelC").concat(m+1,";\n                     ")}}else m<l&&(o%2===1?(p+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n               "),m+1<l&&(p+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                 "))):(p+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(\n                   xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n               "),m+1<l&&(p+="\n                   xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                 "))));m<l&&(p+="\n             wTexel = getW(r, ".concat(m,", d1, d2);\n             dotProd += xC").concat(m,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(m,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),m+1<l&&(p+="\n               wTexel = getW(r, ".concat(m+1,", d1, d2);\n               dotProd += xC").concat(m+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(m+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}p+="\n     }\n   ",p+="\n     }\n   ",p+="\n     }\n   ";var y="",b="";r&&(y=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),b="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(y,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(p,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(x,"\n         ").concat(b,"\n         setOutput(result);\n       }\n     ")})),EP=L((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=FD(this.outputShape.length);for(var r=n.dataFormat,a=lD(),i="channelsLast"===r,o=i?1:2,s=i?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),c="",l=0;l<=1;l++)for(var d=0;d<=1;d++)c+="\n          blockIndex = rc.z + ".concat(d,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+d,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+d,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function _P(e,t){var n=e.length;return n>=3?[].concat(R(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function RP(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,d=void 0===l?0:l,p=e.activation,h=void 0===p?null:p,f=n.shape,v=i.texData.get(n.dataId),m=a.inChannels,g=f[0]*f[1]*f[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[];if(null!=c){var k=_P(c.shape,b);null!=k&&(c=HM({inputs:{x:c},backend:i,attrs:{shape:k}}),x.push(c))}if(null!=s){var w=_P(s.shape,b);null!=w&&(s=HM({inputs:{x:s},backend:i,attrs:{shape:w}}),x.push(s))}if(!((1===g||1===y)&&m>nz)&&v.isPacked&&b&&null!=v.texture&&f[2]%2!==0&&Ir(v.shape.slice(-3),f.slice(-3))){var C=f[0]*f[1]*(f[2]+1),S={dataId:n.dataId,shape:[1,C,a.inChannels],dtype:n.dtype},N=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,wr(rD(v.shape,S.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(S.shape," isn't free")}));var I=HM({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(I);var T=rz({a:S,b:I,backend:i,transposeA:!1,transposeB:false,bias:s,activation:h,preluActivationWeights:c,leakyreluAlpha:d}),E=i.texData.get(T.dataId);wr(E.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=N,E.shape=a.outShape,(t=SM({inputs:{x:T},backend:i})).shape=a.outShape,x.push(T)}else{var _=a.outHeight*a.outWidth,R=HM({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,_,a.inChannels]:[a.batchSize,a.inChannels,_]}}),A=HM({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),O=rz({a:b?R:A,b:b?A:R,transposeA:!b,transposeB:false,backend:i,bias:s,activation:h,preluActivationWeights:c,leakyreluAlpha:d});t=HM({inputs:{x:O},backend:i,attrs:{shape:a.outShape}}),x.push(R),x.push(A),x.push(O)}for(var F=0,D=x;F<D.length;F++){var L=D[F];i.disposeIntermediateTensorInfo(L)}return t}function AP(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,d=e.activation,p=void 0===d?null:d,h=r.filterWidth,f=r.filterHeight,v=r.inChannels,m=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=h*f*v,x=g*m,k=[r.batchSize,b,x],w=[];if(null!=u){var C=_P(u.shape,y);null!=C&&(u=HM({inputs:{x:u},backend:a,attrs:{shape:C}}),w.push(u))}if(null!=o){var S=_P(o.shape,y);null!=S&&(o=HM({inputs:{x:o},backend:a,attrs:{shape:S}}),w.push(o))}var N=HM({inputs:{x:n},backend:a,attrs:{shape:[1,b,Nr(n.shape)/b]}});w.push(N);var I=new EP(k,r),T=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],E=a.runWebGLProgram(I,[t],"float32",T),_=HM({inputs:{x:E},backend:a,attrs:{shape:k}});w.push(E),w.push(_);var R=null!=o,A=null!=u,O="leakyrelu"===p,F=p?zM(p,!0):null,D=new PM(y?_.shape:N.shape,y?N.shape:_.shape,y?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],!0,!1,R,F,A,O),L=y?[_,N]:[N,_];if(o&&L.push(o),A&&L.push(u),O){var M=a.makeTensorInfo([],"float32",Ps(l,"float32"));L.push(M),w.push(M)}var z=a.runWebGLProgram(D,L,"float32"),P=HM({inputs:{x:z},backend:a,attrs:{shape:r.outShape}});w.push(z);for(var B=0,V=w;B<V.length;B++){var W=V[B];a.disposeIntermediateTensorInfo(W)}return P}var OP={kernelName:La,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,d=a.dimRoundingMode,p=Ud(c),h=Od(i.shape,o.shape,s,l,u,d,!1,p);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===p&&na().getBool("WEBGL_EXP_CONV")){var f=new TP(h),v=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];t=r.runWebGLProgram(f,[i,o],"float32",v)}else if(na().getBool("WEBGL_CONV_IM2COL"))t=AP({x:i,filter:o,convInfo:h,backend:r});else{var m=new NP(h);t=r.runWebGLProgram(m,[i,o],"float32")}else t=RP({x:i,filter:o,convInfo:h,backend:r});var g=HM({inputs:{x:t},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(t),g}},FP=L((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),DP=L((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,d=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(d,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),LP=L((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),MP=L((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var zP={kernelName:Ma,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,d=Ud(u),p=Od(a.shape,l,o,1,s,c,!1,d),h=new FP(p);return n.runWebGLProgram(h,[a,i],"float32")}};var PP={kernelName:za,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,d=Ud(c),p=Od(o,i.shape,s,1,u,l,!1,d),h=new DP(p);return n.runWebGLProgram(h,[a,i],"float32")}};var BP={kernelName:Pa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=Fd(a.shape,i.shape,o,u,s),l=new IP(c);return n.runWebGLProgram(l,[a,i],"float32")}};var VP={kernelName:Ba,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=Fd(a.shape,u,o,1,s),l=new LP(c);return n.runWebGLProgram(l,[a,i],"float32")}};var WP,UP={kernelName:Va,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=Fd(r.inputShape,i.shape,s,1,o),c=new MP(u);return n.runWebGLProgram(c,[a,i],"float32")}},jP=LM({opSnippet:DM+"\n  return cos(x);\n"}),HP={kernelName:Wa,backendName:"webgl",kernelFunc:jP},GP=LM({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),qP={kernelName:Ua,backendName:"webgl",kernelFunc:GP},KP=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=H(t,4),s=o[0],u=o[1],c=o[2],l=o[3],d=H(n,1)[0],p=H(r,2),h=p[0],f=p[1];this.outputShape=[d,h,f,l];var v="bilinear"===a?1:0,m="".concat(u-1,".0"),g="".concat(c-1,".0"),y=H(h>1?["".concat((u-1)/(h-1)),"(y2-y1) * height_ratio","y1*".concat(m," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(m)],3),b=y[0],x=y[1],k=y[2],w=H(f>1?["".concat((c-1)/(f-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],3),C=w[0],S=w[1],N=w[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(x,";\n        float width_scale = ").concat(S,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(N,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),XP={kernelName:Ga,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new KP(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(WP||(WP={}));var ZP=L((function e(t,n,r,a){A(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===WP.Prod?"1.0":"0.0",s=r?o:"getX(".concat(YP(i,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1],c="",l="";r?(c=a?"end != ".concat(u-1):"end != 0",l=a?"end + 1":"end - 1"):(c=a?"end + pow2 < ".concat(u):"end >= pow2",l=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(ID(i)," coords = getOutputCoords();\n        int end = ").concat(QP(i,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(QP(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(YP(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function YP(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function QP(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function JP(e,t,n,r,a,i){var o=t.shape.length,s=Vp([r],o),u=t;null!=s&&(u=ez({inputs:{x:t},backend:n,attrs:{perm:s}}));var c=Up(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=u.shape[c],d=SM({inputs:{x:u},backend:n}),p=0;p<=Math.ceil(Math.log2(l))-1;p++){var h=new ZP(e,u.shape,!1,i),f=[[p]],v=d;d=n.runWebGLProgram(h,[d],d.dtype,f),n.disposeIntermediateTensorInfo(v)}if(a){var m=new ZP(e,u.shape,a,i),g=d;d=n.runWebGLProgram(m,[d],d.dtype),n.disposeIntermediateTensorInfo(g)}if(null!=s){var y=ez({inputs:{x:d},backend:n,attrs:{perm:Wp(s)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(u),y}return d}var $P={kernelName:ja,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return JP(WP.Prod,a,n,i,o,s)}};var eB={kernelName:Ha,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return JP(WP.Sum,a,n,i,o,s)}};var tB={kernelName:qa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=$D(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var d=n.bufferSync(a),p=n.bufferSync(i),h=eL(d,p,o,s);return n.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},nB=function(){function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return L(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var rB={kernelName:Ka,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),d=new nB("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(d,[a],a.dtype)}},aB=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=FD(this.outputShape.length);var o=t.filterHeight,s=t.filterWidth,u=t.outChannels/t.inChannels,c="",l="";r&&(c=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),l="result = activation(result);");var d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(d,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")})),iB=L((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=FD(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,d=t.filterWidth,p=d,h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",f=0;f<d;f++)h+="\n          vec4 xTexelC".concat(2*f,";\n          int xTexelC").concat(2*f,"Ready;\n          vec4 xTexelC").concat(2*f+1,";\n          int xTexelC").concat(2*f+1,"Ready;\n          vec4 xC").concat(f,";");h+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(var v=0;v<d;v++)h+="\n          xTexelC".concat(2*v," = vec4(0.0);\n          xTexelC").concat(2*v,"Ready = 0;\n          xTexelC").concat(2*v+1," = vec4(0.0);\n          xTexelC").concat(2*v+1,"Ready = 0;\n          xC").concat(v," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var m=0;m<(p+1)/2;m++){var g=2*m;if(h+="\n          xC = xCCorner + ".concat(g*c,";\n          "),1===u){if(g<d&&(s%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n              "),h+=1===c&&g>0?"\n                xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                  } else {\n                    xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xC").concat(g," = xTexelC").concat(g,";\n                "),g+1<d)){var y=s%2===0?br(c):c;c%2===0&&s%2===1||c%2!==0&&s%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                    xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(g+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(g+1,"Ready = 1;\n                  }\n                  "),h+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                    } else {\n                     xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                    }\n                    "):"\n                    xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                    ")):h+=1===y?"\n                    xC".concat(g+1," = xTexelC").concat(g,";\n                    "):"\n                    xCOffset = xC + ".concat(y,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                      xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(g+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(g+1,"Ready = 1;\n                    }\n\n                    xC").concat(g+1," = xTexelC").concat(g+1,";\n                    ")}}else g<d&&(s%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n              "),g+1<d&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(\n                  xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n              "),g+1<d&&(h+="\n                  xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                "))));g<d&&(h+="\n            wTexel = getW(r, ".concat(g,", d1, q);\n            dotProd += xC").concat(g," * vec4(wTexel.xz, wTexel.xz);\n          "),g+1<d&&(h+="\n              wTexel = getW(r, ".concat(g+1,", d1, q);\n              dotProd += xC").concat(g+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";var b="",x="";r&&(b=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),x="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(k,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}));var oB={kernelName:Xa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),wr(Vd(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var d,p=Od(a.shape,i.shape,o,l,s,c,!0);d=na().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new iB(p):new aB(p);var h=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(d,[a,i],"float32",h)}},sB=L((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),uB=L((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var cB={kernelName:Za,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,d=Od(a.shape,l,o,s,u,c,!0),p=new sB(d);return n.runWebGLProgram(p,[a,i],"float32")}};var lB={kernelName:Ya,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=Od(r.inputShape,i.shape,o,s,u,c,!0),d=new uB(l);return n.runWebGLProgram(d,[a,i],"float32")}},dB=L((function e(t){A(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var pB={kernelName:Qa,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(R(r.shape),R(r.shape)),i=Nr(r.shape),o=HM({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new dB(i),u=n.runWebGLProgram(s,[o],o.dtype),c=HM({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},hB=L((function e(t){A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,d=a.top,p=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var fB={kernelName:Ja,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=_d(i.shape,o.shape,s,u,"NHWC",c),d=new hB(l),p=HM({inputs:{x:t=r.runWebGLProgram(d,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),p}};var vB={kernelName:ni,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=vg(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;gg(i.length,s,r);for(var u=yg(o,s),c=u.path,l=u.steps,d=l.length,p=null,h=i.length,f=[],v=0;v<d;++v){var m,g=K(l[v]);try{for(g.s();!(m=g.n()).done;){var y=m.value,b=mg(h,s[y]),x=b.permutationIndices,k=b.expandDims,w=void 0;bg(x)?w=r[y]:(w=ez({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),f.push(w));for(var C=w.shape.slice(),S=0;S<k.length;++S)C.splice(k[S],0,1);Ir(w.shape,C)||(w=HM({inputs:{x:w},backend:n,attrs:{shape:C}}),f.push(w)),null===p?p=w:(p=UM({inputs:{a:w,b:p},backend:n}),f.push(p))}}catch(aH){g.e(aH)}finally{g.f()}v<d-1&&(c[v]>=0&&(p=JM({inputs:{x:p},backend:n,attrs:{axis:c[v]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(var N=0,I=f;N<I.length;N++){var T=I[N];T!==p&&n.disposeIntermediateTensorInfo(T)}return p}},mB=LM({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),gB={kernelName:ri,backendName:"webgl",kernelFunc:mB},yB={kernelName:ai,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=na().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new CM("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new kM("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},bB=MM({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:aL}),xB={kernelName:oi,backendName:"webgl",kernelFunc:bB},kB=LM({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(tg,";\n  float a1 = ").concat(ng,";\n  float a2 = ").concat(rg,";\n  float a3 = ").concat(ag,";\n  float a4 = ").concat(ig,";\n  float a5 = ").concat(og,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),wB={kernelName:ii,backendName:"webgl",kernelFunc:kB},CB=LM({opSnippet:DM+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:iL,dtype:"float32"}),SB={kernelName:si,backendName:"webgl",kernelFunc:CB};function NB(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(wr(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),HM({inputs:{x:i},backend:r,attrs:{shape:s}})}var IB={kernelName:ui,backendName:"webgl",kernelFunc:NB},TB="return exp(x) - 1.0;",EB=LM({opSnippet:TB,packedOpSnippet:TB,cpuKernelImpl:oL}),_B={kernelName:ci,backendName:"webgl",kernelFunc:EB},RB=L((function e(t,n,r){A(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function AB(e,t,n){var r=n.texData.get(e.dataId),a=Nr(e.shape),i=e.shape[e.shape.length-1],o=HM({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new RB("real",s,t),c=new RB("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],d=n.runWebGLProgram(u,l,"float32"),p=n.runWebGLProgram(c,l,"float32"),h=IM({inputs:{real:d,imag:p},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p);var f=HM({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(h),f}var OB={kernelName:li,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return AB(t.input,!1,n)}},FB=L((function e(t,n){A(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function DB(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||Vr(a))){var o=Lr(i,Nr(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new FB(r,a),u=[[a]];return t.runWebGLProgram(s,[],i,u)}var LB,MB={kernelName:di,backendName:"webgl",kernelFunc:DB},zB=L((function e(t){A(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),PB={kernelName:pi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new zB(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},BB="return floor(x);",VB=LM({opSnippet:BB,packedOpSnippet:BB,cpuKernelImpl:sL}),WB={kernelName:hi,backendName:"webgl",kernelFunc:VB},UB=MM({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),jB={kernelName:fi,backendName:"webgl",kernelFunc:UB},HB=L((function e(t){A(this,e),this.variableNames=["A"];var n=lD(),r=H(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),GB=L((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=lD(),r=H(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),qB={kernelName:ls,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u=H(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=u[0],l=u[1],d=[l,c],p=[l,c,i];if(s||o){var h=na().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=LB&&h===KB||(KB=h,LB=document.createElement("canvas").getContext("2d",{willReadFrequently:KB})),LB.canvas.width=c,LB.canvas.height=l,LB.drawImage(a,0,0,c,l),a=LB.canvas}var f=n.makeTensorInfo(d,"int32");n.texData.get(f.dataId).usage=TF.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);var v=na().getBool("WEBGL_PACK")?new GB(p):new HB(p),m=n.runWebGLProgram(v,[f],"int32");return n.disposeData(f.dataId),m}},KB=na().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var XB={kernelName:hs,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,d=a.dataFormat,p=a.dilations,h=a.dimRoundingMode,f=a.activation,v=a.leakyreluAlpha,m=Ud(d),g=Od(i.shape,o.shape,c,p,l,h,!1,m),y=[],b=null!=s,x=null!=u,k="leakyrelu"===f,w=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=HM({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(s,d)),x&&e.push(t(u,d)),k){var n=r.makeTensorInfo([],"float32",Ps(v,"float32"));e.push(n),y.push(n)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&na().getBool("WEBGL_EXP_CONV")){var C=f?zM(f,!0):null,S=new TP(g,b,C,x,k),N=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],I=w();t=r.runWebGLProgram(S,I,"float32",N)}else if(na().getBool("WEBGL_CONV_IM2COL"))t=AP({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:f,preluActivationWeights:u,leakyreluAlpha:v});else{var T=f?zM(f,!1):null,E=new NP(g,b,T,x,k),_=w();t=r.runWebGLProgram(E,_,"float32")}else t=RP({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:f,preluActivationWeights:u,leakyreluAlpha:v});var R=HM({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),R}};var ZB={kernelName:fs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,d=r.dimRoundingMode,p=r.activation,h=r.leakyreluAlpha,f=[],v=l;null==v&&(v=[1,1]),wr(Vd(u,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'")}));var m,g=Od(a.shape,i.shape,u,v,c,d,!0),y=na().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=p?zM(p,y):null,x=[a,i],k=null!=o,w=null!=s,C="leakyrelu"===p;if(k&&x.push(o),w&&x.push(s),C){var S=n.makeTensorInfo([],"float32",Ps(h,"float32"));x.push(S),f.push(S)}m=y?new iB(g,k,b,w,C):new aB(g,k,b,w,C);var N=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],I=n.runWebGLProgram(m,x,"float32",N);return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),I}},YB=L((function e(t,n,r,a){A(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=ID(r.length),o="\n    int index;",s=0;s<this.sliceDim;s++)o+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var QB={kernelName:gi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=Nr(r.shape),u=H(Jm(r,a),4),c=u[0],l=u[1],d=u[2],p=u[3],h=HM({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=HM({inputs:{x:r},backend:n,attrs:{shape:[Nr(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var v=n.readSync(a.dataId),m=n.bufferSync(r),g=uL(v,m,r.dtype,l,o,d,p,r.shape,s);return n.makeTensorInfo(c,r.dtype,g.values)}var y=new YB(o,p,[l,d],r.shape),b=n.runWebGLProgram(y,[f,h],f.dtype),x=HM({inputs:{x:b},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(b),x}},JB=L((function e(t,n){A(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=ID(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function $B(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=Or(o,a.shape)[0];if(na().get("DEBUG"))for(var c=n.readSync(i.dataId),l=a.shape[u],d=function(){var e=c[p];wr(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},p=0;p<c.length;++p)d();var h=Ng(a,i,u,s),f=Nr(i.shape),v=[],m=HM({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=HM({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,f/h.batchSize]}});v.push(m),v.push(g);var y=[h.batchSize,h.outerSize,f/h.batchSize,h.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var b=n.bufferSync(g),x=n.bufferSync(m),k=cL(x,b,y);return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h.outputShape,k.dtype,k.values)}var w=new JB(m.shape,y),C=n.runWebGLProgram(w,[m,g],m.dtype);v.push(C);var S=HM({inputs:{x:C},backend:n,attrs:{shape:h.outputShape}});return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),S}var eV={kernelName:mi,backendName:"webgl",kernelFunc:$B},tV=MM({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:lL,dtype:"bool"}),nV={kernelName:yi,backendName:"webgl",kernelFunc:tV},rV=MM({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:dL}),aV={kernelName:bi,backendName:"webgl",kernelFunc:rV};var iV={kernelName:ki,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return AB(t.input,!0,n)}},oV=LM({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),sV={kernelName:Ci,backendName:"webgl",kernelFunc:oV},uV=LM({opSnippet:"return float(isinf(x));",dtype:"bool"}),cV={kernelName:Si,backendName:"webgl",kernelFunc:uV},lV=LM({opSnippet:"return float(isnan(x));",dtype:"bool"}),dV={kernelName:Ni,backendName:"webgl",kernelFunc:lV},pV=MM({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:pL,dtype:"bool"}),hV={kernelName:Ti,backendName:"webgl",kernelFunc:pV},fV=MM({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:hL,dtype:"bool"}),vV={kernelName:Ei,backendName:"webgl",kernelFunc:fV};var mV={kernelName:_i,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=fL(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},gV=LM({opSnippet:DM+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:vL}),yV={kernelName:Ri,backendName:"webgl",kernelFunc:gV},bV=LM({opSnippet:DM+"\n  return log(1.0 + x);\n"}),xV={kernelName:Ai,backendName:"webgl",kernelFunc:bV},kV=MM({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),wV={kernelName:Oi,backendName:"webgl",kernelFunc:kV},CV=LM({opSnippet:"return float(!(x >= 1.0));"}),SV={kernelName:Fi,backendName:"webgl",kernelFunc:CV},NV=MM({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),IV={kernelName:Di,backendName:"webgl",kernelFunc:NV},TV=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),EV=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),_V={kernelName:Li,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=na().getBool("WEBGL_PACK_NORMALIZATION")?new EV(a.shape,i,o,s,u):new TV(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},RV=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),AV={kernelName:Mi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,d=new RV(a.shape,s,u,c,l);return n.runWebGLProgram(d,[a,i,o],a.dtype)}};function OV(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=Or(i,a.shape),c=u,l=Vp(c,s),d=null!=l,p=n.shouldExecuteOnCPU([a]),h=a;if(d){if(p){for(var f=n.texData.get(h.dataId).values,v=new Array(s),m=0;m<v.length;m++)v[m]=a.shape[l[m]];var g=jL(f,a.shape,a.dtype,l,v);h=n.makeTensorInfo(v,a.dtype),n.texData.get(h.dataId).values=g}else h=QM(a,l,n);c=Up(c.length,s)}Bp("max",c,s);var y,b=H(zp(h.shape,c),2),x=b[0],k=b[1],w=x;if(o&&(w=Pp(x,u)),p){var C=n.texData.get(h.dataId).values,S=mL(C,Nr(k),w,a.dtype);y=n.makeTensorInfo(w,a.dtype),n.texData.get(y.dataId).values=S}else y=function(e,t,n,r){var a=Nr(t),i=HM({inputs:{x:e},attrs:{shape:[Nr(e.shape)/a,a]},backend:r}),o=XM(i,e.dtype,"max",r),s=HM({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(h,k,w,n);return d&&n.disposeIntermediateTensorInfo(h),y}var FV={kernelName:zi,backendName:"webgl",kernelFunc:OV},DV=MM({opSnippet:xM+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+wM+"\n  return result;\n",cpuKernelImpl:gL}),LV={kernelName:Pi,backendName:"webgl",kernelFunc:DV};var MV={kernelName:Bi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;uD(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;wr(Vd(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Rd(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&Ir(c.inShape,c.outShape))return SM({inputs:{x:a},backend:n});var l=new Mz(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var zV={kernelName:Wi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=Ad(a.shape,i,o,[1,1,1],s,c,u),d=new zz(l,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}},PV=L((function e(t){A(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),BV=L((function e(t){A(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,d=u-1-t.padInfo.front,p=c-1-t.padInfo.top,h=l-1-t.padInfo.left,f=u*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(p,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var VV={kernelName:Ui,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Ad(i.shape,o,s,[1,1,1],u,c),d=new zz(l,"max",!0),p=n.runWebGLProgram(d,[i],i.dtype),h=new BV(l),f=n.runWebGLProgram(h,[a,p],i.dtype);return n.disposeIntermediateTensorInfo(p),f}};var WV={kernelName:Vi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;uD([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,d=Rd(o.shape,s,u,1,c,l),p=new Mz(d,"max",!0),h=n.runWebGLProgram(p,[o],o.dtype),f=new PV(d),v=n.runWebGLProgram(f,[a,h],o.dtype);return n.disposeIntermediateTensorInfo(h),v}};var UV={kernelName:ji,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;wr(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];wr(Vd(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var d=Rd(a.shape,i,o,l,s),p=function(e,t,n,r){var a=new Mz(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new Mz(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,d,c),h=H(p,2);return[h[0],h[1]]}};var jV={kernelName:Hi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=Or(o,a.shape),l=c,d=Vp(l,u),p=null!=d,h=s.shouldExecuteOnCPU([a]),f=[],v=a;if(p){if(h){for(var m=s.texData.get(v.dataId).values,g=new Array(u),y=0;y<g.length;y++)g[y]=a.shape[d[y]];var b=jL(m,a.shape,a.dtype,d,g);v=s.makeTensorInfo(g,a.dtype),s.texData.get(v.dataId).values=b}else v=QM(a,d,s);f.push(v),l=Up(l.length,u)}Bp("sum",l,u);var x=H(zp(v.shape,l),2),k=x[0],w=x[1],C=k;i&&(C=Pp(k,c));for(var S=function(e,t,n,r){var a=Nr(t),i=HM({inputs:{x:e},attrs:{shape:[Nr(e.shape)/a,a]},backend:r}),o=XM(i,"float32","mean",r),s=HM({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(v,w,C,s),N=0,I=f;N<I.length;N++){var T=I[N];s.disposeIntermediateTensorInfo(T)}return S}};var HV={kernelName:Gi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=Or(i,a.shape),c=u,l=Vp(c,s),d=a;null!=l&&(d=ez({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Up(c.length,a.shape.length)),Bp("min",c,s);var p,h=H(zp(d.shape,c),2),f=h[0],v=HM({inputs:{x:d},backend:n,attrs:{shape:[-1,Nr(h[1])]}}),m=XM(v,v.dtype,"min",n);return p=HM(o?{inputs:{x:m},backend:n,attrs:{shape:Pp(f,u)}}:{inputs:{x:m},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(d),p}},GV=MM({opSnippet:xM+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+wM+"\n  return result;\n",cpuKernelImpl:yL}),qV={kernelName:qi,backendName:"webgl",kernelFunc:GV},KV=L((function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=ID(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),XV=L((function e(t,n,r){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=ID(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=qL("rc",a),c=qL("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),p="reflect"===r?0:1,h="";if(1===a){var f="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(p,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(p,";\n        }\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(f,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(f,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(p,") +\n                gte * ((end - 1) * 2 - source + ").concat(p,");\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")})),ZV={kernelName:Ki,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XV(a.shape,i,o):new KV(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},YV=MM({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+wM+"\n  return result;\n"}),QV={kernelName:Xi,backendName:"webgl",kernelFunc:YV},JV=L((function e(t,n,r){A(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),$V=MM({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),eW={kernelName:ti,backendName:"webgl",kernelFunc:$V},tW="return a - b;",nW=MM({opSnippet:tW,packedOpSnippet:tW,supportsComplex:!0,cpuKernelImpl:VL}),rW={kernelName:Jo,backendName:"webgl",kernelFunc:nW};function aW(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=Or([r.dim],a.shape),o=OV({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=Pp(o.shape,i),u=HM({inputs:{x:o},backend:n,attrs:{shape:s}}),c=nW({inputs:{a:a,b:u},backend:n}),l=CB({inputs:{x:c},backend:n}),d=JM({inputs:{x:l},backend:n,attrs:{axis:i,keepDims:!1}}),p=HM({inputs:{x:d},backend:n,attrs:{shape:s}}),h=$V({inputs:{a:l,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),h}var iW={kernelName:Vo,backendName:"webgl",kernelFunc:aW};var oW={kernelName:Zi,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:aW({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],d=new JV(c,l,i),p=[[o]],h=n.runWebGLProgram(d,[u],"int32",p);return s||n.disposeIntermediateTensorInfo(u),h}},sW=eM+"\n  return -x;\n",uW="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";var cW={kernelName:Qi,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=H(xL(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=na().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new hM(a.shape,uW):new $L(a.shape,sW),r.runWebGLProgram(t,[a],a.dtype)}},lW=Hv;var dW={kernelName:$i,backendName:"webgl",kernelFunc:function(e){vs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),d=lW(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},pW=Gv;var hW={kernelName:eo,backendName:"webgl",kernelFunc:function(e){vs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),d=n.readSync(i.dataId),p=pW(l,d,o,s,u,c),h=p.selectedIndices,f=p.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},fW=qv;var vW={kernelName:to,backendName:"webgl",kernelFunc:function(e){vs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),d=n.readSync(i.dataId),p=fW(l,d,o,s,u,c),h=p.selectedIndices,f=p.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([f.length],"float32",new Float32Array(f))]}},mW=L((function e(t,n,r,a){A(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),gW={kernelName:ro,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue,c=Nr(a.shape),l=new mW(c,o,s,u),d=HM({inputs:{x:a},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(l,[d],i);n.disposeIntermediateTensorInfo(d);var h=HM({inputs:{x:p},backend:n,attrs:{shape:[].concat(R(a.shape),[o])}});return n.disposeIntermediateTensorInfo(p),h}};function yW(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=aP({inputs:{input:r},backend:n}),i=yW({inputs:{x:a},backend:n}),o=xP({inputs:{input:r},backend:n}),s=yW({inputs:{x:o},backend:n}),u=IM({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return DB({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var bW={kernelName:us,backendName:"webgl",kernelFunc:yW};var xW={kernelName:no,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=aP({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=xP({inputs:{input:a},backend:r}),u=yW({inputs:{x:s},backend:r}),c=IM({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return DB({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var kW={kernelName:ao,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return NB({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Cr(a,e.shape,"All tensors passed to stack must have matching shapes"),wr(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=CP({inputs:t.map((function(e){var t=NB({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}},wW=L((function e(t,n,r){A(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=ID(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),CW=L((function e(t,n,r){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=ID(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=qL("rc",a),c=qL("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),p=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",v=0,m=1===a?2:4;v<m;v++)f+="\n        ".concat(p[v],"\n        if (").concat(h,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(c.join(),"), ").concat(d,");\n        }\n      ");f+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")})),SW=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===Nr(a.shape)){var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return DB({backend:n,attrs:{shape:s,value:o,dtype:a.dtype}})}var u=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CW(a.shape,i,o):new wW(a.shape,i,o),c=[[o]];return n.runWebGLProgram(u,[a],a.dtype,c)},NW={kernelName:io,backendName:"webgl",kernelFunc:SW},IW=MM({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+wM+"\n  return result;\n"}),TW={kernelName:oo,backendName:"webgl",kernelFunc:IW};var EW={kernelName:uo,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],l=Or(o,i.shape),d=l,p=Vp(d,u),h=i;if(null!=p&&(h=ez({inputs:{x:i},backend:r,attrs:{perm:p}}),d=Up(d.length,u),c.push(h)),Bp("prod",d,u),r.shouldExecuteOnCPU([h])){var f=r.texData.get(h.dataId).values,v=wL(h.shape,h.dtype,f,d),m=v.outVals,g=v.outShape,y=v.outDtype;t=r.makeTensorInfo(g,y,m)}else{var b=H(zp(h.shape,d),2),x=b[0],k=Nr(b[1]),w=HM({inputs:{x:h},backend:r,attrs:{shape:[-1,k]}}),C=XM(w,fu(i.dtype),"prod",r);t=HM({inputs:{x:C},backend:r,attrs:{shape:x}}),c.push(w),c.push(C)}if(s){c.push(t);var S=Pp(t.shape,l);t=HM({inputs:{x:t},backend:r,attrs:{shape:S}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var _W={kernelName:co,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=r.outputRaggedRank,u=a.map((function(e){return n.readSync(e.dataId)})),c=a.map((function(e){return e.shape})),l=n.readSync(i.dataId),d=n.readSync(o.dataId),p=H(CL(u,c,l,i.shape,i.dtype,d,o.shape,s),3),h=p[0],f=p[1],v=p[2],m=h.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),g=n.makeTensorInfo(v,i.dtype,f);return m.concat([g])}};var RW={kernelName:lo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=H(SL(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),l=c[0],d=c[1];return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([d.length],r.dtype,d)]}};var AW={kernelName:po,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.readSync(a.dataId),l=n.readSync(i.dataId),d=n.readSync(o.dataId),p=s.map((function(e){return n.readSync(e.dataId)})),h=s.map((function(e){return e.shape})),f=H(NL(c,a.shape,l,i.shape,i.dtype,d,o.shape,p,h,u),2),v=f[0],m=f[1];return n.makeTensorInfo(v,i.dtype,m)}},OW=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=IL(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},FW={kernelName:ho,backendName:"webgl",kernelFunc:OW},DW=LM({opSnippet:"return 1.0 / x;"}),LW={kernelName:vo,backendName:"webgl",kernelFunc:DW},MW=LM({opSnippet:eM+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),zW={kernelName:mo,backendName:"webgl",kernelFunc:MW},PW=LM({opSnippet:eM+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),BW={kernelName:wo,backendName:"webgl",kernelFunc:PW},VW=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.outputShape=[];var o=H(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var d,p=[a&&n>1?u-1:u,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/h[0],",\n          ").concat(p[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),WW=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=H(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var d,p=[a&&n>1?u-1:u,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/h[0],",\n          ").concat(p[1]/h[1],",\n          ").concat(p[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var UW={kernelName:xo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=H(r.size,2),u=s[0],c=s[1],l=na().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new WW(a.shape,u,c,i,o):new VW(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],"float32")}},jW=L((function e(t,n,r){A(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=H(n,3),i=a[1],o=a[2],s=H(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],d=[r&&u>1?u-1:u,r&&c>1?c-1:c],p=l[0]/d[0],h=l[1]/d[1],f=1/p,v=1/h,m=2*Math.ceil(f)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(h,");\n\n        const float invHeightScale = float(").concat(f,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var HW={kernelName:ko,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new jW(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},GW=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.outputShape=[];var o=H(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var d,p=[a&&n>1?u-1:u,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r],f=a?"0.5":"0.0";d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/h[0],",\n          ").concat(p[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(f,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),qW=L((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=H(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var d,p=[a&&n>1?u-1:u,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r],f=a?"0.5":"0.0";d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/h[0],",\n          ").concat(p[1]/h[1],",\n          ").concat(p[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(f,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var KW={kernelName:yo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=H(r.size,2),u=s[0],c=s[1],l=na().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qW(a.shape,u,c,i,o):new GW(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],a.dtype)}},XW=L((function e(t,n,r){A(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=H(n,3),i=a[1],o=a[2],s=H(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],d=[r&&u>1?u-1:u,r&&c>1?c-1:c],p=l[0]/d[0],h=l[1]/d[1],f=1/p,v=1/h,m=2*Math.ceil(f)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(h,");\n\n        const float invHeightScale = float(").concat(f,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(d[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(d[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var ZW={kernelName:bo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new XW(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},YW=L((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=ID(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),QW=L((function e(t,n){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=qL("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=ID(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var JW={kernelName:Co,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=Or(i,a.shape);if(0===o)return SM({inputs:{x:a},backend:n});var u=na().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QW(a.shape,s):new YW(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},$W=L((function e(t,n){A(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),eU={kernelName:ds,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new $W(a.shape,o),l=H(qm(s,a.shape[1],a.shape[2]),2),d=[[l[0],l[1],Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(c,[a],a.dtype,d)}},tU=LM({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),nU={kernelName:So,backendName:"webgl",kernelFunc:tU},rU=LM({opSnippet:"return inversesqrt(x);",cpuKernelImpl:TL}),aU={kernelName:No,backendName:"webgl",kernelFunc:rU},iU=L((function e(t,n,r,a,i,o){A(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=ID(i.length),u=ID(o.length),c="";1===r?c="i":2===r&&(c="i, j");var l="getIndices(".concat(c,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var p="getUpdates(".concat(d,")"),h=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(h,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}));var oU={kernelName:Io,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=hv(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,d=s.strides,p=s.outputSize,h=[p/l,l];if(0===p)return n.makeTensorInfo(o,a.dtype);var f=HM({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),v=HM({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new iU(c,u,f.shape.length,v.shape.length,d,h),y=n.runWebGLProgram(g,[v,f,m],v.dtype),b=HM({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}},sU=L((function e(t,n,r,a){A(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===na().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var uU={kernelName:To,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=new sU(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}},cU=L((function e(t,n,r){var a,i;if(A(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=ID(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var lU={kernelName:Eo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new cU(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],hu(a.dtype,i.dtype))}},dU=LM({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat($m,";\n  float scale = ").concat(eg,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),pU={kernelName:_o,backendName:"webgl",kernelFunc:dU},hU=LM({opSnippet:DM+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:_L}),fU={kernelName:Do,backendName:"webgl",kernelFunc:hU},vU=LM({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),mU={kernelName:Fo,backendName:"webgl",kernelFunc:vU},gU=LM({opSnippet:DM+"\n  return sin(x);\n"}),yU={kernelName:Ao,backendName:"webgl",kernelFunc:gU},bU=LM({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),xU={kernelName:Oo,backendName:"webgl",kernelFunc:bU},kU=LM({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),wU={kernelName:Lo,backendName:"webgl",kernelFunc:kU},CU={kernelName:Po,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;wr(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,R(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],d=SW({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),p=Km(d.shape,i,s,!1),h=Xm(p.length,i.length,!1),f=Zm(d.shape,i,s,!1),v=HM({inputs:{x:d},backend:n,attrs:{shape:p}}),m=ez({inputs:{x:v},backend:n,attrs:{perm:h}}),g=HM({inputs:{x:m},backend:n,attrs:{shape:f}});return l.push(d),l.push(v),l.push(m),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var SU={kernelName:Wo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],d=H(OL(s,r.shape,r.dtype,u,a.dtype,c,l),5),p=d[0],h=d[1],f=d[2],v=d[3],m=d[4];return[n.makeTensorInfo(h,r.dtype,p),n.makeTensorInfo([h[0]],a.dtype,f),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};var NU={kernelName:Uo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),c=H(FL(s,r.shape,r.dtype,o,u),3),l=c[0],d=c[1],p=c[2];return[n.makeTensorInfo(d,r.dtype,l),n.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}};var IU={kernelName:jo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=H(DL(o,r.shape,r.dtype,s,u,!0),2),l=c[0],d=c[1];return n.makeTensorInfo(d,r.dtype,l)}};var TU={kernelName:Ho,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=H(DL(o,r.shape,r.dtype,s,u),2),l=c[0],d=c[1];return n.makeTensorInfo(d,r.dtype,l)}};var EU={kernelName:Go,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=hv(0,a,s),c=u.sliceRank,l=u.numUpdates,d=u.sliceSize,p=u.strides,h=u.outputSize;if("string"===i.dtype){var f=n.bufferSync(a),v=n.bufferSync(i),m=Us(n.readSync(o.dataId)[0]),g=EL(f,v,s,h,d,l,c,p,m,false);return n.makeTensorInfo(s,g.dtype,g.values)}var y=new iU(l,c,a.shape.length,i.shape.length,p,[h,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),x=HM({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(b),x}};var _U={kernelName:Bo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=Or(r.axis,a.shape)[0],s=kg(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=R(l);t[o]=e;var r=Qz({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},RU="return sqrt(x);",AU=LM({opSnippet:RU,packedOpSnippet:RU,cpuKernelImpl:LL}),OU={kernelName:Mo,backendName:"webgl",kernelFunc:AU},FU={kernelName:Ko,backendName:"webgl",kernelFunc:LM({opSnippet:"return x * x;"})},DU="return (a - b) * (a - b);",LU=MM({opSnippet:DU,packedOpSnippet:DU}),MU={kernelName:qo,backendName:"webgl",kernelFunc:LU};var zU={kernelName:cs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=eM+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new $L(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},PU=L((function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=ID(r.length),o=ID(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var BU={kernelName:Xo,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,d=a.ellipsisMask,p=a.newAxisMask,h=a.shrinkAxisMask,f=vd(i.shape,o,s,u,c,l,d,p,h),v=f.finalShapeSparse,m=f.finalShape,g=f.isIdentity,y=f.sliceDim0,b=f.isSimpleSlice,x=f.begin,k=f.end,w=f.strides;if(g)t=HM({inputs:{x:i},backend:r,attrs:{shape:m}});else if(y||b){wr(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var C=dd(x,k,w),S=Qz({inputs:{x:i},backend:r,attrs:{begin:x,size:C}});t=HM({inputs:{x:S},backend:r,attrs:{shape:m}}),r.disposeIntermediateTensorInfo(S)}else{if(r.shouldExecuteOnCPU([i])){var N=r.readSync(i.dataId),I=Kc(i.shape,i.dtype,N),T=ML(v,I,w,x);t=r.makeTensorInfo(m,i.dtype,T.values)}else{var E=new PU(x,w,v);t=r.runWebGLProgram(E,[i],i.dtype)}}var _=HM({inputs:{x:t},backend:r,attrs:{shape:m}});return r.disposeIntermediateTensorInfo(t),_}};var VU={kernelName:Zo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,d=t.dataSplits,p=n.readSync(l.dataId),h=n.readSync(d.dataId),f=H(zL(p,h,a,i,o,s,u,c),2),v=f[0],m=f[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(d.shape,"int32",m)]}};var WU={kernelName:Yo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=n.readSync(a.dataId),s=n.readSync(i.dataId)[0],u=H(PL(o,s,r),3),c=u[0],l=u[1],d=u[2],p=l.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var UU={kernelName:Qo,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=BL(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},jU=LM({opSnippet:"return tan(x);"}),HU={kernelName:$o,backendName:"webgl",kernelFunc:jU},GU=LM({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),qU={kernelName:es,backendName:"webgl",kernelFunc:GU},KU=L((function e(t,n){A(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=ID(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function XU(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),s="string"===a.dtype?o.map((function(e){return Us(e)})):o,u=Kc(a.shape,a.dtype,s),c=WL(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new KU(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var ZU={kernelName:ts,backendName:"webgl",kernelFunc:XU},YU=L((function e(t){A(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),QU=L((function e(t){A(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function JU(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function $U(e){for(var t=1;t<e;)t*=2;return t}var ej={kernelName:ns,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=na().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=na().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([a])||l<s||i>u){var d=n.readSync(a.dataId),p=H(UL(d,c,a.dtype,i,o),2),h=p[0],f=p[1];return[n.makeTensorInfo(h.shape,h.dtype,h.values),n.makeTensorInfo(f.shape,f.dtype,f.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===l)return[a,DB({attrs:{shape:c,dtype:"int32",value:0},backend:n})];var v=n.texData.get(a.dataId),m=null!==v&&v.isPacked,g=m?n.unpackTensor(a):a,y=Nr(c)/l,b=HM({inputs:{x:g},attrs:{shape:[y,l]},backend:n});m&&JU(n,g);for(var x=$U(i),k=$U(l),w=null,C=function(){return null===w?[b,b]:[b,w]},S=function(e,t,r){var a=C(),i=new YU(r),o=[[l],[null===w?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=w;w=n.runWebGLProgram(i,a,"int32",o),JU(n,s)},N=1;N<x;N*=2)for(var I=2*N,T=N;T>=1;T/=2)S(I,T,[y,k]);for(var E=k;E>x;E/=2){var _=C(),R=new QU([y,E/2]),A=[[l],[null===w?1:0],[x]],O=w;w=n.runWebGLProgram(R,_,"int32",A),JU(n,O);for(var F=x/2,D=2*F,L=F;L>=1;L/=2)S(D,L,w.shape)}var M=w;w=Qz({inputs:{x:w},backend:n,attrs:{begin:0,size:[y,i]}}),JU(n,M);var z=$B({inputs:{x:b,indices:w},backend:n,attrs:{axis:1,batchDims:1}});JU(n,b);var P=c.slice(0,-1);P.push(i),M=w,w=HM({inputs:{x:w},attrs:{shape:P},backend:n}),JU(n,M);var B=z;return z=HM({inputs:{x:z},attrs:{shape:P},backend:n}),JU(n,B),[z,w]}},tj=L((function e(t,n,r,a,i,o){A(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var nj={kernelName:rs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,c=r.outputShape,l=H(a.shape,4),d=l[0],p=l[1],h=l[2],f=l[3],v=H(null!=c?c:[p,h],2),m=v[0],g=v[1],y=new tj(p,h,o,s,u,[d,m,g,f]);return n.runWebGLProgram(y,[a,i],"float32")}};var rj={kernelName:is,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;uD(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=HL(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var aj={kernelName:os,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,d=0;d<s;d++)d!==i&&(c[l++]=o.shape[d]);var p=[],h=new Array(s).fill(0),f=o.shape.slice();f[i]=1;for(var v=new Array(u),m=0;m<v.length;m++){h[i]=m;var g=Qz({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),y=HM({inputs:{x:g},backend:n,attrs:{shape:c}});v[m]=y,p.push(g)}return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},ij=L((function e(t,n){A(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var oj={kernelName:ss,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=Vp([c],s),d=a;null!=l&&(d=ez({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(d),c=Up(1,s)[0]);var p=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(d.shape,c,o),h=Nr([d.shape[c]]),f=HM({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});u.push(f);var v=function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=function(e,t){var n,r=!1;for(e<=Hm?(n=e,r=!0):n=Ur(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Ur(e,n+1);return n}(c,o),d=new ij({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),p=n.compileAndRun(d,[t,a],i);if(u.push(p),p.shape[1]===o)return p;var h=OW({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),f=XU({inputs:{x:h},backend:n,attrs:{reps:[c/l]}});return u.push(h),u.push(f),e(p,r,f,i,o)}(f,"unsortedSegmentSum",i,fu(a.dtype),o),m=HM({inputs:{x:v},backend:n,attrs:{shape:p}}),g=m;if(null!=l){u.push(m);var y=Wp(l);g=ez({inputs:{x:g},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},sj=0,uj=[az,oz,uz,lz,hz,mz,gz,yz,Sz,Nz,Tz,_z,Az,Fz,Lz,Pz,Bz,Uz,jz,Hz,Kz,$z,eP,tP,sP,lP,hP,TM,mP,SP,OP,zP,PP,BP,VP,UP,HP,qP,XP,$P,eB,tB,rB,oB,cB,lB,pB,fB,vB,gB,yB,xB,wB,SB,IB,_B,OB,MB,PB,WB,jB,qB,XB,ZB,QB,eV,nV,aV,NM,iV,kP,sV,cV,dV,RM,hV,vV,mV,yV,xV,wV,SV,IV,_V,AV,FV,LV,MV,zV,VV,WV,UV,jV,HV,qV,ZV,QV,oW,jM,cW,dW,hW,vW,rP,gW,xW,kW,NW,TW,FM,EW,_W,RW,AW,FW,iP,eW,LW,zW,BW,GM,UW,HW,KW,ZW,JW,eU,nU,aU,oU,uU,lU,pU,fU,mU,yU,xU,Jz,iW,wU,CU,SU,NU,IU,TU,EU,_U,OU,FU,MU,zU,BU,VU,WU,UU,rW,$M,HU,qU,ZU,ej,nj,tz,rj,aj,oj,bW];sj<uj.length;sj++){ks(uj[sj])}var cj=n(7948),lj=n.n(cj),dj={1:{name:"hello",color:"red"},2:{name:"thanks",color:"yellow"},3:{name:"name",color:"lime"},4:{name:"good",color:"blue"},5:{name:"luck",color:"red"},6:{name:"bad",color:"yellow"},7:{name:"meet",color:"lime"},8:{name:"you",color:"blue"},9:{name:"morning",color:"red"},10:{name:"afternoon",color:"yellow"},11:{name:"how",color:"lime"}},pj={1:{name:"step",color:"red"},2:{name:"mother",color:"yellow"},3:{name:"father",color:"lime"},4:{name:"son",color:"blue"},5:{name:"daughter",color:"red"},6:{name:"brother",color:"yellow"},7:{name:"sister",color:"lime"},8:{name:"baby",color:"blue"},9:{name:"home",color:"red"},10:{name:"my",color:"yellow"},11:{name:"your",color:"lime"}},hj=function(e,t,n,r,a,i,o,s){for(var u=0;u<=e.length;u++)if(n[u]>r&&e[u]&&t[u]){var c=H(e[u],4),l=c[0],d=c[1],p=c[2],h=c[3],f=t[u];s(dj[f].name),o.strokeStyle=dj[f].color,o.lineWidth=4,o.fillStyle="white",o.font="30px Arial",o.beginPath(),o.fillText(dj[f].name+" - "+Math.round(100*n[u])/100,d*a,l*i-10),o.rect(d*a,l*i,h*a/2,p*i/2),o.stroke()}},fj=function(e,t,n,r,a,i,o,s,u,c){for(var l=0;l<=e.length;l++)if(n[l]>r&&e[l]&&t[l]){var d=H(e[l],4),p=d[0],h=d[1],f=d[2],v=d[3],m=t[l];console.log(m),s(dj[m].name),o.strokeStyle=dj[m].color,o.lineWidth=4,o.fillStyle="white",o.font="30px Arial",o.beginPath(),o.fillText(dj[m].name+" - "+Math.round(100*n[l])/100,h*a,p*i-10),o.rect(h*a,p*i,v*a/2,f*i/2),o.stroke()}},vj=function(e,t,n,r,a,i,o,s,u,c){for(var l=0;l<=e.length;l++)if(n[l]>r&&e[l]&&t[l]){var d=H(e[l],4),p=d[0],h=d[1],f=d[2],v=d[3],m=t[l];s(pj[m].name),o.strokeStyle=pj[m].color,o.lineWidth=4,o.fillStyle="white",o.font="30px Arial",o.beginPath(),o.fillText(pj[m].name+" - "+Math.round(100*n[l])/100,h*a,p*i-10),o.rect(h*a,p*i,v*a/2,f*i/2),o.stroke()}},mj={container:"quiz_container__sKZR-","course-details":"quiz_course-details__monhh","course-heading":"quiz_course-heading__8NErm","question-count":"quiz_question-count__USDUw","header-container":"quiz_header-container__U4Pa5","question-section":"quiz_question-section__liOWZ","button-1":"quiz_button-1__JJEc6","button-2":"quiz_button-2__qaecR","camera-view":"quiz_camera-view__Na+zH",webcam:"quiz_webcam__gsprp","skip-button":"quiz_skip-button__Rzbec","leave-section":"quiz_leave-section__KsxOA","leave-button":"quiz_leave-button__NDZTo","results-section":"quiz_results-section__x3WSY",score:"quiz_score__8ki8T"};function gj(){var e=qe(),t=H((0,S.useState)(0),2),n=t[0],r=t[1],a=H((0,S.useState)(0),2),i=a[0],o=a[1],s=H((0,S.useState)(!1),2),u=(s[0],s[1]),c=H((0,S.useState)(""),2),l=c[0],d=c[1],p=(0,S.useRef)(null),h=(0,S.useRef)(null);(0,S.useEffect)((function(){l===v[i].answers?(u(!0),r(n+1),o(i+1)):u(!1)}),[l]);var f=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TI("https://raw.githubusercontent.com/dp846/SlingoModels/main/model.json");case 2:t=e.sent,setInterval((function(){m(t)}),16.7);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=[{questionText:"Sign: Hello",answers:"hello"},{questionText:"Sign: Thanks",answers:"thanks"},{questionText:"Sign: Good",answers:"good"},{questionText:"Sign: Afternoon",answers:"afternoon"},{questionText:"Sign: Meet",answers:"meet"},{questionText:"Sign: You",answers:"you"},{questionText:"Sign: How",answers:"how"},{questionText:"Sign: Bad",answers:"bad"}],m=function(){var e=mt(ft().mark((function e(t){var n,r,a,o,s,c,l,f,m,g,y,b;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof p.current||null===p.current||4!==p.current.video.readyState){e.next=31;break}return n=p.current.video,r=p.current.video.videoWidth,a=p.current.video.videoHeight,p.current.video.width=r,p.current.video.height=a,h.current.width=r,h.current.height=a,o=sd(n),s=Fm.resizeBilinear(o,[640,480]),c=s.cast("int32"),l=c.expandDims(0),e.next=14,t.executeAsync(l);case 14:return f=e.sent,e.next=17,f[2].array();case 17:return m=e.sent,e.next=20,f[4].array();case 20:return g=e.sent,e.next=23,f[7].array();case 23:y=e.sent,b=h.current.getContext("2d"),requestAnimationFrame((function(){fj(m[0],g[0],y[0],.65,r,a,b,d,u,v[i].answers)})),el(o),el(s),el(c),el(l),el(f);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,S.useEffect)((function(){f()}),[]),i!==v.length?(0,ct.jsxs)("div",{className:mj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:mj["course-details"],children:[(0,ct.jsx)("p",{className:mj["course-heading"],children:"Greetings - test"}),(0,ct.jsxs)("p",{className:mj["question-count"],children:["Question ",i+1," of ",v.length]})]}),(0,ct.jsxs)("div",{className:mj["header-container"],children:[(0,ct.jsx)("div",{className:mj["question-section"],children:(0,ct.jsx)("div",{className:mj["question-text"],children:(0,ct.jsx)("p",{children:v[i].questionText})})}),(0,ct.jsx)("div",{className:mj["answer-section"]})]}),(0,ct.jsxs)("div",{className:mj["camera-view"],children:[(0,ct.jsxs)("div",{className:mj.webcam,children:[(0,ct.jsx)(hr(),{ref:p,muted:!0}),(0,ct.jsx)("canvas",{ref:h,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:8,width:640,height:480}})]}),(0,ct.jsx)("button",{className:mj["skip-button"],onClick:function(){return o(i+1)},children:"Skip \u2192"})]}),(0,ct.jsx)("div",{className:mj["leave-section"],children:(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:mj["leave-button"],children:"Leave session"})})]}):(0,ct.jsxs)("div",{className:mj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:mj["course-details"],children:[(0,ct.jsx)("p",{className:mj["course-heading"],children:"Greetings - test"}),(0,ct.jsx)("p",{className:mj["question-count"],children:"You have completed the test"})]}),(0,ct.jsxs)("div",{className:mj["header-container"],children:[(0,ct.jsx)("div",{className:mj["results-section"],children:(0,ct.jsx)("div",{className:mj.score,children:(0,ct.jsxs)("p",{children:["You got ",n," / ",v.length," correct."]})})}),(0,ct.jsx)("div",{className:mj["leave-section"],children:(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:mj["leave-button"],children:"Leave session"})})]})]})}function yj(){var e=qe(),t=H((0,S.useState)(0),2),n=t[0],r=t[1],a=H((0,S.useState)(0),2),i=a[0],o=a[1],s=H((0,S.useState)(!1),2),u=(s[0],s[1]),c=H((0,S.useState)(""),2),l=c[0],d=c[1],p=(0,S.useRef)(null),h=(0,S.useRef)(null);(0,S.useEffect)((function(){l===v[i].answers?(u(!0),r(n+1),o(i+1)):u(!1)}),[l]);var f=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TI("https://raw.githubusercontent.com/dp846/SlingoModels/main/family_v1/model.json");case 2:t=e.sent,setInterval((function(){m(t)}),16.7);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=[{questionText:"Sign: Step",answers:"step"},{questionText:"Sign: Father",answers:"father"},{questionText:"Sign: Mother",answers:"mother"},{questionText:"Sign: Brother",answers:"brother"},{questionText:"Sign: Your",answers:"your"},{questionText:"Sign: Baby",answers:"baby"},{questionText:"Sign: Sister",answers:"sister"},{questionText:"Sign: Son",answers:"son"}],m=function(){var e=mt(ft().mark((function e(t){var n,r,a,o,s,c,l,f,m,g,y,b;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof p.current||null===p.current||4!==p.current.video.readyState){e.next=31;break}return n=p.current.video,r=p.current.video.videoWidth,a=p.current.video.videoHeight,p.current.video.width=r,p.current.video.height=a,h.current.width=r,h.current.height=a,o=sd(n),s=Fm.resizeBilinear(o,[640,480]),c=s.cast("int32"),l=c.expandDims(0),e.next=14,t.executeAsync(l);case 14:return f=e.sent,e.next=17,f[3].array();case 17:return m=e.sent,e.next=20,f[7].array();case 20:return g=e.sent,e.next=23,f[4].array();case 23:y=e.sent,b=h.current.getContext("2d"),requestAnimationFrame((function(){vj(m[0],g[0],y[0],.65,r,a,b,d,u,v[i].answers)})),el(o),el(s),el(c),el(l),el(f);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,S.useEffect)((function(){f()}),[]),i!==v.length?(0,ct.jsxs)("div",{className:mj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:mj["course-details"],children:[(0,ct.jsx)("p",{className:mj["course-heading"],children:"Family - test"}),(0,ct.jsxs)("p",{className:mj["question-count"],children:["Question ",i+1," of ",v.length]})]}),(0,ct.jsxs)("div",{className:mj["header-container"],children:[(0,ct.jsx)("div",{className:mj["question-section"],children:(0,ct.jsx)("div",{className:mj["question-text"],children:(0,ct.jsx)("p",{children:v[i].questionText})})}),(0,ct.jsx)("div",{className:mj["answer-section"]})]}),(0,ct.jsxs)("div",{className:mj["camera-view"],children:[(0,ct.jsxs)("div",{className:mj.webcam,children:[(0,ct.jsx)(hr(),{ref:p,muted:!0}),(0,ct.jsx)("canvas",{ref:h,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:8,width:640,height:480}})]}),(0,ct.jsx)("button",{className:mj["skip-button"],onClick:function(){return o(i+1)},children:"Skip \u2192"})]}),(0,ct.jsx)("div",{className:mj["leave-section"],children:(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:mj["leave-button"],children:"Leave session"})})]}):(0,ct.jsxs)("div",{className:mj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:mj["course-details"],children:[(0,ct.jsx)("p",{className:mj["course-heading"],children:"Family - test"}),(0,ct.jsx)("p",{className:mj["question-count"],children:"You have completed the test"})]}),(0,ct.jsxs)("div",{className:mj["header-container"],children:[(0,ct.jsx)("div",{className:mj["results-section"],children:(0,ct.jsx)("div",{className:mj.score,children:(0,ct.jsxs)("p",{children:["You got ",n," / ",v.length," correct."]})})}),(0,ct.jsx)("div",{className:mj["leave-section"],children:(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:mj["leave-button"],children:"Leave session"})})]})]})}var bj={container:"translate_container__ZZDVG","camera-view":"translate_camera-view__WhQ9I",webcam:"translate_webcam__-0iGZ","results-container":"translate_results-container__sfIUp","results-container-content":"translate_results-container-content__f2I0Z","clear-output-container":"translate_clear-output-container__PK4PI","clear-output-button":"translate_clear-output-button__GGEFK",results:"translate_results__dQjTG"};var xj=function(){var e=(0,S.useRef)(null),t=(0,S.useRef)(null),n=H((0,S.useState)(""),2),r=n[0],a=n[1],i=H((0,S.useState)(""),2),o=i[0],s=i[1];(0,S.useEffect)((function(){var e=setTimeout((function(){s(o+" "+r)}),1500);return function(){return clearTimeout(e)}}),[r]);var u=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TI("https://raw.githubusercontent.com/dp846/SlingoModels/main/model.json");case 2:t=e.sent,setInterval((function(){c(t)}),16.7);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var n=mt(ft().mark((function n(r){var i,o,s,u,c,l,d,p,h,f,v,m;return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("undefined"===typeof e.current||null===e.current||4!==e.current.video.readyState){n.next=31;break}return i=e.current.video,o=e.current.video.videoWidth,s=e.current.video.videoHeight,e.current.video.width=o,e.current.video.height=s,t.current.width=o,t.current.height=s,u=sd(i),c=Fm.resizeBilinear(u,[640,480]),l=c.cast("int32"),d=l.expandDims(0),n.next=14,r.executeAsync(d);case 14:return p=n.sent,n.next=17,p[2].array();case 17:return h=n.sent,n.next=20,p[4].array();case 20:return f=n.sent,n.next=23,p[7].array();case 23:v=n.sent,m=t.current.getContext("2d"),requestAnimationFrame((function(){hj(h[0],f[0],v[0],.65,o,s,m,a)})),el(u),el(c),el(l),el(d),el(p);case 31:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,S.useEffect)((function(){u()}),[]),(0,ct.jsxs)("div",{className:bj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsx)("div",{className:bj["results-container"],children:(0,ct.jsxs)("div",{className:bj["results-container-content"],children:[(0,ct.jsx)("div",{className:bj["clear-output-container"],children:(0,ct.jsx)("button",{className:bj["clear-output-button"],onClick:function(){s("")},children:"Clear output"})}),(0,ct.jsx)("p",{className:bj.results,children:o})]})}),(0,ct.jsx)("div",{className:bj["camera-view"],children:(0,ct.jsxs)("div",{className:bj.webcam,children:[(0,ct.jsx)(hr(),{ref:e,muted:!0}),(0,ct.jsx)("canvas",{ref:t,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:8,width:640,height:480}})]})})]})},kj=n(2168),wj={container:"learn_container__aCnYQ",title:"learn_title__wogG9","learn-title":"learn_learn-title__eIyFz","learn-text":"learn_learn-text__AKwrs","progress-bar":"learn_progress-bar__Fnk6Q","navigation-buttons":"learn_navigation-buttons__GCuy3","modal-container":"learn_modal-container__lfVNk","modal-content":"learn_modal-content__tBXnz","modal-header":"learn_modal-header__vhJLv","modal-sub-header":"learn_modal-sub-header__tkchv","modal-buttons":"learn_modal-buttons__dGSge","close-button":"learn_close-button__k+pCN"};function Cj(){var e=qe(),t=H((0,S.useState)(0),2),n=t[0],r=t[1],a=localStorage.getItem("userid");(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t,n,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://localhost:8080/api/progress/".concat(a),e.next=4,ir.get(t);case 4:n=e.sent,i=n.data,r(Math.round(i.overallProgress/22*100)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var i=H((0,S.useState)(!1),2),o=i[0],s=i[1],u=H((0,S.useState)(!1),2),c=u[0],l=u[1],d=function(){s(!1)},p=function(){l(!1)};return(0,ct.jsxs)("div",{className:wj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:wj.title,children:[(0,ct.jsx)("h1",{className:wj["learn-title"],children:"Learn"}),(0,ct.jsx)("p",{className:wj["learn-text"],children:"What do you want to learn today?"}),(0,ct.jsx)("div",{className:wj["progress-bar"],children:(0,ct.jsx)(kj.k,{width:600,height:18,text:"".concat(n,"% progress"),percent:n})})]}),(0,ct.jsxs)("div",{className:wj["navigation-buttons"],children:[(0,ct.jsx)("button",{onClick:function(){s(!0)},className:wj["greeting-button"],children:"Greetings"}),(0,ct.jsx)("button",{onClick:function(){l(!0)},className:wj["family-button"],children:"Family"}),(0,ct.jsx)("button",{className:wj["numbers-button"],children:"Basic Numbers"}),(0,ct.jsx)("button",{className:wj["weather-button"],children:"Weather"}),(0,ct.jsx)("button",{className:wj["travel-button"],children:"Travel and Transport"}),(0,ct.jsx)("button",{className:wj["directions-button"],children:"Giving Directions"})]}),(0,ct.jsxs)(lj(),{isOpen:o,onRequestClose:d,contentLabel:"Greetings Modal",className:wj["modal-container"],children:[(0,ct.jsx)("button",{className:wj["close-button"],onClick:d,children:"X"}),(0,ct.jsxs)("div",{className:wj["modal-content"],children:[(0,ct.jsx)("p",{className:wj["modal-header"],children:"Greetings section"}),(0,ct.jsx)("p",{className:wj["modal-sub-header"],children:"What do you want to do?"}),(0,ct.jsxs)("div",{className:wj["modal-buttons"],children:[(0,ct.jsx)("button",{onClick:function(){return e("/quiz")},children:"Test"}),(0,ct.jsx)("button",{onClick:function(){return e("/learnsign")},children:"Learn"}),(0,ct.jsx)("button",{onClick:function(){return e("/learninteractively")},children:"Learn interactively"})]})]})]}),(0,ct.jsxs)(lj(),{isOpen:c,onRequestClose:p,contentLabel:"Family Modal",className:wj["modal-container"],children:[(0,ct.jsx)("button",{className:wj["close-button"],onClick:p,children:"X"}),(0,ct.jsxs)("div",{className:wj["modal-content"],children:[(0,ct.jsx)("p",{className:wj["modal-header"],children:"Family section"}),(0,ct.jsx)("p",{className:wj["modal-sub-header"],children:"What do you want to do?"}),(0,ct.jsxs)("div",{className:wj["modal-buttons"],children:[(0,ct.jsx)("button",{onClick:function(){return e("/quiz2")},children:"Test"}),(0,ct.jsx)("button",{onClick:function(){return e("/learnsign2")},children:"Learn"})]})]})]})]})}var Sj={container:"learnSign_container__RF4kC",content:"learnSign_content__Srerh","slide-show":"learnSign_slide-show__vF4ue",previous:"learnSign_previous__0Dcz0",next:"learnSign_next__1G20E",description:"learnSign_description__FIWxZ","leave-button":"learnSign_leave-button__PRGJX"},Nj=n.p+"static/media/afternoon.f41d2840ad13f62d26c7.jpg",Ij=n.p+"static/media/bad.dd8505b6b5ff18112c75.jpg",Tj=n.p+"static/media/good.ab16f9c0b67b43593173.jpg",Ej=n.p+"static/media/hello.9ceccd6bd5bf3e884cd5.jpg",_j=n.p+"static/media/how.5ec77ccfa38fa0b4ad94.jpg",Rj=n.p+"static/media/luck.bbaf07b9d779b887cfa1.jpg",Aj=n.p+"static/media/meet.19c0ee883c245b36fe45.jpg",Oj=n.p+"static/media/morning.de79eae9b057ac96d17b.jpg",Fj=n.p+"static/media/name.fd275d411d49a054e196.jpg",Dj=n.p+"static/media/thanks.d5e3d0eefa4d71db728b.jpg",Lj=n.p+"static/media/you.7c03dae3144e4f064ab9.jpg";function Mj(){var e=qe(),t=H((0,S.useState)(!0),2),n=t[0],r=t[1],a=H((0,S.useState)([]),2),i=a[0],o=a[1],s=H((0,S.useState)(""),2),u=s[0],c=s[1];(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"http://localhost:8080/api/courses/greetings",e.next=4,ir.get("http://localhost:8080/api/courses/greetings");case 4:t=e.sent,n=t.data,o(n.course.signs),c(n.course.signs[0]._id),r(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var l=localStorage.getItem("userid"),d=H((0,S.useState)(0),2),p=d[0],h=d[1];(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://localhost:8080/api/progress/".concat(l,"/").concat(u),e.next=4,ir.post(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();e()}),[p]);var f=[{src:Nj,alt:"afternoon"},{src:Ij,alt:"bad"},{src:Tj,alt:"good"},{src:Ej,alt:"hello"},{src:_j,alt:"how"},{src:Rj,alt:"luck"},{src:Aj,alt:"meet"},{src:Oj,alt:"morning"},{src:Fj,alt:"name"},{src:Dj,alt:"thanks"},{src:Lj,alt:"you"}];if(!n)return(0,ct.jsxs)("div",{className:Sj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:Sj.content,children:[(0,ct.jsx)("h1",{className:Sj.title,children:i[p].name}),(0,ct.jsxs)("div",{className:Sj["slide-show"],children:[(0,ct.jsx)("button",{className:Sj.previous,onClick:function(){var e=0===p?f.length-1:p-1;h(e),c(i[e]._id)},children:"Previous"}),(0,ct.jsx)("img",{src:f[p].src,alt:f[p].alt}),(0,ct.jsx)("button",{className:Sj.next,onClick:function(){var e=(p+1)%f.length;h(e),c(i[e]._id)},children:"Next"})]}),(0,ct.jsx)("p",{className:Sj.description,children:i[p].description}),(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:Sj["leave-button"],children:"Leave session"})]})]})}var zj=n.p+"static/media/father.bc682d8e85f13601b019.jpg",Pj=n.p+"static/media/mother.005406dd7a7dee4521da.jpg",Bj=n.p+"static/media/son.9f24fd63fe017355c4ae.jpg",Vj=n.p+"static/media/daughter.84f5b2c379fec9815886.jpg",Wj=n.p+"static/media/brother.1b8890f7f0c7c40ccadd.jpg",Uj=n.p+"static/media/sister.d178f1f278853e948fb7.jpg",jj=n.p+"static/media/step.0d2985890b0ed706e4e7.jpg",Hj=n.p+"static/media/baby.551c738888ba2f68acc5.jpg",Gj=n.p+"static/media/home.70002a0ca4d870126b5f.jpg",qj=n.p+"static/media/my.a996c1b73da93f70d3cd.jpg",Kj=n.p+"static/media/your.ff9f36a7800a374765e6.jpg";function Xj(){var e=qe(),t=H((0,S.useState)(!0),2),n=t[0],r=t[1],a=H((0,S.useState)([]),2),i=a[0],o=a[1],s=H((0,S.useState)(""),2),u=s[0],c=s[1];(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"http://localhost:8080/api/courses/family",e.next=4,ir.get("http://localhost:8080/api/courses/family");case 4:t=e.sent,n=t.data,o(n.course.signs),c(n.course.signs[0]._id),r(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var l=localStorage.getItem("userid"),d=H((0,S.useState)(0),2),p=d[0],h=d[1];(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://localhost:8080/api/progress/".concat(l,"/").concat(u),e.next=4,ir.post(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();e()}),[p]);var f=[{src:zj,alt:"Father"},{src:Pj,alt:"Mother"},{src:Bj,alt:"Son"},{src:Vj,alt:"Daughter"},{src:Wj,alt:"Brother"},{src:Uj,alt:"Sister"},{src:jj,alt:"Step"},{src:Hj,alt:"Baby"},{src:Gj,alt:"Home"},{src:qj,alt:"My"},{src:Kj,alt:"Your"}];if(!n)return(0,ct.jsxs)("div",{className:Sj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:Sj.content,children:[(0,ct.jsx)("h1",{className:Sj.title,children:i[p].name}),(0,ct.jsxs)("div",{className:Sj["slide-show"],children:[(0,ct.jsx)("button",{className:Sj.previous,onClick:function(){var e=0===p?f.length-1:p-1;h(e),c(i[e]._id)},children:"Previous"}),(0,ct.jsx)("img",{src:f[p].src,alt:f[p].alt}),(0,ct.jsx)("button",{className:Sj.next,onClick:function(){var e=(p+1)%f.length;h(e),c(i[e]._id)},children:"Next"})]}),(0,ct.jsx)("p",{className:Sj.description,children:i[p].description}),(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:Sj["leave-button"],children:"Leave session"})]})]})}var Zj={container:"tutorial_container__TQGNW",heading:"tutorial_heading__EjTCn",video:"tutorial_video__Ujh4O"},Yj=n.p+"static/media/slingo.3b748b8febeaab375e97.mp4";function Qj(){var e=qe();return localStorage.setItem("was_visited",1),(0,ct.jsxs)("div",{className:Zj.container,children:[(0,ct.jsxs)("div",{className:Zj.heading,children:[(0,ct.jsx)("h1",{children:"Slingo uses your camera!"}),(0,ct.jsx)("p",{children:"So ensure your camera permissions are turned on!"})]}),(0,ct.jsx)("div",{className:Zj.video,children:(0,ct.jsx)("video",{src:Yj,width:800,height:600,autoPlay:!0,muted:!0,loop:!0})}),(0,ct.jsx)("button",{onClick:function(){return e("../home")},children:"Continue"})]})}var Jj={container:"learnInteractive_container__9DBF5",content:"learnInteractive_content__82L1h","slide-show":"learnInteractive_slide-show__zv8HF",previous:"learnInteractive_previous__GL6Fi",next:"learnInteractive_next__krdgm",description:"learnInteractive_description__mbObs","leave-button":"learnInteractive_leave-button__Da34T"};function $j(){var e=qe(),t=H((0,S.useState)(!0),2),n=t[0],r=t[1],a=H((0,S.useState)([]),2),i=a[0],o=a[1],s=H((0,S.useState)(""),2),u=s[0],c=s[1];(0,S.useEffect)((function(){var e=function(){var e=mt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"http://localhost:8080/api/courses/greetings",e.next=4,ir.get("http://localhost:8080/api/courses/greetings");case 4:t=e.sent,n=t.data,o(n.course.signs),c(n.course.signs[0]._id),r(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var l=localStorage.getItem("userid"),d=H((0,S.useState)(0),2),p=d[0],h=d[1];(0,S.useEffect)((function(){if(!n){var e=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://localhost:8080/api/progress/".concat(l,"/").concat(u),e.next=4,ir.post(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();e()}}),[p]);var f=[{src:Nj,alt:"afternoon"},{src:Ij,alt:"bad"},{src:Tj,alt:"good"},{src:Ej,alt:"hello"},{src:_j,alt:"how"},{src:Rj,alt:"luck"},{src:Aj,alt:"meet"},{src:Oj,alt:"morning"},{src:Fj,alt:"name"},{src:Dj,alt:"thanks"},{src:Lj,alt:"you"}];var v=H((0,S.useState)(""),2),m=(v[0],v[1]),g=(0,S.useRef)(null),y=(0,S.useRef)(null),b=function(){var e=mt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TI("https://raw.githubusercontent.com/dp846/SlingoModels/main/model.json");case 2:t=e.sent,setInterval((function(){x(t)}),16.7);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=mt(ft().mark((function e(t){var n,r,a,i,o,s,u,c,l,d,p,h;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof g.current||null===g.current||4!==g.current.video.readyState){e.next=31;break}return n=g.current.video,r=g.current.video.videoWidth,a=g.current.video.videoHeight,g.current.video.width=r,g.current.video.height=a,y.current.width=r,y.current.height=a,i=sd(n),o=Fm.resizeBilinear(i,[640,480]),s=o.cast("int32"),u=s.expandDims(0),e.next=14,t.executeAsync(u);case 14:return c=e.sent,e.next=17,c[2].array();case 17:return l=e.sent,e.next=20,c[4].array();case 20:return d=e.sent,e.next=23,c[7].array();case 23:p=e.sent,h=y.current.getContext("2d"),requestAnimationFrame((function(){fj(l[0],d[0],p[0],.65,r,a,h,m)})),el(i),el(o),el(s),el(u),el(c);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!n)return b(),(0,ct.jsxs)("div",{className:Jj.container,children:[(0,ct.jsx)(lt,{}),(0,ct.jsxs)("div",{className:Jj.content,children:[(0,ct.jsx)("h1",{className:Jj.title,children:i[p].name}),(0,ct.jsxs)("div",{className:Jj["slide-show"],children:[(0,ct.jsx)("button",{className:Jj.previous,onClick:function(){var e=0===p?f.length-1:p-1;h(e),c(i[e]._id)},children:"Previous"}),(0,ct.jsx)("img",{src:f[p].src,alt:f[p].alt}),(0,ct.jsxs)("div",{style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:640,height:480},children:[(0,ct.jsx)(hr(),{ref:g,muted:!0}),(0,ct.jsx)("canvas",{ref:y,style:{position:"absolute",zIndex:8,width:640,height:480}})]}),(0,ct.jsx)("button",{className:Jj.next,onClick:function(){var e=(p+1)%f.length;h(e),c(i[e]._id)},children:"Next"})]}),(0,ct.jsx)("p",{className:Jj.description,children:i[p].description}),(0,ct.jsx)("button",{onClick:function(){return e("/learn")},className:Jj["leave-button"],children:"Leave session"})]})]})}var eH=function(){return(0,ct.jsx)("div",{children:(0,ct.jsxs)(at,{children:[(0,ct.jsx)(nt,{path:"home",element:(0,ct.jsx)(dt,{})}),(0,ct.jsx)(nt,{exact:!0,path:"Slingo",element:(0,ct.jsx)(ht,{})}),(0,ct.jsx)(nt,{path:"login",element:(0,ct.jsx)(sr,{})}),(0,ct.jsx)(nt,{path:"signup",element:(0,ct.jsx)(cr,{})}),(0,ct.jsx)(nt,{path:"forgot-password",element:(0,ct.jsx)(dr,{})}),(0,ct.jsx)(nt,{path:"tutorial",element:(0,ct.jsx)(Qj,{})}),(0,ct.jsx)(nt,{path:"learn",element:(0,ct.jsx)(Cj,{})}),(0,ct.jsx)(nt,{path:"learnSign",element:(0,ct.jsx)(Mj,{})}),(0,ct.jsx)(nt,{path:"learnInteractively",element:(0,ct.jsx)($j,{})}),(0,ct.jsx)(nt,{path:"learnSign2",element:(0,ct.jsx)(Xj,{})}),(0,ct.jsx)(nt,{path:"quiz",element:(0,ct.jsx)(gj,{})}),(0,ct.jsx)(nt,{path:"quiz2",element:(0,ct.jsx)(yj,{})}),(0,ct.jsx)(nt,{path:"translate",element:(0,ct.jsx)(xj,{})})]})})};function tH(e){var t,n=e.basename,r=e.children,a=e.window,i=S.useRef();null==i.current&&(i.current=(void 0===(t={window:a,v5Compat:!0})&&(t={}),ne((function(e,t){var n=e.location;return $("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:ee(t)}),null,t)));var o=i.current,s=H(S.useState({action:o.action,location:o.location}),2),u=s[0],c=s[1];return S.useLayoutEffect((function(){return o.listen(c)}),[o]),S.createElement(rt,{basename:n,children:r,location:u.location,navigationType:u.action,navigator:o})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var nH,rH;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(nH||(nH={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(rH||(rH={}));I.createRoot(document.getElementById("root")).render((0,ct.jsx)(tH,{basname:"Slingo",children:(0,ct.jsx)(eH,{})}))}()}();
//# sourceMappingURL=main.a530f825.js.map